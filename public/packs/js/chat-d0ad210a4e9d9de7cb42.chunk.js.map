{"version":3,"sources":["webpack:///./app/javascript/packs/chat.js"],"names":["Chat","container","this","container_class","loading_box","loading_box_class","waiting_time_for_next_message","loading_time","calculate_reading_time","string","length","calculate_loading_time","add_left_chat_message","data","self","append_loading_box_left","then","append_message_to_box","setTimeout","chat_messages_controller","children","id","content","add_right_chat_message","get_chat_message","append_loading_box_right","add_buttons","log","console","remove_buttons","Promise","resolve","reject","$","empty","html_buttons","i","append","click","image_url","html","start","ajax","method","url","done","append_loading_box","remove_loading_box","remove","append_message_left"],"mappings":"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","file":"js/chat-d0ad210a4e9d9de7cb42.chunk.js","sourcesContent":["export function Chat(container) {\n  this.container = container,\n  this.container_class = \".\" + this.container,\n  this.loading_box = this.container + \"_loading_box\",\n  this.loading_box_class = \".\" + this.loading_box,\n  this.waiting_time_for_next_message = 1000,\n  this.loading_time = 1000,\n  this.calculate_reading_time = function(string){\n    return 2000 + string.length * 50\n  },\n  this.calculate_loading_time = function(string){\n    return 1000 //+ string.length * 25\n  },\n  this.add_left_chat_message = function(data) {\n    var self = this;\n\n    self.append_loading_box_left(data)\n    .then(data => self.append_message_to_box(data))\n    .then(data =>\n      setTimeout(function(){\n        self.chat_messages_controller(data.children[0].id)\n      }, self.calculate_reading_time(data.content))\n    )\n  },\n  this.add_right_chat_message = function(id) {\n    var self = this;\n    self.get_chat_message(id)\n    .then(data => self.append_loading_box_right(data))\n    .then(data => self.append_message_to_box(data))\n    .then(data =>\n      setTimeout(function(){\n        self.chat_messages_controller(data.children[0].id)\n      }, self.calculate_reading_time(data.content))\n    )\n  },\n  this.chat_messages_controller = function(id){\n\n    var self = this;\n    self.get_chat_message(id)\n    .then(function(data){\n      self.append_message_to_box(data);\n\n        if (data[\"chatter\"] === \"computer\"){\n          self.add_left_chat_message(data)\n        } else {\n          self.add_buttons(data[\"siblings\"]);\n        }\n      }\n    )\n  },\n  this.log = function(){\n    console.log(\"OOOOGOGOGIJAOGAG\")\n  },\n  this.remove_buttons = function(){\n    return new Promise(function(resolve, reject)\n    {\n      $(\".chat-buttons-parent\").empty();\n      resolve();\n    });\n  },\n  this.add_buttons = function(children){\n    var self = this;\n    var html_buttons = \"\";\n\n    for (let i = 0; i < children.length; i++) {\n      html_buttons += `<button class=\"btn btn-light chat-buttons\" data-chat-message-id=\"${children[i].id}\" type=\"button\">${children[i].content}</button>`;\n    }\n\n    return new Promise(function(resolve, reject)\n    {\n    $(self.container_class).append(`\n      <div class=\"d-grid gap-4 col-6 mx-auto chat-buttons-parent\">\n        ${html_buttons}\n      </div>\n      `)\n\n      $(\".chat-buttons\").click(function(){\n        console.log($(this).data(\"chat-message-id\"));\n        self.remove_buttons()\n        .then(data => self.add_right_chat_message($(this).data(\"chat-message-id\")));\n      });\n\n      resolve(children)\n    })\n  },\n  this.append_loading_box_left = function(data){\n    var self = this;\n    return new Promise(function(resolve, reject)\n    {\n    $(self.container_class).append(`\n      <div class=\"chat-section-field\">\n        <div class=\"row\">\n            <div class=\"col-12 d-flex align-items-end\">\n              <div class=\"\" style=\"padding-right: 0.5rem;\">\n                <img src=\"${data.image_url}\" class=\"rounded-circle border-white white-border-for-rounded-circle bg-white\" width=\"50px\" height=\"50px\">\n              </div>\n              <div class=\"chat-bg-computer chat-text chat-argument-field chat_message_${data.id}\">\n                <div class=\"lds-ellipsis\"><div></div><div></div><div></div><div></div></div>\n              </div>\n            </div>\n        </div>\n      </div>\n      `)\n      resolve(data)\n    })\n  },\n  this.append_loading_box_right = function(data){\n    var self = this;\n    return new Promise(function(resolve, reject)\n    {\n    $(self.container_class).append(`\n      <div class=\"chat-section-field\">\n        <div class=\"row\">\n            <div class=\"col-12 d-flex align-items-end justify-content-end\">\n              <div class=\"chat-bg-computer chat-text chat-argument-field chat_message_${data.id}\">\n                <div class=\"lds-ellipsis\"><div></div><div></div><div></div><div></div></div>\n              </div>\n              <div class=\"\" style=\"padding-left: 0.5rem;\">\n                <img src=\"${data.image_url}\" class=\"rounded-circle border-white white-border-for-rounded-circle bg-white\" width=\"50px\" height=\"50px\">\n              </div>\n            </div>\n        </div>\n      </div>\n      `)\n      resolve(data)\n    })\n  },\n  this.append_message_to_box = function(data){\n    var self = this;\n    return new Promise(function(resolve, reject)\n    {\n      setTimeout(function(){\n        $(\".chat_message_\" + data.id).html(data.content);\n        resolve(data)\n      }, self.calculate_loading_time(data.content))\n\n    })\n  },\n  this.start = function() {\n    var self = this;\n    self.chat_messages_controller(1)\n  },\n  this.get_chat_message = function(id){\n    return new Promise(function(resolve, reject)\n    {\n    $.ajax({\n      method: \"GET\",\n      url: \"/chat_messages/\" + id + \"/json\"\n        })\n      .done(function( data ) {\n        resolve(data);\n      });\n    })\n  },\n  this.append_loading_box = function(){\n    $(this.container_class).append(`\n      <div class=\"${this.loading_box} chat-bg-computer chat-text chat-argument-field\">\n        <div class=\"lds-ellipsis\"><div></div><div></div><div></div><div></div></div>\n      </div>\n    `);\n  },\n  this.remove_loading_box = function(){\n    $(this.loading_box_class).remove();\n  },\n  this.append_message_left = function(data){\n    var self = this;\n    return new Promise(function(resolve, reject)\n    {\n    $(self.container_class).append(`\n      <div class=\"chat-section-field\">\n        <div class=\"row\">\n            <div class=\"col-12 d-flex align-items-end\">\n              <div class=\"\" style=\"padding-right: 0.5rem;\">\n                <img src=\"${data.image_url}\" class=\"rounded-circle border-white white-border-for-rounded-circle bg-white\" width=\"50px\" height=\"50px\">\n              </div>\n              <div class=\"chat-bg-computer chat-text chat-argument-field chat_message_${data.id}\">\n                <div class=\"lds-ellipsis\"><div></div><div></div><div></div><div></div></div>\n              </div>\n            </div>\n        </div>\n      </div>\n      `)\n      resolve(data)\n    })\n  }\n}\n"],"sourceRoot":""}