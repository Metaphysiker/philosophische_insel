!function(){"use strict";function n(n,e){var t={};for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t}function e(n,e,t){if(t||2===arguments.length)for(var o,r=0,i=e.length;r<i;r++)!o&&r in e||((o=o||Array.prototype.slice.call(e,0,r))[r]=e[r]);return n.concat(o||Array.prototype.slice.call(e))}function t(n){return function(e){return o=typeof(t=e),(null===t?"null":"object"==o&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==o&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":o)===n;var t,o}}function o(n){return function(e){return typeof e===n}}function r(n){return function(e){return n===e}}function i(n){return!(null==n)}function u(){}function c(n,e){return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return n(e.apply(null,t))}}function a(n){return function(){return n}}function s(n){return n}function f(n,e){return n===e}function l(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var r=e.concat(t);return n.apply(null,r)}}function d(n){return function(e){return!n(e)}}function m(n){return function(){throw new Error(n)}}function g(n){return n()}function p(){return Xc}function h(n){return n()}function v(n){var e,t=!1;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return t||(t=!0,e=n.apply(null,o)),e}}function b(n,e){return-1<Jc.call(n,e)}function y(n,e){for(var t=0,o=n.length;t<o;t++)if(e(n[t],t))return 1}function x(n,e){for(var t=n.length,o=new Array(t),r=0;r<t;r++){var i=n[r];o[r]=e(i,r)}return o}function w(n,e){for(var t=0,o=n.length;t<o;t++)e(n[t],t)}function S(n,e){for(var t=[],o=0,r=n.length;o<r;o++){var i=n[o];e(i,o)&&t.push(i)}return t}function O(n,e,t){return function(n){for(var o,r=n.length-1;0<=r;r--)o=n[r],t=e(t,o,r)}(n),t}function k(n,e,t){return w(n,(function(n,o){t=e(t,n,o)})),t}function T(n,e){return function(n,e,t){for(var o=0,r=n.length;o<r;o++){var i=n[o];if(e(i,o))return Yc.some(i);if(t(i,o))break}return Yc.none()}(n,e,Uc)}function C(n,e){for(var t=0,o=n.length;t<o;t++)if(e(n[t],t))return Yc.some(t);return Yc.none()}function E(n){for(var e=[],t=0,o=n.length;t<o;++t){if(!Pc(n[t]))throw new Error("Arr.flatten item "+t+" was not an array, input: "+n);Qc.apply(e,n[t])}return e}function D(n,e){return E(x(n,e))}function M(n,e){for(var t=0,o=n.length;t<o;++t)if(!0!==e(n[t],t))return!1;return!0}function _(n){var e=Kc.call(n,0);return e.reverse(),e}function R(n,e){return S(n,(function(n){return!b(e,n)}))}function F(n){return[n]}function I(n,e){for(var t=0;t<n.length;t++){var o=e(n[t],t);if(o.isSome())return o}return Yc.none()}function V(n,e){var t=String(e).toLowerCase();return T(n,(function(n){return n.search(t)}))}function B(n,e){return-1!==n.indexOf(e)}function A(n){return function(e){return B(e,n)}}function N(n){return window.matchMedia(n).matches}function H(n){return a("alloy."+n)}function P(n,e){Ua(n,n.element,e,{})}function z(n,e,t){Ua(n,n.element,e,t)}function j(n){P(n,Ba())}function L(n,e,t){Ua(n,e,t,{})}function $(n,e){var t=n.dom;if(1!==t.nodeType)return!1;var o=t;if(void 0!==o.matches)return o.matches(e);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(e);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(e);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")}function G(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount}function U(n,e){var t=void 0===e?document:e.dom;return G(t)?[]:x(t.querySelectorAll(n),Wa.fromDom)}function W(n,e){var t=void 0===e?document:e.dom;return G(t)?Yc.none():Yc.from(t.querySelector(n)).map(Wa.fromDom)}function X(n,e){return n.dom===e.dom}function q(){return Zc(0,0)}function Y(n){function e(n){return function(){return t===n}}var t=n.current,o=n.version;return{current:t,version:o,isEdge:e("Edge"),isChrome:e("Chrome"),isIE:e("IE"),isOpera:e("Opera"),isFirefox:e(ra),isSafari:e("Safari")}}function K(n){function e(n){return function(){return t===n}}var t=n.current,o=n.version;return{current:t,version:o,isWindows:e(ca),isiOS:e("iOS"),isAndroid:e(aa),isOSX:e("OSX"),isLinux:e("Linux"),isSolaris:e(sa),isFreeBSD:e(fa),isChromeOS:e(la)}}function J(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}}function Q(n){return n.dom.nodeName.toLowerCase()}function Z(n){return function(e){return e.dom.nodeType===n}}function nn(n){return Wa.fromDom(n.dom.ownerDocument)}function en(n){return Ja(n)?n:nn(n)}function tn(n){return Yc.from(n.dom.parentNode).map(Wa.fromDom)}function on(n,e){var t=n.dom.childNodes;return Yc.from(t[e]).map(Wa.fromDom)}function rn(n,e){tn(n).each((function(t){t.dom.insertBefore(e.dom,n.dom)}))}function un(n,e){Yc.from(n.dom.nextSibling).map(Wa.fromDom).fold((function(){tn(n).each((function(n){ns(n,e)}))}),(function(n){rn(n,e)}))}function cn(n,e){on(n,0).fold((function(){ns(n,e)}),(function(t){n.dom.insertBefore(e.dom,t.dom)}))}function an(n,e){w(e,(function(e){ns(n,e)}))}function sn(n){n.dom.textContent="",w(Za(n),(function(n){es(n)}))}function fn(n){return Qa(n)&&i(n.dom.host)}function ln(n){return Wa.fromDom(n.dom.host)}function dn(){return cs(Wa.fromDom(document))}function mn(n,e){ns(n.element,e.element)}function gn(n){var e,t=tn(n.element).bind((function(e){return n.getSystem().getByDom(e).toOptional()}));as(e=n),es(e.element),e.getSystem().removeFromWorld(e),t.each((function(n){n.syncComponents()}))}function pn(n,e){for(var t=ls(n),o=0,r=t.length;o<r;o++){var i=t[o];e(n[i],i)}}function hn(n,e){return ms(n,(function(n,t){return{k:t,v:e(n,t)}}))}function vn(n,e){var t=[];return pn(n,(function(n,o){t.push(e(n,o))})),t}function bn(n,e){return gs(n,e)?Yc.from(n[e]):Yc.none()}function yn(n,e){return gs(n,e)&&void 0!==n[e]&&null!==n[e]}function xn(n,e,t){if(!(Nc(t)||jc(t)||Gc(t)))throw console.error("Invalid call to Attribute.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")}function wn(n,e,t){xn(n.dom,e,t)}function Sn(n,e){var t=n.dom;pn(e,(function(n,e){xn(t,e,n)}))}function On(n,e){var t=n.dom.getAttribute(e);return null===t?void 0:t}function kn(n,e){return Yc.from(On(n,e))}function Tn(n,e){var t=n.dom;return!(!t||!t.hasAttribute)&&t.hasAttribute(e)}function Cn(n,e){n.dom.removeAttribute(e)}function En(n,e){var t=On(n,e);return void 0===t||""===t?[]:t.split(" ")}function Dn(n){return void 0!==n.dom.classList}function Mn(n,e){var t,o,r;Dn(n)?n.dom.classList.add(e):(o=e,r=En(t=n,"class").concat([o]),wn(t,"class",r.join(" ")))}function _n(n,e){var t,o,r,i;Dn(n)?n.dom.classList.remove(e):(r=e,0<(i=S(En(o=n,"class"),(function(n){return n!==r}))).length?wn(o,"class",i.join(" ")):Cn(o,"class")),0===(Dn(t=n)?t.dom.classList:En(t,"class")).length&&Cn(t,"class")}function Rn(n,e){return Dn(n)&&n.dom.classList.contains(e)}function Fn(n,e,t){_n(n,t),Mn(n,e)}function In(n,e,t){return n.stype===Xa.Error?e(n.serror):t(n.svalue)}function Vn(n){return{stype:Xa.Value,svalue:n}}function Bn(n){return{stype:Xa.Error,serror:n}}function An(n,e,t,o){return{tag:"field",key:n,newKey:e,presence:t,prop:o}}function Nn(n,e,t){switch(n.tag){case"field":return e(n.key,n.newKey,n.presence,n.prop);case"custom":return t(n.newKey,n.instantiator)}}function Hn(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)throw new Error("Can't merge zero objects");for(var o={},r=0;r<e.length;r++){var i,u=e[r];for(i in u)gs(u,i)&&(o[i]=n(o[i],u[i]))}return o}}function Pn(){return{tag:"required",process:{}}}function zn(n){return{tag:"defaultedThunk",process:n}}function jn(n){return zn(a(n))}function Ln(){return{tag:"option",process:{}}}function $n(n){return{tag:"mergeWithThunk",process:n}}function Gn(n){return Hc(n)&&100<ls(n).length?" removed due to size":JSON.stringify(n,null,2)}function Un(n,e){return Ss([{path:n,getErrorInfo:e}])}function Wn(n){return{extract:function(e,t){return ks(n(t),(function(n){return Un(e,a(n))}))},toString:a("val")}}function Xn(n,e,t,o){return o(bn(n,e).getOrThunk((function(){return t(n)})))}function qn(n,e,t,o,r){function i(n){return r.extract(e.concat([o]),n)}function u(n){return n.fold((function(){return ws(Yc.none())}),(function(n){var t=r.extract(e.concat([o]),n);return Ts(t,Yc.some)}))}var c,s,f,l,d,m;switch(n.tag){case"required":return f=e,m=i,bn(l=t,d=o).fold((function(){return n=d,e=l,Un(f,(function(){return'Could not find valid *required* value for "'+n+'" in '+Gn(e)}));var n,e}),m);case"defaultedThunk":return Xn(t,o,n.process,i);case"option":return u(bn(t,o));case"defaultedOptionThunk":return s=n.process,u(bn(c=t,o).map((function(n){return!0===n?s(c):n})));case"mergeWithThunk":return Xn(t,o,a({}),(function(e){return i(Ds(n.process(t),e))}))}}function Yn(n){var e=Fs(n),t=O(n,(function(n,e){return Nn(e,(function(e){var t;return Ds(n,((t={})[e]=!0,t))}),a(n))}),{});return{extract:function(n,o){var r,c,a,s,f,l,d=S(jc(o)?[]:ls((a=i,s=c={},f=function(n,e){s[e]=n},l=u,pn(o,(function(n,e){(a(n,e)?f:l)(n,e)})),c)),(function(n){return!yn(t,n)}));return 0===d.length?e.extract(n,o):(r=d,Un(n,(function(){return"There are unsupported fields: ["+r.join(", ")+"] specified"})))},toString:e.toString}}function Kn(n,e){return{extract:function(t,o){var r,i,u,c=ls(o),a=(u=Wn(n),r=t,i=x(c,(function(n,e){return u.extract(r.concat(["["+e+"]"]),n)})),_s(i));return Os(a,(function(n){var r=x(n,(function(n){return An(n,n,Pn(),e)}));return Fs(r).extract(t,o)}))},toString:function(){return"setOf("+e.toString()+")"}}}function Jn(n,e){return{extract:function(t,o){return bn(o,n).fold((function(){return e=n,Un(t,(function(){return'Choice schema did not contain choice key: "'+e+'"'}));var e}),(function(n){return r=t,i=o,bn(u=e,c=n).fold((function(){return n=u,e=c,Un(r,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+Gn(n)}));var n,e}),(function(n){return n.extract(r.concat(["branch: "+c]),i)}));var r,i,u,c}))},toString:function(){return"chooseOn("+n+"). Possible values: "+ls(e)}}}function Qn(n){return Wn((function(e){return n(e).fold(Ss,ws)}))}function Zn(n,e){return Kn((function(e){return n(e).fold(Bn,Vn)}),e)}function ne(n,e,t){return xs((r=e.extract([n],o=t),Cs(r,(function(n){return{input:o,errors:n}}))));var o,r}function ee(n){return n.fold((function(n){throw new Error(Bs(n))}),s)}function te(n,e,t){return ee(ne(n,e,t))}function oe(n,e){return Jn(n,hn(e,Fs))}function re(n){return As(n,n,Pn(),Is())}function ie(n,e){return As(n,n,Pn(),e)}function ue(n,e){return As(n,n,Pn(),Fs(e))}function ce(n){return As(n,n,Ln(),Is())}function ae(n,e){return As(n,n,Ln(),e)}function se(n,e){return ae(n,Fs(e))}function fe(n,e){return ae(n,Yn(e))}function le(n,e){return As(n,n,jn(e),Is())}function de(n,e,t){return As(n,n,jn(e),t)}function me(n){if(!Pc(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var e=[],t={};return w(n,(function(o,r){var i=ls(o);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],c=o[u];if(void 0!==t[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!Pc(c))throw new Error("case arguments must be an array");e.push(u),t[u]=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var i=t.length;if(i!==c.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+c.length+" ("+c+"), got "+i);return{fold:function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];if(e.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+e.length);return e[r].apply(null,t)},match:function(n){var o=ls(n);if(e.length!==o.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+o.join(","));if(!M(e,(function(n){return b(o,n)})))throw new Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+e.join(", "));return n[u].apply(null,t)},log:function(n){console.log(n,{constructors:e,constructor:u,params:t})}}}})),t}function ge(n,e){return(t={})[n]=e,t;var t}function pe(n){return e={},w(n,(function(n){e[n.key]=n.value})),e;var e}function he(n,e,t){return void 0===t&&(t=f),n.exists((function(n){return t(n,e)}))}function ve(n){for(var e=[],t=function(n){e.push(n)},o=0;o<n.length;o++)n[o].each(t);return e}function be(n){return $c(n)?n:Uc}function ye(n,e){return X(n.element,e.event.target)}function xe(n){if(!yn(n,"can")&&!yn(n,"abort")&&!yn(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return Ac(Ac({},Ls),n)}function we(n,e){return{key:n,value:xe({abort:e})}}function Se(n,e){return{key:n,value:xe({run:e})}}function Oe(n,e,t){return{key:n,value:xe({run:function(n,o){e.apply(void 0,[n,o].concat(t))}})}}function ke(n){return function(e){return{key:n,value:xe({run:function(n,t){ye(n,t)&&e(n,t)}})}}}function Te(n,e,t){var o,r,i=e.partUids[t];return r=i,Se(o=n,(function(n,e){n.getSystem().getByUid(r).each((function(n){var t=n.element,r=o,i=e;n.getSystem().triggerEvent(r,t,i.event)}))}))}function Ce(n){return Se(n,(function(n,e){e.cut()}))}function Ee(n,e){var t=n.toString(),o=t.indexOf(")")+1,r=t.indexOf("("),i=t.substring(r+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:e,parameters:qs(i)}},n}function De(n){return{classes:Lc(n.classes)?[]:n.classes,attributes:Lc(n.attributes)?{}:n.attributes,styles:Lc(n.styles)?{}:n.styles}}function Me(n,e,t){return Ws((function(o){t(o,n,e)}))}function _e(n){return{key:n,value:void 0}}function Re(n){var e=te("Creating behaviour: "+n.name,Zs,n),t=e.fields,o=e.name,r=e.active,i=e.apis,u=e.extra,c=e.state,a=Yn(t),s=se(o,[fe("config",t)]);return Ys(a,s,o,r,i,u,c)}function Fe(n){var e=n;return{get:function(){return e},set:function(n){e=n}}}function Ie(n){return n.dom.focus()}function Ve(n){return n.dom.blur()}function Be(n){return void 0===n&&(n=Wa.fromDom(document)),Yc.from(n.dom.activeElement).map(Wa.fromDom)}function Ae(n){return Be(rs(n)).filter((function(e){return n.dom.contains(e.dom)}))}function Ne(n){return n.dom.innerHTML}function He(n){if(fn(n))return"#shadow-root";var e=Wa.fromDom(n.dom.cloneNode(!1)),t=Wa.fromTag("div"),o=Wa.fromDom(e.dom.cloneNode(!0));return ns(t,o),Ne(t)}function Pe(n,e,t){var o,r,i,u;switch(bn(mf.get(),n).orThunk((function(){return I(ls(mf.get()),(function(e){return-1<n.indexOf(e)?Yc.some(mf.get()[e]):Yc.none()}))})).getOr(zs.NORMAL)){case zs.NORMAL:return t(pf());case zs.LOGGING:var c=(o=n,r=e,i=[],u=(new Date).getTime(),{logEventCut:function(n,e,t){i.push({outcome:"cut",target:e,purpose:t})},logEventStopped:function(n,e,t){i.push({outcome:"stopped",target:e,purpose:t})},logNoParent:function(n,e,t){i.push({outcome:"no-parent",target:e,purpose:t})},logEventNoHandlers:function(n,e){i.push({outcome:"no-handlers-left",target:e})},logEventResponse:function(n,e,t){i.push({outcome:"response",purpose:t,target:e})},write:function(){var n=(new Date).getTime();b(["mousemove","mouseover","mouseout",Pa()],o)||console.log(o,{event:o,time:n-u,target:r.dom,sequence:x(i,(function(n){return b(["cut","stopped","response"],n.outcome)?"{"+n.purpose+"} "+n.outcome+" at ("+He(n.target)+")":n.outcome}))})}}),a=t(c);return c.write(),a;case zs.STOP:return!0}}function ze(n,e,t){return void 0!==(o=new Error).stack&&T(o.stack.split("\n"),(function(n){return 0<n.indexOf("alloy")&&!y(gf,(function(e){return-1<n.indexOf(e)}))})).getOr(df),As(e,e,t,Qn((function(n){return bs.value((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.apply(void 0,e)}))})));var o}function je(n){return ze(0,n,jn(u))}function Le(n){return ze(0,n,jn(Yc.none))}function $e(n){return ze(0,n,Pn())}function Ge(n){return ze(0,n,Pn())}function Ue(n,e){return Ns(n,a(e))}function We(n){return Ns(n,s)}function Xe(n,e,t){var o=e.aria;o.update(n,o,t.get())}function qe(n,e,t){e.toggleClass.each((function(e){(t.get()?Mn:_n)(n.element,e)}))}function Ye(n,e,t){pt(n,e,t,!t.get())}function Ke(n,e,t){t.set(!0),qe(n,e,t),Xe(n,e,t)}function Je(n,e,t){t.set(!1),qe(n,e,t),Xe(n,e,t)}function Qe(n,e,t){pt(n,e,t,e.selected)}function Ze(n,e){return Sf.config({channels:ge(af,{onReceive:function(t,o){o.command===n&&e(t,o.state)}})})}function nt(n){return Sf.config({channels:ge(sf,{onReceive:n})})}function et(n,e){return{key:n,value:{onReceive:e}}}function tt(){function n(n,e){e.stop(),j(n)}return[Se(Ea(),n),Se(Na(),n),Ce(ha()),Ce(ya())]}function ot(n,e){e.ignore||(Ie(n.element),e.onFocus(n))}function rt(n){return void 0!==n.style&&$c(n.style.getPropertyValue)}function it(n,e,t){if(!Nc(t))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);rt(n)&&n.style.setProperty(e,t)}function ut(n,e,t){it(n.dom,e,t)}function ct(n,e){var t=n.dom;pn(e,(function(n,e){it(t,e,n)}))}function at(n,e){var t=n.dom,o=window.getComputedStyle(t).getPropertyValue(e);return""!==o||us(n)?o:Rf(t,e)}function st(n,e){var t=n.dom,o=Rf(t,e);return Yc.from(o).filter((function(n){return 0<n.length}))}function ft(n,e){var t,o=e;rt(t=n.dom)&&t.style.removeProperty(o),he(kn(n,"style").map(ea),"")&&Cn(n,"style")}function lt(n){return n.dom.offsetWidth}function dt(n,e){function t(t){var o=e(t);if(o<=0||null===o){var r=at(t,n);return parseFloat(r)||0}return o}function o(n,e){return k(e,(function(e,t){var o=at(n,t),r=void 0===o?0:parseInt(o,10);return isNaN(r)?e:e+r}),0)}return{set:function(e,t){if(!Gc(t)&&!t.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+t);var o=e.dom;rt(o)&&(o.style[n]=t+"px")},get:t,getOuter:t,aggregate:o,max:function(n,e,t){var r=o(n,t);return r<e?e-r:0}}}function mt(n){return Ff.get(n)}function gt(n,e){return U(e,n)}function pt(n,e,t,o){(o?Ke:Je)(n,e,t)}function ht(n,e,t){wn(n.element,"aria-expanded",t)}function vt(n,e,t,o,r){return n(t,o)?Yc.some(t):$c(r)&&r(t)?Yc.none():e(t,o,r)}function bt(n,e,t){for(var o=n.dom,r=$c(t)?t:Uc;o.parentNode;){o=o.parentNode;var i=Wa.fromDom(o);if(e(i))return Yc.some(i);if(r(i))break}return Yc.none()}function yt(n,e,t){return bt(n,(function(n){return $(n,e)}),t)}function xt(n,e){return W(e,n)}function wt(n,e,t){return vt($,yt,n,e,t)}function St(n,e,t){var o=_(n.slice(0,e)),r=_(n.slice(e+1));return T(o.concat(r),t)}function Ot(n,e,t){return T(_(n.slice(0,e)),t)}function kt(n,e,t){var o=n.slice(0,e);return T(n.slice(e+1).concat(o),t)}function Tt(n,e,t){return T(n.slice(e+1),t)}function Ct(n){return function(e){var t=e.raw;return b(n,t.which)}}function Et(n){return function(e){return M(n,(function(n){return n(e)}))}}function Dt(n){return!0===n.raw.shiftKey}function Mt(n){return!0===n.raw.ctrlKey}function _t(n,e){return{matches:n,classification:e}}function Rt(n,e,t,o){var r=n+e;return o<r?t:r<t?o:r}function Ft(n,e,t){return Math.min(Math.max(n,e),t)}function It(n,e,t,o){w(gt(n.element,"."+e.highlightClass),(function(t){y(o,(function(n){return n.element===t}))||(_n(t,e.highlightClass),n.getSystem().getByDom(t).each((function(t){e.onDehighlight(n,t),P(t,Ga())})))}))}function Vt(n,e,t,o){It(n,e,0,[o]),Pt(0,e,0,o)||(Mn(o.element,e.highlightClass),e.onHighlight(n,o),P(o,$a()))}function Bt(n,e,t,o){var r=gt(n.element,"."+e.itemClass);return C(r,(function(n){return Rn(n,e.highlightClass)})).bind((function(e){var t=Rt(e,o,0,r.length-1);return n.getSystem().getByDom(r[t]).toOptional()}))}function At(n,e,t){e.exists((function(n){return t.exists((function(e){return X(e,n)}))}))||z(n,La(),{prevFocus:e,newFocus:t})}function Nt(){function n(n){return Ae(n.element)}return{get:n,set:function(e,t){var o=n(e);e.getSystem().triggerFocus(t,e.element),At(e,o,n(e))}}}function Ht(){function n(n){return Gf.getHighlighted(n).map((function(n){return n.element}))}return{get:n,set:function(e,t){var o=n(e);e.getSystem().getByDom(t).fold(u,(function(n){Gf.highlight(e,n)}));var r=n(e);At(e,o,r)}}}function Pt(n,e,t,o){return Rn(o.element,e.highlightClass)}function zt(n,e){return xt(n.element,"."+e.itemClass).bind((function(e){return n.getSystem().getByDom(e).toOptional()}))}function jt(n,e){var t=gt(n.element,"."+e.itemClass);return(0<t.length?Yc.some(t[t.length-1]):Yc.none()).bind((function(e){return n.getSystem().getByDom(e).toOptional()}))}function Lt(n,e){return ve(x(gt(n.element,"."+e.itemClass),(function(e){return n.getSystem().getByDom(e).toOptional()})))}function $t(n,e,t,o,r){function i(n,e,t,o,r){var i=t(n,e,o,r),u=e.event;return T(i,(function(n){return n.matches(u)})).map((function(n){return n.classification})).bind((function(t){return t(n,e,o,r)}))}var u={schema:function(){return n.concat([le("focusManager",Nt()),de("focusInside","onFocus",Qn((function(n){return b(["onFocus","onEnterOrSpace","onApi"],n)?bs.value(n):bs.error("Invalid value for focusInside")}))),Ue("handler",u),Ue("state",e),Ue("sendFocusIn",r)])},processKey:i,toEvents:function(n,e){var u=n.focusInside!==bf.OnFocusMode?Yc.none():r(n).map((function(t){return Se(Ra(),(function(o,r){t(o,n,e),r.stop()}))})),c=[Se(Oa(),(function(o,u){i(o,u,t,n,e).fold((function(){var t=o,i=u,c=Ct(Nf.concat(Bf))(i.event);n.focusInside===bf.OnEnterOrSpaceMode&&c&&ye(t,i)&&r(n).each((function(o){o(t,n,e),i.stop()}))}),(function(){u.stop()}))})),Se(ka(),(function(t,r){i(t,r,o,n,e).each((function(){r.stop()}))}))];return $s(u.toArray().concat(c))}};return u}function Gt(n){function e(n,e){return 0<mt(n.visibilitySelector.bind((function(n){return wt(e,n)})).getOr(e))}function t(n,t){var o=t,r=S(gt(n.element,o.selector),(function(n){return e(o,n)}));Yc.from(r[o.firstTabstop]).each((function(e){t.focusManager.set(n,e)}))}function o(n,t,o,r){var i,u=gt(n.element,o.selector);return(i=o).focusManager.get(n).bind((function(n){return wt(n,i.selector)})).bind((function(t){return C(u,l(X,t)).bind((function(t){return i=n,c=o,r(u,t,(function(n){return e(t=c,o=n)&&t.useTabstopAt(o);var t,o})).fold((function(){return c.cyclic?Yc.some(!0):Yc.none()}),(function(n){return c.focusManager.set(i,n),Yc.some(!0)}));var i,c}))}))}var r=[ce("onEscape"),ce("onEnter"),le("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),le("firstTabstop",0),le("useTabstopAt",Wc),ce("visibilitySelector")].concat([n]),i=a([_t(Et([Dt,Ct(Vf)]),(function(n,e,t){return o(n,0,t,t.cyclic?St:Ot)})),_t(Ct(Vf),(function(n,e,t){return o(n,0,t,t.cyclic?kt:Tt)})),_t(Ct(Af),(function(n,e,t){return t.onEscape.bind((function(t){return t(n,e)}))})),_t(Et([Lf,Ct(Bf)]),(function(n,e,t){return t.onEnter.bind((function(t){return t(n,e)}))}))]),u=a([]);return $t(r,Ks.init,i,u,(function(){return Yc.some(t)}))}function Ut(n){return"input"===Q(n)&&"radio"!==On(n,"type")||"textarea"===Q(n)}function Wt(n,e,t){return Ut(t)&&Ct(Nf)(e.event)?Yc.none():(L(n,t,Ba()),Yc.some(!0))}function Xt(){return Yc.some(!0)}function qt(n,e,t){return t.execute(n,e,n.element)}function Yt(n){function e(){return t.get().each(n)}var t=Fe(Yc.none());return{clear:function(){e(),t.set(Yc.none())},isSet:function(){return t.get().isSome()},get:function(){return t.get()},set:function(n){e(),t.set(Yc.some(n))}}}function Kt(){var n=Yt((function(n){return n.destroy()}));return Ac(Ac({},n),{run:function(e){return n.get().each(e)}})}function Jt(){var n=Yt(u);return Ac(Ac({},n),{on:function(e){return n.get().each(e)}})}function Qt(){var n=Jt();return Js({readState:function(){return n.get().map((function(n){return{numRows:String(n.numRows),numColumns:String(n.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(e,t){n.set({numRows:e,numColumns:t})},getNumRows:function(){return n.get().map((function(n){return n.numRows}))},getNumColumns:function(){return n.get().map((function(n){return n.numColumns}))}})}function Zt(n,e){return function(t){return"rtl"===il(t)?e:n}}function no(n){return function(e,t,o,r){var i=n(e.element);return ul(i,e,t,o,r)}}function eo(n,e){return no(Zt(n,e))}function to(n,e){return no(Zt(e,n))}function oo(n){return function(e,t,o,r){return ul(n,e,t,o,r)}}function ro(n){return!((e=n.dom).offsetWidth<=0&&e.offsetHeight<=0);var e}function io(n,e,t){var o,r=S(gt(n,t),ro);return C(o=r,(function(n){return X(n,e)})).map((function(n){return{index:n,candidates:o}}))}function uo(n,e){return C(n,(function(n){return X(e,n)}))}function co(n,e,t,o){return o(Math.floor(e/t),e%t).bind((function(e){var o=e.row*t+e.column;return 0<=o&&o<n.length?Yc.some(n[o]):Yc.none()}))}function ao(n,e,t,o,r){return co(n,e,o,(function(e,i){var u=e===t-1?n.length-e*o:o,c=Rt(i,r,0,u-1);return Yc.some({row:e,column:c})}))}function so(n,e,t,o,r){return co(n,e,o,(function(e,i){var u=Rt(e,r,0,t-1),c=Ft(i,0,(u===t-1?n.length-u*o:o)-1);return Yc.some({row:u,column:c})}))}function fo(n,e){xt(n.element,e.selector).each((function(t){e.focusManager.set(n,t)}))}function lo(n){return function(e,t,o,r){return io(e,t,o.selector).bind((function(e){return n(e.candidates,e.index,r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))}))}}function mo(n,e,t){return t.captureTab?Yc.some(!0):Yc.none()}function go(n,e,t,o){var r=function(n,e,t){var i,u=Rt(e,o,0,t.length-1);return u===n?Yc.none():"button"===Q(i=t[u])&&"disabled"===On(i,"disabled")?r(n,u,t):Yc.from(t[u])};return io(n,t,e).bind((function(n){var e=n.index,t=n.candidates;return r(e,e,t)}))}function po(n,e,t){return(o=t).focusManager.get(n).bind((function(n){return wt(n,o.selector)})).bind((function(o){return t.execute(n,e,o)}));var o}function ho(n,e){e.getInitial(n).orThunk((function(){return xt(n.element,e.selector)})).each((function(t){e.focusManager.set(n,t)}))}function vo(n,e,t){return go(n,t.selector,e,-1)}function bo(n,e,t){return go(n,t.selector,e,1)}function yo(n){return function(e,t,o,r){return n(e,t,o,r).bind((function(){return o.executeOnMove?po(e,t,o):Yc.some(!0)}))}}function xo(n,e,t){return t.onEscape(n,e)}function wo(n,e,t){return Yc.from(n[e]).bind((function(n){return Yc.from(n[t]).map((function(n){return{rowIndex:e,columnIndex:t,cell:n}}))}))}function So(n,e,t,o){return wo(n,e,Rt(t,o,0,n[e].length-1))}function Oo(n,e,t,o){var r=Rt(t,o,0,n.length-1);return wo(n,r,Ft(e,0,n[r].length-1))}function ko(n,e,t,o){return wo(n,e,Ft(t+o,0,n[e].length-1))}function To(n,e,t,o){var r=Ft(t+o,0,n.length-1);return wo(n,r,Ft(e,0,n[r].length-1))}function Co(n,e){e.previousSelector(n).orThunk((function(){var t=e.selectors;return xt(n.element,t.cell)})).each((function(t){e.focusManager.set(n,t)}))}function Eo(n,e){return function(t,o,r){var i=r.cycles?n:e;return wt(o,r.selectors.row).bind((function(n){return uo(gt(n,r.selectors.cell),o).bind((function(e){var o=gt(t,r.selectors.row);return uo(o,n).bind((function(n){var t,u=(t=r,x(o,(function(n){return gt(n,t.selectors.cell)})));return i(u,n,e).map((function(n){return n.cell}))}))}))}))}}function Do(n,e,t){return t.focusManager.get(n).bind((function(o){return t.execute(n,e,o)}))}function Mo(n,e){xt(n.element,e.selector).each((function(t){e.focusManager.set(n,t)}))}function _o(n,e,t){return go(n,t.selector,e,-1)}function Ro(n,e,t){return go(n,t.selector,e,1)}function Fo(n,e){return t=n,o={},r=x(e,(function(e){return t=e.name(),o="Cannot configure "+e.name()+" for "+n,As(t,t,Ln(),Wn((function(){return Ss("The field: "+t+" is forbidden. "+o)})));var t,o})).concat([Ns("dump",s)]),de(t,o,Fs(r));var t,o,r}function Io(n,e){return Ac(Ac({},Qs(e)),n.dump)}function Vo(n){return gs(n,"uiType")}function Bo(n){var e=(new Date).getTime();return n+"_"+Math.floor(1e9*Math.random())+ ++ql+String(e)}function Ao(n){function e(n){return n.name}return n.fold(e,e,e,e)}function No(n,e){return function(t){var o=te("Converting part type",e,t);return n(o)}}function Ho(n,e,t,o){return Ds(e.defaults(n,t,o),t,{uid:n.partUids[e.name]},e.overrides(n,t,o))}function Po(n,e,t){return o=e,r={},i={},w(t,(function(n){n.fold((function(n){r[n.pname]=Ul(!0,(function(e,t,o){return n.factory.sketch(Ho(e,n,t,o))}))}),(function(n){var e=o.parts[n.name];i[n.name]=a(n.factory.sketch(Ho(o,n,e[fd()]),e))}),(function(n){r[n.pname]=Ul(!1,(function(e,t,o){return n.factory.sketch(Ho(e,n,t,o))}))}),(function(n){r[n.pname]=Wl(!0,(function(e,t,o){return x(e[n.name],(function(t){return n.factory.sketch(Ds(n.defaults(e,t,o),t,n.overrides(e,t)))}))}))}))})),{internals:a(r),externals:a(i)};var o,r,i}function zo(n,e,t){return o=Yc.some(n),i=(r=e).components,f=hn(t,(function(n,e){return o=n,r=!1,{name:a(t=e),required:function(){return o.fold((function(n){return n}),(function(n){return n}))},used:function(){return r},replace:function(){if(r)throw new Error("Trying to use the same placeholder more than once: "+t);return r=!0,o}};var t,o,r})),u=o,c=r,s=f,l=D(i,(function(n){return Gl(u,c,n,s)})),pn(f,(function(n){if(!1===n.used()&&n.required())throw new Error("Placeholder: "+n.name()+" was not found in components list\nNamespace: "+o.getOr("none")+"\nComponents: "+JSON.stringify(r.components,null,2))})),l;var o,r,i,u,c,s,f,l}function jo(n,e,t){var o=e.partUids[t];return n.getSystem().getByUid(o).toOptional()}function Lo(n,e,t){return jo(n,e,t).getOrDie("Could not find part: "+t)}function $o(n){return As("partUids","partUids",$n((function(e){return t=e.uid,o=x(n,Ao),pe(x(o,(function(n){return{key:n,value:t+"-"+n}})));var t,o})),Is())}function Go(n){return ge(dd,n)}function Uo(n){return t=function(t){for(var o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];return n.apply(void 0,e([t.getApis(),t],o,!1))},r=(o=n.toString()).indexOf(")")+1,i=o.indexOf("("),u=o.substring(i+1,r-1).split(/,\s*/),t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:qs(u.slice(1))}},t;var t,o,r,i,u}function Wo(n){var e=Ya(n)?n.dom[hd]:null;return Yc.from(e)}function Xo(n,e,t,o,r){var i;return te(n+" [SpecSchema]",Yn((i=r,(0<o.length?[ue("parts",o)]:[]).concat([re("uid"),le("dom",{}),le("components",[]),We("originalSpec"),le("debug.sketcher",{})]).concat(i)).concat(e)),t)}function qo(n,e,t,o,r){var i=yd(r),u=Xo(n,e,i,D(t,(function(n){return n.fold(Yc.none,Yc.some,Yc.none,Yc.none).map((function(n){return ue(n.name,n.schema.concat([We(fd())]))})).toArray()})),[$o(t)]),c=Po(0,u,t);return o(u,zo(n,u,c.internals()),i,c.externals())}function Yo(n){var e=te("Sketcher for "+n.name,xd,n),t=hn(e.apis,Uo),o=hn(e.extraApis,Ee);return Ac(Ac({name:e.name,configFields:e.configFields,sketch:function(n){return t=e.name,o=e.configFields,(0,e.factory)(Xo(t,o,r=yd(n),[],[]),r);var t,o,r}},t),o)}function Ko(n){var e,t,o,r=te("Sketcher for "+n.name,wd,n),i=(e=r.name,t=r.partFields,o={},w(t,(function(n){n.fold(Yc.some,Yc.none,Yc.some,Yc.some).each((function(n){var t=ld(e,n.pname);o[n.name]=function(o){var r=te("Part: "+n.name+" in "+e,Fs(n.schema),o);return Ac(Ac({},t),{config:o,validated:r})}}))})),o),u=hn(r.apis,Uo),c=hn(r.extraApis,Ee);return Ac(Ac({name:r.name,partFields:r.partFields,configFields:r.configFields,sketch:function(n){return qo(r.name,r.configFields,r.partFields,r.factory,n)},parts:i},u),c)}function Jo(n){var e,t,o,r,i,u,c=(e={prefix:Cf},n.replace(/\$\{([^{}]*)\}/g,(function(n,t){var o,r=e[t];return"string"==(o=typeof r)||"number"==o?r.toString():n})));return t=Wa.fromHtml(c),o=Za(t),r=k(void 0!==t.dom.attributes?t.dom.attributes:[],(function(n,e){var t;return"class"===e.name?n:Ac(Ac({},n),((t={})[e.name]=e.value,t))}),{}),i=Array.prototype.slice.call(t.dom.classList,0),u=0===o.length?{}:{innerHtml:Ne(t)},Ac({tag:Q(t),classes:i,attributes:r},u)}function Qo(n){return{dom:Jo(n)}}function Zo(n){return Qs([Tf.config({toggleClass:Ef("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),Ze(n,(function(n,e){(e?Tf.on:Tf.off)(n)}))])}function nr(n,e,t,o){var r=Zo(t);return kd(e,o,r,n)}function er(n,e){var t=e.ui.registry.getAll().icons;return Yc.from(t[n]).fold((function(){return Jo('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item ${prefix}-icon-'+n+' ${prefix}-icon"></span>')}),(function(n){return Jo('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item">'+n+"</span>")}))}function tr(n){return ad({name:n+"-edge",overrides:function(e){return e.model.manager.edgeActions[n].fold((function(){return{}}),(function(n){return{events:$s([Oe(ha(),(function(e,t,o){return n(e,o)}),[e]),Oe(ya(),(function(e,t,o){return n(e,o)}),[e]),Oe(xa(),(function(e,t,o){o.mouseIsDown.get()&&n(e,o)}),[e])])}}))}})}function or(n,e,t){e.store.manager.onLoad(n,e,t)}function rr(n,e,t){e.store.manager.onUnload(n,e,t)}function ir(){var n=Fe(null);return Js({set:n.set,get:n.get,isNotSet:function(){return null===n.get()},clear:function(){n.set(null)},readState:function(){return{mode:"memory",
value:n.get()}}})}function ur(){var n=Fe({}),e=Fe({});return Js({readState:function(){return{mode:"dataset",dataByValue:n.get(),dataByText:e.get()}},lookup:function(t){return bn(n.get(),t).orThunk((function(){return bn(e.get(),t)}))},update:function(t){var o=n.get(),r=e.get(),i={},u={};w(t,(function(n){bn(i[n.value]=n,"meta").each((function(e){bn(e,"text").each((function(e){u[e]=n}))}))})),n.set(Ac(Ac({},o),i)),e.set(Ac(Ac({},r),u))},clear:function(){n.set({}),e.set({})}})}function cr(n,e,t,o){var r=e.store;t.update([o]),r.setValue(n,o),e.onSetValue(n,o)}function ar(n,e){return zd.set(n,e)}function sr(n){return zd.get(n)}function fr(n){var e=n.event.raw;return-1===e.type.indexOf("touch")?void 0!==e.clientX?Yc.some(e).map((function(n){return Ld(n.clientX,n.clientY)})):Yc.none():void 0!==e.touches&&1===e.touches.length?Yc.some(e.touches[0]).map((function(n){return Ld(n.clientX,n.clientY)})):Yc.none()}function lr(n){return n.model.minX}function dr(n){return n.model.minY}function mr(n){return n.model.minX-1}function gr(n){return n.model.minY-1}function pr(n){return n.model.maxX}function hr(n){return n.model.maxY}function vr(n){return n.model.maxX+1}function br(n){return n.model.maxY+1}function yr(n,e,t){return e(n)-t(n)}function xr(n){return yr(n,pr,lr)}function wr(n){return yr(n,hr,dr)}function Sr(n){return xr(n)/2}function Or(n){return wr(n)/2}function kr(n){return n.stepSize}function Tr(n){return n.snapToGrid}function Cr(n){return n.snapStart}function Er(n){return n.rounded}function Dr(n,e){return void 0!==n[e+"-edge"]}function Mr(n){return Dr(n,"left")}function _r(n){return Dr(n,"right")}function Rr(n){return Dr(n,"top")}function Fr(n){return Dr(n,"bottom")}function Ir(n){return n.model.value.get()}function Vr(n,e){return{x:n,y:e}}function Br(n,e){z(n,$d(),{value:e})}function Ar(n,e,t,o){return n<e?n:t<n?t:n===e?e-1:Math.max(e,n-o)}function Nr(n,e,t,o){return t<n?n:n<e?e:n===t?t+1:Math.min(t,n+o)}function Hr(n,e,t){return Math.max(e,Math.min(t,n))}function Pr(n){var e=n.min,t=n.max,o=n.range,r=n.value,i=n.step,u=n.snap,c=n.snapStart,a=n.rounded,s=n.hasMinEdge,f=n.hasMaxEdge,l=n.minBound,d=n.maxBound,m=n.screenRange,g=s?e-1:e,p=f?t+1:t;if(r<l)return g;if(d<r)return p;var h,v,b,y,x,w=Hr((x=l,(Math.min(d,Math.max(r,x))-x)/m*o+e),g,p);return u&&e<=w&&w<=t?(h=w,v=e,b=t,y=i,c.fold((function(){var n=Math.round((h-v)/y)*y;return Hr(v+n,v-1,b+1)}),(function(n){var e=Math.round((h-n)%y/y),t=Math.floor((h-n)/y),o=Math.floor((b-n)/y),r=Math.min(o,t+e);return Math.max(n,n+r*y)}))):a?Math.round(w):w}function zr(n){var e=n.min,t=n.max,o=n.range,r=n.value,i=n.hasMinEdge,u=n.hasMaxEdge,c=n.maxBound,a=n.maxOffset,s=n.centerMinEdge,f=n.centerMaxEdge;return r<e?i?0:s:t<r?u?c:f:(r-e)/o*a}function jr(n){return n.element.dom.getBoundingClientRect()}function Lr(n){return jr(n)[Gd]}function $r(n){return jr(n).right}function Gr(n){return jr(n).top}function Ur(n){return jr(n).bottom}function Wr(n){return jr(n).width}function Xr(n){return jr(n).height}function qr(n,e){var t=jr(n),o=jr(e);return(t[Gd]+t.right)/2-o[Gd]}function Yr(n,e){var t=jr(n),o=jr(e);return(t.top+t.bottom)/2-o.top}function Kr(n,e){z(n,$d(),{value:e})}function Jr(n,e,t){return Pr({min:lr(e),max:pr(e),range:xr(e),value:t,step:kr(e),snap:Tr(e),snapStart:Cr(e),rounded:Er(e),hasMinEdge:Mr(e),hasMaxEdge:_r(e),minBound:Lr(n),maxBound:$r(n),screenRange:Wr(n)})}function Qr(n){return function(e,t){return Kr(e,{x:r=(0<n?Nr:Ar)(Ir(o=t).x,lr(o),pr(o),kr(o))}),Yc.some(r).map(Wc);var o,r}}function Zr(n,e,t,o,r,i){var u,c,a,s,f,l,d,m,g=(c=i,a=t,s=o,f=r,l=Wr(u=e),d=s.bind((function(n){return Yc.some(qr(n,u))})).getOr(0),m=f.bind((function(n){return Yc.some(qr(n,u))})).getOr(l),zr({min:lr(c),max:pr(c),range:xr(c),value:a,hasMinEdge:Mr(c),hasMaxEdge:_r(c),minBound:Lr(u),minOffset:0,maxBound:$r(u),maxOffset:l,centerMinEdge:d,centerMaxEdge:m}));return Lr(e)-Lr(n)+g}function ni(n,e){z(n,$d(),{value:e})}function ei(n,e,t){return Pr({min:dr(e),max:hr(e),range:wr(e),value:t,step:kr(e),snap:Tr(e),snapStart:Cr(e),rounded:Er(e),hasMinEdge:Rr(e),hasMaxEdge:Fr(e),minBound:Gr(n),maxBound:Ur(n),screenRange:Xr(n)})}function ti(n){return function(e,t){return ni(e,{y:r=(0<n?Nr:Ar)(Ir(o=t).y,dr(o),hr(o),kr(o))}),Yc.some(r).map(Wc);var o,r}}function oi(n,e,t,o,r,i){var u,c,a,s,f,l,d,m,g=(c=i,a=t,s=o,f=r,l=Xr(u=e),d=s.bind((function(n){return Yc.some(Yr(n,u))})).getOr(0),m=f.bind((function(n){return Yc.some(Yr(n,u))})).getOr(l),zr({min:dr(c),max:hr(c),range:wr(c),value:a,hasMinEdge:Rr(c),hasMaxEdge:Fr(c),minBound:Gr(u),minOffset:0,maxBound:Ur(u),maxOffset:l,centerMinEdge:d,centerMaxEdge:m}));return Gr(e)-Gr(n)+g}function ri(n,e){z(n,$d(),{value:e})}function ii(n,e){return{x:n,y:e}}function ui(n,e){return function(t,o){return i=o,u=0<n?Nr:Ar,ri(t,ii(c=(r=e)?Ir(i).x:u(Ir(i).x,lr(i),pr(i),kr(i)),r?u(Ir(i).y,dr(i),hr(i),kr(i)):Ir(i).y)),Yc.some(c).map(Wc);var r,i,u,c}}function ci(n,e,t,o){return kd(e,(function(){var o=t();n.setContextToolbar([{label:e+" group",items:o}])}),{},o)}function ai(n,e){var t={onChange:function(n,t,o){e.undoManager.transact((function(){e.formatter.apply("forecolor",{value:o}),e.nodeChanged()}))},getInitialValue:a(-1)};return ci(n,"color-levels",(function(){function n(n){return n<0?"black":360<n?"white":"hsl("+n+", 100%, 50%)"}return[(e=t,dm.sketch({dom:Jo('<div class="${prefix}-slider ${prefix}-hue-slider-container"></div>'),components:[dm.parts["left-edge"](Qo('<div class="${prefix}-hue-slider-black"></div>')),dm.parts.spectrum({dom:Jo('<div class="${prefix}-slider-gradient-container"></div>'),components:[Qo('<div class="${prefix}-slider-gradient"></div>')],behaviours:Qs([Tf.config({toggleClass:Ef("thumb-active")})])}),dm.parts["right-edge"](Qo('<div class="${prefix}-hue-slider-white"></div>')),dm.parts.thumb({dom:Jo('<div class="${prefix}-slider-thumb"></div>'),behaviours:Qs([Tf.config({toggleClass:Ef("thumb-active")})])})],onChange:function(t,o,r){var i=n(r.x());ut(o.element,"background-color",i),e.onChange(t,o,i)},onDragStart:function(n,e){Tf.on(e)},onDragEnd:function(n,e){Tf.off(e)},onInit:function(e,t,o,r){var i=n(r.x());ut(t.element,"background-color",i)},stepSize:10,model:{mode:"x",minX:0,maxX:360,getInitialValue:function(){return{x:e.getInitialValue()}}},sliderBehaviours:Qs([nt(dm.refresh)])}))];var e}),e)}function si(n){var e,t,o=n.selection.getStart(),r=Wa.fromDom(o),i=Wa.fromDom(n.getBody()),u=(e=function(n){return X(i,n)},(Ya(t=r)?Yc.some(t):tn(t).filter(Ya)).map((function(n){return vt((function(n,e){return e(n)}),bt,n,(function(n){return st(n,"font-size").isSome()}),e).bind((function(n){return st(n,"font-size")})).getOrThunk((function(){return at(n,"font-size")}))})).getOr(""));return T(mm,(function(n){return u===n})).getOr("medium")}function fi(n){return[Qo('<span class="${prefix}-toolbar-button ${prefix}-icon-small-font ${prefix}-icon"></span>'),(e={onChange:n.onChange,sizes:hm,category:"font",getInitialValue:n.getInitialValue},t=te("SizeSlider",pm,e),dm.sketch({dom:{tag:"div",classes:[Ef("slider-"+t.category+"-size-container"),Ef("slider"),Ef("slider-size-container")]},onChange:function(n,e,o){var r=o.x();0<=r&&r<t.sizes.length&&t.onChange(r)},onDragStart:function(n,e){Tf.on(e)},onDragEnd:function(n,e){Tf.off(e)},model:{mode:"x",minX:0,maxX:t.sizes.length-1,getInitialValue:function(){return{x:t.getInitialValue()}}},stepSize:1,snapToGrid:!0,sliderBehaviours:Qs([nt(dm.refresh)]),components:[dm.parts.spectrum({dom:Jo('<div class="${prefix}-slider-size-container"></div>'),components:[Qo('<div class="${prefix}-slider-size-line"></div>')]}),dm.parts.thumb({dom:Jo('<div class="${prefix}-slider-thumb"></div>'),behaviours:Qs([Tf.config({toggleClass:Ef("thumb-active")})])})]})),Qo('<span class="${prefix}-toolbar-button ${prefix}-icon-large-font ${prefix}-icon"></span>')];var e,t}function li(n){var e=void 0!==n.uid&&yn(n,"uid")?n.uid:bd("memento");return{get:function(n){return n.getSystem().getByUid(e).getOrDie()},getOpt:function(n){return n.getSystem().getByUid(e).toOptional()},asSpec:function(){return Ac(Ac({},n),{uid:e})}}}function di(n){var e=li({dom:{tag:"input",attributes:{accept:"image/*",type:"file",title:""},styles:{visibility:"hidden",position:"absolute"}},events:$s([Ce(Ea()),Se(Ca(),(function(e,t){var o=t.event.raw,r=o.target.files||o.dataTransfer.files;Yc.from(r[0]).each((function(e){var t,o,r=n;o=t=e,new xm((function(n){var e=new FileReader;e.onloadend=function(){n(e.result)},e.readAsDataURL(o)})).then((function(n){return n.split(",")[1]})).then((function(n){r.undoManager.transact((function(){var e=r.editorUpload.blobCache,o=e.create(Bo("mceu"),t,n);e.add(o);var i=r.dom.createHTML("img",{src:o.blobUri()});r.insertContent(i)}))}))}))}))])});return Sd.sketch({dom:er("image",n),components:[e.asSpec()],action:function(n){e.get(n).element.dom.click()}})}function mi(n){return n.dom.textContent}function gi(n){return 0<n.length}function pi(n){return null==n?"":n}function hi(n,e){e.url.toOptional().filter(gi).fold((function(){var t=n;e.link.bind(s).each((function(){t.execCommand("unlink")}))}),(function(t){var o,r,i=(o=e,(r={}).href=t,o.title.toOptional().filter(gi).each((function(n){r.title=n})),o.target.toOptional().filter(gi).each((function(n){r.target=n})),r);e.link.bind(s).fold((function(){var o=e.text.toOptional().filter(gi).getOr(t);n.insertContent(n.dom.createHTML("a",i,n.dom.encode(o)))}),(function(n){var o,r,u=(o=n,r=t,e.text.toOptional().filter(gi).fold((function(){return On(n=o,"href")===mi(n)?Yc.some(r):Yc.none();var n}),Yc.some));Sn(n,i),u.each((function(e){n.dom.textContent=e}))}))}))}function vi(n,e){var t,o;return{key:n,value:{config:{},me:(t=n,o=$s(e),Re({fields:[re("enabled")],name:t,active:{events:a(o)}})),configAsRaw:a({}),initialConfig:{},state:Ks}}}function bi(n){return n.dom.value}function yi(n,e){if(void 0===e)throw new Error("Value.set was undefined");n.dom.value=e}function xi(n,e){var t=li(Em.sketch({inputAttributes:{placeholder:_m.translate(e)},onSetValue:function(n){P(n,Ta())},inputBehaviours:Qs([km.config({find:Yc.some}),Mm.config({}),Pl.config({mode:"execution"})]),selectOnFocus:!1})),o=li(Sd.sketch({dom:Jo('<button class="${prefix}-input-container-x ${prefix}-icon-cancel-circle ${prefix}-icon"></button>'),action:function(n){var e=t.get(n);Pd.setValue(e,"")}}));return{name:n,spec:Tm.sketch({dom:Jo('<div class="${prefix}-input-container"></div>'),components:[t.asSpec(),o.asSpec()],containerBehaviours:Qs([Tf.config({toggleClass:Ef("input-container-empty")}),km.config({find:function(n){return Yc.some(t.get(n))}}),vi("input-clearing",[Se(Ta(),(function(n){var e=t.get(n);(0<Pd.getValue(e).length?Tf.off:Tf.on)(n)}))])])})}}function wi(n,e){(e.disabled()?Fm:Im)(n,e)}function Si(n,e){return!0===e.useNative&&b(Rm,Q(n.element))}function Oi(n,e){return Si(n,e)?Tn(n.element,"disabled"):"true"===On(n.element,"aria-disabled")}function ki(n){return"<alloy.field."+n+">"}function Ti(n,e){return nr(e,"link","link",(function(){var t,o,r=Pm(n,e);n.setContextToolbar(r),t=e,o=function(){n.focusToolbar()},(Sm.os.isAndroid()?function(n,e){var t=e.selection.getRng();n(),e.selection.setRng(t)}:g)(o,t),wm(e).each((function(n){e.selection.select(n.dom)}))}))}function Ci(n){function e(e){return"The component must be in a context to execute: "+e+(n?"\n"+He(n().element)+" is not in context.":"")}function t(n){return function(){throw new Error(e(n))}}function o(n){return function(){console.warn(e(n))}}return{debugInfo:a("fake"),triggerEvent:o("triggerEvent"),triggerFocus:o("triggerFocus"),triggerEscape:o("triggerEscape"),broadcast:o("broadcast"),broadcastOn:o("broadcastOn"),broadcastEvent:o("broadcastEvent"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),isConnected:Uc}}function Ei(n,e){var t={};return pn(n,(function(n,o){pn(n,(function(n,r){var i=bn(t,r).getOr([]);t[r]=i.concat([e(o,n)])}))})),t}function Di(n){return n.cHandler}function Mi(n,e){return{name:n,handler:e}}function _i(n,e,t){var o=e[t];return o?function(n,e,t,o){try{var r=(i=function(t,r){var i=t[e],u=r[e],c=o.indexOf(i),a=o.indexOf(u);if(-1===c)throw new Error("The ordering for "+n+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(o,null,2));if(-1===a)throw new Error("The ordering for "+n+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(o,null,2));return c<a?-1:a<c?1:0},(u=Kc.call(t,0)).sort(i),u);return bs.value(r)}catch(t){return bs.error([t])}var i,u}("Event: "+t,"name",n,o).map((function(n){var e,t,o,r,i=x(n,(function(n){return n.handler}));return{can:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return k(t,(function(e,t){return e&&t.can.apply(void 0,n)}),!0)},abort:(o=t=e=i,r=function(n){return n.abort},function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return k(o,(function(e,t){return e||r(t).apply(void 0,n)}),!1)}),run:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];w(e,(function(e){e.run.apply(void 0,n)}))}}})):bs.error(["The event ("+t+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(x(n,(function(n){return n.name})),null,2)])}function Ri(n,e){w(e,(function(e){Mn(n,e)}))}function Fi(n,e){w(e,(function(e){_n(n,e)}))}function Ii(n){var e,t,o,r,u=(e=bn(n,"behaviours").getOr({}),D(ls(e),(function(n){var t=e[n];return i(t)?[t.me]:[]})));return t=n,r=x(o=u,(function(n){return se(n.name(),[re("config"),le("state",Ks)])})),{list:o,data:hn(ne("component.behaviours",Fs(r),t.behaviours).fold((function(n){throw new Error(Bs(n)+"\nComplete spec:\n"+JSON.stringify(t,null,2))}),s),(function(n){return a(n.map((function(n){return{config:n.config,state:n.state.init(n.config)}})))}))}}function Vi(n,e,t){var o,r,i=Ac(Ac({},(o=n).dom),{uid:o.uid,domChildren:x(o.components,(function(n){return n.element}))}),u=n.domModification.fold((function(){return De({})}),De),c=0<e.length?function(n,e,t,o){function r(n){return O(n,(function(n,e){return Ac(Ac({},e.modification),n)}),{})}var i=Ac({},e);w(t,(function(e){i[e.name()]=e.exhibit(n,o)}));var u=Ei(i,(function(n,e){return{name:n,modification:e}}));return De({classes:O(u.classes,(function(n,e){return e.modification.concat(n)}),[]),attributes:r(u.attributes),styles:r(u.styles)})}(t,{"alloy.base.modification":u},e,i):u;return Ac(Ac({},r=i),{attributes:Ac(Ac({},r.attributes),c.attributes),styles:Ac(Ac({},r.styles),c.styles),classes:r.classes.concat(c.classes)})}function Bi(n,e,t){var o,r,i,u,c,a={"alloy.base.behaviour":n.events},s=n.eventOrder;return r=t,i=e,o=Ei(Ac(Ac({},a),(u=r,c={},w(i,(function(n){c[n.name()]=n.handlers(u)})),c)),Mi),Gm(o,s).getOrDie()}function Ai(n){function e(){return f}var t=Fe($m),o=ee(ne("custom.definition",Wm,n)),r=Ii(n),i=r.list,u=r.data,c=function(n){var e=Wa.fromTag(n.tag);Sn(e,n.attributes),Ri(e,n.classes),ct(e,n.styles),n.innerHtml.each((function(n){return o=n,u=nn(t=e).dom,an(c=Wa.fromDom(u.createDocumentFragment()),(r=o,(i=(u||document).createElement("div")).innerHTML=r,Za(Wa.fromDom(i)))),sn(t),void ns(t,c);var t,o,r,i,u,c}));var t=n.domChildren;return an(e,t),n.value.each((function(n){yi(e,n)})),n.uid,vd(e,n.uid),e}(Vi(o,i,u)),a=Bi(o,i,u),s=Fe(o.components),f={uid:n.uid,getSystem:t.get,config:function(e){var t=u;return($c(t[e.name()])?t[e.name()]:function(){throw new Error("Could not find "+e.name()+" in "+JSON.stringify(n,null,2))})()},hasConfigured:function(n){return $c(u[n.name()])},spec:n,readState:function(n){return u[n]().map((function(n){return n.state.readState()})).getOr("not enabled")},getApis:function(){return o.apis},connect:function(n){t.set(n)},disconnect:function(){t.set(Ci(e))},element:c,syncComponents:function(){var n=D(Za(c),(function(n){return t.get().getByDom(n).fold((function(){return[]}),F)}));s.set(n)},components:s.get,events:a};return f}function Ni(n){return function(n){var e=te("external.component",Yn([re("element"),ce("uid")]),n),t=Fe(Ci()),o=e.uid.getOrThunk((function(){return bd("external")}));vd(e.element,o);var r={uid:o,getSystem:t.get,config:Yc.none,hasConfigured:Uc,connect:function(n){t.set(n)},disconnect:function(){t.set(Ci((function(){return r})))},getApis:function(){return{}},element:e.element,spec:n,readState:a("No state"),syncComponents:u,components:a([]),events:{}};return Go(r)}({element:Wa.fromText(n)})}function Hi(n){(Ae(n.element).isNone()||_f.isFocused(n))&&(_f.isFocused(n)||_f.focus(n),z(n,Km,{item:n}))}function Pi(n){z(n,Jm,{item:n})}function zi(n,e,t,o){var r=n.getSystem().build(o);fs(n,r,t)}function ji(n,e,t,o){T(sg(n),(function(n){return X(o.element,n.element)})).each(gn)}function Li(n,e,t,o,r){var i=sg(n);return Yc.from(i[o]).map((function(e){return ji(n,0,0,e),r.each((function(e){zi(n,0,(function(n,e){var t,r=e;on(t=n,o).fold((function(){ns(t,r)}),(function(n){rn(n,r)}))}),e)})),e}))}function $i(n,e,t,o){return bn(e.routes,o.start).bind((function(n){return bn(n,o.destination)}))}function Gi(n,e,t){var o,r,i=t;vg(o=n,r=e).bind((function(n){return hg(o,r,i,n)})).each((function(t){var o=t.transition;_n(n.element,o.transitionClass),Cn(n.element,e.destinationAttr)}))}function Ui(n,e,t,o){Gi(n,e,t),Tn(n.element,e.stateAttr)&&On(n.element,e.stateAttr)!==o&&e.onFinish(n,o),wn(n.element,e.stateAttr,o)}function Wi(n){Mn(n,wg)}function Xi(n){_n(n,wg)}function qi(n){return bn(n,"format").getOr(n.title)}function Yi(n){return yn(n,"items")?(r=Ds((e=["items"],t={},pn(o=n,(function(n,o){b(e,o)||(t[o]=n)})),t),{menu:!0}),i=Tg(o.items),{item:r,menus:Ds(i.menus,ge(o.title,i.items)),expansions:Ds(i.expansions,ge(o.title,o.title))}):{item:n,menus:{},expansions:{}};var e,t,o,r,i}function Ki(n,e,t){var o,r,i,u,c,a,s,f,l,d,m,g=(o=n,i=(r=function(n){return D(n,(function(n){return void 0===n.items?!yn(n,"format")||o.formatter.canApply(n.format)?[n]:[]:0<r(n.items).length?[n]:[]}))})(e),Tg(i));return c=(u={formats:g,handle:function(e,o){n.undoManager.transact((function(){Tf.isOn(e)?n.formatter.remove(o):n.formatter.apply(o)})),t()}}).formats,a=function(){return m},s=kg("Styles",[].concat(x(c.items,(function(n){return Og(qi(n),n.title,n.isSelected(),n.getPreview(),yn(c.expansions,qi(n)))}))),a,!1),f=hn(c.menus,(function(n,e){var t=x(n,(function(n){return Og(qi(n),n.title,void 0!==n.isSelected&&n.isSelected(),void 0!==n.getPreview?n.getPreview():"",yn(c.expansions,qi(n)))}));return kg(e,t,a,!0)})),l=Ds(f,ge("styles",s)),d={tmenu:pg.tieredData("styles",l,c.expansions)},(m=li(pg.sketch({dom:{tag:"div",classes:[Ef("styles-menu")]},components:[],fakeFocus:!0,stayInDom:!0,onExecute:function(n,e){var t=Pd.getValue(e);return u.handle(e,t.value),Yc.none()},onEscape:function(){return Yc.none()},onOpenMenu:function(n,e){var t=sr(n.element);ar(e.element,t),xg.jumpTo(e,"current")},onOpenSubmenu:function(n,e,t){var o=sr(n.element),r=yt(e.element,'[role="menu"]').getOrDie("hacky"),i=n.getSystem().getByDom(r).getOrDie();ar(t.element,o),xg.progressTo(i,"before"),xg.jumpTo(t,"after"),xg.progressTo(t,"current")},onCollapseMenu:function(n,e,t){var o=yt(e.element,'[role="menu"]').getOrDie("hacky"),r=n.getSystem().getByDom(o).getOrDie();xg.progressTo(r,"after"),xg.progressTo(t,"current")},navigateOnHover:!1,highlightImmediately:!0,data:d.tmenu,markers:{backgroundMenu:Ef("styles-background-menu"),menu:Ef("styles-menu"),selectedMenu:Ef("styles-selected-menu"),item:Ef("styles-item"),selectedItem:Ef("styles-selected-item")}}))).asSpec()}function Ji(n){var e=n.replace(/\|/g," ").trim();return 0<e.length?e.split(/\s+/):[]}function Qi(n,e){function t(n){return function(){return kd(o=n,(function(){t.execCommand(o)}),{},t=e);var t,o}}function o(n){return function(){return t=e,r=Zo(o=n),kd(o,(function(){t.execCommand(o)}),r,t);var t,o,r}}function r(n,t,o){return function(){return nr(e,n,t,o)}}function i(){return Ki(e,S,(function(){e.fire("scrollIntoView")}))}function u(n,t){return{isSupported:function(){var t=e.ui.registry.getAll().buttons;return n.forall((function(n){return yn(t,n)}))},sketch:t}}function c(n){return function(){return f.formatter.match(n)}}function s(n){return function(){return f.formatter.getCssText(n)}}var f,l,d=t("undo"),m=t("redo"),g=o("bold"),p=o("italic"),h=o("underline"),v=t("removeformat"),b=r("unlink","link",(function(){e.execCommand("unlink",null,!1)})),y=r("unordered-list","ul",(function(){e.execCommand("InsertUnorderedList",null,!1)})),w=r("ordered-list","ol",(function(){e.execCommand("InsertOrderedList",null,!1)})),S=(l=function(n){return x(n,(function(n){if(yn(n,"items")){var e=l(n.items);return Ds(Ds(n,{isSelected:Uc,getPreview:a("")}),{items:e})}return yn(n,"format")?Ds(n,{isSelected:c(n.format),getPreview:s(n.format)}):(o=Bo((t=n).title),r=Ds(t,{format:o,isSelected:c(o),getPreview:s(o)}),f.formatter.register(o,r),r);var t,o,r}))})((f=e).getParam("style_formats",uf,"array"));return{undo:u(Yc.none(),d),redo:u(Yc.none(),m),bold:u(Yc.none(),g),italic:u(Yc.none(),p),underline:u(Yc.none(),h),removeformat:u(Yc.none(),v),link:u(Yc.none(),(function(){return Ti(n,e)})),unlink:u(Yc.none(),b),image:u(Yc.none(),(function(){return di(e)})),bullist:u(Yc.some("bullist"),y),numlist:u(Yc.some("numlist"),w),fontsizeselect:u(Yc.none(),(function(){return o={onChange:function(n){var e;e=t,Yc.from(mm[n]).each((function(n){var t,o=n;si(t=e)!==o&&t.execCommand("fontSize",!1,o)}))},getInitialValue:function(){return n=si(t),C(mm,(function(e){return e===n})).getOr(2);var n}},ci(n,"font-size",(function(){return fi(o)}),t=e);var t,o})),forecolor:u(Yc.none(),(function(){return ai(n,e)})),styleselect:u(Yc.none(),(function(){return kd("style-formats",(function(t){e.fire("toReading"),n.dropup.appear(i,Tf.on,t)}),Qs([Tf.config({toggleClass:Ef("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),Sf.config({channels:pe([et(sf,Tf.off),et(ff,Tf.off)])})]),e)}))}}function Zi(n){function e(){return n.stopPropagation()}function t(){return n.preventDefault()}var o=c(t,e);return{target:Wa.fromDom(function(n){if(os()&&i(n.target)){var e=Wa.fromDom(n.target);if(Ya(e)&&is(e)&&n.composed&&n.composedPath){var t=n.composedPath();if(t)return 0<(o=t).length?Yc.some(o[0]):Yc.none()}}var o;return Yc.from(n.target)}(n).getOr(n.target)),x:n.clientX,y:n.clientY,stop:e,prevent:t,kill:o,raw:n}}function nu(n,e,t,o,r){var i,u,c=(i=t,u=o,function(n){i(n)&&u(Zi(n))});return n.dom.addEventListener(e,c,r),{unbind:l(Eg,n,e,c,r)}}function eu(n,e,t){return nu(n,e,Dg,t,!1)}function tu(n,e,t){return nu(n,e,Dg,t,!0)}function ou(n){return{isPortrait:a(n.matchMedia("(orientation: portrait)").matches)}}function ru(n,e){var t=Wa.fromDom(n),o=null,r=eu(t,"orientationchange",(function(){Mg.clearInterval(o);var t=ou(n);e.onChange(t),i((function(){e.onReady(t)}))})),i=function(e){Mg.clearInterval(o);var t=n.innerHeight,r=0;o=Mg.setInterval((function(){t!==n.innerHeight?(Mg.clearInterval(o),e(Yc.some(n.innerHeight))):20<r&&(Mg.clearInterval(o),e(Yc.none())),r++}),50)};return{onAdjustment:i,destroy:function(){r.unbind()}}}function iu(n,e,t){var o,r=n.document.createRange(),i=r;return e.fold((function(n){i.setStartBefore(n.dom)}),(function(n,e){i.setStart(n.dom,e)}),(function(n){i.setStartAfter(n.dom)})),o=r,t.fold((function(n){o.setEndBefore(n.dom)}),(function(n,e){o.setEnd(n.dom,e)}),(function(n){o.setEndAfter(n.dom)})),r}function uu(n,e,t,o,r){var i=n.document.createRange();return i.setStart(e.dom,t),i.setEnd(o.dom,r),i}function cu(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}}function au(n,e,t){return e(Wa.fromDom(t.startContainer),t.startOffset,Wa.fromDom(t.endContainer),t.endOffset)}function su(n,e){var t,o,r,i=(t=n,e.match({domRange:function(n){return{ltr:a(n),rtl:Yc.none}},relative:function(n,e){return{ltr:v((function(){return iu(t,n,e)})),rtl:v((function(){return Yc.some(iu(t,e,n))}))}},exact:function(n,e,o,r){return{ltr:v((function(){return uu(t,n,e,o,r)})),rtl:v((function(){return Yc.some(uu(t,o,r,n,e))}))}}}));return(r=(o=i).ltr()).collapsed?o.rtl().filter((function(n){return!1===n.collapsed})).map((function(n){return _g.rtl(Wa.fromDom(n.endContainer),n.endOffset,Wa.fromDom(n.startContainer),n.startOffset)})).getOrThunk((function(){return au(0,_g.ltr,r)})):au(0,_g.ltr,r)}function fu(n,e){return{uid:n.uid,dom:n.dom,components:e,behaviours:Io(n.formBehaviours,[Pd.config({store:{mode:"manual",getValue:function(e){var t,o,r=(t=n,o=e.getSystem(),hn(t.partUids,(function(n){return a(o.getByUid(n))})));return hn(r,(function(n,e){return n().bind((function(n){var t=km.getCurrent(n),o=new Error("Cannot find a current component to extract the value from for form part '"+e+"': "+He(n.element));return t.fold((function(){return bs.error(o)}),bs.value)})).map(Pd.getValue)}))},setValue:function(e,t){pn(t,(function(t,o){jo(e,n,o).each((function(n){km.getCurrent(n).each((function(n){Pd.setValue(n,t)}))}))}))}}})]),apis:{getField:function(e,t){return jo(e,n,t).bind(km.getCurrent)}}}}function lu(n){return"prepared"===n.type?Yc.some(n.menu):Yc.none()}function du(n,e){var t=Q(n);return"input"===t?Hg.after(n):b(["br","img"],t)?0===e?Hg.before(n):Hg.after(n):Hg.on(n,e)}function mu(n){return Yc.from(n.getSelection())}function gu(n,e,t,o,r){var i=uu(n,e,t,o,r);mu(n).each((function(n){n.removeAllRanges(),n.addRange(i)}))}function pu(n,e,t,o,r){var i,u,c,a,s,f=(i=o,u=r,c=du(e,t),a=du(i,u),zg.relative(c,a));su(s=n,f).match({ltr:function(n,e,t,o){gu(s,n,e,t,o)},rtl:function(n,e,t,o){mu(s).each((function(r){if(r.setBaseAndExtent)r.setBaseAndExtent(n.dom,e,t.dom,o);else if(r.extend)try{u=t,c=o,(i=r).collapse(n.dom,e),i.extend(u.dom,c)}catch(r){gu(s,t,o,n,e)}else gu(s,t,o,n,e);var i,u,c}))}})}function hu(n){if(0<n.rangeCount){var e=n.getRangeAt(0),t=n.getRangeAt(n.rangeCount-1);return Yc.some(Bg(Wa.fromDom(e.startContainer),e.startOffset,Wa.fromDom(t.endContainer),t.endOffset))}return Yc.none()}function vu(n){if(null===n.anchorNode||null===n.focusNode)return hu(n);var e,t,o,r,i,u,c,a,s,f,l,d=Wa.fromDom(n.anchorNode),m=Wa.fromDom(n.focusNode);return e=d,u=t=n.anchorOffset,c=o=m,a=r=n.focusOffset,(s=nn(i=e).dom.createRange()).setStart(i.dom,u),s.setEnd(c.dom,a),f=s,l=X(e,o)&&t===r,f.collapsed&&!l?Yc.some(Bg(d,n.anchorOffset,m,n.focusOffset)):hu(n)}function bu(n){return mu(n).filter((function(n){return 0<n.rangeCount})).bind(vu)}function yu(n,e){var t,o,r,i=(o=su(t=n,e).match({ltr:function(n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},rtl:function(n,e,o,r){var i=t.document.createRange();return i.setStart(o.dom,r),i.setEnd(n.dom,e),i}})).getClientRects();return 0<(r=0<i.length?i[0]:o.getBoundingClientRect()).width||0<r.height?Yc.some(r).map(cu):Yc.none()}function xu(n){return Yc.from(n.dom.contentWindow)}function wu(n){return xu(n).bind(bu)}function Su(n){return n.getFrame()}function Ou(n,e,t,o){return n[t].getOrThunk((function(){return function(n){return eu(e,o,n)}}))}function ku(n){var e=Su(n);return Yc.some(Wa.fromDom(e.dom.contentWindow.document.body)).bind((function(t){return Yc.some(Wa.fromDom(e.dom.contentWindow.document)).bind((function(o){return xu(e).map((function(r){var i=Wa.fromDom(o.dom.documentElement),u=n.getCursorBox.getOrThunk((function(){return function(){return bu(r).map((function(n){return zg.exact(n.start,n.soffset,n.finish,n.foffset)})).bind((function(n){return yu(r,n).orThunk((function(){return bu(r).filter((function(n){return X(n.start,n.finish)&&n.soffset===n.foffset})).bind((function(n){var e=n.start.dom.getBoundingClientRect();return 0<e.width||0<e.height?Yc.some(e):Yc.none()}))}))}))}})),c=n.setSelection.getOrThunk((function(){return function(n,e,t,o){pu(r,n,e,t,o)}})),a=n.clearSelection.getOrThunk((function(){return function(){mu(r).each((function(n){return n.removeAllRanges()}))}}));return{body:t,doc:o,win:r,html:i,getSelection:l(wu,e),setSelection:c,clearSelection:a,frame:e,onKeyup:Ou(n,o,"onKeyup","keyup"),onNodeChanged:Ou(n,o,"onNodeChanged","SelectionChange"),onDomChanged:n.onDomChanged,onScrollToCursor:n.onScrollToCursor,onScrollToElement:n.onScrollToElement,onToReading:n.onToReading,onToEditing:n.onToEditing,onToolbarScrollStart:n.onToolbarScrollStart,onTouchContent:n.onTouchContent,onTapContent:n.onTapContent,onTouchToolstrip:n.onTouchToolstrip,getCursorBox:u}}))}))}))}function Tu(){var n=W("head").getOrDie(),e=W('meta[name="viewport"]').getOrThunk((function(){var e=Wa.fromTag("meta");return wn(e,"name","viewport"),ns(n,e),e})),t=On(e,"content");return{maximize:function(){wn(e,"content","width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0")},restore:function(){null!=t&&0<t.length?wn(e,"content",t):wn(e,"content","user-scalable=yes")}}}function Cu(n,e){function t(n){return function(e){var t=On(e,"style"),o=void 0===t?"no-styles":t.trim();o===n||(wn(e,Lg,o),wn(e,"style",n))}}var o,r,i=(r=function(n){return $(n,"*")},S(function(n,e){for(var t=$c(e)?e:Uc,o=n.dom,r=[];null!==o.parentNode&&void 0!==o.parentNode;){var i=o.parentNode,u=Wa.fromDom(i);if(r.push(u),!0===t(u))break;o=i}return r}(n,void 0),r)),u=D(i,(function(n){return e=function(n){return $(n,"*")},S(tn(t=n).map(Za).map((function(n){return S(n,(function(n){return!X(t,n)}))})).getOr([]),e);var e,t})),c=void 0!==(o=at(e,"background-color"))&&""!==o?"background-color:"+o+"!important":"background-color:rgb(255,255,255)!important;";w(u,t("display:none!important;")),w(i,t($g+Gg+c)),t((!0===Ug?"":$g)+Gg+c)(n)}function Eu(){w(U("["+Lg+"]"),(function(n){var e=On(n,Lg);"no-styles"!==e?wn(n,"style",e):Cn(n,"style"),Cn(n,Lg)}))}function Du(n){var e=n.raw;return void 0===e.touches||1!==e.touches.length?Yc.none():Yc.some(e.touches[0])}function Mu(n){var e,t,o=Jt(),r=Fe(!1),i=(e=function(e){n.triggerEvent(Ha(),e),r.set(!0)},t=null,{cancel:function(){null!==t&&(clearTimeout(t),t=null)},schedule:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];t=setTimeout((function(){e.apply(null,n),t=null}),400)}}),u=pe([{key:ha(),value:function(n){return Du(n).each((function(e){i.cancel();var t={x:e.clientX,y:e.clientY,target:n.target};i.schedule(n),r.set(!1),o.set(t)})),Yc.none()}},{key:va(),value:function(n){return i.cancel(),Du(n).each((function(n){o.on((function(e){var t=n,r=e,i=Math.abs(t.clientX-r.x),u=Math.abs(t.clientY-r.y);(5<i||5<u)&&o.clear()}))})),Yc.none()}},{key:ba(),value:function(e){return i.cancel(),o.get().filter((function(n){return X(n.target,e.target)})).map((function(){return r.get()?(e.prevent(),!1):n.triggerEvent(Na(),e)}))}}]);return{fireIfReady:function(n,e){return bn(u,e).bind((function(e){return e(n)}))}}}function _u(n){var e=Mu({triggerEvent:function(e,t){n.onTapContent(t)}});return{fireTouchstart:function(n){e.fireIfReady(n,"touchstart")},onTouchend:function(){return eu(n.body,"touchend",(function(n){e.fireIfReady(n,"touchend")}))},onTouchmove:function(){return eu(n.body,"touchmove",(function(n){e.fireIfReady(n,"touchmove")}))}}}function Ru(n,e){var t=parseInt(On(n,e),10);return isNaN(t)?0:t}function Fu(n){return Ac(Ac({},n),{width:2})}function Iu(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}}function Vu(n){var e=n.getSelection();return void 0!==e&&0<e.rangeCount?function(n){if(n.collapsed){var e=Wa.fromDom(n.startContainer);return tn(e).bind((function(t){var o,r=zg.exact(e,n.startOffset,t,"img"===Q(o=t)?1:Ag.getOption(o).fold((function(){return Za(o).length}),(function(n){return n.length})));return yu(n.startContainer.ownerDocument.defaultView,r).map(Fu).map(F)})).getOr([])}return x(n.getClientRects(),Iu)}(e.getRangeAt(0)):[]}function Bu(n,e){wn(n,Xg,e)}function Au(n){return{top:n.top,bottom:n.top+n.height}}function Nu(n,e){var t=Wa.fromDom(e.document.body),o=eu(Wa.fromDom(n),"resize",(function(){var o,r,i;o=n,r=Ru(t,Xg),((i=o.innerHeight)<r?Yc.some(r-i):Yc.none()).each((function(n){var t;(0<(t=Vu(e)).length?Yc.some(t[0]).map(Au):Yc.none()).each((function(t){var o=t.top>e.innerHeight||t.bottom>e.innerHeight?Math.min(n,t.bottom-e.innerHeight+50):0;0!==o&&e.scrollTo(e.pageXOffset,e.pageYOffset+o)}))})),Bu(t,n.innerHeight)}));return Bu(t,n.innerHeight),{toEditing:function(){!function(n){n.focus();var e=Wa.fromDom(n.document.body);(Be().exists((function(n){return b(["input","textarea"],Q(n))}))?function(n){Mg.setTimeout((function(){n()}),0)}:g)((function(){Be().each(Ve),Ie(e)}))}(e)},destroy:function(){o.unbind()}}}function Hu(n,e){function t(){zc(o)||(clearTimeout(o),o=null)}var o=null;return{cancel:t,throttle:function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];t(),o=setTimeout((function(){o=null,n.apply(null,r)}),e)}}}function Pu(n){var e,t,o=li(Tm.sketch({dom:Jo('<div aria-hidden="true" class="${prefix}-mask-tap-icon"></div>'),containerBehaviours:Qs([Tf.config({toggleClass:Ef("mask-tap-icon-selected"),toggleOnExecute:!1})])})),r=(e=n,
t=null,{cancel:function(){zc(t)||(clearTimeout(t),t=null)},throttle:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];zc(t)&&(t=setTimeout((function(){t=null,e.apply(null,n)}),200))}});return Tm.sketch({dom:Jo('<div class="${prefix}-disabled-mask"></div>'),components:[Tm.sketch({dom:Jo('<div class="${prefix}-content-container"></div>'),components:[Sd.sketch({dom:Jo('<div class="${prefix}-content-tap-section"></div>'),components:[o.asSpec()],action:function(){r.throttle()},buttonBehaviours:Qs([Tf.config({toggleClass:Ef("mask-tap-icon-selected")})])})]})]})}function zu(n){var e=te("Getting AndroidWebapp schema",Yg,n);ut(e.toolstrip,"width","100%");var t=qm(Pu((function(){e.setReadOnly(e.readOnlyOnInit()),f.enter()}),e.translate));e.alloy.add(t);var o={show:function(){e.alloy.add(t)},hide:function(){e.alloy.remove(t)}};ns(e.container,t.element);var r,i,c,a,s,f=(r=e,i=o,c=Tu(),a=Kt(),s=Kt(),{enter:function(){i.hide(),Mn(r.container,Ef("fullscreen-maximized")),Mn(r.container,Ef("android-maximized")),c.maximize(),Mn(r.body,Ef("android-scroll-reload")),a.set(Nu(r.win,jg(r.editor).getOrDie("no"))),ku(r.editor).each((function(n){function e(n){return!X(n.start,n.finish)||n.soffset!==n.foffset}function t(){var n=o.doc.dom.hasFocus()&&o.getSelection().exists(e);c.getByDom(i).each(!0===(n||Be(f).filter((function(n){return"input"===Q(n)})).exists((function(n){return n.dom.selectionStart!==n.dom.selectionEnd})))?Tf.on:Tf.off)}var o,i,c,a,f,l;Cu(r.container,n.body),s.set((o=n,i=r.toolstrip,c=r.alloy,a=_u(o),f=nn(i),l=[eu(o.body,"touchstart",(function(n){o.onTouchContent(),a.fireTouchstart(n)})),a.onTouchmove(),a.onTouchend(),eu(i,"touchstart",(function(){o.onTouchToolstrip()})),o.onToReading((function(){Ve(o.body)})),o.onToEditing(u),o.onScrollToCursor((function(n){n.preventDefault(),o.getCursorBox().each((function(n){var e=o.win,t=n.top>e.innerHeight||n.bottom>e.innerHeight?n.bottom-e.innerHeight+50:0;0!=t&&e.scrollTo(e.pageXOffset,e.pageYOffset+t)}))}))].concat(1==Wg?[]:[eu(Wa.fromDom(o.win),"blur",(function(){c.getByDom(i).each(Tf.off)})),eu(f,"select",t),eu(o.doc,"selectionchange",t)]),{destroy:function(){w(l,(function(n){n.unbind()}))}}))}))},exit:function(){c.restore(),i.show(),_n(r.container,Ef("fullscreen-maximized")),_n(r.container,Ef("android-maximized")),Eu(),_n(r.body,Ef("android-scroll-reload")),s.clear(),a.clear()}});return{setReadOnly:e.setReadOnly,refreshStructure:u,enter:f.enter,exit:f.exit,destroy:u}}function ju(n){return"true"===On(n,tp)?0<n.dom.scrollLeft||function(n){n.dom.scrollLeft=1;var e=0!==n.dom.scrollLeft;return n.dom.scrollLeft=0,e}(n):0<n.dom.scrollTop||function(n){n.dom.scrollTop=1;var e=0!==n.dom.scrollTop;return n.dom.scrollTop=0,e}(n)}function Lu(){function n(n){var e=!0===n.scrollable?"${prefix}-toolbar-scrollable-group":"";return{dom:Jo('<div aria-label="'+n.label+'" class="${prefix}-toolbar-group '+e+'"></div>'),tgroupBehaviours:Qs([vi("adhoc-scrollable-toolbar",!0===n.scrollable?[Ws((function(n){ut(n.element,"overflow-x","auto"),wn(n.element,tp,"true"),Wi(n.element)}))]:[])]),components:[Tm.sketch({components:[ep.parts.items({})]})],markers:{itemSelector:"."+Ef("toolbar-group-item")},items:n.items}}function e(){Qg.setGroups(t,r.get()),Tf.off(t)}var t=qm(Qg.sketch({dom:Jo('<div class="${prefix}-toolbar"></div>'),components:[Qg.parts.groups({})],toolbarBehaviours:Qs([Tf.config({toggleClass:Ef("context-toolbar"),toggleOnExecute:!1,aria:{mode:"none"}}),Pl.config({mode:"cyclic"})]),shell:!0})),o=qm(Tm.sketch({dom:{classes:[Ef("toolstrip")]},components:[Ym(t)],containerBehaviours:Qs([Tf.config({toggleClass:Ef("android-selection-context-toolbar"),toggleOnExecute:!1})])})),r=Fe([]);return{wrapper:o,toolbar:t,createGroups:function(e){return x(e,c(ep.sketch,n))},setGroups:function(n){r.set(n),e()},setContextToolbar:function(n){Tf.on(t),Qg.setGroups(t,n)},restoreToolbar:function(){Tf.isOn(t)&&e()},refresh:function(){},focus:function(){Pl.focusIn(t)}}}function $u(n){return qm(Sd.sketch({dom:Jo('<div class="${prefix}-mask-edit-icon ${prefix}-icon"></div>'),action:function(){n.run((function(n){n.setReadOnly(!1)}))}}))}function Gu(){return qm(Tm.sketch({dom:Jo('<div class="${prefix}-editor-socket"></div>'),components:[],containerBehaviours:Qs([fg.config({})])}))}function Uu(n,e,t,o){(!0===t?tf.toAlpha:tf.toOmega)(o),(t?function(n,e){fg.append(n,Ym(e))}:function(n,e){fg.remove(n,e)})(n,e)}function Wu(n,e){return e.getAnimationRoot.fold((function(){return n.element}),(function(e){return e(n)}))}function Xu(n){return n.dimension.property}function qu(n,e){return n.dimension.getDimension(e)}function Yu(n,e){Fi(Wu(n,e),[e.shrinkingClass,e.growingClass])}function Ku(n,e){_n(n.element,e.openClass),Mn(n.element,e.closedClass),ut(n.element,Xu(e),"0px"),lt(n.element)}function Ju(n,e){_n(n.element,e.closedClass),Mn(n.element,e.openClass),ft(n.element,Xu(e))}function Qu(n,e,t){t.setCollapsed(),ut(n.element,Xu(e),qu(e,n.element)),lt(n.element),Yu(n,e),Ku(n,e),e.onStartShrink(n),e.onShrunk(n)}function Zu(n,e,t){var o=qu(e,n.element);("0px"===o?Qu:function(n,e,t,o){var r=o.getOrThunk((function(){return qu(e,n.element)}));t.setCollapsed(),ut(n.element,Xu(e),r),lt(n.element);var i=Wu(n,e);_n(i,e.growingClass),Mn(i,e.shrinkingClass),Ku(n,e),e.onStartShrink(n)})(n,e,t,Yc.some(o))}function nc(n,e,t){var o=Wu(n,e),r=Rn(o,e.shrinkingClass),i=qu(e,n.element);Ju(n,e);var u=qu(e,n.element);(r?function(){ut(n.element,Xu(e),i),lt(n.element)}:function(){Ku(n,e)})(),_n(o,e.shrinkingClass),Mn(o,e.growingClass),Ju(n,e),ut(n.element,Xu(e),u),t.setExpanded(),e.onStartGrow(n)}function ec(n,e){return!0===Rn(Wu(n,e),e.growingClass)}function tc(n,e){return!0===Rn(Wu(n,e),e.shrinkingClass)}function oc(n,e){var t=qm(Tm.sketch({dom:{tag:"div",classes:[Ef("dropup")]},components:[],containerBehaviours:Qs([fg.config({}),ip.config({closedClass:Ef("dropup-closed"),openClass:Ef("dropup-open"),shrinkingClass:Ef("dropup-shrinking"),growingClass:Ef("dropup-growing"),dimension:{property:"height"},onShrunk:function(t){n(),e(),fg.set(t,[])},onGrown:function(){n(),e()}}),nt((function(){o(u)}))])})),o=function(n){window.requestAnimationFrame((function(){n(),ip.shrink(t)}))};return{appear:function(n,e,o){!0===ip.hasShrunk(t)&&!1===ip.isTransitioning(t)&&window.requestAnimationFrame((function(){e(o),fg.set(t,[n()]),ip.grow(t)}))},disappear:o,component:t,element:t.element}}function rc(){return ga().browser.isFirefox()}function ic(n,e){var t,o,r,i,u=Ac({stopBackspace:!0},e),c=Mu(u),a=x(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(e){return eu(n,e,(function(n){c.fireIfReady(n,e).each((function(e){e&&n.kill()})),u.triggerEvent(e,n)&&n.kill()}))})),s=Jt(),f=eu(n,"paste",(function(n){c.fireIfReady(n,"paste").each((function(e){e&&n.kill()})),u.triggerEvent("paste",n)&&n.kill(),s.set(setTimeout((function(){u.triggerEvent(Ia(),n)}),0))})),l=eu(n,"keydown",(function(n){var e;u.triggerEvent("keydown",n)?n.kill():!u.stopBackspace||(e=n).raw.which!==If[0]||b(["input","textarea"],Q(e.target))||wt(e.target,'[contenteditable="true"]',void 0).isSome()||n.prevent()})),d=(t=n,o=function(n){u.triggerEvent("focusin",n)&&n.kill()},rc()?tu(t,"focus",o):eu(t,"focusin",o)),m=Jt(),g=(r=n,i=function(n){u.triggerEvent("focusout",n)&&n.kill(),m.set(setTimeout((function(){u.triggerEvent(Fa(),n)}),0))},rc()?tu(r,"blur",i):eu(r,"focusout",i));return{unbind:function(){w(a,(function(n){n.unbind()})),l.unbind(),d.unbind(),g.unbind(),f.unbind(),s.on(clearTimeout),m.on(clearTimeout)}}}function uc(n,e){return Fe(bn(n,"target").getOr(e))}function cc(n,e,t,o,r,i){var u,c,a=n(e,o),s=(u=Fe(!1),c=Fe(!1),{stop:function(){u.set(!0)},cut:function(){c.set(!0)},isStopped:u.get,isCut:c.get,event:t,setSource:r.set,getSource:r.get});return a.fold((function(){return i.logEventNoHandlers(e,o),up.complete()}),(function(n){var t=n.descHandler;return Di(t)(s),s.isStopped()?(i.logEventStopped(e,n.element,t.purpose),up.stopped()):s.isCut()?(i.logEventCut(e,n.element,t.purpose),up.complete()):tn(n.element).fold((function(){return i.logNoParent(e,n.element,t.purpose),up.complete()}),(function(o){return i.logEventResponse(e,n.element,t.purpose),up.resume(o)}))}))}function ac(){var n={};return{registerId:function(e,t,o){pn(o,(function(o,r){var i,u=void 0!==n[r]?n[r]:{};u[t]={cHandler:l.apply(void 0,[(i=o).handler].concat(e)),purpose:i.purpose},n[r]=u}))},unregisterId:function(e){pn(n,(function(n){gs(n,e)&&delete n[e]}))},filterByType:function(e){return bn(n,e).map((function(n){return vn(n,(function(n,e){return{id:e,descHandler:n}}))})).getOr([])},find:function(e,t,o){return bn(n,t).bind((function(n){return i=e,u=(r=function(e){return t=n,Wo(o=e).bind((function(n){return bn(t,n)})).map((function(n){return{element:o,descHandler:n}}));var t,o})(t=o),c=be(i),u.orThunk((function(){return c(t)?Yc.none():function(n){for(var e=t.dom,o=be(c);e.parentNode;){e=e.parentNode;var r=Wa.fromDom(e),i=n(r);if(i.isSome())return i;if(o(r))break}return Yc.none()}(r)}));var t,r,i,u,c}))}}}function sc(){function n(n){Wo(n.element).each((function(n){delete t[n],e.unregisterId(n)}))}var e=ac(),t={};return{find:function(n,t,o){return e.find(n,t,o)},filter:function(n){return e.filterByType(n)},register:function(o){var r,i=Wo((r=o).element).getOrThunk((function(){return n=r.element,e=Bo(pd+"uid-"),vd(n,e),e;var n,e}));yn(t,i)&&function(e){var o=t[i];if(o!==e)throw new Error('The tagId "'+i+'" is already used by: '+He(o.element)+"\nCannot use it for: "+He(e.element)+"\nThe conflicting element is"+(us(o.element)?" ":" not ")+"already in the DOM");n(e)}(o),e.registerId([o],i,o.events),t[i]=o},unregister:n,getById:function(n){return bn(t,n)}}}function fc(n,e,t,o,r){var i=uc(t,o);return cp(n,e,t,o,i,r)}function lc(n){var e=qm(Tm.sketch({dom:{classes:[Ef("outer-container")].concat(n.classes)},containerBehaviours:Qs([tf.config({alpha:sp,omega:fp})])}));return ap(e)}function dc(n,e){var t=Wa.fromTag("input");ct(t,{opacity:"0",position:"absolute",top:"-1000px",left:"-1000px"}),ns(n,t),Ie(t),e(t),es(t)}function mc(n){var e,t,o=n.getSelection();0<o.rangeCount&&(e=o.getRangeAt(0),(t=n.document.createRange()).setStart(e.startContainer,e.startOffset),t.setEnd(e.endContainer,e.endOffset),o.removeAllRanges(),o.addRange(t))}function gc(n,e){Be().each((function(n){X(n,e)||Ve(n)})),n.focus(),Ie(Wa.fromDom(n.document.body)),mc(n)}function pc(n,e,t,o){function r(){gc(e,o)}var i=eu(t,"keydown",(function(n){b(["input","textarea"],Q(n.target))||r()}));return{toReading:function(){dc(n,Ve)},toEditing:r,onToolbarTouch:u,destroy:function(){i.unbind()}}}function hc(n){setTimeout((function(){throw n}),0)}function vc(n){var e,t,o=ou(n).isPortrait(),r=(e=n.screen.width,t=n.screen.height,I([{width:320,height:480,keyboard:{portrait:300,landscape:240}},{width:320,height:568,keyboard:{portrait:300,landscape:240}},{width:375,height:667,keyboard:{portrait:305,landscape:240}},{width:414,height:736,keyboard:{portrait:320,landscape:240}},{width:768,height:1024,keyboard:{portrait:320,landscape:400}},{width:1024,height:1366,keyboard:{portrait:380,landscape:460}}],(function(n){return o=e<=n.width&&t<=n.height,r=n.keyboard,o?Yc.some(r):Yc.none();var o,r})).getOr({portrait:t/5,landscape:e/4})),i=o?r.portrait:r.landscape;return(o?n.screen.height:n.screen.width)-n.innerHeight>i?0:i}function bc(n,e){var t=nn(n).dom.defaultView;return mt(n)+mt(e)-vc(t)}function yc(n,e,t){var o=bc(e,t);ut(n,"padding-bottom",mt(e)+mt(t)-o+"px")}function xc(n){return Ru(n,vp)}function wc(n,e){var t=On(n,bp);return hp.fixed(n,t,e)}function Sc(n,e){return hp.scroller(n,e)}function Oc(n){var e=xc(n);return("true"===On(n,yp)?Sc:wc)(n,e)}function kc(n,e,t){var o=nn(n).dom.defaultView.innerHeight;return wn(n,xp,o+"px"),o-e-t}function Tc(n){var e=st(n,"top").getOr("0");return parseInt(e,10)}function Cc(n){return parseInt(n.dom.scrollTop,10)}function Ec(n,e){return gp((function(t){var o=l(Cc,n);wn(n,Sp,o());var r=Math.abs(e-o()),i=Math.ceil(r/10);wp.animate(o,e,i,(function(e,t){Ru(n,Sp)!==n.dom.scrollTop?t(n.dom.scrollTop):(n.dom.scrollTop=e,wn(n,Sp,e))}),(function(){n.dom.scrollTop=e,wn(n,Sp,e),t(e)}),10)}))}function Dc(n,e){ut(n,"top",e+xc(n)+"px")}function Mc(n,e){return n.fold((function(n,t,o){return ut(n,t,e+(r=o)+"px"),pp(r);var r}),(function(n,t){return i=e+(r=t),u=st(o=n,"top").getOr(r),c=i-parseInt(u,10),a=o.dom.scrollTop+c,s=o,f=a,d=i,gp((function(n){var e=l(Cc,s);wp.animate(e,f,15,(function(n){s.dom.scrollTop=n,ut(s,"top",Tc(s)+15+"px")}),(function(){s.dom.scrollTop=f,ut(s,"top",d+"px"),n(f)}),10)}));var o,r,i,u,c,a,s,f,d}))}function _c(n,e){var t,o=x(gt(n,"["+vp+"]"),Oc),r=x(o,(function(n){return Mc(n,e)}));return t=r,gp((function(n){var e=[],o=0;0===t.length?n([]):w(t,(function(r,i){var u;r.get((u=i,function(r){e[u]=r,++o>=t.length&&n(e)}))}))}))}function Rc(n){function e(){var n=w.innerHeight;return Ru(r,xp)<n}function t(){var n,e,t;E&&(n=mt(c),e=mt(a),t=kc(r,n,e),wn(r,vp,n+"px"),ut(r,"height",t+"px"),yc(i,r,a))}function o(){Z.clear()}var r,i,c,a,f,m,g,p,h,v,b,y,w,S,O,k,T,C,E,D=n.cWin,M=n.ceBody,_=n.socket,R=n.toolstrip,F=n.contentElement,I=n.keyboardType,V=n.outerWindow,B=n.dropup,A=n.outerBody,N=(i=M,c=R,a=B,w=nn(r=_).dom.defaultView,y=On(b=c,"style"),ct(b,{position:"absolute",top:"0px"}),wn(b,vp,"0px"),wn(b,bp,"top"),S={restore:function(){wn(b,"style",y||""),Cn(b,vp),Cn(b,bp)}},O=mt(c),k=mt(a),p=kc(r,g=O,k),v=On(h=r,"style"),Wi(h),ct(h,{position:"absolute",height:p+"px",width:"100%",top:g+"px"}),wn(h,vp,g+"px"),wn(h,yp,"true"),wn(h,bp,"top"),T={restore:function(){Xi(h),wn(h,"style",v||""),Cn(h,vp),Cn(h,yp),Cn(h,bp)}},m=On(f=a,"style"),ct(f,{position:"absolute",bottom:"0px"}),wn(f,vp,"0px"),wn(f,bp,"bottom"),C={restore:function(){wn(f,"style",m||""),Cn(f,vp),Cn(f,bp)}},E=!0,yc(i,r,a),{setViewportOffset:function(n){wn(r,vp,n+"px"),t()},isExpanding:e,isShrinking:d(e),refresh:t,restore:function(){E=!1,S.restore(),T.restore(),C.restore()}}),H=I(A,D,dn(),F),P=ru(V,{onChange:u,onReady:N.refresh});P.onAdjustment((function(){N.refresh()}));var z,j,L,$,G,U,W,X,q,Y,K,J=eu(Wa.fromDom(V),"resize",(function(){N.isExpanding()&&N.refresh()})),Q=(z=R,j=_,L=A,$=V,G=N,U=D,W=function(n){return t=j,o=n,r=nn(e=z).dom.defaultView,gp((function(n){Dc(e,o),Dc(t,o),r.scrollTo(0,o),n(o)}));var e,t,o,r},X=Fe(dp.pure({})),q={start:function(n){var e=dp.nu((function(e){return W(n).get(e)}));X.set(e)},idle:function(n){X.get().get((function(){n()}))}},Y=Hu((function(){q.idle((function(){_c(L,$.pageYOffset).get((function(){var n=Vu(U);Yc.from(n[0]).bind((function(n){var e=n.top-j.dom.scrollTop;return e>$.innerHeight+5||e<-5?Yc.some({top:e,bottom:e+n.height}):Yc.none()})).each((function(n){j.dom.scrollTop=j.dom.scrollTop+n.top})),q.start(0),G.refresh()}))}))}),1e3),K=eu(Wa.fromDom($),"scroll",(function(){$.pageYOffset<0||Y.throttle()})),_c(L,$.pageYOffset).get(s),{unbind:K.unbind}),Z=function(n,e){function t(n){var e=Wa.fromTag("span");return Ri(e,[Ef("layer-editor"),Ef("unfocused-selection")]),ct(e,{left:n.left+"px",top:n.top+"px",width:n.width+"px",height:n.height+"px"}),e}var o=n.document,r=Wa.fromTag("div");Mn(r,Ef("unfocused-selections")),ns(Wa.fromDom(o.documentElement),r);var i=eu(r,"touchstart",(function(t){t.prevent(),gc(n,e),u()})),u=function(){sn(r)};return{update:function(){u();var e=x(Vu(n),t);an(r,e)},isActive:function(){return 0<Za(r).length},destroy:function(){i.unbind(),es(r)},clear:u}}(D,F);return{toEditing:function(){H.toEditing(),o()},toReading:function(){H.toReading()},onToolbarTouch:function(){H.onToolbarTouch()},refreshSelection:function(){Z.isActive()&&Z.update()},clearSelection:o,highlightSelection:function(){Z.update()},scrollIntoView:function(n,e){var t,o=D,r=n,i=e,u=bc(t=_,B),c=l(mc,o);u<r||u<i?Ec(t,t.dom.scrollTop-u+i).get(c):r<0&&Ec(t,t.dom.scrollTop+r).get(c)},updateToolbarPadding:u,setViewportOffset:function(n){var e,t;N.setViewportOffset(n),e=_,t=n,gp((function(n){function o(n){ut(e,"top",n+"px")}var r=l(Tc,e),i=Math.abs(t-r()),u=Math.ceil(i/10);wp.animate(r,t,u,o,(function(){o(t),n(t)}),10)})).get(s)},syncHeight:function(){ut(F,"height",F.dom.contentWindow.document.body.scrollHeight+"px")},refreshStructure:N.refresh,destroy:function(){N.restore(),P.destroy(),Q.unbind(),J.unbind(),H.destroy(),Z.destroy(),dc(dn(),Ve)}}}function Fc(n,e){var t=Tu(),o=Jt(),r=Jt(),i=Kt(),c=Kt();return{enter:function(){e.hide();var a=Wa.fromDom(document);ku(n.editor).each((function(e){function s(){p.run((function(n){n.refreshSelection()}))}function f(n,e){var t=n-v.dom.scrollTop;p.run((function(n){n.scrollIntoView(t,t+e)}))}function l(){p.run((function(n){n.clearSelection()}))}function d(){g.getCursorBox().each((function(n){f(n.top,n.height)})),p.run((function(n){n.syncHeight()}))}var m,g,p,h,v,b,y,x;o.set({socketHeight:st(n.socket,"height"),iframeHeight:st(e.frame,"height"),outerScroll:document.body.scrollTop}),r.set({exclusives:(m="."+Sg,eu(a,"touchmove",(function(n){wt(n.target,m).filter(ju).fold((function(){n.prevent()}),u)})))}),Mn(n.container,Ef("fullscreen-maximized")),Cu(n.container,e.body),t.maximize(),ut(n.socket,"overflow","scroll"),ut(n.socket,"-webkit-overflow-scrolling","touch"),Ie(e.body),i.set(Rc({cWin:e.win,ceBody:e.body,socket:n.socket,toolstrip:n.toolstrip,dropup:n.dropup.element,contentElement:e.frame,outerBody:n.body,outerWindow:n.win,keyboardType:pc})),i.run((function(n){n.syncHeight()})),c.set((g=e,p=i,h=n.toolstrip,v=n.socket,n.dropup,b=_u(g),y=Hu(d,300),x=[g.onKeyup((function(){l(),y.throttle()})),g.onNodeChanged(s),g.onDomChanged(y.throttle),g.onDomChanged(s),g.onScrollToCursor((function(n){n.preventDefault(),y.throttle()})),g.onScrollToElement((function(n){n.element,f(p,v)})),g.onToEditing((function(){p.run((function(n){n.toEditing()}))})),g.onToReading((function(){p.run((function(n){n.toReading()}))})),eu(g.doc,"touchend",(function(n){X(g.html,n.target)||X(g.body,n.target)})),eu(h,"transitionend",(function(n){var e;"height"===n.raw.propertyName&&(e=mt(h),p.run((function(n){n.setViewportOffset(e)})),s(),d())})),tu(h,"touchstart",(function(n){var e;p.run((function(n){n.highlightSelection()})),e=n,p.run((function(n){n.onToolbarTouch(e)})),g.onTouchToolstrip()})),eu(g.body,"touchstart",(function(n){l(),g.onTouchContent(),b.fireTouchstart(n)})),b.onTouchmove(),b.onTouchend(),eu(g.body,"click",(function(n){n.kill()})),eu(h,"touchmove",(function(){g.onToolbarScrollStart()}))],{destroy:function(){w(x,(function(n){n.unbind()}))}}))}))},refreshStructure:function(){i.run((function(n){n.refreshStructure()}))},exit:function(){t.restore(),c.clear(),i.clear(),e.show(),o.on((function(e){e.socketHeight.each((function(e){ut(n.socket,"height",e)})),e.iframeHeight.each((function(e){ut(n.editor.getFrame(),"height",e)})),document.body.scrollTop=e.scrollTop})),o.clear(),r.on((function(n){n.exclusives.unbind()})),r.clear(),_n(n.container,Ef("fullscreen-maximized")),Eu(),Xi(n.toolbar),ft(n.socket,"overflow"),ft(n.socket,"-webkit-overflow-scrolling"),Ve(n.editor.getFrame()),ku(n.editor).each((function(n){n.clearSelection()}))}}}function Ic(n,e,t){n.system.broadcastOn([af],{command:e,state:t})}function Vc(n){return function(){function e(){n._skinLoaded=!0,n.fire("SkinLoaded")}n.initialized?e():n.on("init",e)}}var Bc,Ac=function(){return(Ac=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}).apply(this,arguments)},Nc=t("string"),Hc=t("object"),Pc=t("array"),zc=r(null),jc=o("boolean"),Lc=r(void 0),$c=o("function"),Gc=o("number"),Uc=a(!1),Wc=a(!0),Xc={fold:function(n){return n()},isSome:Uc,isNone:Wc,getOr:s,getOrThunk:h,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:a(null),getOrUndefined:a(void 0),or:s,orThunk:h,map:p,each:u,bind:p,exists:Uc,forall:Wc,filter:function(){return Xc},toArray:function(){return[]},toString:a("none()")},qc=function(n){function e(){return r}function t(e){return e(n)}var o=a(n),r={fold:function(e,t){return t(n)},isSome:Wc,isNone:Uc,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:e,orThunk:e,map:function(e){return qc(e(n))},each:function(e){e(n)},bind:t,exists:t,forall:t,filter:function(e){return e(n)?r:Xc},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return r},Yc={some:qc,none:p,from:function(n){return null==n?Xc:qc(n)}},Kc=Array.prototype.slice,Jc=Array.prototype.indexOf,Qc=Array.prototype.push,Zc=function(n,e){return{major:n,minor:e}},na={nu:Zc,detect:function(n,e){function t(n){return Number(o.replace(r,"$"+n))}var o,r,i=String(e).toLowerCase();return 0===n.length?q():(r=function(n,e){for(var t=0;t<n.length;t++){var o=n[t];if(o.test(e))return o}}(n,o=i))?Zc(t(1),t(2)):{major:0,minor:0}},unknown:q},ea=(Bc=/^\s+|\s+$/g,function(n){return n.replace(Bc,"")}),ta=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,oa={browsers:a([{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return B(n,"edge/")&&B(n,"chrome")&&B(n,"safari")&&B(n,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ta],search:function(n){return B(n,"chrome")&&!B(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return B(n,"msie")||B(n,"trident")}},{name:"Opera",versionRegexes:[ta,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:A("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:A("firefox")},{name:"Safari",versionRegexes:[ta,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(B(n,"safari")||B(n,"mobile/"))&&B(n,"applewebkit")}}]),oses:a([{name:"Windows",search:A("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return B(n,"iphone")||B(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:A("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:A("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:A("linux"),versionRegexes:[]},{name:"Solaris",search:A("sunos"),versionRegexes:[]},{name:"FreeBSD",search:A("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:A("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}])},ra="Firefox",ia=function(){return Y({current:void 0,version:na.unknown()})},ua=Y,ca=(a("Edge"),a("Chrome"),a("IE"),a("Opera"),a(ra),a("Safari"),"Windows"),aa="Android",sa="Solaris",fa="FreeBSD",la="ChromeOS",da=function(){return K({current:void 0,version:na.unknown()})},ma=K,ga=(a(ca),a("iOS"),a(aa),a("Linux"),a("OSX"),a(sa),a(fa),a(la),v((function(){return n=navigator.userAgent,e=Yc.from(navigator.userAgentData),t=N,h=oa.browsers(),v=oa.oses(),b=e.bind((function(n){return e=h,I(n.brands,(function(n){var t=n.brand.toLowerCase();return T(e,(function(n){var e;return t===(null===(e=n.brand)||void 0===e?void 0:e.toLowerCase())})).map((function(e){return{current:e.name,version:na.nu(parseInt(n.version,10),0)}}))}));var e})).orThunk((function(){return V(h,e=n).map((function(n){var t=na.detect(n.versionRegexes,e);return{current:n.name,version:t}}));var e})).fold(ia,ua),y=V(v,o=n).map((function(n){var e=na.detect(n.versionRegexes,o);return{current:n.name,version:e}})).fold(da,ma),{browser:b,os:y,deviceType:(i=b,u=n,c=t,s=(r=y).isiOS()&&!0===/ipad/i.test(u),f=r.isiOS()&&!s,d=(l=r.isiOS()||r.isAndroid())||c("(pointer:coarse)"),m=s||!f&&l&&c("(min-device-width:768px)"),g=f||l&&!m,p=i.isSafari()&&r.isiOS()&&!1===/safari/i.test(u),{isiPad:a(s),isiPhone:a(f),isTablet:a(m),isPhone:a(g),isTouch:a(d),isAndroid:r.isAndroid,isiOS:r.isiOS,isWebView:a(p),isDesktop:a(!g&&!m&&!p)})};var n,e,t,o,r,i,u,c,s,f,l,d,m,g,p,h,v,b,y}))),pa=a,ha=pa("touchstart"),va=pa("touchmove"),ba=pa("touchend"),ya=pa("mousedown"),xa=pa("mousemove"),wa=pa("mouseup"),Sa=pa("mouseover"),Oa=pa("keydown"),ka=pa("keyup"),Ta=pa("input"),Ca=pa("change"),Ea=pa("click"),Da=pa("transitionend"),Ma=pa("selectstart"),_a={tap:H("tap")},Ra=H("focus"),Fa=H("blur.post"),Ia=H("paste.post"),Va=H("receive"),Ba=H("execute"),Aa=H("focus.item"),Na=_a.tap,Ha=H("longpress"),Pa=H("system.init"),za=H("system.attached"),ja=H("system.detached"),La=H("focusmanager.shifted"),$a=H("highlight"),Ga=H("dehighlight"),Ua=function(n,e,t,o){var r=Ac({target:e},o);n.getSystem().triggerEvent(t,e,r)},Wa={fromHtml:function(n,e){var t=(e||document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||1<t.childNodes.length)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return J(t.childNodes[0])},fromTag:function(n,e){return J((e||document).createElement(n))},fromText:function(n,e){return J((e||document).createTextNode(n))},fromDom:J,fromPoint:function(n,e,t){return Yc.from(n.dom.elementFromPoint(e,t)).map(J)}};"undefined"!=typeof window||Function("return this;")();var Xa,qa,Ya=Z(1),Ka=Z(3),Ja=Z(9),Qa=Z(11),Za=function(n){return x(n.dom.childNodes,Wa.fromDom)},ns=function(n,e){n.dom.appendChild(e.dom)},es=function(n){var e=n.dom;null!==e.parentNode&&e.parentNode.removeChild(e)},ts=$c(Element.prototype.attachShadow)&&$c(Node.prototype.getRootNode),os=a(ts),rs=ts?function(n){return Wa.fromDom(n.dom.getRootNode())}:en,is=function(n){return i(n.dom.shadowRoot)},us=function(n){var e=Ka(n)?n.dom.parentNode:n.dom;if(null==e||null===e.ownerDocument)return!1;var t,o,r=e.ownerDocument,i=Wa.fromDom(e),u=rs(i);return(fn(u)?Yc.some(u):Yc.none()).fold((function(){return r.body.contains(e)}),(t=us,o=ln,function(n){return t(o(n))}))},cs=function(n){var e=n.dom.body;if(null==e)throw new Error("Body is not available yet");return Wa.fromDom(e)},as=function(n){P(n,ja()),w(n.components(),as)},ss=function(n){w(n.components(),ss),P(n,za())},fs=function(n,e,t){n.getSystem().addToWorld(e),t(n.element,e.element),us(n.element)&&ss(e),n.syncComponents()},ls=Object.keys,ds=Object.hasOwnProperty,ms=function(n,e){var t={};return pn(n,(function(n,o){var r=e(n,o);t[r.k]=r.v})),t},gs=function(n,e){return ds.call(n,e)},ps=Object.freeze({__proto__:null,toAlpha:function(n,e){Fn(n.element,e.alpha,e.omega)},toOmega:function(n,e){Fn(n.element,e.omega,e.alpha)},isAlpha:function(n,e){return Rn(n.element,e.alpha)},isOmega:function(n,e){return Rn(n.element,e.omega)},clear:function(n,e){_n(n.element,e.alpha),_n(n.element,e.omega)}}),hs=function(n){return{isValue:Wc,isError:Uc,getOr:a(n),getOrThunk:a(n),getOrDie:a(n),or:function(){return hs(n)},orThunk:function(){return hs(n)},fold:function(e,t){return t(n)},map:function(e){return hs(e(n))},mapError:function(){return hs(n)},each:function(e){e(n)},bind:function(e){return e(n)},exists:function(e){return e(n)},forall:function(e){return e(n)},toOptional:function(){return Yc.some(n)}}},vs=function(n){return{isValue:Uc,isError:Wc,getOr:s,getOrThunk:function(n){return n()},getOrDie:function(){return m(String(n))()},or:s,orThunk:function(n){return n()},fold:function(e){return e(n)},map:function(){return vs(n)},mapError:function(e){return vs(e(n))},each:u,bind:function(){return vs(n)},exists:Uc,forall:Wc,toOptional:Yc.none}},bs={value:hs,error:vs,fromOption:function(n,e){return n.fold((function(){return vs(e)}),hs)}};(qa=Xa={})[qa.Error=0]="Error",qa[qa.Value=1]="Value";var ys,xs=function(n){return In(n,bs.error,bs.value)},ws=Vn,Ss=Bn,Os=function(n,e){return n.stype===Xa.Value?e(n.svalue):n},ks=function(n,e){return n.stype===Xa.Error?e(n.serror):n},Ts=function(n,e){return n.stype===Xa.Value?{stype:Xa.Value,svalue:e(n.svalue)}:n},Cs=function(n,e){return n.stype===Xa.Error?{stype:Xa.Error,serror:e(n.serror)}:n},Es=In,Ds=Hn((function(n,e){return Hc(n)&&Hc(e)?Ds(n,e):e})),Ms=Hn((function(n,e){return e})),_s=function(n){var e,t,o=(e=[],t=[],w(n,(function(n){In(n,(function(n){return t.push(n)}),(function(n){return e.push(n)}))})),{values:e,errors:t});return 0<o.errors.length?c(Ss,E)(o.errors):ws(o.values)},Rs=Wn(ws),Fs=function(n){return{extract:function(e,t){for(var o={},r=[],i=0,u=n;i<u.length;i++)Nn(u[i],(function(n,i,u,c){var a=qn(u,e,t,n,c);Es(a,(function(n){r.push.apply(r,n)}),(function(n){o[i]=n}))}),(function(n,e){o[n]=e(t)}));return 0<r.length?Ss(r):ws(o)},toString:function(){return"obj{\n"+x(n,(function(n){return Nn(n,(function(n,e,t,o){return n+" -> "+o.toString()}),(function(n){return"state("+n+")"}))})).join("\n")+"}"}}},Is=a(Rs),Vs=(ys=$c,Wn((function(n){var e=typeof n;return ys(n)?ws(n):Ss("Expected type: function but got: "+e)}))),Bs=function(n){return"Errors: \n"+x(10<(e=n.errors).length?e.slice(0,10).concat([{path:[],getErrorInfo:a("... (only showing first ten failures)")}]):e,(function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()})).join("\n")+"\n\nInput object: "+Gn(n.input);var e},As=An,Ns=function(n,e){return{tag:"custom",newKey:n,instantiator:e}},Hs=[re("alpha"),re("omega")];me([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);var Ps,zs,js,Ls={can:Wc,abort:Uc,run:u},$s=pe,Gs=ke(za()),Us=ke(ja()),Ws=ke(Pa()),Xs=(Ps=Ba(),function(n){return Se(Ps,n)}),qs=function(n){return x(n,(function(n){return e=n.length-"/*".length,n.length>="/*".length&&"/*"===n.substr(e,e+"/*".length)?n.substring(0,n.length-"/*".length):n;var e}))},Ys=function(n,e,t,o,r,i,u){function c(n){return yn(n,t)?n[t]():Yc.none()}var s=hn(r,(function(n,e){return o=t,u=function(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var u=[n].concat(e);return n.config({name:a(o)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+o+". Using API: "+i)}),(function(e){var t=Array.prototype.slice.call(u,1);return r.apply(void 0,[n,e.config,e.state].concat(t))}))},c=i=e,f=(s=(r=n).toString()).indexOf(")")+1,l=s.indexOf("("),d=s.substring(l+1,f-1).split(/,\s*/),u.toFunctionAnnotation=function(){return{name:c,parameters:qs(d.slice(0,1).concat(d.slice(3)))}},u;var o,r,i,u,c,s,f,l,d})),f=hn(i,Ee),d=Ac(Ac(Ac({},f),s),{revoke:l(_e,t),config:function(e){var o=te(t+"-config",n,e);return{key:t,value:{config:o,me:d,configAsRaw:v((function(){return te(t+"-config",n,e)})),initialConfig:e,state:u}}},schema:a(e),exhibit:function(n,e){return t=c(n),r=bn(o,"exhibit"),i=function(n,t){return t(e,n.config,n.state)},(t.isSome()&&r.isSome()?Yc.some(i(t.getOrDie(),r.getOrDie())):Yc.none()).getOrThunk((function(){return De({})}));var t,r,i},name:a(t),handlers:function(n){return c(n).map((function(n){return bn(o,"events").getOr((function(){return{}}))(n.config,n.state)})).getOr({})}});return d},Ks={init:function(){return Js({readState:a("No State required")})}},Js=function(n){return n},Qs=pe,Zs=Yn([re("fields"),re("name"),le("active",{}),le("apis",{}),le("state",Ks),le("extra",{})]),nf=Yn([re("branchKey"),re("branches"),re("name"),le("active",{}),le("apis",{}),le("state",Ks),le("extra",{})]),ef=a(void 0),tf=Re({fields:Hs,name:"swapping",apis:ps}),of=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),rf=tinymce.util.Tools.resolve("tinymce.ThemeManager"),uf=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}],cf=["undo","bold","italic","link","image","bullist","styleselect"],af="formatChanged",sf="orientationChanged",ff="dropupDismissed",lf=Object.freeze({__proto__:null,events:function(n){return $s([Se(Va(),(function(e,t){var o,r=n.channels,i=ls(r),u=t;w((o=u).universal?i:S(i,(function(n){return b(o.channels,n)})),(function(n){var t=r[n],o=t.schema,i=te("channel["+n+"] data\nReceiver: "+He(e.element),o,u.data);t.onReceive(e,i)}))}))])}}),df="unknown";(js=zs={})[js.STOP=0]="STOP",js[js.NORMAL=1]="NORMAL",js[js.LOGGING=2]="LOGGING"
;var mf=Fe({}),gf=["alloy/data/Fields","alloy/debugging/Debugging"],pf=a({logEventCut:u,logEventStopped:u,logNoParent:u,logEventNoHandlers:u,logEventResponse:u,write:u}),hf=a([re("menu"),re("selectedMenu")]),vf=a([re("item"),re("selectedItem")]);a(Fs(vf().concat(hf())));var bf,yf,xf=a(Fs(vf())),wf=a(ue("initSize",[re("numColumns"),re("numRows")])),Sf=Re({fields:[ie("channels",Zn(bs.value,Yn([$e("onReceive"),le("schema",Is())])))],name:"receiving",active:lf}),Of=Object.freeze({__proto__:null,onLoad:Qe,toggle:Ye,isOn:function(n,e,t){return t.get()},on:Ke,off:Je,set:pt}),kf=Object.freeze({__proto__:null,exhibit:function(){return De({})},events:function(n,e){var t,o,r,i=(t=n,o=e,r=Ye,Xs((function(n){r(n,t,o)}))),u=Me(n,e,Qe);return $s(E([n.toggleOnExecute?[i]:[],[u]]))}}),Tf=Re({fields:[le("selected",!1),ce("toggleClass"),le("toggleOnExecute",!0),de("aria",{mode:"none"},oe("mode",{pressed:[le("syncWithExpanded",!1),Ue("update",(function(n,e,t){wn(n.element,"aria-pressed",t),e.syncWithExpanded&&ht(n,0,t)}))],checked:[Ue("update",(function(n,e,t){wn(n.element,"aria-checked",t)}))],expanded:[Ue("update",ht)],selected:[Ue("update",(function(n,e,t){wn(n.element,"aria-selected",t)}))],none:[Ue("update",u)]}))],name:"toggling",active:kf,apis:Of,state:{init:function(){var n=Fe(!1);return{get:function(){return n.get()},set:function(e){return n.set(e)},clear:function(){return n.set(!1)},readState:function(){return n.get()}}}}}),Cf="tinymce-mobile",Ef=function(n){return Cf+"-"+n},Df=Object.freeze({__proto__:null,focus:ot,blur:function(n,e){e.ignore||Ve(n.element)},isFocused:function(n){return e=n.element,t=rs(e).dom,e.dom===t.activeElement;var e,t}}),Mf=Object.freeze({__proto__:null,exhibit:function(n,e){return De(e.ignore?{}:{attributes:{tabindex:"-1"}})},events:function(n){return $s([Se(Ra(),(function(e,t){ot(e,n),t.stop()}))].concat(n.stopMousedown?[Se(ya(),(function(n,e){e.event.prevent()}))]:[]))}}),_f=Re({fields:[je("onFocus"),le("stopMousedown",!1),le("ignore",!1)],name:"focusing",active:Mf,apis:Df}),Rf=function(n,e){return rt(n)?n.style.getPropertyValue(e):""},Ff=dt("height",(function(n){var e=n.dom;return us(n)?e.getBoundingClientRect().height:e.offsetHeight})),If=[8],Vf=[9],Bf=[13],Af=[27],Nf=[32],Hf=[37],Pf=[38],zf=[39],jf=[40],Lf=d(Dt),$f=Object.freeze({__proto__:null,dehighlightAll:function(n,e){return It(n,e,0,[])},dehighlight:function(n,e,t,o){Pt(0,e,0,o)&&(_n(o.element,e.highlightClass),e.onDehighlight(n,o),P(o,Ga()))},highlight:Vt,highlightFirst:function(n,e){zt(n,e).each((function(t){Vt(n,e,0,t)}))},highlightLast:function(n,e){jt(n,e).each((function(t){Vt(n,e,0,t)}))},highlightAt:function(n,e,t,o){var r,i,u;i=o,u=gt((r=n).element,"."+e.itemClass),Yc.from(u[i]).fold((function(){return bs.error(new Error("No element found with index "+i))}),r.getSystem().getByDom).fold((function(n){throw n}),(function(t){Vt(n,e,0,t)}))},highlightBy:function(n,e,t,o){T(Lt(n,e),o).each((function(t){Vt(n,e,0,t)}))},isHighlighted:Pt,getHighlighted:function(n,e){return xt(n.element,"."+e.highlightClass).bind((function(e){return n.getSystem().getByDom(e).toOptional()}))},getFirst:zt,getLast:jt,getPrevious:function(n,e){return Bt(n,e,0,-1)},getNext:function(n,e){return Bt(n,e,0,1)},getCandidates:Lt}),Gf=Re({fields:[re("highlightClass"),re("itemClass"),je("onHighlight"),je("onDehighlight")],name:"highlighting",apis:$f});(yf=bf=bf||{}).OnFocusMode="onFocus",yf.OnEnterOrSpaceMode="onEnterOrSpace",yf.OnApiMode="onApi";var Uf,Wf,Xf,qf,Yf,Kf,Jf,Qf,Zf,nl,el=Gt(Ns("cyclic",Uc)),tl=Gt(Ns("cyclic",Wc)),ol=$t([le("execute",Wt),le("useSpace",!1),le("useEnter",!0),le("useControlEnter",!1),le("useDown",!1)],Ks.init,(function(n,e,t){var o=t.useSpace&&!Ut(n.element)?Nf:[],r=t.useEnter?Bf:[],i=t.useDown?jf:[];return[_t(Ct(o.concat(r).concat(i)),qt)].concat(t.useControlEnter?[_t(Et([Mt,Ct(Bf)]),qt)]:[])}),(function(n,e,t){return t.useSpace&&!Ut(n.element)?[_t(Ct(Nf),Xt)]:[]}),(function(){return Yc.none()})),rl=Object.freeze({__proto__:null,flatgrid:Qt,init:function(n){return n.state(n)}}),il=function(n){return"rtl"===at(n,"direction")?"rtl":"ltr"},ul=function(n,e,t,o,r){return o.focusManager.get(e).bind((function(t){return n(e.element,t,o,r)})).map((function(n){return o.focusManager.set(e,n),!0}))},cl=oo,al=oo,sl=oo,fl=lo((function(n,e,t,o){return ao(n,e,t,o,-1)})),ll=lo((function(n,e,t,o){return ao(n,e,t,o,1)})),dl=lo((function(n,e,t,o){return so(n,e,t,o,-1)})),ml=lo((function(n,e,t,o){return so(n,e,t,o,1)})),gl=$t([re("selector"),le("execute",Wt),Le("onEscape"),le("captureTab",!1),wf()],Qt,a([_t(Ct(Hf),eo(fl,ll)),_t(Ct(zf),to(fl,ll)),_t(Ct(Pf),cl(dl)),_t(Ct(jf),al(ml)),_t(Et([Dt,Ct(Vf)]),mo),_t(Et([Lf,Ct(Vf)]),mo),_t(Ct(Af),(function(n,e,t){return t.onEscape(n,e)})),_t(Ct(Nf.concat(Bf)),(function(n,e,t){return(o=t).focusManager.get(n).bind((function(n){return wt(n,o.selector)})).bind((function(o){return t.execute(n,e,o)}));var o}))]),a([_t(Ct(Nf),Xt)]),(function(){return Yc.some(fo)})),pl=[re("selector"),le("getInitial",Yc.none),le("execute",Wt),Le("onEscape"),le("executeOnMove",!1),le("allowVertical",!0)],hl=a([_t(Ct(Nf),Xt)]),vl=$t(pl,Ks.init,(function(n,e,t){var o=Hf.concat(t.allowVertical?Pf:[]),r=zf.concat(t.allowVertical?jf:[]);return[_t(Ct(o),yo(eo(vo,bo))),_t(Ct(r),yo(to(vo,bo))),_t(Ct(Bf),po),_t(Ct(Nf),po),_t(Ct(Af),xo)]}),hl,(function(){return Yc.some(ho)})),bl=[ue("selectors",[re("row"),re("cell")]),le("cycles",!0),le("previousSelector",Yc.none),le("execute",Wt)],yl=Eo((function(n,e,t){return So(n,e,t,-1)}),(function(n,e,t){return ko(n,e,t,-1)})),xl=Eo((function(n,e,t){return So(n,e,t,1)}),(function(n,e,t){return ko(n,e,t,1)})),wl=Eo((function(n,e,t){return Oo(n,t,e,-1)}),(function(n,e,t){return To(n,t,e,-1)})),Sl=Eo((function(n,e,t){return Oo(n,t,e,1)}),(function(n,e,t){return To(n,t,e,1)})),Ol=a([_t(Ct(Hf),eo(yl,xl)),_t(Ct(zf),to(yl,xl)),_t(Ct(Pf),cl(wl)),_t(Ct(jf),al(Sl)),_t(Ct(Nf.concat(Bf)),(function(n,e,t){return Ae(n.element).bind((function(o){return t.execute(n,e,o)}))}))]),kl=a([_t(Ct(Nf),Xt)]),Tl=$t(bl,Ks.init,Ol,kl,(function(){return Yc.some(Co)})),Cl=[re("selector"),le("execute",Wt),le("moveOnTab",!1)],El=a([_t(Ct(Pf),sl(_o)),_t(Ct(jf),sl(Ro)),_t(Et([Dt,Ct(Vf)]),(function(n,e,t,o){return t.moveOnTab?sl(_o)(n,e,t,o):Yc.none()})),_t(Et([Lf,Ct(Vf)]),(function(n,e,t,o){return t.moveOnTab?sl(Ro)(n,e,t,o):Yc.none()})),_t(Ct(Bf),Do),_t(Ct(Nf),Do)]),Dl=a([_t(Ct(Nf),Xt)]),Ml=$t(Cl,Ks.init,El,Dl,(function(){return Yc.some(Mo)})),_l=$t([Le("onSpace"),Le("onEnter"),Le("onShiftEnter"),Le("onLeft"),Le("onRight"),Le("onTab"),Le("onShiftTab"),Le("onUp"),Le("onDown"),Le("onEscape"),le("stopSpaceKeyup",!1),ce("focusIn")],Ks.init,(function(n,e,t){return[_t(Ct(Nf),t.onSpace),_t(Et([Lf,Ct(Bf)]),t.onEnter),_t(Et([Dt,Ct(Bf)]),t.onShiftEnter),_t(Et([Dt,Ct(Vf)]),t.onShiftTab),_t(Et([Lf,Ct(Vf)]),t.onTab),_t(Ct(Pf),t.onUp),_t(Ct(jf),t.onDown),_t(Ct(Hf),t.onLeft),_t(Ct(zf),t.onRight),_t(Ct(Nf),t.onSpace),_t(Ct(Af),t.onEscape)]}),(function(n,e,t){return t.stopSpaceKeyup?[_t(Ct(Nf),Xt)]:[]}),(function(n){return n.focusIn})),Rl=el.schema(),Fl=tl.schema(),Il=vl.schema(),Vl=gl.schema(),Bl=Tl.schema(),Al=ol.schema(),Nl=Ml.schema(),Hl=_l.schema(),Pl=(Wf=oe((nl=te("Creating behaviour: "+(Uf={branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:Rl,cyclic:Fl,flow:Il,flatgrid:Vl,matrix:Bl,execution:Al,menu:Nl,special:Hl}),name:"keying",active:{events:function(n,e){return n.handler.toEvents(n,e)}},apis:{focusIn:function(n,e,t){e.sendFocusIn(e).fold((function(){n.getSystem().triggerFocus(n.element,n.element)}),(function(o){o(n,e,t)}))},setGridSize:function(n,e,t,o,r){yn(t,"setGridSize")?t.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:rl}).name,nf,Uf)).branchKey,nl.branches),Xf=nl.name,qf=nl.active,Yf=nl.apis,Kf=nl.extra,Jf=nl.state,Zf=se(Xf,[ae("config",Qf=Wf)]),Ys(Qf,Zf,Xf,qf,Yf,Kf,Jf)),zl=Fo,jl=Io,Ll="placeholder",$l=me([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Gl=function(n,e,t,o){return r=n,u=o,(Vo(i=t)&&i.uiType===Ll?(f=i,l=u,(c=r).exists((function(n){return n!==f.owner}))?$l.single(!0,a(f)):bn(l,f.name).fold((function(){throw new Error("Unknown placeholder component: "+f.name+"\nKnown: ["+ls(l)+"]\nNamespace: "+c.getOr("none")+"\nSpec: "+JSON.stringify(f,null,2))}),(function(n){return n.replace()}))):$l.single(!1,a(i))).fold((function(r,i){var u=Vo(t)?i(e,t.config,t.validated):i(e),c=D(bn(u,"components").getOr([]),(function(t){return Gl(n,e,t,o)}));return[Ac(Ac({},u),{components:c})]}),(function(n,o){if(Vo(t)){var r=o(e,t.config,t.validated);return t.validated.preprocess.getOr(s)(r)}return o(e)}));var r,i,u,c,f,l},Ul=$l.single,Wl=$l.multiple,Xl=a(Ll),ql=0,Yl=me([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Kl=le("factory",{sketch:s}),Jl=le("schema",[]),Ql=re("name"),Zl=As("pname","pname",zn((function(n){return"<alloy."+Bo(n.name)+">"})),Is()),nd=Ns("schema",(function(){return[ce("preprocess")]})),ed=le("defaults",a({})),td=le("overrides",a({})),od=Fs([Kl,Jl,Ql,Zl,ed,td]),rd=Fs([Kl,Jl,Ql,ed,td]),id=Fs([Kl,Jl,Ql,Zl,ed,td]),ud=Fs([Kl,nd,Ql,re("unit"),Zl,ed,td]),cd=No(Yl.required,od);No(Yl.external,rd);var ad=No(Yl.optional,id),sd=No(Yl.group,ud),fd=a("entirety"),ld=function(n,e){return{uiType:Xl(),owner:n,name:e}},dd=Bo("alloy-premade"),md=a("alloy-id-"),gd=a("data-alloy-id"),pd=md(),hd=gd(),vd=function(n,e){Object.defineProperty(n.dom,hd,{value:e,writable:!0})},bd=Bo,yd=function(n){return gs(n,"uid")?n:Ac(Ac({},n),{uid:bd("uid")})},xd=Yn([re("name"),re("factory"),re("configFields"),le("apis",{}),le("extraApis",{})]),wd=Yn([re("name"),re("factory"),re("configFields"),re("partFields"),le("apis",{}),le("extraApis",{})]),Sd=Yo({name:"Button",factory:function(n){function e(e){return bn(n.dom,"attributes").bind((function(n){return bn(n,e)}))}var t,o=(t=n.action,$s(E([t.map((function(n){return Xs((function(e,t){n(e),t.stop()}))})).toArray(),tt()]))),r=n.dom.tag;return{uid:n.uid,dom:n.dom,components:n.components,events:o,behaviours:jl(n.buttonBehaviours,[_f.config({}),Pl.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==r)return{role:e("role").getOr("button")};var n=e("type").getOr("button"),t=e("role").map((function(n){return{role:n}})).getOr({});return Ac({type:n},t)}()},eventOrder:n.eventOrder}},configFields:[le("uid",void 0),re("dom"),le("components",[]),zl("buttonBehaviours",[_f,Pl]),ce("action"),ce("role"),le("eventOrder",{})]}),Od=Re({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return $s([we(Ma(),Wc)])},exhibit:function(){return De({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),kd=function(n,e,t,o){return Sd.sketch({dom:er(n,o),action:e,buttonBehaviours:Ds(Qs([Od.config({})]),t)})},Td=ad({schema:[re("dom")],name:"label"}),Cd=tr("top-left"),Ed=tr("top"),Dd=tr("top-right"),Md=tr("right"),_d=tr("bottom-right"),Rd=tr("bottom"),Fd=tr("bottom-left"),Id=[Td,tr("left"),Md,Ed,Rd,Cd,Dd,Fd,_d,cd({name:"thumb",defaults:a({dom:{styles:{position:"absolute"}}}),overrides:function(n){return{events:$s([Te(ha(),n,"spectrum"),Te(va(),n,"spectrum"),Te(ba(),n,"spectrum"),Te(ya(),n,"spectrum"),Te(xa(),n,"spectrum"),Te(wa(),n,"spectrum")])}}}),cd({schema:[Ns("mouseIsDown",(function(){return Fe(!1)}))],name:"spectrum",overrides:function(n){function e(e,o){return t.getValueFromEvent(o).map((function(o){return t.setValueFrom(e,n,o)}))}var t=n.model.manager;return{behaviours:Qs([Pl.config({mode:"special",onLeft:function(e){return t.onLeft(e,n)},onRight:function(e){return t.onRight(e,n)},onUp:function(e){return t.onUp(e,n)},onDown:function(e){return t.onDown(e,n)}}),_f.config({})]),events:$s([Se(ha(),e),Se(va(),e),Se(ya(),e),Se(xa(),(function(t,o){n.mouseIsDown.get()&&e(t,o)}))])}}})],Vd=Object.freeze({__proto__:null,onLoad:or,onUnload:rr,setValue:function(n,e,t,o){e.store.manager.setValue(n,e,t,o)},getValue:function(n,e,t){return e.store.manager.getValue(n,e,t)},getState:function(n,e,t){return t}}),Bd=Object.freeze({__proto__:null,events:function(n,e){var t=n.resetOnDom?[Gs((function(t){or(t,n,e)})),Us((function(t){rr(t,n,e)}))]:[Me(n,e,or)];return $s(t)}}),Ad=Object.freeze({__proto__:null,memory:ir,dataset:ur,manual:function(){return Js({readState:u})},init:function(n){return n.store.manager.state(n)}}),Nd=[ce("initialValue"),re("getFallbackEntry"),re("getDataKey"),re("setValue"),Ue("manager",{setValue:cr,getValue:function(n,e,t){var o=e.store,r=o.getDataKey(n);return t.lookup(r).getOrThunk((function(){return o.getFallbackEntry(r)}))},onLoad:function(n,e,t){e.store.initialValue.each((function(o){cr(n,e,t,o)}))},onUnload:function(n,e,t){t.clear()},state:ur})],Hd=[re("getValue"),le("setValue",u),ce("initialValue"),Ue("manager",{setValue:function(n,e,t,o){e.store.setValue(n,o),e.onSetValue(n,o)},getValue:function(n,e){return e.store.getValue(n)},onLoad:function(n,e){e.store.initialValue.each((function(t){e.store.setValue(n,t)}))},onUnload:u,state:Ks.init})],Pd=Re({fields:[de("store",{mode:"memory"},oe("mode",{memory:[ce("initialValue"),Ue("manager",{setValue:function(n,e,t,o){t.set(o),e.onSetValue(n,o)},getValue:function(n,e,t){return t.get()},onLoad:function(n,e,t){e.store.initialValue.each((function(n){t.isNotSet()&&t.set(n)}))},onUnload:function(n,e,t){t.clear()},state:ir})],manual:Hd,dataset:Nd})),je("onSetValue"),le("resetOnDom",!1)],name:"representing",active:Bd,apis:Vd,extra:{setValueFrom:function(n,e){var t=Pd.getValue(e);Pd.setValue(n,t)}},state:Ad}),zd=dt("width",(function(n){return n.dom.offsetWidth})),jd=function(n,e){return{left:n,top:e,translate:function(t,o){return jd(n+t,e+o)}}},Ld=jd,$d=a("slider.change.value"),Gd="left",Ud=Qr(-1),Wd=Qr(1),Xd=Yc.none,qd=Yc.none,Yd={"top-left":Yc.none(),top:Yc.none(),"top-right":Yc.none(),right:Yc.some((function(n,e){Br(n,{x:vr(e)})})),"bottom-right":Yc.none(),bottom:Yc.none(),"bottom-left":Yc.none(),left:Yc.some((function(n,e){Br(n,{x:mr(e)})}))},Kd=Object.freeze({__proto__:null,setValueFrom:function(n,e,t){var o=Jr(n,e,t);return Kr(n,{x:o}),o},setToMin:function(n,e){Kr(n,{x:lr(e)})},setToMax:function(n,e){Kr(n,{x:pr(e)})},findValueOfOffset:Jr,getValueFromEvent:function(n){return fr(n).map((function(n){return n.left}))},findPositionOfValue:Zr,setPositionFromValue:function(n,e,t,o){var r=Ir(t),i=Zr(n,o.getSpectrum(n),r.x,o.getLeftEdge(n),o.getRightEdge(n),t),u=sr(e.element)/2;ut(e.element,"left",i-u+"px")},onLeft:Ud,onRight:Wd,onUp:Xd,onDown:qd,edgeActions:Yd}),Jd=Yc.none,Qd=Yc.none,Zd=ti(-1),nm=ti(1),em={"top-left":Yc.none(),top:Yc.some((function(n,e){Br(n,{y:gr(e)})})),"top-right":Yc.none(),right:Yc.none(),"bottom-right":Yc.none(),bottom:Yc.some((function(n,e){Br(n,{y:br(e)})})),"bottom-left":Yc.none(),left:Yc.none()},tm=Object.freeze({__proto__:null,setValueFrom:function(n,e,t){var o=ei(n,e,t);return ni(n,{y:o}),o},setToMin:function(n,e){ni(n,{y:dr(e)})},setToMax:function(n,e){ni(n,{y:hr(e)})},findValueOfOffset:ei,getValueFromEvent:function(n){return fr(n).map((function(n){return n.top}))},findPositionOfValue:oi,setPositionFromValue:function(n,e,t,o){var r=Ir(t),i=oi(n,o.getSpectrum(n),r.y,o.getTopEdge(n),o.getBottomEdge(n),t),u=mt(e.element)/2;ut(e.element,"top",i-u+"px")},onLeft:Jd,onRight:Qd,onUp:Zd,onDown:nm,edgeActions:em}),om=fr,rm=ui(-1,!1),im=ui(1,!1),um=ui(-1,!0),cm=ui(1,!0),am={"top-left":Yc.some((function(n,e){Br(n,Vr(mr(e),gr(e)))})),top:Yc.some((function(n,e){Br(n,Vr(Sr(e),gr(e)))})),"top-right":Yc.some((function(n,e){Br(n,Vr(vr(e),gr(e)))})),right:Yc.some((function(n,e){Br(n,Vr(vr(e),Or(e)))})),"bottom-right":Yc.some((function(n,e){Br(n,Vr(vr(e),br(e)))})),bottom:Yc.some((function(n,e){Br(n,Vr(Sr(e),br(e)))})),"bottom-left":Yc.some((function(n,e){Br(n,Vr(mr(e),br(e)))})),left:Yc.some((function(n,e){Br(n,Vr(mr(e),Or(e)))}))},sm=Object.freeze({__proto__:null,setValueFrom:function(n,e,t){var o=ii(Jr(n,e,t.left),ei(n,e,t.top));return ri(n,o),o},setToMin:function(n,e){ri(n,ii(lr(e),dr(e)))},setToMax:function(n,e){ri(n,ii(pr(e),hr(e)))},getValueFromEvent:om,setPositionFromValue:function(n,e,t,o){var r=Ir(t),i=Zr(n,o.getSpectrum(n),r.x,o.getLeftEdge(n),o.getRightEdge(n),t),u=oi(n,o.getSpectrum(n),r.y,o.getTopEdge(n),o.getBottomEdge(n),t),c=sr(e.element)/2,a=mt(e.element)/2;ut(e.element,"left",i-c+"px"),ut(e.element,"top",u-a+"px")},onLeft:rm,onRight:im,onUp:um,onDown:cm,edgeActions:am}),fm=[le("stepSize",1),le("onChange",u),le("onChoose",u),le("onInit",u),le("onDragStart",u),le("onDragEnd",u),le("snapToGrid",!1),le("rounded",!0),ce("snapStart"),ie("model",oe("mode",{x:[le("minX",0),le("maxX",100),Ns("value",(function(n){return Fe(n.mode.minX)})),re("getInitialValue"),Ue("manager",Kd)],y:[le("minY",0),le("maxY",100),Ns("value",(function(n){return Fe(n.mode.minY)})),re("getInitialValue"),Ue("manager",tm)],xy:[le("minX",0),le("maxX",100),le("minY",0),le("maxY",100),Ns("value",(function(n){return Fe({x:n.mode.minX,y:n.mode.minY})})),re("getInitialValue"),Ue("manager",sm)]})),Fo("sliderBehaviours",[Pl,Pd]),Ns("mouseIsDown",(function(){return Fe(!1)}))],lm=a("mouse.released"),dm=Ko({name:"Slider",configFields:fm,partFields:Id,factory:function(n,e){function t(e){return Lo(e,n,"thumb")}function o(e){return Lo(e,n,"spectrum")}function r(e){return jo(e,n,"left-edge")}function i(e){return jo(e,n,"right-edge")}function u(e){return jo(e,n,"top-edge")}function c(e){return jo(e,n,"bottom-edge")}function a(e,t){p.setPositionFromValue(e,t,n,{getLeftEdge:r,getRightEdge:i,getTopEdge:u,getBottomEdge:c,getSpectrum:o})}function s(n,e){g.value.set(e),a(n,t(n))}function f(e){var t=n.mouseIsDown.get();n.mouseIsDown.set(!1),t&&jo(e,n,"thumb").each((function(t){var o=g.value.get();n.onChoose(e,t,o)}))}function l(e,o){o.stop(),n.mouseIsDown.set(!0),n.onDragStart(e,t(e))}function d(e,o){o.stop(),n.onDragEnd(e,t(e)),f(e)}var m,g=n.model,p=g.manager;return{uid:n.uid,dom:n.dom,components:e,behaviours:Io(n.sliderBehaviours,[Pl.config({mode:"special",focusIn:function(e){return jo(e,n,"spectrum").map(Pl.focusIn).map(Wc)}}),Pd.config({store:{mode:"manual",getValue:function(){return g.value.get()}}}),Sf.config({channels:((m={})[lm()]={onReceive:f},m)})]),events:$s([Se($d(),(function(e,o){!function(e,o){s(e,o);var r=t(e);n.onChange(e,r,o),Yc.some(!0)}(e,o.event.value)})),Gs((function(e){var r=g.getInitialValue();g.value.set(r);var i=t(e);a(e,i);var u=o(e);n.onInit(e,i,u,g.value.get())})),Se(ha(),l),Se(ba(),d),Se(ya(),l),Se(wa(),d)]),apis:{resetToMin:function(e){p.setToMin(e,n)},resetToMax:function(e){p.setToMax(e,n)},setValue:s,refresh:a},domModification:{styles:{position:"relative"}}}},apis:{setValue:function(n,e,t){n.setValue(e,t)},resetToMin:function(n,e){n.resetToMin(e)},resetToMax:function(n,e){n.resetToMax(e)},refresh:function(n,e){n.refresh(e)}}}),mm=["9px","10px","11px","12px","14px","16px","18px","20px","24px","32px","36px"],gm=a(mm),pm=Yn([re("getInitialValue"),re("onChange"),re("category"),re("sizes")]),hm=gm(),vm={},bm={exports:vm};!function(){var n=this,e=function(){function n(){}function e(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(n,this)}function t(n,t){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,e._immediateFn((function(){var e,i=1===n._state?t.onFulfilled:t.onRejected;if(null!==i){try{e=i(n._value)}catch(e){return void r(t.promise,e)}o(t.promise,e)}else(1===n._state?o:r)(t.promise,n._value)}))):n._deferreds.push(t)}function o(n,t){try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var o=t.then;if(t instanceof e)return n._state=3,n._value=t,void i(n);if("function"==typeof o)return void c((u=o,a=t,function(){u.apply(a,arguments)}),n)}n._state=1,n._value=t,i(n)}catch(t){r(n,t)}var u,a}function r(n,e){n._state=2,n._value=e,i(n)}function i(n){2===n._state&&0===n._deferreds.length&&e._immediateFn((function(){n._handled||e._unhandledRejectionFn(n._value)}));for(var o=0,r=n._deferreds.length;o<r;o++)t(n,n._deferreds[o]);n._deferreds=null}function u(n,e,t){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.promise=t}function c(n,e){var t=!1;try{n((function(n){t||(t=!0,o(e,n))}),(function(n){t||(t=!0,r(e,n))}))}catch(n){if(t)return;t=!0,r(e,n)}}var a,s,f,l={exports:{}};a=l,s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},f=setTimeout,e.prototype.catch=function(n){return this.then(null,n)},e.prototype.then=function(e,o){var r=new this.constructor(n);return t(this,new u(e,o,r)),r},e.all=function(n){var t=Array.prototype.slice.call(n);return new e((function(n,e){if(0===t.length)return n([]);for(var o=t.length,r=0;r<t.length;r++)!function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var c=u.then;if("function"==typeof c)return c.call(u,(function(n){r(i,n)}),e),0}t[i]=u,0==--o&&n(t)}catch(u){e(u)}}(r,t[r])}))},e.resolve=function(n){return n&&"object"==typeof n&&n.constructor===e?n:new e((function(e){e(n)}))},e.reject=function(n){return new e((function(e,t){t(n)}))},e.race=function(n){return new e((function(e,t){for(var o=0,r=n.length;o<r;o++)n[o].then(e,t)}))},e._immediateFn="function"==typeof setImmediate?function(n){setImmediate(n)}:function(n){f(n,0)},e._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},e._setImmediateFn=function(n){e._immediateFn=n},e._setUnhandledRejectionFn=function(n){e._unhandledRejectionFn=n},a.exports?a.exports=e:s.Promise||(s.Promise=e);var d=l.exports;return{boltExport:("undefined"!=typeof window?window:Function("return this;")()).Promise||d}};"object"==typeof vm&&void 0!==bm?bm.exports=e():(n="undefined"!=typeof globalThis?globalThis:n||self).EphoxContactWrapper=e()}();var ym,xm=bm.exports.boltExport,wm=function(n){return wt(Wa.fromDom(n.selection.getStart()),"a")},Sm=ga(),Om=Object.freeze({__proto__:null,getCurrent:function(n,e){return e.find(n)}}),km=Re({fields:[re("find")],name:"composing",apis:Om}),Tm=Yo({name:"Container",factory:function(e){var t=e.dom,o=t.attributes,r=n(t,["attributes"]);return{uid:e.uid,dom:Ac({tag:"div",attributes:Ac({role:"presentation"},o)},r),components:e.components,behaviours:e.containerBehaviours.dump,events:e.events,domModification:e.domModification,eventOrder:e.eventOrder}},configFields:[le("components",[]),Fo("containerBehaviours",[]),le("events",{}),le("domModification",{}),le("eventOrder",{})]}),Cm=Yo({name:"DataField",factory:function(n){return{uid:n.uid,dom:n.dom,behaviours:jl(n.dataBehaviours,[Pd.config({store:{mode:"memory",initialValue:n.getInitialValue()}}),km.config({find:Yc.some})]),events:$s([Gs((function(e){Pd.setValue(e,n.getInitialValue())}))])}},configFields:[re("uid"),re("dom"),re("getInitialValue"),zl("dataBehaviours",[Pd,km])]}),Em=Yo({name:"Input",configFields:a([ce("data"),le("inputAttributes",{}),le("inputStyles",{}),le("tag","input"),le("inputClasses",[]),je("onSetValue"),le("styles",{}),le("eventOrder",{}),Fo("inputBehaviours",[Pd,_f]),le("selectOnFocus",!0)])(),factory:function(n){return{uid:n.uid,dom:{tag:(t=n).tag,attributes:Ac({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses},components:[],behaviours:(e=n,Ac(Ac({},Qs([_f.config({onFocus:e.selectOnFocus?function(n){var e=n.element,t=bi(e);e.dom.setSelectionRange(0,t.length)}:u})])),Io(e.inputBehaviours,[Pd.config({store:Ac(Ac({mode:"manual"},e.data.map((function(n){return{initialValue:n}})).getOr({})),{getValue:function(n){return bi(n.element)},setValue:function(n,e){bi(n.element)!==e&&yi(n.element,e)}}),onSetValue:e.onSetValue})]))),eventOrder:n.eventOrder};var e,t}}),Dm=Object.freeze({__proto__:null,exhibit:function(n,e){return De({attributes:pe([{key:e.tabAttr,value:"true"}])})}}),Mm=Re({fields:[le("tabAttr","data-alloy-tabstop")],name:"tabstopping",active:Dm}),_m=tinymce.util.Tools.resolve("tinymce.util.I18n"),Rm=["input","button","textarea","select"],Fm=function(n,e){e.disableClass.each((function(e){Mn(n.element,e)})),(Si(n,e)?function(n){wn(n.element,"disabled","disabled")}:function(n){wn(n.element,"aria-disabled","true")})(n),e.onDisabled(n)},Im=function(n,e){e.disableClass.each((function(e){_n(n.element,e)})),(Si(n,e)?function(n){Cn(n.element,"disabled")}:function(n){wn(n.element,"aria-disabled","false")})(n),e.onEnabled(n)},Vm=Object.freeze({__proto__:null,enable:Im,disable:Fm,isDisabled:Oi,onLoad:wi,set:function(n,e,t,o){(o?Fm:Im)(n,e)}}),Bm=Object.freeze({__proto__:null,exhibit:function(n,e){return De({classes:e.disabled()?e.disableClass.toArray():[]})},events:function(n,e){return $s([we(Ba(),(function(e){return Oi(e,n)})),Me(n,e,wi)])}}),Am=Re({fields:[de("disabled",Uc,Vs),le("useNative",!0),ce("disableClass"),je("onDisabled"),je("onEnabled")],name:"disabling",active:Bm,apis:Vm}),Nm=[Fo("formBehaviours",[Pd])],Hm=(Uo((function(n,e,t){return n.getField(e,t)})),function(n){var e,t={field:function(n,t){return e.push(n),o=ki(n),r=t,{uiType:Xl(),owner:"form",name:o,config:r,validated:{}};var o,r},record:a(e=[])},o=n(t),r=x(t.record(),(function(n){return cd({name:n,pname:ki(n)})}));return qo("form",Nm,r,fu,o)}),Pm=v((function(n,e){function t(n,e,t){return Sd.sketch({dom:Jo('<span class="${prefix}-icon-'+e+' ${prefix}-icon"></span>'),action:function(e){z(e,u,{direction:n})},buttonBehaviours:Qs([Am.config({disableClass:Ef("toolbar-navigation-disabled"),disabled:function(){return!t}})])})}function o(n,e){var t=gt(n.element,"."+Ef("serialised-dialog-screen"));xt(n.element,"."+Ef("serialised-dialog-chain")).each((function(n){0<=c.state.currentScreen.get()+e&&c.state.currentScreen.get()+e<t.length&&(st(n,"left").each((function(o){var r=parseInt(o,10),i=sr(t[0]);ut(n,"left",r-e*i+"px")})),c.state.currentScreen.set(c.state.currentScreen.get()+e))}))}function r(n){var e=gt(n.element,"input");Yc.from(e[c.state.currentScreen.get()]).each((function(e){n.getSystem().getByDom(e).each((function(e){var t=n,o=e.element;t.getSystem().triggerFocus(o,t.element)}))}));var t=s.get(n);Gf.highlightAt(t,c.state.currentScreen.get())}return[{label:"the link group",items:[(i={fields:[xi("url","Type or paste URL"),xi("text","Link text"),xi("title","Link title"),xi("target","Link target"),{name:"link",spec:Cm.sketch({dom:{tag:"span",styles:{display:"none"}},getInitialValue:function(){return Yc.none()}})}],maxFieldIndex:["url","text","title","target"].length-1,getInitialValue:function(){return Yc.some(wm(n=e).fold((function(){return{url:"",text:n.selection.getContent({format:"text"}),title:"",target:"",link:Yc.none()}}),(function(n){return t=mi(e=n),o=On(e,"href"),r=On(e,"title"),i=On(e,"target"),{url:pi(o),text:t!==o?pi(t):"",title:pi(r),target:pi(i),link:Yc.some(e)};var e,t,o,r,i})));var n},onExecute:function(t){var o=Pd.getValue(t);hi(e,o),n.restoreToolbar(),e.focus()}},u="navigateEvent",c=te("SerialisedDialog",Fs([re("fields"),le("maxFieldIndex",i.fields.length-1),re("onExecute"),re("getInitialValue"),Ns("state",(function(){return{dialogSwipeState:Jt(),currentScreen:Fe(0)}}))]),i),a=li(Hm((function(n){return{dom:Jo('<div class="${prefix}-serialised-dialog"></div>'),components:[Tm.sketch({dom:Jo('<div class="${prefix}-serialised-dialog-chain" style="left: 0px; position: absolute;"></div>'),components:x(c.fields,(function(e,o){return o<=c.maxFieldIndex?Tm.sketch({dom:Jo('<div class="${prefix}-serialised-dialog-screen"></div>'),components:[t(-1,"previous",0<o),n.field(e.name,e.spec),t(1,"next",o<c.maxFieldIndex)]}):n.field(e.name,e.spec)}))})],formBehaviours:Qs([nt((function(n,e){var t=e;xt(n.element,"."+Ef("serialised-dialog-chain")).each((function(n){ut(n,"left",-c.state.currentScreen.get()*t.width+"px")}))})),Pl.config({mode:"special",focusIn:function(n){r(n)},onTab:function(n){return o(n,1),Yc.some(!0)},onShiftTab:function(n){return o(n,-1),Yc.some(!0)}}),vi("form-events",[Gs((function(n){c.state.currentScreen.set(0),c.state.dialogSwipeState.clear();var e=s.get(n);Gf.highlightFirst(e),c.getInitialValue(n).each((function(e){Pd.setValue(n,e)}))})),Xs(c.onExecute),Se(Da(),(function(n,e){"left"===e.event.raw.propertyName&&r(n)})),Se(u,(function(n,e){o(n,e.event.direction)}))])])}}))),s=li({dom:Jo('<div class="${prefix}-dot-container"></div>'),behaviours:Qs([Gf.config({highlightClass:Ef("dot-active"),itemClass:Ef("dot-item")})]),components:D(c.fields,(function(n,e){return e<=c.maxFieldIndex?[Qo('<div class="${prefix}-dot-item ${prefix}-icon-full-dot ${prefix}-icon"></div>')]:[]}))}),{dom:Jo('<div class="${prefix}-serializer-wrapper"></div>'),components:[a.asSpec(),s.asSpec()],behaviours:Qs([Pl.config({mode:"special",focusIn:function(n){var e=a.get(n);Pl.focusIn(e)}}),vi("serializer-wrapper-events",[Se(ha(),(function(n,e){var t=e.event;c.state.dialogSwipeState.set({xValue:t.raw.touches[0].clientX,points:[]})})),Se(va(),(function(n,e){var t=e.event;c.state.dialogSwipeState.on((function(n){e.event.prevent(),c.state.dialogSwipeState.set(function(n,e){if(e===n.xValue)return n;var t=0<e-n.xValue?1:-1,o={direction:t,xValue:e};return{xValue:e,points:(0===n.points.length?[]:n.points[n.points.length-1].direction===t?n.points.slice(0,n.points.length-1):n.points).concat([o])}}(n,t.raw.touches[0].clientX))}))})),Se(ba(),(function(n){c.state.dialogSwipeState.on((function(e){o(a.get(n),-1*function(){if(0===e.points.length)return 0;var n=e.points[0].direction,t=e.points[e.points.length-1].direction;return-1===n&&-1===t?-1:1===n&&1===t?1:0}())}))}))])])})]}];var i,u,c,a,s})),zm=$s([{key:Ra(),value:xe({can:function(n,e){var t,o=e.event,r=o.originator,i=o.target;return!(X(t=r,n.element)&&!X(t,i)&&(console.warn(Ra()+" did not get interpreted by the desired target. \nOriginator: "+He(r)+"\nTarget: "+He(i)+"\nCheck the "+Ra()+" event handlers"),1))}})}]),jm=Object.freeze({__proto__:null,events:zm}),Lm=s,$m=Ci(),Gm=function(n,e){var t,o,r,i,u,c,a=vn(n,(function(n,t){return(1===n.length?bs.value(n[0].handler):_i(n,e,t)).map((function(o){var r,i,u=(i=$c(r=o)?{can:Wc,abort:Uc,run:r}:r,function(n,e){for(var t=[],o=2;o<arguments.length;o++)t[o-2]=arguments[o];var r=[n,e].concat(t);i.abort.apply(void 0,r)?e.stop():i.can.apply(void 0,r)&&i.run.apply(void 0,r)}),c=1<n.length?S(e[t],(function(e){return y(n,(function(n){return n.name===e}))})).join(" > "):n[0].name;return ge(t,{handler:u,purpose:c})}))}));return t={},o=[],r=[],w(a,(function(n){n.fold((function(n){o.push(n)}),(function(n){r.push(n)}))})),0<(c={errors:o,values:r}).errors.length?bs.error(E(c.errors)):(u=t,0===(i=c.values).length?bs.value(u):bs.value(Ds(u,Ms.apply(void 0,i))))},Um="alloy.base.behaviour",Wm=Fs([As("dom","dom",Pn(),Fs([re("tag"),le("styles",{}),le("classes",[]),le("attributes",{}),ce("value"),ce("innerHtml")])),re("components"),re("uid"),le("events",{}),le("apis",{}),As("eventOrder","eventOrder",((ym={})[Ba()]=["disabling",Um,"toggling","typeaheadevents"],ym[Ra()]=[Um,"focusing","keying"],ym[Pa()]=[Um,"disabling","toggling","representing"],ym[Ta()]=[Um,"representing","streaming","invalidating"],ym[ja()]=[Um,"representing","item-events","tooltipping"],ym[ya()]=["focusing",Um,"item-type-events"],ym[ha()]=["focusing",Um,"item-type-events"],ym[Sa()]=["item-type-events","tooltipping"],ym[Va()]=["receiving","reflecting","tooltipping"],$n(a(ym))),Is()),ce("domModification")]),Xm=bd,qm=function(e){return bn(e,dd).getOrThunk((function(){var t,o,r,i,u,c=gs(e,"uid")?e:Ac({uid:Xm("")},e);return o=(t=Lm(c)).events,i=x(bn(r=n(t,["events"]),"components").getOr([]),qm),u=Ac(Ac({},r),{events:Ac(Ac({},jm),o),components:i}),bs.value(Ai(u)).getOrDie()}))},Ym=Go,Km="alloy.item-hover",Jm="alloy.item-focus",Qm=a(Km),Zm=a(Jm),ng=[re("data"),re("components"),re("dom"),le("hasSubmenu",!1),ce("toggling"),zl("itemBehaviours",[Tf,_f,Pl,Pd]),le("ignoreFocus",!1),le("domModification",{}),Ue("builder",(function(n){return{dom:n.dom,domModification:Ac(Ac({},n.domModification),{attributes:Ac(Ac(Ac({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes),{"aria-haspopup":n.hasSubmenu}),n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:jl(n.itemBehaviours,[n.toggling.fold(Tf.revoke,(function(n){return Tf.config(Ac({aria:{mode:"checked"}},n))})),_f.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(n){Pi(n)}}),Pl.config({mode:"execution"}),Pd.config({store:{mode:"memory",initialValue:n.data}}),vi("item-type-events",e(e([],tt(),!0),[Se(Sa(),Hi),Se(Aa(),_f.focus)],!1))]),components:n.components,eventOrder:n.eventOrder}})),le("eventOrder",{})],eg=[re("dom"),re("components"),Ue("builder",(function(n){return{dom:n.dom,components:n.components,events:$s([Se(Aa(),(function(n,e){e.stop()}))])}
}))],tg=a("item-widget"),og=a([cd({name:"widget",overrides:function(n){return{behaviours:Qs([Pd.config({store:{mode:"manual",getValue:function(){return n.data},setValue:u}})])}}})]),rg=oe("type",{widget:[re("uid"),re("data"),re("components"),re("dom"),le("autofocus",!1),le("ignoreFocus",!1),zl("widgetBehaviours",[Pd,_f,Pl]),le("domModification",{}),$o(og()),Ue("builder",(function(n){function e(e){return jo(e,n,"widget").map((function(n){return Pl.focusIn(n),n}))}function t(e,t){return Ut(t.event.target)||n.autofocus&&t.setSource(e.element),Yc.none()}var o=Po(tg(),n,og()),r=zo(tg(),n,o.internals());return{dom:n.dom,components:r,domModification:n.domModification,events:$s([Xs((function(n,t){e(n).each((function(){t.stop()}))})),Se(Sa(),Hi),Se(Aa(),(function(t){n.autofocus?e(t):_f.focus(t)}))]),behaviours:jl(n.widgetBehaviours,[Pd.config({store:{mode:"memory",initialValue:n.data}}),_f.config({ignore:n.ignoreFocus,onFocus:function(n){Pi(n)}}),Pl.config({mode:"special",focusIn:n.autofocus?function(n){e(n)}:ef(),onLeft:t,onRight:t,onEscape:function(e,t){return _f.isFocused(e)||n.autofocus?(n.autofocus&&t.setSource(e.element),Yc.none()):(_f.focus(e),Yc.some(!0))}})])}}))],item:ng,separator:eg}),ig=a([sd({factory:{sketch:function(n){var e=te("menu.spec item",rg,n);return e.builder(e)}},name:"items",unit:"item",defaults:function(n,e){return gs(e,"uid")?e:Ac(Ac({},e),{uid:bd("item")})},overrides:function(n,e){return{type:e.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),ug=a([re("value"),re("items"),re("dom"),re("components"),le("eventOrder",{}),Fo("menuBehaviours",[Gf,Pd,km,Pl]),de("movement",{mode:"menu",moveOnTab:!0},oe("mode",{grid:[wf(),Ue("config",(function(n,e){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:e.initSize.numColumns,numRows:e.initSize.numRows},focusManager:n.focusManager}}))],matrix:[Ue("config",(function(n,e){return{mode:"matrix",selectors:{row:e.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}})),re("rowSelector")],menu:[le("moveOnTab",!0),Ue("config",(function(n,e){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:e.moveOnTab,focusManager:n.focusManager}}))]})),ie("markers",xf()),le("fakeFocus",!1),le("focusManager",Nt()),je("onHighlight")]),cg=a("alloy.menu-focus"),ag=Ko({name:"Menu",configFields:ug(),partFields:ig(),factory:function(n,e){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Io(n.menuBehaviours,[Gf.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),Pd.config({store:{mode:"memory",initialValue:n.value}}),km.config({find:Yc.some}),Pl.config(n.movement.config(n,n.movement))]),events:$s([Se(Zm(),(function(n,e){var t=e.event;n.getSystem().getByDom(t.target).each((function(t){Gf.highlight(n,t),e.stop(),z(n,cg(),{menu:n,item:t})}))})),Se(Qm(),(function(n,e){var t=e.event.item;Gf.highlight(n,t)}))]),components:e,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}}}),sg=function(n){return n.components()},fg=Re({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(n,e,t,o){zi(n,0,ns,o)},prepend:function(n,e,t,o){zi(n,0,cn,o)},remove:ji,replaceAt:Li,replaceBy:function(n,e,t,o,r){return C(sg(n),o).bind((function(e){return Li(n,0,0,e,r)}))},set:function(n,e,t,o){var r,i,c,a;r=function(){var e,t,r,i;t=x(o,n.getSystem().build),i=(e=n).components(),w((r=e).components(),(function(n){return es(n.element)})),sn(r.element),r.syncComponents(),w(R(i,t),(function(n){as(n),e.getSystem().removeFromWorld(n)})),w(t,(function(n){n.getSystem().isConnected()?mn(e,n):(e.getSystem().addToWorld(n),mn(e,n),us(e.element)&&ss(n)),e.syncComponents()}))},i=n.element,a=Be(c=rs(i)).bind((function(n){function e(e){return X(n,e)}var t,o;return e(i)?Yc.some(i):(t=e,(o=function(n){for(var e=0;e<n.childNodes.length;e++){var r=Wa.fromDom(n.childNodes[e]);if(t(r))return Yc.some(r);var i=o(n.childNodes[e]);if(i.isSome())return i}return Yc.none()})(i.dom))})),r(i),a.each((function(n){Be(c).filter((function(e){return X(e,n)})).fold((function(){Ie(n)}),u)}))},contents:sg})}),lg=function(n,e,t,o){return bn(t,o).bind((function(o){return bn(n,o).bind((function(o){var r=lg(n,e,t,o);return Yc.some([o].concat(r))}))})).getOr([])},dg=function(){function n(n){return function(e){for(var t=ls(e),o=0,r=t.length;o<r;o++){var i=e[t[o]];if(i===n)return Yc.some(i)}return Yc.none()}(o.get())}function e(n){return a(n).bind(lu)}function t(n){return bn(o.get(),n)}var o=Fe({}),r=Fe({}),i=Fe({}),u=Jt(),c=Fe({}),a=function(n){return bn(r.get(),n)};return{setMenuBuilt:function(n,e){var t;r.set(Ac(Ac({},r.get()),((t={})[n]={type:"prepared",menu:e},t)))},setContents:function(n,e,t,a){u.set(n),o.set(t),r.set(e),c.set(a);var s=function(n,e){var t={};pn(n,(function(n,e){w(n,(function(n){t[n]=e}))}));var o=e,r=ms(e,(function(n,e){return{k:n,v:e}})),i=hn(r,(function(n,e){return[e].concat(lg(t,o,r,e))}));return hn(t,(function(n){return bn(i,n).getOr([n])}))}(a,t);i.set(s)},expand:function(n){return bn(o.get(),n).map((function(e){var t=bn(i.get(),n).getOr([]);return[e].concat(t)}))},refresh:function(n){return bn(i.get(),n)},collapse:function(n){return bn(i.get(),n).bind((function(n){return 1<n.length?Yc.some(n.slice(1)):Yc.none()}))},lookupMenu:a,lookupItem:t,otherMenus:function(n){var e=c.get();return R(ls(e),n)},getPrimary:function(){return u.get().bind(e)},getMenus:function(){return r.get()},clear:function(){o.set({}),r.set({}),i.set({}),u.clear()},isClear:function(){return u.get().isNone()},getTriggeringPath:function(o,r){var c=S(t(o).toArray(),(function(n){return e(n).isSome()}));return bn(i.get(),o).bind((function(t){var o=_(c.concat(t));return function(n){for(var e=[],t=0;t<n.length;t++){var o=n[t];if(!o.isSome())return Yc.none();e.push(o.getOrDie())}return Yc.some(e)}(D(o,(function(t,i){return c=t,a=r,s=o.slice(0,i+1),e(c).bind((function(e){return n(c).bind((function(n){return a(n).map((function(n){return{triggeredMenu:e,triggeringItem:n,triggeringPath:s}}))}))})).fold((function(){return he(u.get(),t)?[]:[Yc.none()]}),(function(n){return[Yc.some(n)]}));var c,a,s})))}))}}},mg=lu,gg=a("collapse-item"),pg=Yo({name:"TieredMenu",configFields:[Ge("onExecute"),Ge("onEscape"),$e("onOpenMenu"),$e("onOpenSubmenu"),je("onRepositionMenu"),je("onCollapseMenu"),le("highlightImmediately",!0),ue("data",[re("primary"),re("menus"),re("expansions")]),le("fakeFocus",!1),je("onHighlight"),je("onHover"),ue("markers",[re("backgroundMenu")].concat(hf()).concat(vf())),re("dom"),le("navigateOnHover",!0),le("stayInDom",!1),Fo("tmenuBehaviours",[Pl,Gf,km,fg]),le("eventOrder",{})],apis:{collapseMenu:function(n,e){n.collapseMenu(e)},highlightPrimary:function(n,e){n.highlightPrimary(e)},repositionMenus:function(n,e){n.repositionMenus(e)}},factory:function(n){function e(e){var t,o,r=(t=e,o=n.data.primary,hn(n.data.menus,(function(e,r){function i(){return ag.sketch(Ac(Ac({},e),{value:r,markers:n.markers,fakeFocus:n.fakeFocus,onHighlight:n.onHighlight,focusManager:(n.fakeFocus?Ht:Nt)()}))}return r===o?{type:"prepared",menu:t.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))),i=hn(n.data.menus,(function(n){return D(n.items,(function(n){return"separator"===n.type?[]:[n.data.value]}))}));return v.setContents(n.data.primary,r,n.data.expansions,i),v.getPrimary()}function t(n){return Pd.getValue(n).value}function o(n,e){Gf.highlight(n,e),Gf.getHighlighted(e).orThunk((function(){return Gf.getFirst(e)})).each((function(e){L(n,e.element,Aa())}))}function r(n,e){return ve(x(e,(function(e){return n.lookupMenu(e).bind((function(n){return"prepared"===n.type?Yc.some(n.menu):Yc.none()}))})))}function i(e,t,o){w(r(t,t.otherMenus(o)),(function(t){Fi(t.element,[n.markers.backgroundMenu]),n.stayInDom||fg.remove(e,t)}))}function c(e,o){var r;pn((r=e,h.get().getOrThunk((function(){var e={};return w(S(gt(r.element,"."+n.markers.item),(function(n){return"true"===On(n,"aria-haspopup")})),(function(n){r.getSystem().getByDom(n).each((function(n){var o=t(n);e[o]=n}))})),h.set(e),e}))),(function(n,e){var t=b(o,e);wn(n.element,"aria-expanded",t)}))}function a(e,t,u){return Yc.from(u[0]).bind((function(c){return t.lookupMenu(c).bind((function(c){if("notbuilt"===c.type)return Yc.none();var a=c.menu;return w(r(t,u.slice(1)),(function(e){Mn(e.element,n.markers.backgroundMenu)})),us(a.element)||fg.append(e,Ym(a)),Fi(a.element,[n.markers.backgroundMenu]),o(e,a),i(e,t,u),Yc.some(a)}))}))}function f(e,o,r){if(void 0===r&&(r=g.HighlightSubmenu),o.hasConfigured(Am)&&Am.isDisabled(o))return Yc.some(o);var i=t(o);return v.expand(i).bind((function(t){return c(e,t),Yc.from(t[0]).bind((function(i){return v.lookupMenu(i).bind((function(u){var c=function(n,e,t){if("notbuilt"!==t.type)return t.menu;var o=n.getSystem().build(t.nbMenu());return v.setMenuBuilt(e,o),o}(e,i,u);return us(c.element)||fg.append(e,Ym(c)),n.onOpenSubmenu(e,o,c,_(t)),r===g.HighlightSubmenu?(Gf.highlightFirst(c),a(e,v,t)):(Gf.dehighlightAll(c),Yc.some(o))}))}))}))}function l(e,o){var r=t(o);return v.collapse(r).bind((function(t){return c(e,t),a(e,v,t).map((function(t){return n.onCollapseMenu(e,o,t),t}))}))}function d(e){return function(t,o){return wt(o.getSource(),"."+n.markers.item).bind((function(n){return t.getSystem().getByDom(n).toOptional().bind((function(n){return e(t,n).map(Wc)}))}))}}function m(n){return Gf.getHighlighted(n).bind(Gf.getHighlighted)}var g,p,h=Jt(),v=dg();(p=g={})[p.HighlightSubmenu=0]="HighlightSubmenu",p[p.HighlightParent=1]="HighlightParent";var y=$s([Se(cg(),(function(n,e){var o=e.event.item;v.lookupItem(t(o)).each((function(){var o=e.event.menu;Gf.highlight(n,o);var r=t(e.event.item);v.refresh(r).each((function(e){return i(n,v,e)}))}))})),Xs((function(e,o){var r=o.event.target;e.getSystem().getByDom(r).each((function(o){0===t(o).indexOf("collapse-item")&&l(e,o),f(e,o,g.HighlightSubmenu).fold((function(){n.onExecute(e,o)}),u)}))})),Gs((function(t){e(t).each((function(e){fg.append(t,Ym(e)),n.onOpenMenu(t,e),n.highlightImmediately&&o(t,e)}))}))].concat(n.navigateOnHover?[Se(Qm(),(function(e,o){var r=o.event.item,i=e,u=t(r);v.refresh(u).bind((function(n){return c(i,n),a(i,v,n)})),f(e,r,g.HighlightParent),n.onHover(e,r)}))]:[])),O={collapseMenu:function(n){m(n).each((function(e){l(n,e)}))},highlightPrimary:function(n){v.getPrimary().each((function(e){o(n,e)}))},repositionMenus:function(e){v.getPrimary().bind((function(n){return m(e).bind((function(n){var e=t(n),o=ve(x(vn(v.getMenus(),s),mg));return v.getTriggeringPath(e,(function(n){return e=n,I(o,(function(n){return n.getSystem().isConnected()?T(Gf.getCandidates(n),(function(n){return t(n)===e})):Yc.none()}));var e}))})).map((function(e){return{primary:n,triggeringPath:e}}))})).fold((function(){Yc.from(e.components()[0]).filter((function(n){return"menu"===On(n.element,"role")})).each((function(t){n.onRepositionMenu(e,t,[])}))}),(function(t){var o=t.primary,r=t.triggeringPath;n.onRepositionMenu(e,o,r)}))}};return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Io(n.tmenuBehaviours,[Pl.config({mode:"special",onRight:d((function(n,e){return Ut(e.element)?Yc.none():f(n,e,g.HighlightSubmenu)})),onLeft:d((function(n,e){return Ut(e.element)?Yc.none():l(n,e)})),onEscape:d((function(e,t){return l(e,t).orThunk((function(){return n.onEscape(e,t).map((function(){return e}))}))})),focusIn:function(n){v.getPrimary().each((function(e){L(n,e.element,Aa())}))}}),Gf.config({highlightClass:n.markers.selectedMenu,itemClass:n.markers.menu}),km.config({find:function(n){return Gf.getHighlighted(n)}}),fg.config({})]),eventOrder:n.eventOrder,apis:O,events:y}},extraApis:{tieredData:function(n,e,t){return{primary:n,menus:e,expansions:t}},singleData:function(n,e){return{primary:n,menus:ge(n,e),expansions:{}}},collapseItem:function(n){return{value:Bo(gg()),meta:{text:n}}}}}),hg=function(n,e,t,o){return $i(0,e,0,o).bind((function(n){return n.transition.map((function(e){return{transition:e,route:n}}))}))},vg=function(n,e){return kn(n.element,e.destinationAttr).map((function(t){return{start:On(n.element,e.stateAttr),destination:t}}))},bg=Object.freeze({__proto__:null,findRoute:$i,disableTransition:Gi,getCurrentRoute:vg,jumpTo:Ui,progressTo:function(n,e,t,o){var r,i=e;Tn((r=n).element,i.destinationAttr)&&(kn(r.element,i.destinationAttr).each((function(n){wn(r.element,i.stateAttr,n)})),Cn(r.element,i.destinationAttr));var u,c=(u=o,{start:On(n.element,e.stateAttr),destination:u});hg(n,e,t,c).fold((function(){Ui(n,e,t,o)}),(function(r){Gi(n,e,t);var i=r.transition;Mn(n.element,i.transitionClass),wn(n.element,e.destinationAttr,o)}))},getState:function(n,e){return kn(n.element,e.stateAttr)}}),yg=Object.freeze({__proto__:null,events:function(n,e){return $s([Se(Da(),(function(t,o){var r=o.event.raw;vg(t,n).each((function(o){$i(0,n,0,o).each((function(i){i.transition.each((function(i){r.propertyName===i.property&&(Ui(t,n,e,o.destination),n.onTransition(t,o))}))}))}))})),Gs((function(t){Ui(t,n,e,n.initialState)}))])}}),xg=Re({fields:[le("destinationAttr","data-transitioning-destination"),le("stateAttr","data-transitioning-state"),re("initialState"),je("onTransition"),je("onFinish"),ie("routes",Zn(bs.value,Zn(bs.value,Yn([fe("transition",[re("property"),re("transitionClass")])]))))],name:"transitioning",active:yg,apis:bg,extra:{createRoutes:function(n){var e={};return pn(n,(function(n,t){var o=t.split("<->");e[o[0]]=ge(o[1],n),e[o[1]]=ge(o[0],n)})),e},createBistate:function(n,e,t){return pe([{key:n,value:ge(e,t)},{key:e,value:ge(n,t)}])},createTristate:function(n,e,t,o){return pe([{key:n,value:pe([{key:e,value:o},{key:t,value:o}])},{key:e,value:pe([{key:n,value:o},{key:t,value:o}])},{key:t,value:pe([{key:n,value:o},{key:e,value:o}])}])}}}),wg=Ef("scrollable"),Sg=wg,Og=function(n,e,t,o,r){return{data:{value:n,text:e},type:"item",dom:{tag:"div",classes:r?[Ef("styles-item-is-menu")]:[]},toggling:{toggleOnExecute:!1,toggleClass:Ef("format-matches"),selected:t},itemBehaviours:Qs(r?[]:[Ze(n,(function(n,e){(e?Tf.on:Tf.off)(n)}))]),components:[{dom:{tag:"div",attributes:{style:o},innerHtml:e}}]}},kg=function(n,e,t,o){return{value:n,dom:{tag:"div"},components:[Sd.sketch({dom:{tag:"div",classes:[Ef("styles-collapser")]},components:o?[{dom:{tag:"span",classes:[Ef("styles-collapse-icon")]}},Ni(n)]:[Ni(n)],action:function(n){var e;o&&(e=t().get(n),pg.collapseMenu(e))}}),{dom:{tag:"div",classes:[Ef("styles-menu-items-container")]},components:[ag.parts.items({})],behaviours:Qs([vi("adhoc-scrollable-menu",[Gs((function(n){ut(n.element,"overflow-y","auto"),ut(n.element,"-webkit-overflow-scrolling","touch"),Wi(n.element)})),Us((function(n){ft(n.element,"overflow-y"),ft(n.element,"-webkit-overflow-scrolling"),Xi(n.element)}))])])}],items:e,menuBehaviours:Qs([xg.config({initialState:"after",routes:xg.createTristate("before","current","after",{transition:{property:"transform",transitionClass:"transitioning"}})})])}},Tg=function(n){return O(n,(function(n,e){var t=Yi(e);return{menus:Ds(n.menus,t.menus),items:[t.item].concat(n.items),expansions:Ds(n.expansions,t.expansions)}}),{menus:{},expansions:{},items:[]})},Cg=function(n){return D(n,(function(n){return(Pc(n)?Cg:Ji)(n)}))},Eg=function(n,e,t,o){n.dom.removeEventListener(e,t,o)},Dg=Wc,Mg=tinymce.util.Tools.resolve("tinymce.util.Delay"),_g=me([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]);_g.ltr,_g.rtl;var Rg,Fg,Ig,Vg,Bg=function(n,e,t,o){return{start:n,soffset:e,finish:t,foffset:o}},Ag=(Rg=Ka,{get:function(n){if(!Rg(n))throw new Error("Can only get text value of a text node");return Fg(n).getOr("")},getOption:Fg=function(n){return Rg(n)?Yc.from(n.dom.nodeValue):Yc.none()},set:function(n,e){if(!Rg(n))throw new Error("Can only set raw text value of a text node");n.dom.nodeValue=e}}),Ng=me([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Hg={before:Ng.before,on:Ng.on,after:Ng.after,cata:function(n,e,t,o){return n.fold(e,t,o)},getStart:function(n){return n.fold(s,s,s)}},Pg=me([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),zg={domRange:Pg.domRange,relative:Pg.relative,exact:Pg.exact,exactFromRange:function(n){return Pg.exact(n.start,n.soffset,n.finish,n.foffset)},getWin:function(n){var e=n.match({domRange:function(n){return Wa.fromDom(n.startContainer)},relative:function(n){return Hg.getStart(n)},exact:function(n){return n}});return Wa.fromDom(en(e).dom.defaultView)},range:Bg},jg=(Ig=xu,function(n){return n.getWin.getOrThunk((function(){var e=Su(n);return function(){return Ig(e)}}))()}),Lg="data-ephox-mobile-fullscreen-style",$g="position:absolute!important;",Gg="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",Ug=ga().os.isAndroid(),Wg=6<=ga().os.version.major,Xg="data-"+Ef("last-outer-height"),qg=a({unbind:u}),Yg=Fs([ue("editor",[re("getFrame"),ce("getBody"),ce("getDoc"),ce("getWin"),ce("getSelection"),ce("setSelection"),ce("clearSelection"),ce("cursorSaver"),ce("onKeyup"),ce("onNodeChanged"),ce("getCursorBox"),re("onDomChanged"),le("onTouchContent",u),le("onTapContent",u),le("onTouchToolstrip",u),le("onScrollToCursor",qg),le("onScrollToElement",qg),le("onToEditing",qg),le("onToReading",qg),le("onToolbarScrollStart",s)]),re("socket"),re("toolstrip"),re("dropup"),re("toolbar"),re("container"),re("alloy"),Ns("win",(function(n){return nn(n.socket).dom.defaultView})),Ns("body",(function(n){return Wa.fromDom(n.socket.dom.ownerDocument.body)})),le("translate",s),le("setReadOnly",u),le("readOnlyOnInit",Wc)]),Kg=a([re("dom"),le("shell",!0),Fo("toolbarBehaviours",[fg])]),Jg=a([ad({name:"groups",overrides:function(){return{behaviours:Qs([fg.config({})])}}})]),Qg=Ko({name:"Toolbar",configFields:Kg(),partFields:Jg(),factory:function(n,e){var t=n.shell?{behaviours:[fg.config({})],components:[]}:{behaviours:[],components:e};return{uid:n.uid,dom:n.dom,components:t.components,behaviours:Io(n.toolbarBehaviours,t.behaviours),apis:{setGroups:function(e,t){var o;o=e,(n.shell?Yc.some(o):jo(o,n,"groups")).fold((function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(n){fg.set(n,t)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,e,t){n.setGroups(e,t)}}}),Zg=a([re("items"),ue("markers",x(["itemSelector"],re)),Fo("tgroupBehaviours",[Pl])]),np=a([sd({name:"items",unit:"item"})]),ep=Ko({name:"ToolbarGroup",configFields:Zg(),partFields:np(),factory:function(n,e){return{uid:n.uid,dom:n.dom,components:e,behaviours:Io(n.tgroupBehaviours,[Pl.config({mode:"flow",selector:n.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),tp="data-"+Ef("horizontal-scroll"),op=Object.freeze({__proto__:null,refresh:function(n,e,t){var o;t.isExpanded()&&(ft(n.element,Xu(e)),o=qu(e,n.element),ut(n.element,Xu(e),o))},grow:function(n,e,t){t.isExpanded()||nc(n,e,t)},shrink:function(n,e,t){t.isExpanded()&&Zu(n,e,t)},immediateShrink:function(n,e,t){t.isExpanded()&&Qu(n,e,t)},hasGrown:function(n,e,t){return t.isExpanded()},hasShrunk:function(n,e,t){return t.isCollapsed()},isGrowing:ec,isShrinking:tc,isTransitioning:function(n,e){return ec(n,e)||tc(n,e)},toggleGrow:function(n,e,t){(t.isExpanded()?Zu:nc)(n,e,t)},disableTransitions:Yu}),rp=Object.freeze({__proto__:null,exhibit:function(n,e){return De(e.expanded?{classes:[e.openClass],styles:{}}:{classes:[e.closedClass],styles:ge(e.dimension.property,"0px")})},events:function(n,e){return $s([ke(Da())((function(t,o){o.event.raw.propertyName===n.dimension.property&&(Yu(t,n),e.isExpanded()&&ft(t.element,n.dimension.property),(e.isExpanded()?n.onGrown:n.onShrunk)(t))}))])}}),ip=Re({fields:[re("closedClass"),re("openClass"),re("shrinkingClass"),re("growingClass"),ce("getAnimationRoot"),je("onShrunk"),je("onStartShrink"),je("onGrown"),je("onStartGrow"),le("expanded",!1),ie("dimension",oe("property",{width:[Ue("property","width"),Ue("getDimension",(function(n){return sr(n)+"px"}))],height:[Ue("property","height"),Ue("getDimension",(function(n){return mt(n)+"px"}))]}))],name:"sliding",active:rp,apis:op,state:Object.freeze({__proto__:null,init:function(n){var e=Fe(n.expanded);return Js({isExpanded:function(){return!0===e.get()},isCollapsed:function(){return!1===e.get()},setCollapsed:l(e.set,!1),setExpanded:l(e.set,!0),readState:function(){return"expanded: "+e.get()}})}})}),up=me([{stopped:[]},{resume:["element"]},{complete:[]}]),cp=function(n,e,t,o,r,i){return cc(n,e,t,o,r,i).fold(Wc,(function(o){return cp(n,e,t,o,r,i)}),Uc)},ap=function(n){function e(e){return tn(n.element).fold(Wc,(function(n){return X(e,n)}))}function t(n,t){return r.find(e,n,t)}function o(n){w(r.filter(Va()),(function(e){Di(e.descHandler)(n)}))}var r=sc(),i=ic(n.element,{triggerEvent:function(n,e){return Pe(n,e.target,(function(o){return fc(t,n,e,e.target,o)}))}}),c={debugInfo:a("real"),triggerEvent:function(n,e,o){Pe(n,e,(function(r){return fc(t,n,o,e,r)}))},triggerFocus:function(n,e){Wo(n).fold((function(){Ie(n)}),(function(){Pe(Ra(),n,(function(o){var r,i,c=t,a=Ra(),s=o,f=uc(r={originator:e,kill:u,prevent:u,target:n},i=n);return cc(c,a,r,i,f,s),!1}))}))},triggerEscape:function(n,e){c.triggerEvent("keydown",n.element,e.event)},getByUid:function(n){return v(n)},getByDom:function(n){return b(n)},build:qm,addToGui:function(n){l(n)},removeFromGui:function(n){d(n)},addToWorld:function(n){s(n)},removeFromWorld:function(n){f(n)},broadcast:function(n){g(n)},broadcastOn:function(n,e){p(n,e)},broadcastEvent:function(n,e){h(n,e)},isConnected:Wc},s=function(n){n.connect(c),Ka(n.element)||(r.register(n),w(n.components(),s),c.triggerEvent(Pa(),n.element,{target:n.element}))},f=function(n){Ka(n.element)||(w(n.components(),f),r.unregister(n)),n.disconnect()},l=function(e){fs(n,e,ns)},d=function(n){gn(n)},g=function(n){o({universal:!0,data:n})},p=function(n,e){o({universal:!1,channels:n,data:e})},h=function(n,e){var t,o,i=r.filter(n);return o={stop:function(){t.set(!0)},cut:u,isStopped:(t=Fe(!1)).get,isCut:Uc,event:e,setSource:m("Cannot set source of a broadcasted event"),getSource:m("Cannot get source of a broadcasted event")},w(i,(function(n){Di(n.descHandler)(o)})),o.isStopped()},v=function(n){return r.getById(n).fold((function(){return bs.error(new Error('Could not find component with uid: "'+n+'" in system.'))}),bs.value)},b=function(n){var e=Wo(n).getOr("not found");return v(e)};return s(n),{root:n,element:n.element,destroy:function(){i.unbind(),es(n.element)},add:l,remove:d,getByUid:v,getByDom:b,addToWorld:s,removeFromWorld:f,broadcast:g,broadcastOn:p,broadcastEvent:h}},sp=Ef("readonly-mode"),fp=Ef("edit-mode"),lp=function(n){function e(n){r()?i(n):o.push(n)}var t=Yc.none(),o=[],r=function(){return t.isSome()},i=function(n){t.each((function(e){setTimeout((function(){n(e)}),0)}))};return n((function(n){r()||(t=Yc.some(n),w(o,i),o=[])})),{get:e,map:function(n){return lp((function(t){e((function(e){t(n(e))}))}))},isReady:r}},dp={nu:lp,pure:function(n){return lp((function(e){e(n)}))}},mp=function(n){function e(e){n().then(e,hc)}return{map:function(e){return mp((function(){return n().then(e)}))},bind:function(e){return mp((function(){return n().then((function(n){return e(n).toPromise()}))}))},anonBind:function(e){return mp((function(){return n().then((function(){return e.toPromise()}))}))},toLazy:function(){return dp.nu(e)},toCached:function(){var e=null;return mp((function(){return e=null===e?n():e}))},toPromise:n,get:e}},gp=function(n){return mp((function(){return new xm(n)}))},pp=function(n){return mp((function(){return xm.resolve(n)}))},hp=me([{fixed:["element","property","offsetY"]},{scroller:["element","offsetY"]}]),vp="data-"+Ef("position-y-fixed"),bp="data-"+Ef("y-property"),yp="data-"+Ef("scrolling"),xp="data-"+Ef("last-window-height"),wp=(Vg=null,{animate:function(n,e,t,o,r,i){function u(n){a=!0,r(n)}function c(n){Mg.clearInterval(Vg),u(n)}var a=!1;Mg.clearInterval(Vg),Vg=Mg.setInterval((function(){var r=n(),i=r,s=e,f=t;(Math.abs(i-s)<=f?Yc.none():i<s?Yc.some(i+f):Yc.some(i-f)).fold((function(){Mg.clearInterval(Vg),u(e)}),(function(t){var i;o(t,c),a||((i=n())!==t||Math.abs(i-e)>Math.abs(r-e))&&(Mg.clearInterval(Vg),u(e))}))}),i)}}),Sp="data-"+Ef("last-scroll-top"),Op=tinymce.util.Tools.resolve("tinymce.EditorManager"),kp="toReading",Tp="toEditing";rf.add("mobile",(function(n){return{getNotificationManagerImpl:function(){return{open:a({progressBar:{value:u},close:u,text:u,getEl:a(null),moveTo:u,moveRel:u,settings:{}}),close:u,reposition:u,getArgs:a({})}},renderUI:function(){function e(){n.fire("ScrollIntoView")}function t(e,t,o,r){!1===r&&n.selection.collapse();var i,u,c,a=(i=t,u=o,{readOnly:(c=e.get()).backToMask.concat(i.get()),main:c.backToMask.concat(u.get())});C.setToolbarGroups(!0===r?a.readOnly:a.main),n.setMode(!0===r?"readonly":"design"),n.fire(!0===r?kp:Tp),C.updateMode(r)}function o(e,t){return n.on(e,t),{unbind:function(){n.off(e)}}}var r,i,c=n.getElement(),a={content:(r=Yc.from(n.getParam("skin_url")).getOrThunk((function(){return Op.baseURL+"/skins/ui/oxide"})))+"/content.mobile.min.css",ui:r+"/skin.mobile.min.css"};!1===n.getParam("skin")==0?(i=of.DOM.styleSheetLoader,n.contentCSS.push(a.content),i.load(a.ui,Vc(n)),n.on("remove",(function(){return i.unload(a.ui)}))):Vc(n)();var s,f,l,d,m,g,p,h,v,b,y,x,S,O,k,T,C=ga().os.isAndroid()?(s=e,f=lc({classes:[Ef("android-container")]}),l=Lu(),d=Kt(),m=$u(d),g=Gu(),p=oc(u,s),f.add(l.wrapper),f.add(g),f.add(p.component),{system:f,element:f.element,init:function(n){d.set(zu(n))},exit:function(){d.run((function(n){n.exit(),fg.remove(g,m)}))},setToolbarGroups:function(n){var e=l.createGroups(n);l.setGroups(e)},setContextToolbar:function(n){var e=l.createGroups(n);l.setContextToolbar(e)},focusToolbar:function(){l.focus()},restoreToolbar:function(){l.restoreToolbar()},updateMode:function(n){Uu(g,m,n,f.root)},socket:g,dropup:p}):(v=e,b=lc({classes:[Ef("ios-container")]}),y=Lu(),x=Kt(),S=$u(x),O=Gu(),k=oc((function(){x.run((function(n){n.refreshStructure()}))}),v),b.add(y.wrapper),b.add(O),b.add(k.component),{system:b,element:b.element,init:function(n){x.set(function(){var e=te("Getting IosWebapp schema",Yg,n);ut(e.toolstrip,"width","100%"),ut(e.container,"position","relative");var t=qm(Pu((function(){e.setReadOnly(e.readOnlyOnInit()),r.enter()}),e.translate));e.alloy.add(t);var o={show:function(){e.alloy.add(t)},hide:function(){e.alloy.remove(t)}},r=Fc(e,o);return{setReadOnly:e.setReadOnly,refreshStructure:r.refreshStructure,enter:r.enter,exit:r.exit,destroy:u}}())},exit:function(){x.run((function(n){fg.remove(O,S),n.exit()}))},setToolbarGroups:function(n){var e=y.createGroups(n);y.setGroups(e)},setContextToolbar:function(n){var e=y.createGroups(n);y.setContextToolbar(e)},focusToolbar:function(){y.focus()},restoreToolbar:function(){y.restoreToolbar()},updateMode:function(n){Uu(O,S,n,b.root)},socket:O,dropup:k}),E=Wa.fromDom(c);h=C.system,un(E,(T=h).element),w(Za(T.element),(function(n){T.getByDom(n).each(ss)}));var M=c.ownerDocument.defaultView,_=ru(M,{onChange:function(){var n,e,t;C.system.broadcastOn([sf],{width:(n=M,e=ga().os.isiOS(),t=ou(n).isPortrait(),e&&!t?n.screen.height:n.screen.width)})},onReady:u});return n.on("init",(function(){C.init({editor:{getFrame:function(){return Wa.fromDom(n.contentAreaContainer.querySelector("iframe"))},onDomChanged:function(){return{unbind:u}},onToReading:function(n){return o(kp,n)},onToEditing:function(n){return o(Tp,n)},onScrollToCursor:function(e){return n.on("ScrollIntoView",(function(n){e(n)})),{unbind:function(){n.off("ScrollIntoView"),_.destroy()}}},onTouchToolstrip:function(){s()},onTouchContent:function(){Ae(Wa.fromDom(n.editorContainer.querySelector("."+Ef("toolbar")))).bind((function(n){return C.system.getByDom(n).toOptional()})).each(j),C.restoreToolbar(),s()},onTapContent:function(e){var t=e.target;"img"===Q(t)?(n.selection.select(t.dom),e.kill()):"a"===Q(t)&&C.system.getByDom(Wa.fromDom(n.editorContainer)).each((function(n){tf.isAlpha(n)&&function(n){var e=document.createElement("a");e.target="_blank",e.href=n.href,e.rel="noreferrer noopener";var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),document.body.appendChild(e),e.dispatchEvent(t),document.body.removeChild(e)}(t.dom)}))}},container:Wa.fromDom(n.editorContainer),socket:Wa.fromDom(n.contentAreaContainer),toolstrip:Wa.fromDom(n.editorContainer.querySelector("."+Ef("toolstrip"))),toolbar:Wa.fromDom(n.editorContainer.querySelector("."+Ef("toolbar"))),dropup:C.dropup,alloy:C.system,translate:u,setReadOnly:function(n){t(h,p,g,n)},readOnlyOnInit:function(){return!1}});var e,r,i,c,a,s=function(){C.dropup.disappear((function(){C.system.broadcastOn([ff],{})}))},f={label:"The first group",scrollable:!1,items:[kd("back",(function(){n.selection.collapse(),C.exit()}),{},n)]},l={label:"Back to read only",scrollable:!1,items:[kd("readonly-back",(function(){t(h,p,g,!0)}),{},n)]},d=Qi(C,n),m={label:"The extra group",scrollable:!1,items:[]},g=Fe([{label:"the action group",scrollable:!0,items:(e=d,a=n.getParam("toolbar",cf,"array"),r=(Pc(a)?Cg:Ji)(a),i={},D(r,(function(n){var t=!yn(i,n)&&yn(e,n)&&e[n].isSupported()?[e[n].sketch()]:[];return i[n]=!0,t})))},m]),p=Fe([{label:"The read only mode group",scrollable:!0,items:[]},m]),h=Fe({backToMask:[f],backToReadOnly:[l]}),v=C;w(ls((c=n).formatter.get()),(function(n){c.formatter.formatChanged(n,(function(e){Ic(v,n,e)}))})),w(["ul","ol"],(function(n){c.selection.selectorChanged(n,(function(e){Ic(v,n,e)}))}))})),n.on("remove",(function(){C.exit()})),n.on("detach",(function(){var n=C.system;w(Za(n.element),(function(e){n.getByDom(e).each(as)})),es(n.element),C.system.destroy()})),{iframeContainer:C.socket.element.dom,editorContainer:C.element.dom}}}}))}();