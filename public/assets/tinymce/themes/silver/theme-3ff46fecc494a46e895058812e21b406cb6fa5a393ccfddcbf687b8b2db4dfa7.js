!function(){"use strict";function t(t){return function(n){return o=typeof(e=n),(null===e?"null":"object"==o&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==o&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":o)===t;var e,o}}function n(t){return function(n){return typeof n===t}}function e(t){return function(n){return t===n}}function o(t){return null==t}function r(t,n){if(sh(t)){for(var e=0,o=t.length;e<o;++e)if(!n(t[e]))return;return 1}}function i(){}function u(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t(n.apply(null,e))}}function a(t){return function(){return t}}function c(t){return t}function s(t,n){return t===n}function l(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=n.concat(e);return t.apply(null,r)}}function f(t){return function(n){return!t(n)}}function d(t){return function(){throw new Error(t)}}function m(t,n){var e={};for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(e[r[o]]=t[r[o]]);return e}function g(t,n,e){if(e||2===arguments.length)for(var o,r=0,i=n.length;r<i;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))}function p(){return xh}function h(t){return t()}function v(t,n){return Ch.call(t,n)}function b(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return!0;return!1}function y(t,n){for(var e=[],o=0;o<t;o++)e.push(n(o));return e}function x(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=kh.call(t,o,o+n);e.push(r)}return e}function w(t,n){for(var e=t.length,o=new Array(e),r=0;r<e;r++){var i=t[r];o[r]=n(i,r)}return o}function S(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r];(n(u,r)?e:o).push(u)}return{pass:e,fail:o}}function k(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o];n(i,o)&&e.push(i)}return e}function C(t,n,e){return function(t){for(var o,r=t.length-1;0<=r;r--)o=t[r],e=n(e,o,r)}(t),e}function O(t,n,e){return Th(t,(function(t,o){e=n(e,t,o)})),e}function _(t,n){return function(t,n,e){for(var o=0,r=t.length;o<r;o++){var i=t[o];if(n(i,o))return Sh.some(i);if(e(i,o))break}return Sh.none()}(t,n,hh)}function T(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return Sh.some(e);return Sh.none()}function E(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!sh(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);Oh.apply(n,t[e])}return n}function D(t,n){return E(w(t,n))}function B(t,n){for(var e=0,o=t.length;e<o;++e)if(!0!==n(t[e],e))return!1;return!0}function M(t){var n=kh.call(t,0);return n.reverse(),n}function A(t,n){return k(t,(function(t){return!_h(n,t)}))}function F(t,n){for(var e={},o=0,r=t.length;o<r;o++){var i=t[o];e[String(i)]=n(i,o)}return e}function I(t){return[t]}function R(t,n){var e=kh.call(t,0);return e.sort(n),e}function V(t,n){return 0<=n&&n<t.length?Sh.some(t[n]):Sh.none()}function P(t){return V(t,0)}function H(t){return V(t,t.length-1)}function z(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e);if(o.isSome())return o}return Sh.none()}function N(t,n){for(var e=Dh(t),o=0,r=e.length;o<r;o++){var i=e[o];n(t[i],i)}}function L(t,n){return Mh(t,(function(t,e){return{k:e,v:n(t,e)}}))}function W(t,n){var e=[];return N(t,(function(t,o){e.push(n(t,o))})),e}function U(t,n){for(var e=Dh(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i];if(n(u,i,t))return Sh.some(u)}return Sh.none()}function j(t){return W(t,c)}function G(t,n){return Ah(t,n)?Sh.from(t[n]):Sh.none()}function X(t,n){return Ah(t,n)&&void 0!==t[n]&&null!==t[n]}function Y(t,n,e){return void 0===e&&(e=s),t.exists((function(t){return e(t,n)}))}function q(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e);return n}function K(t,n){return t?Sh.some(n):Sh.none()}function J(t,n,e){return""===n||t.length>=n.length&&t.substr(e,e+n.length)===n}function $(t,n){return-1!==t.indexOf(n)}function Q(t){return 0<t.length}function Z(t){return void 0!==t.style&&gh(t.style.getPropertyValue)}function tt(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:t}}function nt(t){return t.dom.nodeName.toLowerCase()}function et(t){return function(n){return n.dom.nodeType===t}}function ot(t){var n,e=!1;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return e||(e=!0,n=t.apply(null,o)),n}}function rt(t,n){var e=String(n).toLowerCase();return _(t,(function(t){return t.search(e)}))}function it(t){return function(n){return $(n,t)}}function ut(t){return window.matchMedia(t).matches}function at(t,n){var e=t.dom;if(1!==e.nodeType)return!1;var o=e;if(void 0!==o.matches)return o.matches(n);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(n);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(n);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")}function ct(t){return 1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount}function st(t,n){return t.dom===n.dom}function lt(t,n){return rv().browser.isIE()?(e=t.dom,o=n.dom,r=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(e.compareDocumentPosition(o)&r)):(i=t.dom)!==(u=n.dom)&&i.contains(u);var e,o,r,i,u}function ft(t){return Ph.fromDom(t.dom.ownerDocument)}function dt(t){return Wh(t)?t:ft(t)}function mt(t){return Ph.fromDom(dt(t).dom.documentElement)}function gt(t){return Ph.fromDom(dt(t).dom.defaultView)}function pt(t){return Sh.from(t.dom.parentNode).map(Ph.fromDom)}function ht(t){return Sh.from(t.dom.offsetParent).map(Ph.fromDom)}function vt(t){return w(t.dom.childNodes,Ph.fromDom)}function bt(t,n){var e=t.dom.childNodes;return Sh.from(e[n]).map(Ph.fromDom)}function yt(t,n){return{element:t,offset:n}}function xt(t,n){var e=vt(t);return 0<e.length&&n<e.length?yt(e[n],0):yt(t,n)}function wt(t){return Uh(t)&&mh(t.dom.host)}function St(t){return wt(t)?t:Ph.fromDom(dt(t).dom.body)}function kt(t){return Ph.fromDom(t.dom.host)}function Ct(t,n,e){if(!(ah(e)||fh(e)||ph(e)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,e+"")}function Ot(t,n,e){Ct(t.dom,n,e)}function _t(t,n){var e=t.dom;N(n,(function(t,n){Ct(e,n,t)}))}function Tt(t,n){var e=t.dom.getAttribute(n);return null===e?void 0:e}function Et(t,n){return Sh.from(Tt(t,n))}function Dt(t,n){var e=t.dom;return!(!e||!e.hasAttribute)&&e.hasAttribute(n)}function Bt(t,n){t.dom.removeAttribute(n)}function Mt(t,n,e){if(!ah(e))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e);Z(t)&&t.style.setProperty(n,e)}function At(t,n){Z(t)&&t.style.removeProperty(n)}function Ft(t,n,e){Mt(t.dom,n,e)}function It(t,n){var e=t.dom;N(n,(function(t,n){Mt(e,n,t)}))}function Rt(t,n){var e=t.dom;N(n,(function(t,n){t.fold((function(){At(e,n)}),(function(t){Mt(e,n,t)}))}))}function Vt(t,n){var e=t.dom,o=window.getComputedStyle(e).getPropertyValue(n);return""!==o||fv(t)?o:gv(e,n)}function Pt(t,n){var e=t.dom,o=gv(e,n);return Sh.from(o).filter((function(t){return 0<t.length}))}function Ht(t,n,e){var o=Ph.fromTag(t);return Ft(o,n,e),Pt(o,n).isSome()}function zt(t,n){At(t.dom,n),Y(Et(t,"style").map(Vh),"")&&Bt(t,"style")}function Nt(t){return t.dom.offsetWidth}function Lt(t,n){function e(e){var o=n(e);if(o<=0||null===o){var r=Vt(e,t);return parseFloat(r)||0}return o}function o(t,n){return O(n,(function(n,e){var o=Vt(t,e),r=void 0===o?0:parseInt(o,10);return isNaN(r)?n:n+r}),0)}return{set:function(n,e){if(!ph(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);var o=n.dom;Z(o)&&(o.style[t]=e+"px")},get:e,getOuter:e,aggregate:o,max:function(t,n,e){var r=o(t,e);return r<n?n-r:0}}}function Wt(t){return pv.get(t)}function Ut(t){return pv.getOuter(t)}function jt(t,n){return void 0!==t?t:void 0!==n?n:0}function Gt(t){var n=t.dom.ownerDocument,e=n.body,o=n.defaultView,r=n.documentElement;if(e===t.dom)return vv(e.offsetLeft,e.offsetTop);var i=jt(null==o?void 0:o.pageYOffset,r.scrollTop),u=jt(null==o?void 0:o.pageXOffset,r.scrollLeft),a=jt(r.clientTop,e.clientTop),c=jt(r.clientLeft,e.clientLeft);return bv(t).translate(u-c,i-a)}function Xt(t){return yv.get(t)}function Yt(t){return yv.getOuter(t)}function qt(t){function n(){return t.stopPropagation()}function e(){return t.preventDefault()}var o=u(e,n);return{target:Ph.fromDom(function(t){if(av()&&mh(t.target)){var n=Ph.fromDom(t.target);if(Nh(n)&&lv(n)&&t.composed&&t.composedPath){var e=t.composedPath();if(e)return P(e)}}return Sh.from(t.target)}(t).getOr(t.target)),x:t.clientX,y:t.clientY,stop:n,prevent:e,kill:o,raw:t}}function Kt(t,n,e,o,r){var i,u,a=(i=e,u=o,function(t){i(t)&&u(qt(t))});return t.dom.addEventListener(n,a,r),{unbind:l(xv,t,n,a,r)}}function Jt(t,n){pt(t).each((function(e){e.dom.insertBefore(n.dom,t.dom)}))}function $t(t,n){Sh.from(t.dom.nextSibling).map(Ph.fromDom).fold((function(){pt(t).each((function(t){wv(t,n)}))}),(function(t){Jt(t,n)}))}function Qt(t,n){bt(t,0).fold((function(){wv(t,n)}),(function(e){t.dom.insertBefore(n.dom,e.dom)}))}function Zt(t,n){Th(n,(function(n){wv(t,n)}))}function tn(t){t.dom.textContent="",Th(vt(t),(function(t){Sv(t)}))}function nn(t){var n,e=vt(t);0<e.length&&(n=t,Th(e,(function(t){Jt(n,t)}))),Sv(t)}function en(t){var n=void 0!==t?t.dom:document,e=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop;return vv(e,o)}function on(t,n,e){var o=(void 0!==e?e.dom:document).defaultView;o&&o.scrollTo(t,n)}function rn(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}}function un(t){var n=void 0===t?window:t,e=n.document,o=en(Ph.fromDom(e)),r=void 0===n?window:n;return(rv().browser.isFirefox()?Sh.none():Sh.from(r.visualViewport)).fold((function(){var t=n.document.documentElement,e=t.clientWidth,r=t.clientHeight;return rn(o.left,o.top,e,r)}),(function(t){return rn(Math.max(t.pageLeft,o.left),Math.max(t.pageTop,o.top),t.width,t.height)}))}function an(t){var n,e=en(Ph.fromDom(document)),o=(n=Cv).owner(t),r=kv(n,o);return Sh.some(r).fold(l(Gt,t),(function(n){var o=bv(t),r=C(n,(function(t,n){var e=bv(n);return{left:t.left+e.left,top:t.top+e.top}}),{left:0,top:0});return vv(r.left+o.left+e.left,r.top+o.top+e.top)}))}function cn(t){var n=an(t),e=Yt(t),o=Ut(t);return Ov(n.left,n.top,e,o)}function sn(){return jh(0,0)}function ln(t){function n(t){return function(){return e===t}}var e=t.current,o=t.version;return{current:e,version:o,isEdge:n("Edge"),isChrome:n("Chrome"),isIE:n("IE"),isOpera:n("Opera"),isFirefox:n(qh),isSafari:n("Safari")}}function fn(t){function n(t){return function(){return e===t}}var e=t.current,o=t.version;return{current:e,version:o,isWindows:n($h),isiOS:n("iOS"),isAndroid:n(Qh),isOSX:n("OSX"),isLinux:n("Linux"),isSolaris:n(Zh),isFreeBSD:n(tv),isChromeOS:n(nv)}}function dn(t,n,e){return t.stype===Hh.Error?n(t.serror):e(t.svalue)}function mn(t){return{stype:Hh.Value,svalue:t}}function gn(t){return{stype:Hh.Error,serror:t}}function pn(t,n,e,o){return{tag:"field",key:t,newKey:n,presence:e,prop:o}}function hn(t,n,e){switch(t.tag){case"field":return n(t.key,t.newKey,t.presence,t.prop);case"custom":return e(t.newKey,t.instantiator)}}function vn(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var o={},r=0;r<n.length;r++){var i,u=n[r];for(i in u)Ah(u,i)&&(o[i]=t(o[i],u[i]))}return o}}function bn(){return{tag:"required",process:{}}}function yn(t){return{tag:"defaultedThunk",process:t}}function xn(t){return yn(a(t))}function wn(){return{tag:"option",process:{}}}function Sn(t){return{tag:"mergeWithThunk",process:t}}function kn(t){return ch(t)&&100<Dh(t).length?" removed due to size":JSON.stringify(t,null,2)}function Cn(t,n){return Fv([{path:t,getErrorInfo:n}])}function On(t){return{extract:function(n,e){return Rv(t(e),(function(t){return Cn(n,a(t))}))},toString:a("val")}}function _n(t,n,e,o){return o(G(t,n).getOrThunk((function(){return e(t)})))}function Tn(t,n,e,o,r){function i(t){return r.extract(n.concat([o]),t)}function u(t){return t.fold((function(){return Av(Sh.none())}),(function(t){var e=r.extract(n.concat([o]),t);return Vv(e,Sh.some)}))}var c,s,l,f,d,m;switch(t.tag){case"required":return l=n,m=i,G(f=e,d=o).fold((function(){return t=d,n=f,Cn(l,(function(){return'Could not find valid *required* value for "'+t+'" in '+kn(n)}));var t,n}),m);case"defaultedThunk":return _n(e,o,t.process,i);case"option":return u(G(e,o));case"defaultedOptionThunk":return s=t.process,u(G(c=e,o).map((function(t){return!0===t?s(c):t})));case"mergeWithThunk":return _n(e,o,a({}),(function(n){return i(zv(t.process(e),n))}))}}function En(t){return{extract:function(n,e){return t().extract(n,e)},toString:function(){return t().toString()}}}function Dn(t){var n=Uv(t),e=C(t,(function(t,n){return hn(n,(function(n){var e;return zv(t,((e={})[n]=!0,e))}),a(t))}),{});return{extract:function(t,o){var r,u,a,c,s,l,f=k(fh(o)?[]:Dh((a=mh,c=u={},s=function(t,n){c[n]=t},l=i,N(o,(function(t,n){(a(t,n)?s:l)(t,n)})),u)),(function(t){return!X(e,t)}));return 0===f.length?n.extract(t,o):(r=f,Cn(t,(function(){return"There are unsupported fields: ["+r.join(", ")+"] specified"})))},toString:n.toString}}function Bn(t){return{extract:function(n,e){var o=w(e,(function(e,o){return t.extract(n.concat(["["+o+"]"]),e)}));return Lv(o)},toString:function(){return"array("+t.toString()+")"}}}function Mn(t){return{extract:function(n,e){for(var o=[],r=0,i=t;r<i.length;r++){var u=i[r].extract(n,e);if(u.stype===Hh.Value)return u;o.push(u)}return Lv(o)},toString:function(){return"oneOf("+w(t,(function(t){return t.toString()})).join(", ")+")"}}}function An(t,n){return On((function(e){var o=typeof e;return t(e)?Av(e):Fv("Expected type: "+n+" but got: "+o)}))}function Fn(t,n){return{extract:function(e,o){return G(o,t).fold((function(){return n=t,Cn(e,(function(){return'Choice schema did not contain choice key: "'+n+'"'}));var n}),(function(t){return r=e,i=o,G(u=n,a=t).fold((function(){return t=u,n=a,Cn(r,(function(){return'The chosen schema: "'+n+'" did not exist in branches: '+kn(t)}));var t,n}),(function(t){return t.extract(r.concat(["branch: "+a]),i)}));var r,i,u,a}))},toString:function(){return"chooseOn("+t+"). Possible values: "+Dh(n)}}}function In(t){return On((function(n){return t(n).fold(Fv,Av)}))}function Rn(t,n){return e=function(n){return t(n).fold(gn,mn)},o=n,{extract:function(t,n){var r=Dh(n),i=Bn(On(e)).extract(t,r);return Iv(i,(function(e){var r=w(e,(function(t){return pn(t,t,bn(),o)}));return Uv(r).extract(t,n)}))},toString:function(){return"setOf("+o.toString()+")"}};var e,o}function Vn(t,n,e){return Mv((r=n.extract([t],o=e),Pv(r,(function(t){return{input:o,errors:t}}))));var o,r}function Pn(t){return t.fold((function(t){throw new Error(Qv(t))}),c)}function Hn(t,n,e){return Pn(Vn(t,n,e))}function zn(t,n){return Fn(t,L(n,Uv))}function Nn(t){return In((function(n){return _h(t,n)?Bv.value(n):Bv.error('Unsupported value: "'+n+'", choose one of "'+t.join(", ")+'".')}))}function Ln(t){return Zv(t,t,bn(),Gv())}function Wn(t,n){return Zv(t,t,bn(),n)}function Un(t){return Wn(t,Yv)}function jn(t,n){return Zv(t,t,bn(),Nn(n))}function Gn(t){return Wn(t,Kv)}function Xn(t,n){return Zv(t,t,bn(),Uv(n))}function Yn(t,n){return Zv(t,t,bn(),jv(n))}function qn(t,n){return Zv(t,t,bn(),Bn(n))}function Kn(t){return Zv(t,t,wn(),Gv())}function Jn(t,n){return Zv(t,t,wn(),n)}function $n(t){return Jn(t,Xv)}function Qn(t){return Jn(t,Yv)}function Zn(t){return Jn(t,Kv)}function te(t,n){return Jn(t,Bn(n))}function ne(t,n){return Jn(t,Uv(n))}function ee(t,n){return Zv(t,t,xn(n),Gv())}function oe(t,n,e){return Zv(t,t,xn(n),e)}function re(t,n){return oe(t,n,Xv)}function ie(t,n){return oe(t,n,Yv)}function ue(t,n,e){return oe(t,n,Nn(e))}function ae(t,n){return oe(t,n,qv)}function ce(t,n){return oe(t,n,Kv)}function se(t,n,e){return oe(t,n,Bn(e))}function le(t,n,e){return oe(t,n,Uv(e))}function fe(t){var n=t;return{get:function(){return n},set:function(t){n=t}}}function de(t){if(!sh(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var n=[],e={};return Th(t,(function(o,r){var i=Dh(o);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],a=o[u];if(void 0!==e[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!sh(a))throw new Error("case arguments must be an array");n.push(u),e[u]=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var i=e.length;if(i!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+i);return{fold:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(n.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+n.length);return n[r].apply(null,e)},match:function(t){var o=Dh(t);if(n.length!==o.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+o.join(","));if(!B(n,(function(t){return _h(o,t)})))throw new Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+n.join(", "));return t[u].apply(null,e)},log:function(t){console.log(t,{constructors:n,constructor:u,params:e})}}}})),e}function me(t,n){return(e={})[t]=n,e;var e}function ge(t){return n={},Th(t,(function(t){n[t.key]=t.value})),n;var n}function pe(t){return gh(t)?t:hh}function he(t,n,e){for(var o=t.dom,r=pe(e);o.parentNode;){o=o.parentNode;var i=Ph.fromDom(o),u=n(i);if(u.isSome())return u;if(r(i))break}return Sh.none()}function ve(t,n,e){var o=n(t),r=pe(e);return o.orThunk((function(){return r(t)?Sh.none():he(t,n,r)}))}function be(t,n){return st(t.element,n.event.target)}function ye(t){if(!X(t,"can")&&!X(t,"abort")&&!X(t,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!");return yh(yh({},ib),t)}function xe(t){return a("alloy."+t)}function we(t,n){Zb(t,t.element,n,{})}function Se(t,n,e){Zb(t,t.element,n,e)}function ke(t){we(t,Ab())}function Ce(t,n,e){Zb(t,n,e,{})}function Oe(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event)}function _e(t,n){return{key:t,value:ye({abort:n})}}function Te(t){return{key:t,value:ye({run:function(t,n){n.event.prevent()}})}}function Ee(t,n){return{key:t,value:ye({run:n})}}function De(t,n,e){return{key:t,value:ye({run:function(t,o){n.apply(void 0,[t,o].concat(e))}})}}function Be(t){return function(n){return{key:t,value:ye({run:function(t,e){be(t,e)&&n(t,e)}})}}}function Me(t,n,e){var o,r=n.partUids[e];return Ee(o=t,(function(t,n){t.getSystem().getByUid(r).each((function(t){Oe(t,t.element,o,n)}))}))}function Ae(t,n){return Ee(t,(function(t,e){var o=e.event,r=t.getSystem().getByDom(o.target).getOrThunk((function(){return ve(o.target,(function(n){return t.getSystem().getByDom(n).toOptional()}),hh).getOr(t)}));n(t,r,e)}))}function Fe(t){return Ee(t,(function(t,n){n.cut()}))}function Ie(t,n){return Be(t)(n)}function Re(t){return t.dom.innerHTML}function Ve(t,n){var e,o,r=ft(t).dom,i=Ph.fromDom(r.createDocumentFragment());Zt(i,(e=n,(o=(r||document).createElement("div")).innerHTML=e,vt(Ph.fromDom(o)))),tn(t),wv(t,i)}function Pe(t){if(wt(t))return"#shadow-root";var n=Ph.fromDom(t.dom.cloneNode(!1)),e=Ph.fromTag("div"),o=Ph.fromDom(n.dom.cloneNode(!0));return wv(e,o),Re(e)}function He(t){var n=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++ay+String(n)}function ze(t){var n=Nh(t)?t.dom[fy]:null;return Sh.from(n)}function Ne(t){function n(n){return"The component must be in a context to execute: "+n+(t?"\n"+Pe(t().element)+" is not in context.":"")}function e(t){return function(){throw new Error(n(t))}}function o(t){return function(){console.warn(n(t))}}return{debugInfo:a("fake"),triggerEvent:o("triggerEvent"),triggerFocus:o("triggerFocus"),triggerEscape:o("triggerEscape"),broadcast:o("broadcast"),broadcastOn:o("broadcastOn"),broadcastEvent:o("broadcastEvent"),build:e("build"),addToWorld:e("addToWorld"),removeFromWorld:e("removeFromWorld"),addToGui:e("addToGui"),removeFromGui:e("removeFromGui"),getByUid:e("getByUid"),getByDom:e("getByDom"),isConnected:hh}}function Le(t,n){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:hy(i)}},t}function We(t){return me(vy,t)}function Ue(t){return n=function(n){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return t.apply(void 0,g([n.getApis(),n],e,!1))},o=(e=t.toString()).indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/),n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:hy(i.slice(1))}},n;var n,e,o,r,i}function je(t,n){var e={};return N(t,(function(t,o){N(t,(function(t,r){var i=G(e,r).getOr([]);e[r]=i.concat([n(o,t)])}))})),e}function Ge(t){return{classes:dh(t.classes)?[]:t.classes,attributes:dh(t.attributes)?{}:t.attributes,styles:dh(t.styles)?{}:t.styles}}function Xe(t){return t.cHandler}function Ye(t,n){return{name:t,handler:n}}function qe(t,n,e){var o=n[e];return o?function(t,n,e){try{var o=R(n,(function(n,o){var r=n.name,i=o.name,u=e.indexOf(r),a=e.indexOf(i);if(-1===u)throw new Error("The ordering for "+t+" does not have an entry for "+r+".\nOrder specified: "+JSON.stringify(e,null,2));if(-1===a)throw new Error("The ordering for "+t+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(e,null,2));return u<a?-1:a<u?1:0}));return Bv.value(o)}catch(n){return Bv.error([n])}}("Event: "+e,t,o).map((function(t){var n,e,o,r,i=w(t,(function(t){return t.handler}));return{can:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return O(e,(function(n,e){return n&&e.can.apply(void 0,t)}),!0)},abort:(o=e=n=i,r=function(t){return t.abort},function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return O(o,(function(n,e){return n||r(e).apply(void 0,t)}),!1)}),run:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Th(n,(function(n){n.run.apply(void 0,t)}))}}})):Bv.error(["The event ("+e+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(w(t,(function(t){return t.name})),null,2)])}function Ke(t,n){var e=Tt(t,n);return void 0===e||""===e?[]:e.split(" ")}function Je(t){return void 0!==t.dom.classList}function $e(t,n){var e,o,r;Je(t)?t.dom.classList.add(n):(o=n,r=Ke(e=t,"class").concat([o]),Ot(e,"class",r.join(" ")))}function Qe(t,n){var e,o,r,i;Je(t)?t.dom.classList.remove(n):(r=n,0<(i=k(Ke(o=t,"class"),(function(t){return t!==r}))).length?Ot(o,"class",i.join(" ")):Bt(o,"class")),0===(Je(e=t)?e.dom.classList:Ke(e,"class")).length&&Bt(e,"class")}function Ze(t,n){return Je(t)&&t.dom.classList.contains(n)}function to(t,n){Th(n,(function(n){$e(t,n)}))}function no(t,n){Th(n,(function(n){Qe(t,n)}))}function eo(t){return t.dom.value}function oo(t,n){if(void 0===n)throw new Error("Value.set was undefined");t.dom.value=n}function ro(t){var n,e,o,r,i=(n=G(t,"behaviours").getOr({}),D(Dh(n),(function(t){var e=n[t];return mh(e)?[e.me]:[]})));return e=t,r=w(o=i,(function(t){return ne(t.name(),[Ln("config"),ee("state",by)])})),{list:o,data:L(Vn("component.behaviours",Uv(r),e.behaviours).fold((function(t){throw new Error(Qv(t)+"\nComplete spec:\n"+JSON.stringify(e,null,2))}),c),(function(t){return a(t.map((function(t){return{config:t.config,state:t.state.init(t.config)}})))}))}}function io(t,n,e){var o,r,i=yh(yh({},(o=t).dom),{uid:o.uid,domChildren:w(o.components,(function(t){return t.element}))}),u=t.domModification.fold((function(){return Ge({})}),Ge),a=0<n.length?function(t,n,e,o){function r(t){return C(t,(function(t,n){return yh(yh({},n.modification),t)}),{})}var i=yh({},n);Th(e,(function(n){i[n.name()]=n.exhibit(t,o)}));var u=je(i,(function(t,n){return{name:t,modification:n}}));return Ge({classes:C(u.classes,(function(t,n){return n.modification.concat(t)}),[]),attributes:r(u.attributes),styles:r(u.styles)})}(e,{"alloy.base.modification":u},n,i):u;return yh(yh({},r=i),{attributes:yh(yh({},r.attributes),a.attributes),styles:yh(yh({},r.styles),a.styles),classes:r.classes.concat(a.classes)})}function uo(t,n,e){var o,r,i,u,a,c={"alloy.base.behaviour":t.events},s=t.eventOrder;return r=e,i=n,o=je(yh(yh({},c),(u=r,a={},Th(i,(function(t){a[t.name()]=t.handlers(u)})),a)),Ye),xy(o,s).getOrDie()}function ao(t){function n(){return f}var e,o,r,i,u,a,c,s,l,f,d=gy(t),g=d.events,p=m(d,["events"]),h=w(G(p,"components").getOr([]),Oy),v=yh(yh({},p),{events:yh(yh({},uy),g),components:h});return Bv.value((o=fe(py),r=Pn(Vn("custom.definition",Sy,e=v)),u=(i=ro(e)).list,a=i.data,c=function(t){var n=Ph.fromTag(t.tag);_t(n,t.attributes),to(n,t.classes),It(n,t.styles),t.innerHtml.each((function(t){return Ve(n,t)}));var e=t.domChildren;return Zt(n,e),t.value.each((function(t){oo(n,t)})),t.uid,dy(n,t.uid),n}(io(r,u,a)),s=uo(r,u,a),l=fe(r.components),f={uid:e.uid,getSystem:o.get,config:function(t){var n=a;return(gh(n[t.name()])?n[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(e,null,2))})()},hasConfigured:function(t){return gh(a[t.name()])},spec:e,readState:function(t){return a[t]().map((function(t){return t.state.readState()})).getOr("not enabled")},getApis:function(){return r.apis},connect:function(t){o.set(t)},disconnect:function(){o.set(Ne(n))},element:c,syncComponents:function(){var t=D(vt(c),(function(t){return o.get().getByDom(t).fold((function(){return[]}),I)}));l.set(t)},components:l.get,events:s}))}function co(t){var n=Ph.fromText(t);return ky({element:n})}function so(t,n,e,o,r){return t(e,o)?Sh.some(e):gh(r)&&r(e)?Sh.none():n(e,o,r)}function lo(t,n,e){for(var o=t.dom,r=gh(e)?e:hh;o.parentNode;){o=o.parentNode;var i=Ph.fromDom(o);if(n(i))return Sh.some(i);if(r(i))break}return Sh.none()}function fo(t,n,e){return so((function(t,n){return n(t)}),lo,t,n,e)}function mo(t,n,e){return fo(t,n,e).isSome()}function go(t,n,e){return lo(t,(function(t){return at(t,n)}),e)}function po(t,n){return e=n,ct(o=void 0===t?document:t.dom)?Sh.none():Sh.from(o.querySelector(e)).map(Ph.fromDom);var e,o}function ho(t,n,e){return so(at,go,t,n,e)}function vo(){var t=He("aria-owns");return{id:t,link:function(n){Ot(n,"aria-owns",t)},unlink:function(t){Bt(t,"aria-owns")}}}function bo(t,n,e){var o,r,i,u;switch(G(Dy.get(),t).orThunk((function(){return z(Dh(Dy.get()),(function(n){return-1<t.indexOf(n)?Sh.some(Dy.get()[n]):Sh.none()}))})).getOr(ob.NORMAL)){case ob.NORMAL:return e(My());case ob.LOGGING:var a=(o=t,r=n,i=[],u=(new Date).getTime(),{logEventCut:function(t,n,e){i.push({outcome:"cut",target:n,purpose:e})},logEventStopped:function(t,n,e){i.push({outcome:"stopped",target:n,purpose:e})},logNoParent:function(t,n,e){i.push({outcome:"no-parent",target:n,purpose:e})},logEventNoHandlers:function(t,n){i.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,e){i.push({outcome:"response",purpose:e,target:n})},write:function(){var t=(new Date).getTime();_h(["mousemove","mouseover","mouseout",Hb()],o)||console.log(o,{event:o,time:t-u,target:r.dom,sequence:w(i,(function(t){return _h(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+Pe(t.target)+")":t.outcome}))})}}),c=e(a);return a.write(),c;case ob.STOP:return!0}}function yo(){return Xn("markers",[Ln("backgroundMenu")].concat(Ay()).concat(Fy()))}function xo(t){return Xn("markers",w(t,Ln))}function wo(t,n,e){return void 0!==(o=new Error).stack&&_(o.stack.split("\n"),(function(t){return 0<t.indexOf("alloy")&&!b(By,(function(n){return-1<t.indexOf(n)}))})).getOr(Ey),Zv(n,n,e,In((function(t){return Bv.value((function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(void 0,n)}))})));var o}function So(t){return wo(0,t,xn(i))}function ko(t){return wo(0,t,xn(Sh.none))}function Co(t){return wo(0,t,bn())}function Oo(t){return wo(0,t,bn())}function _o(t,n){return tb(t,a(n))}function To(t){return tb(t,c)}function Eo(t,n,e,o,r,i,u,a){return{x:t,y:n,bubble:e,direction:o,placement:r,restriction:i,label:u+"-"+r,alwaysFit:a=void 0!==a&&a}}function Do(t,n,e,o){var r=t+n;return o<r?e:r<e?o:r}function Bo(t,n){return F(["left","right","top","bottom"],(function(e){return G(n,e).map((function(n){return function(t){switch(n){case 1:return t.x;case 0:return t.x+t.width;case 2:return t.y;case 3:return t.y+t.height}}(t)}))}))}function Mo(t,n){return t.x+t.width/2-n.width/2}function Ao(t,n){return t.x+t.width-n.width}function Fo(t,n){return t.y-n.height}function Io(t){return t.y+t.height}function Ro(t,n){return t.y+t.height/2-n.height/2}function Vo(t,n,e){return Eo(t.x+t.width,Ro(t,n),e.east(),Uy(),"east",Bo(t,{left:0}),Xy)}function Po(t,n,e){return Eo(t.x-n.width,Ro(t,n),e.west(),jy(),"west",Bo(t,{right:1}),Xy)}function Ho(){return[Yy,qy,Ky,Jy,Qy,$y,Vo,Po]}function zo(){return[qy,Yy,Jy,Ky,Qy,$y,Vo,Po]}function No(){return[Ky,Jy,Yy,qy,$y,Qy]}function Lo(){return[Jy,Ky,qy,Yy,$y,Qy]}function Wo(){return[Yy,qy,Ky,Jy,Qy,$y]}function Uo(){return[qy,Yy,Jy,Ky,Qy,$y]}function jo(t,n,e){return oy((function(o){e(o,t,n)}))}function Go(t){return{key:t,value:void 0}}function Xo(t){var n,e,o,r,i,u,a,c,s=Hn("Creating behaviour: "+t.name,ox,t);return n=s.fields,e=s.name,o=s.active,r=s.apis,i=s.extra,u=s.state,a=Dn(n),c=ne(e,[Jn("config",Dn(n))]),nx(a,c,e,o,r,i,u)}function Yo(t){var n,e=Hn("Creating behaviour: "+t.name,rx,t),o=zn(e.branchKey,e.branches),r=e.name,i=e.active,u=e.apis,a=e.extra,c=e.state,s=ne(r,[Jn("config",n=o)]);return nx(n,s,r,i,u,a,c)}function qo(){return Ph.fromDom(document)}function Ko(t){return t.dom.focus()}function Jo(t){var n=cv(t).dom;return t.dom===n.activeElement}function $o(t){return void 0===t&&(t=qo()),Sh.from(t.dom.activeElement).map(Ph.fromDom)}function Qo(t){return $o(cv(t)).filter((function(n){return t.dom.contains(n.dom)}))}function Zo(t,n){var e=cv(n),o=$o(e).bind((function(t){function e(n){return st(t,n)}var o,r;return e(n)?Sh.some(n):(o=e,(r=function(t){for(var n=0;n<t.childNodes.length;n++){var e=Ph.fromDom(t.childNodes[n]);if(o(e))return Sh.some(e);var i=r(t.childNodes[n]);if(i.isSome())return i}return Sh.none()})(n.dom))})),r=t(n);return o.each((function(t){$o(e).filter((function(n){return st(n,t)})).fold((function(){Ko(t)}),i)})),r}function tr(t,n,e,o,r){function i(t){return t+"px"}return{position:t,left:n.map(i),top:e.map(i),right:o.map(i),bottom:r.map(i)}}function nr(t,n){var e;Rt(t,yh(yh({},e=n),{position:Sh.some(e.position)}))}function er(t,n,e,o,r,i){var u=n.rect,a=u.x-e,c=u.y-o,s=r-(a+u.width),l=i-(c+u.height),f=Sh.some(a),d=Sh.some(c),m=Sh.some(s),g=Sh.some(l),p=Sh.none();return n.direction.fold((function(){return tr(t,f,d,p,p)}),(function(){return tr(t,p,d,m,p)}),(function(){return tr(t,f,p,p,g)}),(function(){return tr(t,p,p,m,g)}),(function(){return tr(t,f,d,p,p)}),(function(){return tr(t,f,p,p,g)}),(function(){return tr(t,f,d,p,p)}),(function(){return tr(t,p,d,m,p)}))}function or(t,n){return t.fold((function(){var t=n.rect;return tr("absolute",Sh.some(t.x),Sh.some(t.y),Sh.none(),Sh.none())}),(function(t,e,o,r){return er("absolute",n,t,e,o,r)}),(function(t,e,o,r){return er("fixed",n,t,e,o,r)}))}function rr(t,n){var e=l(an,n),o=t.fold(e,e,(function(){var t=en();return an(n).translate(-t.left,-t.top)})),r=Yt(n),i=Ut(n);return Ov(o.left,o.top,r,i)}function ir(t){return Et(t,mx)}function ur(t,n,e,o){function r(t,n){return z[t].map((function(e){var o="top"===t||"bottom"===t,r=o?N.top:N.left,i=("left"===t||"top"===t?Math.max:Math.min)(e,n)+r;return o?Gy(i,H.y,H.bottom):Gy(i,H.x,H.right)})).getOr(n)}var i,u,c,s,l,f,d,m,g,p,h,v,b,y,x,w,S,k,C,O,_,T,E,D,B,M,A,F,I,R,V,P,H,z,N,L,W,U,j,G=t.bubble,X=G.offset,Y=(H=o,z=t.restriction,N=X,L=r("left",H.x),W=r("top",H.y),U=r("right",H.right),j=r("bottom",H.bottom),Ov(L,W,U-L,j-W)),q=t.x+X.left,K=t.y+X.top,J=Ov(q,K,n,e),$=(i=Y.x,u=Y.y,c=Y.right,s=Y.bottom,l=J.x,f=J.y,d=J.right,m=J.bottom,g=J.width,p=J.height,{originInBounds:i<=l&&l<=c&&u<=f&&f<=s,sizeInBounds:d<=c&&i<=d&&m<=s&&u<=m,visibleW:Math.min(g,i<=l?c-l:d-i),visibleH:Math.min(p,u<=f?s-f:m-u)}),Q=$.visibleW,Z=$.visibleH,tt=$.originInBounds&&$.sizeInBounds,nt=tt?J:(h=Y.x,v=Y.y,b=Y.right,y=Y.bottom,x=J.x,w=J.y,S=J.width,k=J.height,C=Math.max(h,b-S),O=Math.max(v,y-k),_=Gy(x,h,C),T=Gy(w,v,O),E=Math.min(_+S,b)-_,D=Math.min(T+k,y)-T,
Ov(_,T,E,D)),et=0<nt.width&&0<nt.height,ot=(B=t.direction,F=a((M=nt).bottom-(A=o).y),I=a(A.bottom-M.y),R=B.fold(I,I,F,F,I,F,I,I),V=a(M.right-A.x),P=a(A.right-M.x),{maxWidth:B.fold(P,V,P,V,P,P,P,V),maxHeight:R}),rt={rect:nt,maxHeight:ot.maxHeight,maxWidth:ot.maxWidth,direction:t.direction,placement:t.placement,classes:{on:G.classesOn,off:G.classesOff},layout:t.label,testY:K};return tt||t.alwaysFit?gx.fit(rt):gx.nofit(rt,Q,Z,et)}function ar(t){function n(){return e.get().each(t)}var e=fe(Sh.none());return{clear:function(){n(),e.set(Sh.none())},isSet:function(){return e.get().isSome()},get:function(){return e.get()},set:function(t){n(),e.set(Sh.some(t))}}}function cr(){return ar((function(t){return t.destroy()}))}function sr(){return ar((function(t){return t.unbind()}))}function lr(){var t=ar(i);return yh(yh({},t),{on:function(n){return t.get().each(n)}})}function fr(t,n,e){return Kt(t,n,px,e,!1)}function dr(t,n,e){return Kt(t,n,px,e,!0)}function mr(t,n){function e(n){var e,o=null!==(e=n.raw.pseudoElement)&&void 0!==e?e:"";return st(n.target,t)&&!Q(o)&&_h(vx,n.raw.propertyName)}function r(r){var i;(o(r)||e(r))&&(l.clear(),f.clear(),!o(i=null==r?void 0:r.raw.type)&&i!==Cb()||(clearTimeout(c),Bt(t,bx),no(t,n.classes)))}function i(){l.set(fr(t,Cb(),r)),f.set(fr(t,kb(),r))}function u(t){var n=Vt(d,t);return k(ah(n)?n.split(/\s*,\s*/):[],Q)}function a(t){if(ah(t)&&/^[\d.]+/.test(t)){var n=parseFloat(t);return Rh(t,"ms")?n:1e3*n}return 0}var c,s,l=sr(),f=sr();"ontransitionstart"in t.dom?s=fr(t,Ob(),(function(t){e(t)&&(s.unbind(),i())})):i();var d,m,g=(d=t,m=u("transition-delay"),O(u("transition-duration"),(function(t,n,e){var o=a(m[e])+a(n);return Math.max(t,o)}),0));requestAnimationFrame((function(){c=setTimeout(r,g+17),Ot(t,bx,c)}))}function gr(t,n,e,o,r,i){function u(t){return parseFloat(t).toFixed(3)}var a,c,l,f,d,m,g,p,h,v=(a=o,c=r,i.exists((function(t){var n=a.mode;return"all"===n||t[n]!==c[n]})));v||(h=t,B(o.classes,(function(t){return Ze(h,t)})))?(Ft(t,"position",e.position),l=rr(n,t),f=or(n,yh(yh({},r),{rect:l})),d=F(vx,(function(t){return f[t]})),p=e,U(d,(function(t,n){var e,o,r,i=p[n].map(u),a=t.map(u);return!Fh(e=i,o=a,r=void 0===r?s:r).getOr(e.isNone()&&o.isNone())})).isSome()&&(Rt(t,d),v&&(to(m=t,(g=o).classes),Et(m,bx).each((function(t){clearTimeout(parseInt(t,10)),Bt(m,bx)})),mr(m,g)),Nt(t))):no(t,o.classes)}function pr(t,n,e,o){function r(t,n,e,o,r){var i=ur(t(f,d,m,u,g),p,h,g);return i.fold(a(i),(function(t,u,a,c){return(r===c?o<a||e<u:!r&&c)?i:gx.nofit(n,e,o,r)}))}zt(n,"max-height"),zt(n,"max-width");var i,u,s,f,d,m,g,p,h,v={width:Yt(i=n),height:Ut(i)};return u=n,s=o.preference,f=t,d=v,m=e,g=o.bounds,p=d.width,h=d.height,O(s,(function(t,n){var e=l(r,n);return t.fold(a(t),e)}),gx.nofit({rect:f,maxHeight:d.height,maxWidth:d.width,direction:Py(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:f.y},-1,-1,!1)).fold(c,c)}function hr(t,n){var e=t,o=Math.floor(n);Ft(e,"max-height",pv.max(e,o,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"])+"px")}function vr(t,n,e){return void 0===t[n]?e:t[n]}function br(t,n,e,o){function r(t){return G(e,t).getOr([])}function i(t,n,e){var o=A(Sx,e);return{offset:vv(t,n),classesOn:D(e,r),classesOff:D(o,r)}}var u=t*(o=void 0===o?1:o),a=n*o;return{southeast:function(){return i(-t,n,["top","alignLeft"])},southwest:function(){return i(t,n,["top","alignRight"])},south:function(){return i(-t/2,n,["top","alignCentre"])},northeast:function(){return i(-t,-n,["bottom","alignLeft"])},northwest:function(){return i(t,-n,["bottom","alignRight"])},north:function(){return i(-t/2,-n,["bottom","alignCentre"])},east:function(){return i(t,-n/2,["valignCentre","left"])},west:function(){return i(-t,-n/2,["valignCentre","right"])},insetNortheast:function(){return i(u,a,["top","alignLeft","inset"])},insetNorthwest:function(){return i(-u,a,["top","alignRight","inset"])},insetNorth:function(){return i(-u/2,a,["top","alignCentre","inset"])},insetSoutheast:function(){return i(u,-a,["bottom","alignLeft","inset"])},insetSouthwest:function(){return i(-u,-a,["bottom","alignRight","inset"])},insetSouth:function(){return i(-u/2,-a,["bottom","alignCentre","inset"])},insetEast:function(){return i(-u,-a/2,["valignCentre","right","inset"])},insetWest:function(){return i(u,-a/2,["valignCentre","left","inset"])}}}function yr(){return br(0,0,{})}function xr(t,n){return function(e){return"rtl"===Cx(e)?n:t}}function wr(t){return mo(t,(function(t){return Nh(t)&&Tt(t,"data-alloy-vertical-dir")===lx.BottomToTop}))}function Sr(){return ne("layouts",[Ln("onLtr"),Ln("onRtl"),Kn("onBottomLtr"),Kn("onBottomRtl")])}function kr(t,n,e,o,r,i,u){var a=u.map(wr).getOr(!1),c=n.layouts.map((function(n){return n.onLtr(t)})),s=n.layouts.map((function(n){return n.onRtl(t)}));return xr(a?n.layouts.bind((function(n){return n.onBottomLtr.map((function(n){return n(t)}))})).or(c).getOr(r):c.getOr(e),a?n.layouts.bind((function(n){return n.onBottomRtl.map((function(n){return n(t)}))})).or(s).getOr(i):s.getOr(o))(t)}function Cr(t){return t.fold(c,(function(t,n,e){return t.translate(-n,-e)}))}function Or(t){return t.fold(c,c)}function _r(t){return O(t,(function(t,n){return t.translate(n.left,n.top)}),vv(0,0))}function Tr(t){return _r(w(t,Or))}function Er(t,n,e){var o,r,i=en(ft(t.element)),u=(o=t,r=gt(e.root).dom,Sh.from(r.frameElement).map(Ph.fromDom).filter((function(t){return st(ft(t),ft(o.element))})).map(Gt).getOr(i));return Bx(u,i.left,i.top)}function Dr(t,n,e,o){var r=Dx(vv(t,n));return Sh.some({point:r,width:e,height:o})}function Br(t,n,e,o,r){return t.map((function(t){var i=[n,t.point],u=o.fold((function(){return Tr(i)}),(function(){return Tr(i)}),(function(){return _r(w(i,Cr))})),a={x:u.left,y:u.top,width:t.width,height:t.height},c=(e.showAbove?No:Wo)(),s=(e.showAbove?Lo:Uo)(),l=kr(r,e,c,s,c,s,Sh.none());return kx({anchorBox:a,bubble:e.bubble.getOr(yr()),overrides:e.overrides,layouts:l,placer:Sh.none()})}))}function Mr(t,n,e){var o,r=t.document.createRange(),i=r;return n.fold((function(t){i.setStartBefore(t.dom)}),(function(t,n){i.setStart(t.dom,n)}),(function(t){i.setStartAfter(t.dom)})),o=r,e.fold((function(t){o.setEndBefore(t.dom)}),(function(t,n){o.setEnd(t.dom,n)}),(function(t){o.setEndAfter(t.dom)})),r}function Ar(t,n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i}function Fr(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}}function Ir(t,n,e){return n(Ph.fromDom(e.startContainer),e.startOffset,Ph.fromDom(e.endContainer),e.endOffset)}function Rr(t,n){return e=t,i=n.match({domRange:function(t){return{ltr:a(t),rtl:Sh.none}},relative:function(t,n){return{ltr:ot((function(){return Mr(e,t,n)})),rtl:ot((function(){return Sh.some(Mr(e,n,t))}))}},exact:function(t,n,o,r){return{ltr:ot((function(){return Ar(e,t,n,o,r)})),rtl:ot((function(){return Sh.some(Ar(e,o,r,t,n))}))}}}),((r=(o=i).ltr()).collapsed?o.rtl().filter((function(t){return!1===t.collapsed})).map((function(t){return Px.rtl(Ph.fromDom(t.endContainer),t.endOffset,Ph.fromDom(t.startContainer),t.startOffset)})).getOrThunk((function(){return Ir(0,Px.ltr,r)})):Ir(0,Px.ltr,r)).match({ltr:function(n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},rtl:function(n,e,o,r){var i=t.document.createRange();return i.setStart(o.dom,r),i.setEnd(n.dom,e),i}});var e,o,r,i}function Vr(t){return Wx.getOption(t)}function Pr(t){return Vr(t).filter((function(t){return 0!==t.trim().length||-1<t.indexOf("\xa0")})).isSome()||_h(Ux,nt(t))}function Hr(t,n){return ct(e=void 0===t?document:t.dom)?[]:w(e.querySelectorAll(n),Ph.fromDom);var e}function zr(t){if(0<t.rangeCount){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return Sh.some(Ax(Ph.fromDom(n.startContainer),n.startOffset,Ph.fromDom(e.endContainer),e.endOffset))}return Sh.none()}function Nr(t){if(null===t.anchorNode||null===t.focusNode)return zr(t);var n,e,o,r,i,u,a,c,s,l,f,d=Ph.fromDom(t.anchorNode),m=Ph.fromDom(t.focusNode);return n=d,u=e=t.anchorOffset,a=o=m,c=r=t.focusOffset,(s=ft(i=n).dom.createRange()).setStart(i.dom,u),s.setEnd(a.dom,c),l=s,f=st(n,o)&&e===r,l.collapsed&&!f?Sh.some(Ax(d,t.anchorOffset,m,t.focusOffset)):zr(t)}function Lr(t,n){var e,o,r=(e=Rr(t,n)).getClientRects();return 0<(o=0<r.length?r[0]:e.getBoundingClientRect()).width||0<o.height?Sh.some(o).map(Fr):Sh.none()}function Wr(t,n){return{element:t,offset:n}}function Ur(t,n){return(Lh(t)?Wr:function(t,n){var e=vt(t);if(0===e.length)return Wr(t,n);if(n<e.length)return Wr(e[n],0);var o=e[e.length-1];return Wr(o,(Lh(o)?Wx.get(o):vt(o)).length)})(t,n)}function jr(t,n){return n.getSelection.getOrThunk((function(){return function(){return Sh.from(t.getSelection()).filter((function(t){return 0<t.rangeCount})).bind(Nr)}}))().map((function(t){var n=Ur(t.start,t.soffset),e=Ur(t.finish,t.foffset);return Vx.range(n.element,n.offset,e.element,e.offset)}))}function Gr(t){return t.x+t.width}function Xr(t,n){return t.x-n.width}function Yr(t,n){return t.y-n.height+t.height}function qr(t,n,e){return Eo(Gr(t),t.y,e.southeast(),Py(),"southeast",Bo(t,{left:0,top:2}),Gx)}function Kr(t,n,e){return Eo(Xr(t,n),t.y,e.southwest(),Hy(),"southwest",Bo(t,{right:1,top:2}),Gx)}function Jr(t,n,e){return Eo(Gr(t),Yr(t,n),e.northeast(),zy(),"northeast",Bo(t,{left:0,bottom:3}),Gx)}function $r(t,n,e){return Eo(Xr(t,n),Yr(t,n),e.northwest(),Ny(),"northwest",Bo(t,{right:1,bottom:3}),Gx)}function Qr(){return[qr,Kr,Jr,$r]}function Zr(){return[Kr,qr,$r,Jr]}function ti(t,n,e,o,r,u,a){var c,s,l,f,d,m,g,p,h,v,b,y,x,w;return c={anchorBox:e.anchorBox,origin:n},s=r.element,l=e.bubble,f=e.layouts,d=u,m=o,p=a,v=vr(g=e.overrides,"maxHeightFunction",yx()),b=vr(g,"maxWidthFunction",i),y=c.anchorBox,x=c.origin,w={bounds:(h=x,m.fold((function(){return h.fold(Tv,Tv,Ov)}),(function(t){return h.fold(t,t,(function(){var n=t(),e=sx(h,n.x,n.y);return Ov(e.left,e.top,n.width,n.height)}))}))),origin:x,preference:f,maxHeightFunction:v,maxWidthFunction:b,lastPlacement:d,transition:p},wx(y,s,l,w)}function ni(t,n){wv(t.element,n.element)}function ei(t,n){var e,o=t.components();Th((e=t).components(),(function(t){return Sv(t.element)})),tn(e.element),e.syncComponents();var r=A(o,n);Th(r,(function(n){Qx(n),t.getSystem().removeFromWorld(n)})),Th(n,(function(n){n.getSystem().isConnected()?ni(t,n):(t.getSystem().addToWorld(n),ni(t,n),fv(t.element)&&Zx(n)),t.syncComponents()}))}function oi(t,n){tw(t,n,wv)}function ri(t){Qx(t),Sv(t.element),t.getSystem().removeFromWorld(t)}function ii(t){var n=pt(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}));ri(t),n.each((function(t){t.syncComponents()}))}function ui(t){var n=t.components();Th(n,ri),tn(t.element),t.syncComponents()}function ai(t,n){nw(t,n,wv)}function ci(t){var n=vt(t.element);Th(n,(function(n){t.getByDom(n).each(Qx)})),Sv(t.element)}function si(t,n,e,o){e.get().each((function(){ui(t)})),oi(n.getAttachPoint(t),t);var r=t.getSystem().build(o);return oi(t,r),e.set(r),r}function li(t,n,e,o){var r=si(t,n,e,o);return n.onOpen(t,r),r}function fi(t,n,e){e.get().each((function(o){ui(t),ii(t),n.onClose(t,o),e.clear()}))}function di(t,n,e){return e.isOpen()}function mi(t){var n=Hn("Dismissal",cw,t),e={};return e[iw()]={schema:Dn([Ln("target")]),onReceive:function(t,e){rw.isOpen(t)&&(rw.isPartOf(t,e.target)||n.isExtraPart(t,e.target)||n.fireEventInstead.fold((function(){return rw.close(t)}),(function(n){return we(t,n.event)})))}},e}function gi(t){var n=Hn("Reposition",sw,t),e={};return e[uw()]={onReceive:function(t){rw.isOpen(t)&&n.fireEventInstead.fold((function(){return n.doReposition(t)}),(function(n){return we(t,n.event)}))}},e}function pi(t,n,e){n.store.manager.onLoad(t,n,e)}function hi(t,n,e){n.store.manager.onUnload(t,n,e)}function vi(){var t=fe(null);return yy({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})}function bi(){var t=fe({}),n=fe({});return yy({readState:function(){return{mode:"dataset",dataByValue:t.get(),dataByText:n.get()}},lookup:function(e){return G(t.get(),e).orThunk((function(){return G(n.get(),e)}))},update:function(e){var o=t.get(),r=n.get(),i={},u={};Th(e,(function(t){G(i[t.value]=t,"meta").each((function(n){G(n,"text").each((function(n){u[n]=t}))}))})),t.set(yh(yh({},o),i)),n.set(yh(yh({},r),u))},clear:function(){t.set({}),n.set({})}})}function yi(t,n,e,o){var r=n.store;e.update([o]),r.setValue(t,o),n.onSetValue(t,o)}function xi(t,n){return le(t,{},w(n,(function(n){return e=n.name(),o="Cannot configure "+n.name()+" for "+t,Zv(e,e,wn(),On((function(){return Fv("The field: "+e+" is forbidden. "+o)})));var e,o})).concat([tb("dump",c)]))}function wi(t){return t.dump}function Si(t,n){return yh(yh({},ex(n)),t.dump)}function ki(t){return Ah(t,"uiType")}function Ci(t){return t.fold(Sh.some,Sh.none,Sh.some,Sh.some)}function Oi(t){function n(t){return t.name}return t.fold(n,n,n,n)}function _i(t,n){return function(e){var o=Hn("Converting part type",n,e);return t(o)}}function Ti(t,n,e,o){return zv(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))}function Ei(t,n){var e={};return Th(n,(function(n){Ci(n).each((function(n){var o=Ww(t,n.pname);e[n.name]=function(e){var r=Hn("Part: "+n.name+" in "+t,Uv(n.schema),e);return yh(yh({},o),{config:e,validated:r})}}))})),e}function Di(t,n,e){return{uiType:kw(),owner:t,name:n,config:e,validated:{}}}function Bi(t){return D(t,(function(t){return t.fold(Sh.none,Sh.some,Sh.none,Sh.none).map((function(t){return Xn(t.name,t.schema.concat([To(Nw())]))})).toArray()}))}function Mi(t){return w(t,Oi)}function Ai(t,n,e){return o=n,r={},i={},Th(e,(function(t){t.fold((function(t){r[t.pname]=ww(!0,(function(n,e,o){return t.factory.sketch(Ti(n,t,e,o))}))}),(function(t){var n=o.parts[t.name];i[t.name]=a(t.factory.sketch(Ti(o,t,n[Nw()]),n))}),(function(t){r[t.pname]=ww(!1,(function(n,e,o){return t.factory.sketch(Ti(n,t,e,o))}))}),(function(t){r[t.pname]=Sw(!0,(function(n,e,o){return w(n[t.name],(function(e){return t.factory.sketch(zv(t.defaults(n,e,o),e,t.overrides(n,e)))}))}))}))})),{internals:a(r),externals:a(i)};var o,r,i}function Fi(t,n,e){return o=Sh.some(t),i=(r=n).components,l=L(e,(function(t,n){return o=t,r=!1,{name:a(e=n),required:function(){return o.fold((function(t){return t}),(function(t){return t}))},used:function(){return r},replace:function(){if(r)throw new Error("Trying to use the same placeholder more than once: "+e);return r=!0,o}};var e,o,r})),u=o,c=r,s=l,f=D(i,(function(t){return xw(u,c,t,s)})),N(l,(function(t){if(!1===t.used()&&t.required())throw new Error("Placeholder: "+t.name()+" was not found in components list\nNamespace: "+o.getOr("none")+"\nComponents: "+JSON.stringify(r.components,null,2))})),f;var o,r,i,u,c,s,l,f}function Ii(t,n,e){var o=n.partUids[e];return t.getSystem().getByUid(o).toOptional()}function Ri(t,n,e){return Ii(t,n,e).getOrDie("Could not find part: "+e)}function Vi(t,n,e){var o={},r=n.partUids,i=t.getSystem();return Th(e,(function(t){o[t]=a(i.getByUid(r[t]))})),o}function Pi(t,n){var e=t.getSystem();return L(n.partUids,(function(t){return a(e.getByUid(t))}))}function Hi(t){return Dh(t.partUids)}function zi(t,n,e){var o={},r=n.partUids,i=t.getSystem();return Th(e,(function(t){o[t]=a(i.getByUid(r[t]).getOrDie())})),o}function Ni(t,n){return ge(w(Mi(n),(function(n){return{key:n,value:t+"-"+n}})))}function Li(t){return Zv("partUids","partUids",Sn((function(n){return Ni(n.uid,t)})),Gv())}function Wi(t,n,e,o,r){var i;return Hn(t+" [SpecSchema]",Dn((i=r,(0<o.length?[Xn("parts",o)]:[]).concat([Ln("uid"),ee("dom",{}),ee("components",[]),To("originalSpec"),ee("debug.sketcher",{})]).concat(i)).concat(n)),e)}function Ui(t,n,e,o,r){var i=jw(r),u=Wi(t,n,i,Bi(e),[Li(e)]),a=Ai(0,u,e);return o(u,Fi(t,u,a.internals()),i,a.externals())}function ji(t){var n=Hn("Sketcher for "+t.name,Gw,t),e=L(n.apis,Ue),o=L(n.extraApis,Le);return yh(yh({name:n.name,configFields:n.configFields,sketch:function(t){return e=n.name,o=n.configFields,(0,n.factory)(Wi(e,o,r=jw(t),[],[]),r);var e,o,r}},e),o)}function Gi(t){var n=Hn("Sketcher for "+t.name,Xw,t),e=Ei(n.name,n.partFields),o=L(n.apis,Ue),r=L(n.extraApis,Le);return yh(yh({name:n.name,partFields:n.partFields,configFields:n.configFields,sketch:function(t){return Ui(n.name,n.configFields,n.partFields,n.factory,t)},parts:e},o),r)}function Xi(t){return"input"===nt(t)&&"radio"!==Tt(t,"type")||"textarea"===nt(t)}function Yi(t,n){(n.disabled()?Jw:$w)(t,n)}function qi(t,n){return!0===n.useNative&&_h(Kw,nt(t.element))}function Ki(t,n){return qi(t,n)?Dt(t.element,"disabled"):"true"===Tt(t.element,"aria-disabled")}function Ji(t,n,e,o){var r=Hr(t.element,"."+n.highlightClass);Th(r,(function(e){b(o,(function(t){return t.element===e}))||(Qe(e,n.highlightClass),t.getSystem().getByDom(e).each((function(e){n.onDehighlight(t,e),we(e,Qb())})))}))}function $i(t,n,e,o){Ji(t,n,0,[o]),gu(0,n,0,o)||($e(o.element,n.highlightClass),n.onHighlight(t,o),we(o,$b()))}function Qi(t,n,e,o){var r=Hr(t.element,"."+n.itemClass);return T(r,(function(t){return Ze(t,n.highlightClass)})).bind((function(n){var e=Do(n,o,0,r.length-1);return t.getSystem().getByDom(r[e]).toOptional()}))}function Zi(t,n,e){var o=M(t.slice(0,n)),r=M(t.slice(n+1));return _(o.concat(r),e)}function tu(t,n,e){return _(M(t.slice(0,n)),e)}function nu(t,n,e){var o=t.slice(0,n);return _(t.slice(n+1).concat(o),e)}function eu(t,n,e){return _(t.slice(n+1),e)}function ou(t){return function(n){var e=n.raw;return _h(t,e.which)}}function ru(t){return function(n){return B(t,(function(t){return t(n)}))}}function iu(t){return!0===t.raw.shiftKey}function uu(t){return!0===t.raw.ctrlKey}function au(t,n){return{matches:t,classification:n}}function cu(t,n,e){n.exists((function(t){return e.exists((function(n){return st(n,t)}))}))||Se(t,Yb(),{prevFocus:n,newFocus:e})}function su(){function t(t){return Qo(t.element)}return{get:t,set:function(n,e){var o=t(n);n.getSystem().triggerFocus(e,n.element),cu(n,o,t(n))}}}function lu(){function t(t){return eS.getHighlighted(t).map((function(t){return t.element}))}return{get:t,set:function(n,e){var o=t(n);n.getSystem().getByDom(e).fold(i,(function(t){eS.highlight(n,t)}));var r=t(n);cu(n,o,r)}}}function fu(t,n,e,o,r,i){var u=i.map(_v);return Jx(t,n,e,o,r,u)}function du(t,n){var e,o,r,i=n.getAttachPoint(t);Ft(t.element,"position",$x.getMode(i)),r=n.cloakVisibilityAttr,Pt((e=t).element,o="visibility").fold((function(){Bt(e.element,r)}),(function(t){Ot(e.element,r,t)})),Ft(e.element,o,"hidden")}function mu(t,n){var e,o,r,i=t.element;b(["top","left","right","bottom"],(function(t){return Pt(i,t).isSome()}))||zt(t.element,"position"),o="visibility",r=n.cloakVisibilityAttr,Et((e=t).element,r).fold((function(){return zt(e.element,o)}),(function(t){return Ft(e.element,o,t)}))}function gu(t,n,e,o){return Ze(o.element,n.highlightClass)}function pu(t,n){return po(t.element,"."+n.itemClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))}function hu(t,n){var e=Hr(t.element,"."+n.itemClass);return(0<e.length?Sh.some(e[e.length-1]):Sh.none()).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))}function vu(t,n){return q(w(Hr(t.element,"."+n.itemClass),(function(n){return t.getSystem().getByDom(n).toOptional()})))}function bu(t,n,e,o,r){function i(t,n,e,o,r){var i=e(t,n,o,r),u=n.event;return _(i,(function(t){return t.matches(u)})).map((function(t){return t.classification})).bind((function(e){return e(t,n,o,r)}))}var u={schema:function(){return t.concat([ee("focusManager",su()),oe("focusInside","onFocus",In((function(t){return _h(["onFocus","onEnterOrSpace","onApi"],t)?Bv.value(t):Bv.error("Invalid value for focusInside")}))),_o("handler",u),_o("state",n),_o("sendFocusIn",r)])},processKey:i,toEvents:function(t,n){var u=t.focusInside!==Nx.OnFocusMode?Sh.none():r(t).map((function(e){return Ee(Eb(),(function(o,r){e(o,t,n),r.stop()}))})),a=[Ee(bb(),(function(o,u){i(o,u,e,t,n).fold((function(){var e=o,i=u,a=ou(aS.concat(iS))(i.event);t.focusInside===Nx.OnEnterOrSpaceMode&&a&&be(e,i)&&r(t).each((function(o){o(e,t,n),i.stop()}))}),(function(){u.stop()}))})),Ee(yb(),(function(e,r){i(e,r,o,t,n).each((function(){r.stop()}))}))];return ty(u.toArray().concat(a))}};return u}function yu(t){function n(t,n){return 0<Wt(t.visibilitySelector.bind((function(t){return ho(n,t)})).getOr(n))}function e(t,e){var o=e,r=k(Hr(t.element,o.selector),(function(t){return n(o,t)}));Sh.from(r[o.firstTabstop]).each((function(n){e.focusManager.set(t,n)}))}function o(t,e,o,r){var i,u=Hr(t.element,o.selector);return(i=o).focusManager.get(t).bind((function(t){return ho(t,i.selector)})).bind((function(e){return T(u,l(st,e)).bind((function(e){return i=t,a=o,r(u,e,(function(t){return n(e=a,o=t)&&e.useTabstopAt(o);var e,o})).fold((function(){return a.cyclic?Sh.some(!0):Sh.none()}),(function(t){return a.focusManager.set(i,t),Sh.some(!0)}));var i,a}))}))}var r=[Kn("onEscape"),Kn("onEnter"),ee("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),ee("firstTabstop",0),ee("useTabstopAt",vh),Kn("visibilitySelector")].concat([t]),i=a([au(ru([iu,ou(rS)]),(function(t,n,e){return o(t,0,e,e.cyclic?Zi:tu)})),au(ou(rS),(function(t,n,e){return o(t,0,e,e.cyclic?nu:eu)})),au(ou(uS),(function(t,n,e){return e.onEscape.bind((function(e){return e(t,n)}))})),au(ru([dS,ou(iS)]),(function(t,n,e){return e.onEnter.bind((function(e){return e(t,n)}))}))]),u=a([]);return bu(r,by.init,i,u,(function(){return Sh.some(e)}))}function xu(t,n,e){return Xi(e)&&ou(aS)(n.event)?Sh.none():(Ce(t,e,Ab()),Sh.some(!0))}function wu(){return Sh.some(!0)}function Su(t,n,e){return e.execute(t,n,t.element)}function ku(){var t=lr();return yy({readState:function(){return t.get().map((function(t){return{numRows:String(t.numRows),numColumns:String(t.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(n,e){t.set({numRows:n,numColumns:e})},getNumRows:function(){return t.get().map((function(t){return t.numRows}))},getNumColumns:function(){return t.get().map((function(t){return t.numColumns}))}})}function Cu(t){return function(n,e,o,r){var i=t(n.element);return yS(i,n,e,o,r)}}function Ou(t,n){return Cu(xr(t,n))}function _u(t,n){return Cu(xr(n,t))}function Tu(t){return function(n,e,o,r){return yS(t,n,e,o,r)}}function Eu(t){return!((n=t.dom).offsetWidth<=0&&n.offsetHeight<=0);var n}function Du(t,n,e){var o,r=k(Hr(t,e),Eu);return T(o=r,(function(t){return st(t,n)})).map((function(t){return{index:t,candidates:o}}))}function Bu(t,n){return T(t,(function(t){return st(n,t)}))}function Mu(t,n,e,o){return o(Math.floor(n/e),n%e).bind((function(n){var o=n.row*e+n.column;return 0<=o&&o<t.length?Sh.some(t[o]):Sh.none()}))}function Au(t,n,e,o,r){return Mu(t,n,o,(function(n,i){var u=n===e-1?t.length-n*o:o,a=Do(i,r,0,u-1);return Sh.some({row:n,column:a})}))}function Fu(t,n,e,o,r){return Mu(t,n,o,(function(n,i){var u=Do(n,r,0,e-1),a=u===e-1?t.length-u*o:o,c=Gy(i,0,a-1);return Sh.some({row:u,column:c})}))}function Iu(t,n){po(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))}function Ru(t){return function(n,e,o,r){return Du(n,e,o.selector).bind((function(n){return t(n.candidates,n.index,r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))}))}}function Vu(t,n,e){return e.captureTab?Sh.some(!0):Sh.none()}function Pu(t,n,e,o){var r=function(t,n,e){var i,u=Do(n,o,0,e.length-1);return u===t?Sh.none():"button"===nt(i=e[u])&&"disabled"===Tt(i,"disabled")?r(t,u,e):Sh.from(e[u])};return Du(t,e,n).bind((function(t){var n=t.index,e=t.candidates;return r(n,n,e)}))}function Hu(t,n,e){return(o=e).focusManager.get(t).bind((function(t){return ho(t,o.selector)})).bind((function(o){return e.execute(t,n,o)}));var o}function zu(t,n){n.getInitial(t).orThunk((function(){return po(t.element,n.selector)})).each((function(e){n.focusManager.set(t,e)}))}function Nu(t,n,e){return Pu(t,e.selector,n,-1)}function Lu(t,n,e){return Pu(t,e.selector,n,1)}function Wu(t){return function(n,e,o,r){return t(n,e,o,r).bind((function(){return o.executeOnMove?Hu(n,e,o):Sh.some(!0)}))}}function Uu(t,n,e){return e.onEscape(t,n)}function ju(t,n,e){return Sh.from(t[n]).bind((function(t){return Sh.from(t[e]).map((function(t){return{rowIndex:n,columnIndex:e,cell:t}}))}))}function Gu(t,n,e,o){return ju(t,n,Do(e,o,0,t[n].length-1))}function Xu(t,n,e,o){var r=Do(e,o,0,t.length-1),i=t[r].length;return ju(t,r,Gy(n,0,i-1))}function Yu(t,n,e,o){var r=t[n].length;return ju(t,n,Gy(e+o,0,r-1))}function qu(t,n,e,o){var r=Gy(e+o,0,t.length-1),i=t[r].length;return ju(t,r,Gy(n,0,i-1))}function Ku(t,n){n.previousSelector(t).orThunk((function(){var e=n.selectors;return po(t.element,e.cell)})).each((function(e){n.focusManager.set(t,e)}))}function Ju(t,n){return function(e,o,r){var i=r.cycles?t:n;return ho(o,r.selectors.row).bind((function(t){return Bu(Hr(t,r.selectors.cell),o).bind((function(n){var o=Hr(e,r.selectors.row);return Bu(o,t).bind((function(t){var e,u=(e=r,w(o,(function(t){return Hr(t,e.selectors.cell)})));return i(u,t,n).map((function(t){return t.cell}))}))}))}))}}function $u(t,n,e){return e.focusManager.get(t).bind((function(o){return e.execute(t,n,o)}))}function Qu(t,n){po(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))}function Zu(t,n,e){return Pu(t,e.selector,n,-1)}function ta(t,n,e){return Pu(t,e.selector,n,1)}function na(t,n,e,o){var r=t.getSystem().build(o);tw(t,r,e)}function ea(t,n,e,o){_(ZS(t),(function(t){return st(o.element,t.element)})).each(ii)}function oa(t,n,e,o,r){var i=ZS(t);return Sh.from(i[o]).map((function(n){return ea(t,0,0,n),r.each((function(n){na(t,0,(function(t,n){var e,r=n;bt(e=t,o).fold((function(){wv(e,r)}),(function(t){Jt(t,r)}))}),n)})),n}))}function ra(t,n){var e,o;return{key:t,value:{config:{},me:(e=t,o=ty(n),Xo({fields:[Ln("enabled")],name:e,active:{events:a(o)}})),configAsRaw:a({}),initialConfig:{},state:by}}}function ia(t,n){n.ignore||(Ko(t.element),n.onFocus(t))}function ua(t,n,e){var o=n.aria;o.update(t,o,e.get())}function aa(t,n,e){n.toggleClass.each((function(n){(e.get()?$e:Qe)(t.element,n)}))}function ca(t,n,e){Ha(t,n,e,!e.get())}function sa(t,n,e){e.set(!0),aa(t,n,e),ua(t,n,e)}function la(t,n,e){e.set(!1),aa(t,n,e),ua(t,n,e)}function fa(t,n,e){Ha(t,n,e,n.selected)}function da(){function t(t,n){n.stop(),ke(t)}return[Ee(Sb(),t),Ee(Ib(),t),Fe(ab()),Fe(fb())]}function ma(t){return ty(E([t.map((function(t){return ry((function(n,e){t(n),e.stop()}))})).toArray(),da()]))}function ga(t){(Qo(t.element).isNone()||ok.isFocused(t))&&(ok.isFocused(t)||ok.focus(t),Se(t,ak,{item:t}))}function pa(t){Se(t,ck,{item:t})}function ha(t,n){return t.x+t.width/2-n.width/2}function va(t,n){return t.x+t.width-n.width}function ba(t,n){return t.y+t.height-n.height}function ya(t,n){return t.y+t.height/2-n.height/2}function xa(t,n,e){return Eo(va(t,n),ba(t,n),e.insetSouthwest(),Ny(),"southwest",Bo(t,{right:0,bottom:3}),_k)}function wa(t,n,e){return Eo(t.x,ba(t,n),e.insetSoutheast(),zy(),"southeast",Bo(t,{left:1,bottom:3}),_k)}function Sa(t,n,e){return Eo(va(t,n),t.y,e.insetNorthwest(),Hy(),"northwest",Bo(t,{right:0,top:2}),_k)}function ka(t,n,e){return Eo(t.x,t.y,e.insetNortheast(),Py(),"northeast",Bo(t,{left:1,top:2}),_k)}function Ca(t,n,e){return Eo(va(t,n),ya(t,n),e.insetEast(),jy(),"east",Bo(t,{right:0}),_k)}function Oa(t,n,e){return Eo(t.x,ya(t,n),e.insetWest(),Uy(),"west",Bo(t,{left:1}),_k)}function _a(t){switch(t){case"north":return Tk;case"northeast":return ka;case"northwest":return Sa;case"south":return Ek;case"southeast":return wa;case"southwest":return xa;case"east":return Ca;case"west":return Oa}}function Ta(t,n,e,o,r){return ir(o).map(_a).getOr(Tk)(t,n,e,o,r)}function Ea(t){switch(t){case"north":return Ek;case"northeast":return wa;case"northwest":return xa;case"south":return Tk;case"southeast":return ka;case"southwest":return Sa;case"east":return Oa;case"west":return Ca}}function Da(t,n,e,o,r){return ir(o).map(Ea).getOr(Tk)(t,n,e,o,r)}function Ba(t){var n=void 0!==t.uid&&X(t,"uid")?t.uid:my("memento");return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).toOptional()},asSpec:function(){return yh(yh({},t),{uid:n})}}}function Ma(t){return function(){return G(t,Fk).getOr("!not found!")}}function Aa(t,n){var e,o=t.toLowerCase();if(Mk.isRtl()){var r=Rh(e=o,"-rtl")?e:e+"-rtl";return Ah(n,r)?r:o}return o}function Fa(t,n){return G(n,Aa(t,n))}function Ia(t,n){var e=n();return Fa(t,e).getOrThunk(Ma(e))}function Ra(){return ra("add-focusable",[ny((function(t){var n,e,o;n=t.element,e="svg",o=function(t){return at(t,e)},_(n.dom.childNodes,(function(t){return o(Ph.fromDom(t))})).map(Ph.fromDom).each((function(t){return Ot(t,"focusable","false")}))}))])}function Va(t,n,e,o){var r,i,u,a=(u=n,Mk.isRtl()&&Ah(Ak,u)?["tox-icon--flip"]:[]),c=G(e,Aa(n,e)).or(o).getOrThunk(Ma(e));return{dom:{tag:t.tag,attributes:null!==(r=t.attributes)&&void 0!==r?r:{},classes:t.classes.concat(a),innerHtml:c},behaviours:ex(g(g([],null!==(i=t.behaviours)&&void 0!==i?i:[],!0),[Ra()],!1))}}function Pa(t,n,e,o){return void 0===o&&(o=Sh.none()),Va(n,t,e(),o)}function Ha(t,n,e,o){(o?sa:la)(t,n,e)}function za(t,n,e){Ot(t.element,"aria-expanded",e)}function Na(t){return"prepared"===t.type?Sh.some(t.menu):Sh.none()}function La(t,n){function e(){lh(o)||(clearTimeout(o),o=null)}var o=null;return{cancel:e,throttle:function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];e(),o=setTimeout((function(){o=null,t.apply(null,r)}),n)}}}function Wa(t,n,e,o,r){var i=Vk(t,(function(n){return(e=t).isBlock(o=n)||_h(["BR","IMG","HR","INPUT"],o.nodeName)||"false"===e.getContentEditable(o);var e,o}));return Sh.from(i.backwards(n,e,o,r))}function Ua(t,n){return Pk(Ph.fromDom(t.selection.getNode())).getOrThunk((function(){var e,o,r=Ph.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc());return wv(r,Ph.fromDom(n.extractContents())),n.insertNode(r.dom),pt(r).each((function(t){return t.dom.normalize()})),e=Pr,(o=function(t){for(var n=vt(t),r=n.length-1;0<=r;r--){var i=n[r];if(e(i))return Sh.some(i);var u=o(i);if(u.isSome())return u}return Sh.none()})(r).map((function(n){var e;t.selection.setCursorLocation(n.dom,"img"===nt(e=n)?1:Vr(e).fold((function(){return vt(e).length}),(function(t){return t.length})))})),r}))}function ja(t){return t.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")}function Ga(t){return""!==t&&-1!==" \xa0\f\n\r\t\v".indexOf(t)}function Xa(t,n){return t.substring(n.length)}function Ya(t,n,e,o){return void 0===o&&(o=0),Pk(Ph.fromDom(n.startContainer)).fold((function(){return function(t,n,e,o){if(void 0===o&&(o=0),!n.collapsed||3!==n.startContainer.nodeType)return Sh.none();var r=t.getParent(n.startContainer,t.isBlock)||t.getRoot();return Wa(t,n.startContainer,n.startOffset,(function(t,n,o){return function(t,e){for(var o=n-1;0<=o;o--){var r=t.charAt(o);if(Ga(r))return Sh.none();if(r===e)break}return Sh.some(o)}(o,e).getOr(n)}),r).bind((function(t){var r=n.cloneRange();if(r.setStart(t.container,t.offset),r.setEnd(n.endContainer,n.endOffset),r.collapsed)return Sh.none();var i=ja(r);return 0!==i.lastIndexOf(e)||Xa(i,e).length<o?Sh.none():Sh.some({text:Xa(i,e),range:r,triggerChar:e})}))}(t,n,e,o)}),(function(n){var o=t.createRng();o.selectNode(n.dom);var r=ja(o);return Sh.some({range:o,text:Xa(r,e),triggerChar:e})}))}function qa(t,n){return{container:t,offset:n}}function Ka(t){return Vn("toolbarbutton",Gk,t)}function Ja(t){return Vn("ToggleButton",Yk,t)}function $a(t,n,e,o){void 0===o&&(o={});var r=n(),i=t.selection.getRng().startContainer.nodeValue,u=k(r.lookupByChar(e.triggerChar),(function(n){return e.text.length>=n.minChars&&n.matches.getOrThunk((function(){return n=t.dom,function(t){var e=Nk(t.startContainer,t.startOffset);return!Wa(n,e.container,e.offset,(function(t,n){return 0===n?-1:n}),n.getRoot()).filter((function(t){return!Ga(t.container.data.charAt(t.offset-1))})).isSome()};var n}))(e.range,i,e.text)}));if(0===u.length)return Sh.none();var a=Hk.all(w(u,(function(t){return t.fetch(e.text,t.maxResults,o).then((function(n){return{matchText:e.text,items:n,columns:t.columns,onAction:t.onAction,highlightOn:t.highlightOn}}))})));return Sh.some({lookupData:a,context:e})}function Qa(t){return G(sC,t).getOr(aC)}function Za(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:"color"===t?"tox-swatches":"tox-menu",tieredMenu:"tox-tiered-menu"}}function tc(t){var n=Za(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:Qa(t)}}function nc(t,n,e){return{dom:{tag:"div",classes:E([[Za(e).tieredMenu]])},markers:tc(e)}}function ec(t,n){return function(e){
return w(x(e,n),(function(n){return{dom:t,components:n}}))}}function oc(t,n){var e=[],o=[];return Th(t,(function(t,r){n(t,r)?(0<o.length&&e.push(o),o=[],Ah(t.dom,"innerHtml")&&o.push(t)):o.push(t)})),0<o.length&&e.push(o),w(e,(function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}}))}function rc(t,n){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===t?["tox-collection--list"]:["tox-collection--grid"])},components:[yk.parts.items({preprocess:function(e){return"auto"!==t&&1<t?ec({tag:"div",classes:["tox-collection__group"]},t)(e):oc(e,(function(t,e){return"separator"===n[e].type}))}})]}}function ic(t){return b(t,(function(t){return"icon"in t&&void 0!==t.icon}))}function uc(t){return console.error(Qv(t)),console.log(t),Sh.none()}function ac(t,n,e){var o,r=(o=e,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[yk.parts.items({preprocess:function(t){return oc(t,(function(t,n){return"separator"===o[n].type}))}})]});return{value:t,dom:r.dom,components:r.components,items:e}}function cc(t,n,e,o,r){var i,u;return"color"===r?{value:t,dom:(i={dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[yk.parts.items({preprocess:"auto"!==o?ec({tag:"div",classes:["tox-swatches__row"]},o):c})]}]}).dom,components:i.components,items:e}:"normal"===r&&"auto"===o?{value:t,dom:(i=rc(o,e)).dom,components:i.components,items:e}:"normal"===r&&1===o?{value:t,dom:(i=rc(1,e)).dom,components:i.components,items:e}:"normal"===r?{value:t,dom:(i=rc(o,e)).dom,components:i.components,items:e}:"listpreview"!==r||"auto"===o?{value:t,dom:{tag:"div",classes:E([[(u=Za(r)).menu,"tox-menu-"+o+"-column"],n?[u.hasIcons]:[]])},components:vC,items:e}:{value:t,dom:(i={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[yk.parts.items({preprocess:ec({tag:"div",classes:["tox-collection__group"]},o)})]}).dom,components:i.components,items:e}}function sc(t,n,e){var o=Hr(t.element,"."+e);if(0<o.length){var r=T(o,(function(t){var e=t.dom.getBoundingClientRect().top,r=o[0].dom.getBoundingClientRect().top;return Math.abs(e-r)>n})).getOr(o.length);return Sh.some({numColumns:r,numRows:Math.ceil(o.length/r)})}return Sh.none()}function lc(t){t.getSystem().broadcastOn([FC],{})}function fc(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))}function dc(t){return t.getParam("width",zC.DOM.getStyle(t.getElement(),"width"))}function mc(t){return Sh.from(t.getParam("min_width")).filter(ph)}function gc(t){return Sh.from(t.getParam("min_height")).filter(ph)}function pc(t){return Sh.from(t.getParam("max_width")).filter(ph)}function hc(t){return Sh.from(t.getParam("max_height")).filter(ph)}function vc(t){return!1!==t.getParam("menubar",!0,"boolean")}function bc(t){var n=t.getParam("toolbar",!0),e=!0===n,o=ah(n),r=sh(n)&&0<n.length;return!LC(t)&&(r||o||e)}function yc(t){var n=k(y(9,(function(n){return t.getParam("toolbar"+(n+1),!1,"string")})),(function(t){return"string"==typeof t}));return 0<n.length?Sh.some(n):Sh.none()}function xc(t){return t.getParam("toolbar_mode","","string")}function wc(t){return t.getParam("toolbar_location",rC.auto,"string")}function Sc(t){return wc(t)===rC.bottom}function kc(t){if(!t.inline)return Sh.none();var n=t.getParam("fixed_toolbar_container","","string");if(0<n.length)return po(dv(),n);var e=t.getParam("fixed_toolbar_container_target");return mh(e)?Sh.some(Ph.fromDom(e)):Sh.none()}function Cc(t){return t.inline&&kc(t).isSome()}function Oc(t){return kc(t).getOrThunk((function(){return St(cv(Ph.fromDom(t.getElement())))}))}function _c(t){return t.inline&&!vc(t)&&!bc(t)&&!LC(t)}function Tc(t){return(t.getParam("toolbar_sticky",!1,"boolean")||t.inline)&&!Cc(t)&&!_c(t)}function Ec(t,n){var e=t.outerContainer.element;n&&(t.mothership.broadcastOn([iw()],{target:e}),t.uiMothership.broadcastOn([iw()],{target:e})),t.mothership.broadcastOn([GC],{readonly:n}),t.uiMothership.broadcastOn([GC],{readonly:n})}function Dc(t,n){t.on("init",(function(){t.mode.isReadOnly()&&Ec(n,!0)})),t.on("SwitchMode",(function(){return Ec(n,t.mode.isReadOnly())})),t.getParam("readonly",!1,"boolean")&&t.setMode("readonly")}function Bc(){var t;return ux.config({channels:((t={})[GC]={schema:XC,onReceive:function(t,n){tS.set(t,n.readonly)}},t)})}function Mc(t,n){var e=t.getApi(n);return function(t){t(e)}}function Ac(t,n){return ny((function(e){Mc(t,e)((function(e){var o=t.onSetup(e);gh(o)&&n.set(o)}))}))}function Fc(t,n){return ey((function(e){return Mc(t,e)(n.get())}))}function Ic(t,n,e,o){var r,u,a=fe(i);return{type:"item",dom:n.dom,components:JC(n.optComponents),data:t.data,eventOrder:KC,hasSubmenu:t.triggersSubmenu,itemBehaviours:ex([ra("item-events",[(r=t,u=e,ry((function(t,n){Mc(r,t)(r.onAction),r.triggersSubmenu||u!==uC.CLOSE_ON_EXECUTE||(we(t,Vb()),n.stop())}))),Ac(t,a),Fc(t,a)]),tS.config({disabled:function(){return t.disabled||o.isDisabled()},disableClass:"tox-collection__item--state-disabled"}),Bc(),tk.config({})].concat(t.itemBehaviours))}}function Rc(t){return{value:t.value,meta:yh({text:t.text.getOr("")},t.meta)}}function Vc(t,n,e){return Pa(t,{tag:"div",classes:e=void 0===e?[fC]:e},n)}function Pc(t){return{dom:{tag:"div",classes:[dC]},components:[co(Mk.translate(t))]}}function Hc(t,n){return{dom:{tag:"div",classes:n,innerHtml:t}}}function zc(t,n){return{dom:{tag:"div",classes:[dC]},components:[{dom:{tag:t.tag,styles:t.styles},components:[co(Mk.translate(n))]}]}}function Nc(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:(n=$C.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},e=w(t.split("+"),(function(t){var e=t.toLowerCase().trim();return Ah(n,e)?n[e]:t})),$C.mac?e.join(""):e.join("+"))}};var n,e}function Lc(t){return Vc("checkmark",t,["tox-collection__item-checkmark"])}function Wc(t){var n=t.map((function(t){return{attributes:{title:Mk.translate(t)}}})).getOr({});return yh({tag:"div",classes:[aC,cC]},n)}function Uc(t,n,e,o){return void 0===o&&(o=Sh.none()),"color"===t.presets?(r=n,i=o,c=t.ariaLabel,s=t.value,{dom:(u=t.iconContent.map((function(t){return n=r.icons,e=i,Fa(t,o=n()).or(e).getOrThunk(Ma(o));var n,e,o})).getOr(""),a={tag:"div",attributes:c.map((function(t){return{title:r.translate(t)}})).getOr({}),classes:["tox-swatch"]},yh(yh({},a),"custom"===s?{tag:"button",classes:g(g([],a.classes,!0),["tox-swatches__picker-btn"],!1),innerHtml:u}:"remove"===s?{classes:g(g([],a.classes,!0),["tox-swatch--remove"],!1),innerHtml:u}:{attributes:yh(yh({},a.attributes),{"data-mce-color":s}),styles:{"background-color":s}})),optComponents:[]}):(f=t,d=n,m=o,p={tag:"div",classes:[fC]},h=e?f.iconContent.map((function(t){return Pa(t,p,d.icons,m)})).orThunk((function(){return Sh.some({dom:p})})):Sh.none(),v=f.checkMark,b=Sh.from(f.meta).fold((function(){return Pc}),(function(t){return Ah(t,"style")?l(zc,t.style):Pc})),y=f.htmlContent.fold((function(){return f.textContent.map(b)}),(function(t){return Sh.some(Hc(t,[dC]))})),{dom:Wc(f.ariaLabel),optComponents:[h,y,f.shortcutContent.map(Nc),v,f.caret]});var r,i,u,a,c,s,f,d,m,p,h,v,b,y}function jc(t,n){return G(t,"tooltipWorker").map((function(t){return[HC.config({lazySink:n.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{type:"submenu",item:t,overrides:{maxHeightFunction:xx}}},mode:"follow-highlight",onShow:function(n){t((function(t){HC.setComponents(n,[ky({element:Ph.fromDom(t)})])}))}})]})).getOr([])}function Gc(t,n){var e=Mk.translate(t),o=zC.DOM.encode(e);if(0<n.length){var r=new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");return o.replace(r,(function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"}))}return o}function Xc(t){return{value:t}}function Yc(t){return tO.test(t)||nO.test(t)}function qc(t){var n=t.toString(16);return(1===n.length?"0"+n:n).toUpperCase()}function Kc(t){return Xc(qc(t.red)+qc(t.green)+qc(t.blue))}function Jc(t,n,e,o){return{red:t,green:n,blue:e,alpha:o}}function $c(t){var n=parseInt(t,10);return n.toString()===t&&0<=n&&n<=255}function Qc(t){var n,e,o,r=(t.hue||0)%360,i=t.saturation/100,u=t.value/100;i=oO(0,eO(i,1)),u=oO(0,eO(u,1));if(0===i)return Jc(n=e=o=rO(255*u),e,o,1);var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),l=u-c;switch(Math.floor(a)){case 0:n=c,e=s,o=0;break;case 1:n=s,e=c,o=0;break;case 2:n=0,e=c,o=s;break;case 3:n=0,e=s,o=c;break;case 4:n=s,e=0,o=c;break;case 5:n=c,e=0,o=s;break;default:n=e=o=0}return Jc(n=rO(255*(n+l)),e=rO(255*(e+l)),o=rO(255*(o+l)),1)}function Zc(t){var n,e,o=(n={value:t.value.replace(tO,(function(t,n,e,o){return n+n+e+e+o+o}))},null===(e=nO.exec(n.value))?["FFFFFF","FF","FF","FF"]:e);return Jc(parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16),1)}function ts(t,n,e,o){return Jc(parseInt(t,10),parseInt(n,10),parseInt(e,10),parseFloat(o))}function ns(t){if("transparent"===t)return Sh.some(Jc(0,0,0,0));var n=iO.exec(t);if(null!==n)return Sh.some(ts(n[1],n[2],n[3],"1"));var e=uO.exec(t);return null!==e?Sh.some(ts(e[1],e[2],e[3],e[4])):Sh.none()}function es(t){return"rgba("+t.red+","+t.green+","+t.blue+","+t.alpha+")"}function os(t,n){return t.fire("ResizeContent",n)}function rs(t,n,e){return{hue:t,saturation:n,value:e}}function is(t){var n,e,o=0,r=t.red/255,i=t.green/255,u=t.blue/255,a=Math.min(r,Math.min(i,u)),c=Math.max(r,Math.max(i,u));return a===c?rs(0,0,100*(o=a)):(e=60*((r===a?3:u===a?1:5)-(r===a?i-u:u===a?r-i:u-r)/(c-a)),n=(c-a)/c,o=c,rs(Math.round(e),Math.round(100*n),Math.round(100*o)))}function us(t){return Kc(Qc(t))}function as(t){return(Yc(e=t)?Sh.some({value:(Ih(n=e,"#")?n.substring("#".length):n).toUpperCase()}):Sh.none()).orThunk((function(){return ns(t).map(Kc)})).getOrThunk((function(){var n=document.createElement("canvas");n.height=1,n.width=1;var e=n.getContext("2d");e.clearRect(0,0,n.width,n.height),e.fillStyle="#FFFFFF",e.fillStyle=t,e.fillRect(0,0,1,1);var o=e.getImageData(0,0,1,1).data;return Kc(Jc(o[0],o[1],o[2],o[3]))}));var n,e}function cs(t){return tS.config({disabled:t,disableClass:"tox-tbtn--disabled"})}function ss(t){return!1!==t.getParam("custom_colors")}function ls(t){var n=t.getParam("color_map");return void 0!==n?function(t){for(var n=[],e=0;e<t.length;e+=2)n.push({text:t[e+1],value:"#"+as(t[e]).value,type:"choiceitem"});return n}(n):fO}function fs(t){dO.add(t)}function ds(t){var n,e=(n=ls(t).length,Math.max(5,Math.ceil(Math.sqrt(n))));return t.getParam("color_cols",e,"number")}function ms(t){var n="choiceitem",e={type:n,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return t?[e,{type:n,text:"Custom color",icon:"color-picker",value:"custom"}]:[e]}function gs(t,n,e,o){"custom"===e?gO(t)((function(e){e.each((function(e){fs(e),t.execCommand("mceApplyTextcolor",n,e),o(e)}))}),mO):"remove"===e?(o(""),t.execCommand("mceRemoveTextcolor",n)):(o(e),t.execCommand("mceApplyTextcolor",n,e))}function ps(t,n){return t.concat(w(dO.state(),(function(t){return{type:lO,text:t,value:t}})).concat(ms(n)))}function hs(t,n){return function(e){e(ps(t,n))}}function vs(t,n,e){t.setIconFill("forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",e)}function bs(t,n,e,o,r){t.ui.registry.addSplitButton(n,{tooltip:o,presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:function(n){var o,r=e;return t.dom.getParents(t.selection.getStart(),(function(t){var n;(n=t.style["forecolor"===r?"color":"background-color"])&&(o=o||n)})),Sh.from(o).bind((function(t){return ns(t).map((function(t){var e=Kc(t).value;return $(n.toLowerCase(),e)}))})).getOr(!1)},columns:ds(t),fetch:hs(ls(t),ss(t)),onAction:function(){gs(t,e,r.get(),i)},onItemAction:function(o,i){gs(t,e,i,(function(e){r.set(e),t.fire("TextColorChange",{name:n,color:e})}))},onSetup:function(e){function o(t){t.name===n&&vs(e,t.name,t.color)}return vs(e,n,r.get()),t.on("TextColorChange",o),function(){t.off("TextColorChange",o)}}})}function ys(t,n,e,o){t.ui.registry.addNestedMenuItem(n,{text:o,icon:"forecolor"===n?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(n){gs(t,e,n.value,i)}}]}})}function xs(t,n,e,o,r,i,u,a){return cc(t,ic(n),pO(n,e,o,"color"!==r?"normal":"color",i,u,a),o,r)}function ws(t,n){var e=tc(n);return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group")}}function Ss(t,n){return co(n+"x"+t)}function ks(t,n,e,o,r,u,c){var s=1===o,l=!s||ic(t);return q(w(t,(function(t){switch(t.type){case"separator":return Vn("Autocompleter.Separator",Lk,t).fold(uc,(function(t){return Sh.some(yO(t))}));case"cardmenuitem":return Vn("cardmenuitem",OC,t).fold(uc,(function(t){return Sh.some((o=yh(yh({},t),{onAction:function(n){t.onAction(n),e(t.value,t.meta)}}),i=r,a=u,s={itemBehaviours:jc(t.meta,u),cardText:{matchText:n,highlightOn:c}},l={dom:Wc(o.label),optComponents:[Sh.some({dom:{tag:"div",classes:[pC,hC]},components:QC(o.items,s)})]},Ic({data:Rc(yh({text:Sh.none()},o)),disabled:o.disabled,getApi:function(t){return{isDisabled:function(){return tS.isDisabled(t)},setDisabled:function(n){tS.set(t,n),Th(Hr(t.element,"*"),(function(e){t.getSystem().getByDom(e).each((function(t){t.hasConfigured(tS)&&tS.set(t,n)}))}))}}},onAction:o.onAction,onSetup:o.onSetup,triggersSubmenu:!1,itemBehaviours:Sh.from(s.itemBehaviours).getOr([])},l,i,a.providers)));var o,i,a,s,l}));default:return Vn("Autocompleter.Item",Wk,t).fold(uc,(function(t){return Sh.some(function(t,n,e,o,r,u,c,s){void 0===s&&(s=!0);var l=Uc({presets:"normal",textContent:Sh.none(),htmlContent:e?t.text.map((function(t){return Gc(t,n)})):Sh.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:Sh.none(),checkMark:Sh.none(),caret:Sh.none(),value:t.value},c.providers,s,t.icon);return Ic({data:Rc(t),disabled:t.disabled,getApi:a({}),onAction:function(){return r(t.value,t.meta)},onSetup:a(i),triggersSubmenu:!1,itemBehaviours:jc(t.meta,c)},l,u,c.providers)}(t,n,s,0,e,r,u,l))}))}})))}function Cs(t,n,e,o,r){var i=ic(n),u=q(w(n,(function(t){function n(t){return function(t,n,e,o,r){function i(t){return r?yh(yh({},t),{shortcut:Sh.none(),icon:t.text.isSome()?Sh.none():t.icon}):t}var u=e.shared.providers;switch(t.type){case"menuitem":return Vn("menuitem",DC,t).fold(uc,(function(t){return Sh.some(xO(i(t),n,u,o))}));case"nestedmenuitem":return Vn("nestedmenuitem",BC,t).fold(uc,(function(t){return Sh.some(wO(i(t),n,u,o,r))}));case"togglemenuitem":return Vn("togglemenuitem",MC,t).fold(uc,(function(t){return Sh.some(SO(i(t),n,u,o))}));case"separator":return Vn("separatormenuitem",Lk,t).fold(uc,(function(t){return Sh.some(yO(t))}));case"fancymenuitem":return Vn("fancymenuitem",EC,t).fold(uc,(function(t){return kO(i(t),e)}));default:return console.error("Unknown item in general menu",t),Sh.none()}}(t,e,o,r?!Ah(t,"text"):i,r)}return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?n(yh(yh({},t),{disabled:!0})):n(t)})));return(r?ac:cc)(t,i,u,1,"normal")}function Os(t){return Ck.singleData(t.value,t)}function _s(t,n,e){return ho(t,n,e).isSome()}function Ts(t,n){var e=null;return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},schedule:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];e=setTimeout((function(){t.apply(null,o),e=null}),n)}}}function Es(t){var n=t.raw;return void 0===n.touches||1!==n.touches.length?Sh.none():Sh.some(n.touches[0])}function Ds(){return rv().browser.isFirefox()}function Bs(t,n){var e,o,r,i,u,a,c,s,l,f=yh({stopBackspace:!0},n),d=(u=f,a=lr(),c=fe(!1),s=Ts((function(t){u.triggerEvent(Rb(),t),c.set(!0)}),400),l=ge([{key:ab(),value:function(t){return Es(t).each((function(n){s.cancel();var e={x:n.clientX,y:n.clientY,target:t.target};s.schedule(t),c.set(!1),a.set(e)})),Sh.none()}},{key:cb(),value:function(t){return s.cancel(),Es(t).each((function(t){a.on((function(n){var e=t,o=n,r=Math.abs(e.clientX-o.x),i=Math.abs(e.clientY-o.y);(5<r||5<i)&&a.clear()}))})),Sh.none()}},{key:sb(),value:function(t){return s.cancel(),a.get().filter((function(n){return st(n.target,t.target)})).map((function(){return c.get()?(t.prevent(),!1):u.triggerEvent(Ib(),t)}))}}]),{fireIfReady:function(t,n){return G(l,n).bind((function(n){return n(t)}))}}),m=w(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(n){return fr(t,n,(function(t){d.fireIfReady(t,n).each((function(n){n&&t.kill()})),f.triggerEvent(n,t)&&t.kill()}))})),g=lr(),p=fr(t,"paste",(function(t){d.fireIfReady(t,"paste").each((function(n){n&&t.kill()})),f.triggerEvent("paste",t)&&t.kill(),g.set(setTimeout((function(){f.triggerEvent(Bb(),t)}),0))})),h=fr(t,"keydown",(function(t){var n;f.triggerEvent("keydown",t)?t.kill():!f.stopBackspace||(n=t).raw.which!==oS[0]||_h(["input","textarea"],nt(n.target))||_s(n.target,'[contenteditable="true"]')||t.prevent()})),v=(e=t,o=function(t){f.triggerEvent("focusin",t)&&t.kill()},Ds()?dr(e,"focus",o):fr(e,"focusin",o)),b=lr(),y=(r=t,i=function(t){f.triggerEvent("focusout",t)&&t.kill(),b.set(setTimeout((function(){f.triggerEvent(Db(),t)}),0))},Ds()?dr(r,"blur",i):fr(r,"focusout",i));return{unbind:function(){Th(m,(function(t){t.unbind()})),h.unbind(),v.unbind(),y.unbind(),p.unbind(),g.on(clearTimeout),b.on(clearTimeout)}}}function Ms(t,n){return fe(G(t,"target").getOr(n))}function As(t,n,e,o,r,i){var u,a,c=t(n,o),s=(u=fe(!1),a=fe(!1),{stop:function(){u.set(!0)},cut:function(){a.set(!0)},isStopped:u.get,isCut:a.get,event:e,setSource:r.set,getSource:r.get});return c.fold((function(){return i.logEventNoHandlers(n,o),CO.complete()}),(function(t){var e=t.descHandler;return Xe(e)(s),s.isStopped()?(i.logEventStopped(n,t.element,e.purpose),CO.stopped()):s.isCut()?(i.logEventCut(n,t.element,e.purpose),CO.complete()):pt(t.element).fold((function(){return i.logNoParent(n,t.element,e.purpose),CO.complete()}),(function(o){return i.logEventResponse(n,t.element,e.purpose),CO.resume(o)}))}))}function Fs(){function t(t){ze(t.element).each((function(t){delete o[t],e.unregisterId(t)}))}var n,e=(n={},{registerId:function(t,e,o){N(o,(function(o,r){var i,u=void 0!==n[r]?n[r]:{};u[e]={cHandler:l.apply(void 0,[(i=o).handler].concat(t)),purpose:i.purpose},n[r]=u}))},unregisterId:function(t){N(n,(function(n){Ah(n,t)&&delete n[t]}))},filterByType:function(t){return G(n,t).map((function(t){return W(t,(function(t,n){return{id:n,descHandler:t}}))})).getOr([])},find:function(t,e,o){return G(n,e).bind((function(n){return ve(o,(function(t){return e=n,ze(o=t).bind((function(t){return G(e,t)})).map((function(t){return{element:o,descHandler:t}}));var e,o}),t)}))}}),o={};return{find:function(t,n,o){return e.find(t,n,o)},filter:function(t){return e.filterByType(t)},register:function(n){var r,i=ze((r=n).element).getOrThunk((function(){return t=r.element,n=He(ly+"uid-"),dy(t,n),n;var t,n}));X(o,i)&&function(n){var e=o[i];if(e!==n)throw new Error('The tagId "'+i+'" is already used by: '+Pe(e.element)+"\nCannot use it for: "+Pe(n.element)+"\nThe conflicting element is"+(fv(e.element)?" ":" not ")+"already in the DOM");t(n)}(n),e.registerId([n],i,n.events),o[i]=n},unregister:t,getById:function(t){return G(o,t)}}}function Is(t){function n(n){return pt(t.element).fold(vh,(function(t){return st(n,t)}))}function e(t,e){return r.find(n,t,e)}function o(t){var n=r.filter(Mb());Th(n,(function(n){Xe(n.descHandler)(t)}))}var r=Fs(),u=Bs(t.element,{triggerEvent:function(t,n){return bo(t,n.target,(function(o){return _O(e,t,n,n.target,o)}))}}),c={debugInfo:a("real"),triggerEvent:function(t,n,o){bo(t,n,(function(r){return _O(e,t,o,n,r)}))},triggerFocus:function(t,n){ze(t).fold((function(){Ko(t)}),(function(){bo(Eb(),t,(function(o){var r,u,a=e,c=Eb(),s=o,l=Ms(r={originator:n,kill:i,prevent:i,target:t},u=t);return As(a,c,r,u,l,s),!1}))}))},triggerEscape:function(t,n){c.triggerEvent("keydown",t.element,n.event)},getByUid:function(t){return v(t)},getByDom:function(t){return b(t)},build:Oy,addToGui:function(t){f(t)},removeFromGui:function(t){m(t)},addToWorld:function(t){s(t)},removeFromWorld:function(t){l(t)},broadcast:function(t){g(t)},broadcastOn:function(t,n){p(t,n)},broadcastEvent:function(t,n){h(t,n)},isConnected:vh},s=function(t){t.connect(c),Lh(t.element)||(r.register(t),Th(t.components(),s),c.triggerEvent(Hb(),t.element,{target:t.element}))},l=function(t){Lh(t.element)||(Th(t.components(),l),r.unregister(t)),t.disconnect()},f=function(n){oi(t,n)},m=function(t){ii(t)},g=function(t){o({universal:!0,data:t})},p=function(t,n){o({universal:!1,channels:t,data:n})},h=function(t,n){var e,o,u=r.filter(t);return o={stop:function(){e.set(!0)},cut:i,isStopped:(e=fe(!1)).get,isCut:hh,event:n,setSource:d("Cannot set source of a broadcasted event"),getSource:d("Cannot get source of a broadcasted event")},Th(u,(function(t){Xe(t.descHandler)(o)})),o.isStopped()},v=function(t){return r.getById(t).fold((function(){return Bv.error(new Error('Could not find component with uid: "'+t+'" in system.'))}),Bv.value)},b=function(t){var n=ze(t).getOr("not found");return v(n)};return s(t),{root:t,element:t.element,destroy:function(){u.unbind(),Sv(t.element)},add:f,remove:m,getByUid:v,getByDom:b,addToWorld:s,removeFromWorld:l,broadcast:g,broadcastOn:p,broadcastEvent:h}}function Rs(t,n,e,o){var r=IO(t,n,e,o);return BO.sketch(r)}function Vs(t,n){return BO.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})}function Ps(t){return ex([ok.config({onFocus:t.selectOnFocus?function(t){var n=t.element,e=eo(n);n.dom.setSelectionRange(0,e.length)}:i})])}function Hs(t){return{tag:t.tag,attributes:yh({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}}function zs(t,n){function e(){return a.get().isSome()}function o(){e()&&Ok.hide(l)}function r(t,n){Se(t,bb(),{raw:n})}var i,u,a=lr(),s=fe(!1),l=Oy(Ok.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:ex([ra("dismissAutocompleter",[Ee(Gb(),(function(){return f()}))])]),lazySink:n.getSink})),f=function(){var n;e()&&(n=a.get().map((function(t){return t.element})),Pk(n.getOr(Ph.fromDom(t.selection.getNode()))).each(nn),o(),a.clear(),s.set(!1))},d=ot((function(){return o=L(t.ui.registry.getAll().popups,(function(t){return Vn("Autocompleter",Uk,t).fold((function(t){throw new Error(Qv(t))}),c)})),n=W(o,(function(t){return t.ch})),e={},Th(n,(function(t){e[t]={}})),r=Dh(e),i=j(o),{dataset:o,triggerChars:r,lookupByChar:function(t){return k(i,(function(n){return n.ch===t}))}};var n,e,o,r,i})),m=function(r){var i=r;a.get().map((function(n){return Ya(t.dom,t.selection.getRng(),n.triggerChar).bind((function(n){return $a(t,d,n,i)}))})).getOrThunk((function(){return n=t,o=(e=d)(),r=n.selection.getRng(),i=n.dom,u=r,z(o.triggerChars,(function(t){return Ya(i,u,t)})).bind((function(t){return $a(n,e,t)}));var n,e,o,r,i,u})).fold(f,(function(r){var i,u=r.context;e()||(i=Ua(t,u.range),a.set({triggerChar:u.triggerChar,element:i,matchLength:u.text.length}),s.set(!1)),r.lookupData.then((function(e){a.get().map((function(i){var u,a,c,d,g=r.context;i.triggerChar===g.triggerChar&&(a=g.triggerChar,d=z(c=e,(function(t){return Sh.from(t.columns)})).getOr(1),0<(u=D(c,(function(e){return ks(e.items,e.matchText,(function(n,r){var i=t.selection.getRng();Ya(t.dom,i,a).fold((function(){return console.error("Lost context. Cursor probably moved")}),(function(t){var i=t.range,u={hide:function(){f()},reload:function(t){o(),m(t)}};s.set(!0),e.onAction(u,i,n,r),s.set(!1)}))}),d,uC.BUBBLE_TO_SANDBOX,n,e.highlightOn)}))).length?function(n,e,o,r){n.matchLength=e.text.length;var i,u,a,c,s,f,d=z(o,(function(t){return Sh.from(t.columns)})).getOr(1);Ok.showAt(l,yk.sketch((i=cc("autocompleter-value",!0,r,d,"normal"),u=d,c=((a=UC.ContentFocus)===UC.ContentFocus?lu:su)(),s=ws(u,"normal"),f=tc("normal"),{dom:i.dom,components:i.components,items:i.items,value:i.value,markers:{selectedItem:f.selectedItem,item:f.item},movement:s,fakeFocus:a===UC.ContentFocus,focusManager:c,menuBehaviours:AC("auto"!==u?[]:[ny((function(t){sc(t,4,f.item).each((function(n){var e=n.numColumns,o=n.numRows;QS.setGridSize(t,o,e)}))}))])})),{anchor:{type:"node",root:Ph.fromDom(t.getBody()),node:Sh.from(n.element)}}),Ok.getContent(l).each(eS.highlightFirst)}(i,g,e,u):(10<=g.text.length-i.matchLength?f:o)())}))}))}))},g={onKeypress:La((function(t){27!==t.which&&m()}),50),cancelIfNecessary:f,isMenuOpen:function(){return Ok.isOpen(l)},isActive:e,isProcessingAction:s.get,getView:function(){return Ok.getContent(l)}};!1===t.hasPlugin("rtc")&&(i=g,(u=t).on("keypress compositionend",i.onKeypress.throttle),u.on("remove",i.onKeypress.cancel),u.on("keydown",(function(t){function n(){return i.getView().bind(eS.getHighlighted)}8===t.which&&i.onKeypress.throttle(t),i.isActive()&&(27===t.which&&i.cancelIfNecessary(),i.isMenuOpen()?13===t.which?(n().each(ke),t.preventDefault()):40===t.which?(n().fold((function(){i.getView().each(eS.highlightFirst)}),(function(n){r(n,t)})),t.preventDefault(),t.stopImmediatePropagation()):37!==t.which&&38!==t.which&&39!==t.which||n().each((function(n){r(n,t),t.preventDefault(),t.stopImmediatePropagation()})):13!==t.which&&38!==t.which&&40!==t.which||i.cancelIfNecessary())})),u.on("NodeChange",(function(t){i.isActive()&&!i.isProcessingAction()&&Pk(Ph.fromDom(t.element)).isNone()&&i.cancelIfNecessary()})))}function Ns(t){setTimeout((function(){throw t}),0)}function Ls(t){var n=nt(t);return _h(o_,n)}function Ws(t,n){Qe(n.getRoot(t).getOr(t.element),n.invalidClass),n.notify.each((function(n){Ls(t.element)&&Ot(t.element,"aria-invalid",!1),n.getContainer(t).each((function(t){Ve(t,n.validHtml)})),n.onValid(t)}))}function Us(t,n,e,o){$e(n.getRoot(t).getOr(t.element),n.invalidClass),n.notify.each((function(n){Ls(t.element)&&Ot(t.element,"aria-invalid",!0),n.getContainer(t).each((function(t){Ve(t,o)})),n.onInvalid(t,o)}))}function js(t,n){return n.validator.fold((function(){return e_(Bv.value(!0))}),(function(n){return n.validate(t)}))}function Gs(t,n){return n.notify.each((function(n){n.onValidate(t)})),js(t,n).map((function(e){return t.getSystem().isConnected()?e.fold((function(e){return Us(t,n,0,e),Bv.error(e)}),(function(e){return Ws(t,n),Bv.value(e)})):Bv.error("No longer in system")}))}function Xs(t,n){var e=t.getHotspot(n).getOr(n),o=t.getAnchorOverrides();return t.layouts.fold((function(){return{type:"hotspot",hotspot:e,overrides:o}}),(function(t){return{type:"hotspot",hotspot:e,overrides:o,layouts:t}}))}function Ys(t,n,e,o,r,i,u){var a,c=Xs(t,e),s=e,l=o,f=r,d=u,m=n,g=(0,(a=t).fetch)(s).map(m),p=b_(s,a);return g.map((function(t){return t.bind((function(t){return Sh.from(Ck.sketch(yh(yh({},f.menu()),{uid:my(""),data:t,highlightImmediately:d===KO.HighlightFirst,onOpenMenu:function(t,n){var e=p().getOrDie();$x.position(e,n,{anchor:c}),rw.decloak(l)},onOpenSubmenu:function(t,n,e){var o=p().getOrDie();$x.position(o,e,{anchor:{type:"submenu",item:n}}),rw.decloak(l)},onRepositionMenu:function(t,n,e){var o=p().getOrDie();$x.position(o,n,{anchor:c}),Th(e,(function(t){$x.position(o,t.triggeredMenu,{anchor:{type:"submenu",item:t.triggeringItem}})}))},onEscape:function(){return ok.focus(s),rw.close(l),Sh.some(!0)}})))}))})).map((function(t){return t.fold((function(){rw.isOpen(o)&&rw.close(o)}),(function(t){rw.cloak(o),rw.open(o,t),i(o)})),o}))}function qs(t,n,e,o,r,i){var u=c_.getCoupled(e,"sandbox");return(rw.isOpen(u)?function(t,n,e,o){return rw.close(o),e_(o)}:Ys)(t,n,e,u,o,r,i)}function Ks(t){rw.getState(t).each((function(t){Ck.repositionMenus(t)}))}function Js(t,n,e){var o=vo(),r=b_(n,t);return{dom:{tag:"div",classes:t.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:vw(t.sandboxBehaviours,[pw.config({store:{mode:"memory",initialValue:n}}),rw.config({onOpen:function(r,i){var u,a,c,s,l,f,d=Xs(t,n);o.link(n.element),t.matchWidth&&(u=d.hotspot,a=i,c=t.useMinWidth,l=qw.getCurrent(a).getOr(a),f=Xt(u.element),c?Ft(l.element,"min-width",f+"px"):(s=l.element,yv.set(s,f))),t.onOpen(d,r,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(r,i)},onClose:function(t,r){o.unlink(n.element),void 0!==e&&void 0!==e.onClose&&e.onClose(t,r)},isPartOf:function(t,e,o){return Ty(e,o)||Ty(n,o)},getAttachPoint:function(){return r().getOrDie()}}),qw.config({find:function(t){return rw.getState(t).bind((function(t){return qw.getCurrent(t)}))}}),ux.config({channels:yh(yh({},mi({isExtraPart:hh})),gi({doReposition:Ks}))})])}}function $s(t){Ks(c_.getCoupled(t,"sandbox"))}function Qs(){return[ee("sandboxClasses",[]),hw("sandboxBehaviours",[qw,ux,rw,pw])]}function Zs(t){return Hw({name:t+"-edge",overrides:function(n){return n.model.manager.edgeActions[t].fold((function(){return{}}),(function(t){return{events:ty([De(ab(),(function(n,e,o){return t(n,o)}),[n]),De(fb(),(function(n,e,o){return t(n,o)}),[n]),De(db(),(function(n,e,o){o.mouseIsDown.get()&&t(n,o)}),[n])])}}))}})}function tl(t){var n=t.event.raw;return-1===n.type.indexOf("touch")?void 0!==n.clientX?Sh.some(n).map((function(t){return vv(t.clientX,t.clientY)})):Sh.none():void 0!==n.touches&&1===n.touches.length?Sh.some(n.touches[0]).map((function(t){return vv(t.clientX,t.clientY)})):Sh.none()}function nl(t){return t.model.minX}function el(t){return t.model.minY}function ol(t){return t.model.minX-1}function rl(t){return t.model.minY-1}function il(t){return t.model.maxX}function ul(t){return t.model.maxY}function al(t){return t.model.maxX+1}function cl(t){return t.model.maxY+1}function sl(t,n,e){return n(t)-e(t)}function ll(t){return sl(t,il,nl)}function fl(t){return sl(t,ul,el)}function dl(t){return ll(t)/2}function ml(t){return fl(t)/2}function gl(t){return t.stepSize}function pl(t){return t.snapToGrid}function hl(t){return t.snapStart}function vl(t){return t.rounded}function bl(t,n){return void 0!==t[n+"-edge"]}function yl(t){return bl(t,"left")}function xl(t){return bl(t,"right")}function wl(t){return bl(t,"top")}function Sl(t){return bl(t,"bottom")}function kl(t){return t.model.value.get()}function Cl(t,n){return{x:t,y:n}}function Ol(t,n){Se(t,R_(),{value:n})}function _l(t,n,e,o){return t<n?t:e<t?e:t===n?n-1:Math.max(n,t-o)}function Tl(t,n,e,o){return e<t?t:t<n?n:t===e?e+1:Math.min(e,t+o)}function El(t,n,e){return Math.max(n,Math.min(e,t))}function Dl(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,l=t.hasMaxEdge,f=t.minBound,d=t.maxBound,m=t.screenRange,g=s?n-1:n,p=l?e+1:e;if(r<f)return g;if(d<r)return p;var h,v,b,y,x,w=El((x=f,(Math.min(d,Math.max(r,x))-x)/m*o+n),g,p);return u&&n<=w&&w<=e?(h=w,v=n,b=e,y=i,a.fold((function(){var t=Math.round((h-v)/y)*y;return El(v+t,v-1,b+1)}),(function(t){var n=Math.round((h-t)%y/y),e=Math.floor((h-t)/y),o=Math.floor((b-t)/y),r=Math.min(o,e+n);return Math.max(t,t+r*y)}))):c?Math.round(w):w}function Bl(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,l=t.centerMaxEdge;return r<n?i?0:s:e<r?u?a:l:(r-n)/o*c}function Ml(t){return t.element.dom.getBoundingClientRect()}function Al(t){return Ml(t)[V_]}function Fl(t){return Ml(t).right}function Il(t){return Ml(t).top}function Rl(t){return Ml(t).bottom}function Vl(t){return Ml(t).width}function Pl(t){return Ml(t).height}function Hl(t,n){var e=Ml(t),o=Ml(n);return(e[V_]+e.right)/2-o[V_]}function zl(t,n){var e=Ml(t),o=Ml(n);return(e.top+e.bottom)/2-o.top}function Nl(t,n){Se(t,R_(),{value:n})}function Ll(t,n,e){return Dl({min:nl(n),max:il(n),range:ll(n),value:e,step:gl(n),snap:pl(n),snapStart:hl(n),rounded:vl(n),hasMinEdge:yl(n),hasMaxEdge:xl(n),minBound:Al(t),maxBound:Fl(t),screenRange:Vl(t)})}function Wl(t){return function(n,e){return Nl(n,{x:r=(0<t?Tl:_l)(kl(o=e).x,nl(o),il(o),gl(o))}),Sh.some(r).map(vh);var o,r}}function Ul(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g=(a=i,c=e,s=o,l=r,f=Vl(u=n),d=s.bind((function(t){return Sh.some(Hl(t,u))})).getOr(0),m=l.bind((function(t){return Sh.some(Hl(t,u))})).getOr(f),Bl({min:nl(a),max:il(a),range:ll(a),value:c,hasMinEdge:yl(a),hasMaxEdge:xl(a),minBound:Al(u),minOffset:0,maxBound:Fl(u),maxOffset:f,centerMinEdge:d,centerMaxEdge:m}));return Al(n)-Al(t)+g}function jl(t,n){Se(t,R_(),{value:n})}function Gl(t,n,e){return Dl({min:el(n),max:ul(n),range:fl(n),value:e,step:gl(n),snap:pl(n),snapStart:hl(n),rounded:vl(n),hasMinEdge:wl(n),hasMaxEdge:Sl(n),minBound:Il(t),maxBound:Rl(t),screenRange:Pl(t)})}function Xl(t){return function(n,e){return jl(n,{y:r=(0<t?Tl:_l)(kl(o=e).y,el(o),ul(o),gl(o))
}),Sh.some(r).map(vh);var o,r}}function Yl(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g=(a=i,c=e,s=o,l=r,f=Pl(u=n),d=s.bind((function(t){return Sh.some(zl(t,u))})).getOr(0),m=l.bind((function(t){return Sh.some(zl(t,u))})).getOr(f),Bl({min:el(a),max:ul(a),range:fl(a),value:c,hasMinEdge:wl(a),hasMaxEdge:Sl(a),minBound:Il(u),minOffset:0,maxBound:Rl(u),maxOffset:f,centerMinEdge:d,centerMaxEdge:m}));return Il(n)-Il(t)+g}function ql(t,n){Se(t,R_(),{value:n})}function Kl(t,n){return{x:t,y:n}}function Jl(t,n){return function(e,o){return i=o,u=0<t?Tl:_l,ql(e,Kl(a=(r=n)?kl(i).x:u(kl(i).x,nl(i),il(i),gl(i)),r?u(kl(i).y,el(i),ul(i),gl(i)):kl(i).y)),Sh.some(a).map(vh);var r,i,u,a}}function $l(t){return"<alloy.field."+t+">"}function Ql(t,n,e,o){function r(e,o,r,u,a){var c,s,l=t(fT+"range"),f=[BO.parts.label({dom:{tag:"label",innerHtml:r,attributes:{"aria-label":u}}}),BO.parts.field({data:a,factory:XO,inputAttributes:yh({type:"text"},"hex"===o?{"aria-live":"polite"}:{}),inputClasses:[n("textfield")],inputBehaviours:ex([(c=o,s=e,u_.config({invalidClass:n("invalid"),notify:{onValidate:function(t){Se(t,lT,{type:c})},onValid:function(t){Se(t,cT,{type:c,value:pw.getValue(t)})},onInvalid:function(t){Se(t,sT,{type:c,value:pw.getValue(t)})}},validator:{validate:function(n){var e=pw.getValue(n),o=s(e)?Bv.value(!0):Bv.error(t("aria.input.invalid"));return e_(o)},validateOnLoad:!1}})),AO.config({})]),onSetValue:function(t){u_.isInvalid(t)&&u_.run(t).get(i)}})],d="hex"!==o?[BO.parts["aria-descriptor"]({text:l})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:f.concat(d)}}function u(t,n){var e=n.red,o=n.green,r=n.blue;pw.setValue(t,{red:e,green:o,blue:r})}function a(t,n){c.getOpt(t).each((function(t){Ft(t.element,"background-color","#"+n.value)}))}var c=Ba({dom:{tag:"div",classes:[n("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}});return ji({factory:function(){function i(t){return g[t].get()}function s(t,n){g[t].set(n)}function l(t,n){var e=n.event;"hex"!==e.type?s(e.type,Sh.none()):o(t)}function f(t,n){var o,r,c,l,f=n.event;"hex"===f.type?function(t,n){e(t);var o=Xc(n);s("hex",Sh.some(n));var r=Zc(o);u(t,r),m(r),Se(t,oT,{hex:o}),a(t,o)}(t,f.value):(o=t,r=f.type,c=f.value,l=parseInt(c,10),s(r,Sh.some(l)),i("red").bind((function(t){return i("green").bind((function(n){return i("blue").map((function(e){return Jc(t,n,e,1)}))}))})).each((function(t){var n,e,r=(n=o,e=Kc(t),aT.getField(n,"hex").each((function(t){ok.isFocused(t)||pw.setValue(n,{hex:e.value})})),e);Se(o,oT,{hex:r}),a(o,r)})))}function d(n){return{label:t(fT+n+".label"),description:t(fT+n+".description")}}function m(t){var n=t.red,e=t.green,o=t.blue;s("red",Sh.some(n)),s("green",Sh.some(e)),s("blue",Sh.some(o))}var g={red:fe(Sh.some(255)),green:fe(Sh.some(255)),blue:fe(Sh.some(255)),hex:fe(Sh.some("ffffff"))},p=d("red"),h=d("green"),v=d("blue"),b=d("hex");return zv(aT.sketch((function(e){return{dom:{tag:"form",classes:[n("rgb-form")],attributes:{"aria-label":t("aria.color.picker")}},components:[e.field("red",BO.sketch(r($c,"red",p.label,p.description,255))),e.field("green",BO.sketch(r($c,"green",h.label,h.description,255))),e.field("blue",BO.sketch(r($c,"blue",v.label,v.description,255))),e.field("hex",BO.sketch(r(Yc,"hex",b.label,b.description,"ffffff"))),c.asSpec()],formBehaviours:ex([u_.config({invalidClass:n("form-invalid")}),ra("rgb-form-events",[Ee(cT,f),Ee(sT,l),Ee(lT,l)])])}})),{apis:{updateHex:function(t,n){var e;pw.setValue(t,{hex:n.value}),u(t,e=Zc(n)),m(e),a(t,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}})}function Zl(t,n){return ji({name:"ColourPicker",configFields:[Ln("dom"),ee("onValidHex",i),ee("onInvalidHex",i)],factory:function(e){function o(t,n,e){w.getOpt(t).each((function(t){b.setHue(t,e)}))}function r(t,n){S.getOpt(t).each((function(t){v.updateHex(t,n)}))}function i(t,n,e,o){var r=e,i=Zc(n);y.paletteRgba.set(i),y.paletteHue.set(r),Th(o,(function(o){o(t,n,e)}))}function u(t,n){var e,o,r=t.width,i=t.height,u=t.getContext("2d");null!==u&&(u.fillStyle=n,u.fillRect(0,0,r,i),(e=u.createLinearGradient(0,0,r,0)).addColorStop(0,"rgba(255,255,255,1)"),e.addColorStop(1,"rgba(255,255,255,0)"),u.fillStyle=e,u.fillRect(0,0,r,i),(o=u.createLinearGradient(0,0,0,i)).addColorStop(0,"rgba(0,0,0,0)"),o.addColorStop(1,"rgba(0,0,0,1)"),u.fillStyle=o,u.fillRect(0,0,r,i))}var c,s,l,f,d,m,g,p,h,v=Ql(t,n,e.onValidHex,e.onInvalidHex),b=(g=n,p=eT.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[g("sv-palette-spectrum")]}}),h=eT.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[g("sv-palette-thumb")],innerHtml:"<div class="+g("sv-palette-inner-thumb")+' role="presentation"></div>'}}),ji({factory:function(){var t=a({x:0,y:0}),n=ex([qw.config({find:Sh.some}),ok.config({})]);return eT.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[g("sv-palette")]},model:{mode:"xy",getInitialValue:t},rounded:!1,components:[p,h],onChange:function(t,n,e){Se(t,iT,{value:e})},onInit:function(t,n,e){u(e.element.dom,es(aO))},sliderBehaviours:n})},name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:function(t,n,e){var o=e;u(n.components()[0].element.dom,es(Qc(rs(o,100,100))))},setThumb:function(t,n,e){var o=n,r=is(Zc(e));eT.setValue(o,{x:r.saturation,y:100-r.value})}},extraApis:{}})),y={paletteRgba:fe(aO),paletteHue:fe(0)},x=Ba((s=eT.parts.spectrum({dom:{tag:"div",classes:[(c=n)("hue-slider-spectrum")],attributes:{role:"presentation"}}}),l=eT.parts.thumb({dom:{tag:"div",classes:[c("hue-slider-thumb")],attributes:{role:"presentation"}}}),eT.sketch({dom:{tag:"div",classes:[c("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:a({y:0})},components:[s,l],sliderBehaviours:ex([ok.config({})]),onChange:function(t,n,e){Se(t,rT,{value:e})}}))),w=Ba(b.sketch({})),S=Ba(v.sketch({}));return{uid:e.uid,dom:e.dom,components:[w.asSpec(),x.asSpec(),S.asSpec()],behaviours:ex([ra("colour-picker-events",[Ee(oT,(m=[o,function(t,n,e){x.getOpt(t).each((function(t){eT.setValue(t,{y:100-e/360*100})}))},function(t,n){w.getOpt(t).each((function(t){b.setThumb(t,n)}))}],function(t,n){var e=n.event.hex;i(t,e,is(Zc(e)).hue,m)})),Ee(iT,(d=[r],function(t,n){var e=n.event.value,o=y.paletteHue.get();i(t,us(rs(o,e.x,100-e.y)),o,d)})),Ee(rT,(f=[o,r],function(t,n){var e=(100-n.event.value.y)/100*360,o=is(y.paletteRgba.get());i(t,us(rs(e,o.saturation,o.value)),e,f)}))]),qw.config({find:function(t){return S.getOpt(t)}}),QS.config({mode:"acyclic"})])}}})}function tf(t){return gT[t]}function nf(t,n,e){return pw.config(zv({store:{mode:"manual",getValue:n,setValue:e}},t.map((function(t){return{store:{initialValue:t}}})).getOr({})))}function ef(t,n){function e(t,n){n.stop()}function o(t){return function(n,e){Th(t,(function(t){t(n,e)}))}}function r(t,n){tS.isDisabled(t)||u(t,n.event.raw.dataTransfer.files)}function i(t,n){u(t,n.event.raw.target.files)}function u(e,o){var r,i;pw.setValue(e,(r=o,i=hT.explode(n.getSetting("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string")),k(Eh(r),(function(t){return b(i,(function(n){return Rh(t.name.toLowerCase(),"."+n.toLowerCase())}))})))),Se(e,VO,{name:t.name})}var a=Ba({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:ex([ra("input-file-events",[Fe(Sb()),Fe(Ib())])])});return Rs(t.label.map((function(t){return Vs(t,n)})),BO.parts.field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:ex([xT([]),td(),tS.config({}),uk.config({toggleClass:"dragenter",toggleOnExecute:!1}),ra("dropzone-events",[Ee("dragenter",o([e,uk.toggle])),Ee("dragleave",o([e,uk.toggle])),Ee("dragover",e),Ee("drop",o([e,r])),Ee(wb(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:n.translate("Drop an image here")}},Bk.sketch({dom:{tag:"button",innerHtml:n.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(t){a.get(t).element.dom.click()},buttonBehaviours:ex([AO.config({}),YC(n.isDisabled),Bc()])})]}]}}}}),["tox-form__group--stretched"],[])}function of(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:ex([ok.config({ignore:!0}),AO.config({})])}}function rf(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[of([wT]),t,of([ST])],behaviours:ex([mT(1)])}}function uf(t,n){Se(t,bb(),{raw:{which:9,shiftKey:n}})}function af(t,n){var e=n.element;Ze(e,wT)?uf(t,!0):Ze(e,ST)&&uf(t,!1)}function cf(t){return _s(t,["."+wT,"."+ST].join(","),hh)}function sf(t,n){return OT(document.createElement("canvas"),t,n)}function lf(t){var n=sf(t.width,t.height);return CT(n).drawImage(t,0,0),n}function ff(t){return t.naturalWidth||t.width}function df(t){return t.naturalHeight||t.height}function mf(t,n,e){return n=n||"image/png",gh(HTMLCanvasElement.prototype.toBlob)?new $O((function(o,r){t.toBlob((function(t){t?o(t):r()}),n,e)})):(o=t.toDataURL(n,e),new $O((function(t,n){(function(){var t=o.split(","),n=/data:([^;]+)/.exec(t[0]);if(!n)return Sh.none();for(var e=n[1],r=t[1],i=atob(r),u=i.length,a=Math.ceil(u/1024),c=new Array(a),s=0;s<a;++s){for(var l=1024*s,f=Math.min(1024+l,u),d=new Array(f-l),m=l,g=0;m<f;++g,++m)d[g]=i[m].charCodeAt(0);c[s]=new Uint8Array(d)}return Sh.some(new Blob(c,{type:e}))})().fold((function(){n("uri is not base64: "+o)}),t)})));var o}function gf(t,n,e){function o(n,e){return t.then((function(t){return t.toDataURL(n||"image/png",e)}))}return{getType:a(n.type),toBlob:function(){return $O.resolve(n)},toDataURL:a(e),toBase64:function(){return e.split(",")[1]},toAdjustedBlob:function(n,e){return t.then((function(t){return mf(t,n,e)}))},toAdjustedDataURL:o,toAdjustedBase64:function(t,n){return o(t,n).then((function(t){return t.split(",")[1]}))},toCanvas:function(){return t.then(lf)}}}function pf(t,n){return mf(t,n).then((function(n){return gf($O.resolve(t),n,t.toDataURL())}))}function hf(t){return n=t,new $O((function(t){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(n)})).then((function(n){return gf((e=t,new $O((function(t,n){function o(){i.removeEventListener("load",u),i.removeEventListener("error",a)}var r=URL.createObjectURL(e),i=new Image,u=function(){o(),t(i)},a=function(){o(),n("Unable to load data of type "+e.type+": "+r)};i.addEventListener("load",u),i.addEventListener("error",a),i.src=r,i.complete&&setTimeout(u,0)})).then((function(t){_T(t);var n=sf(ff(t),df(t));return CT(n).drawImage(t,0,0),n}))),t,n);var e}));var n}function vf(t,n,e){var o="string"==typeof t?parseFloat(t):t;return e<o?o=e:o<n&&(o=n),o}function bf(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]}function yf(t,n){for(var e=[],o=new Array(25),r=0;r<5;r++){for(var i=0;i<5;i++)e[i]=n[i+5*r];for(i=0;i<5;i++){for(var u=0,a=0;a<5;a++)u+=t[i+5*a]*e[a];o[i+5*r]=u}}return o}function xf(t,n){return t.toCanvas().then((function(e){return ET(e,t.getType(),n)}))}function wf(t){return function(n,e){return xf(n,t(bf(),e))}}function Sf(t,n){void 0===n&&(n=2);var e=Math.pow(10,n),o=Math.round(t*e);return Math.ceil(o/e)}function kf(t){return DT(t)}function Cf(t){return AT(t)}function Of(t,n){return FT(t,n)}function _f(t,n){return BT(t,n)}function Tf(t,n){return MT(t,n)}function Ef(t,n){return o=n,(e=t).toCanvas().then((function(t){return PT(t,e.getType(),o)}));var e,o}function Df(t,n){return o=n,(e=t).toCanvas().then((function(t){return VT(t,e.getType(),o)}));var e,o}function Bf(t,n,e){return Pa(t,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:e},n)}function Mf(t,n){return Bf(t,n,[])}function Af(t,n){return Bf(t,n,[tk.config({})])}function Ff(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:ex([tk.config({})])}}function If(t,n,e){function o(t,n){var e=pw.getValue(t);return ok.focus(e),Se(e,"keydown",{raw:n.event.raw}),w_.close(e),Sh.some(!0)}var r=fe(i),u=t.text.map((function(t){return Ba(Ff(t,n,e.providers))})),a=t.icon.map((function(t){return Ba(Af(t,e.providers.icons))})),c=t.role.fold((function(){return{}}),(function(t){return{role:t}})),s=t.tooltip.fold((function(){return{}}),(function(t){var n=e.providers.translate(t);return{title:n,"aria-label":n}})),f=Pa("chevron-down",{tag:"div",classes:[n+"__select-chevron"]},e.providers.icons);return Ba(w_.sketch(yh(yh(yh({},t.uid?{uid:t.uid}:{}),c),{dom:{tag:"button",classes:[n,n+"--select"].concat(w(t.classes,(function(t){return n+"--"+t}))),attributes:yh({},s)},components:JC([a.map((function(t){return t.asSpec()})),u.map((function(t){return t.asSpec()})),Sh.some(f)]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:ex(g(g([],t.dropdownBehaviours,!0),[YC((function(){return t.disabled||e.providers.isDisabled()})),Bc(),S_.config({}),tk.config({}),ra("dropdown-events",[Ac(t,r),Fc(t,r)]),ra("menubutton-update-display-text",[Ee(LT,(function(t,n){u.bind((function(n){return n.getOpt(t)})).each((function(t){tk.set(t,[co(e.providers.translate(n.event.text))])}))})),Ee(WT,(function(t,n){a.bind((function(n){return n.getOpt(t)})).each((function(t){tk.set(t,[Af(n.event.icon,e.providers.icons)])}))}))])],!1)),eventOrder:zv(NT,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:ex([QS.config({mode:"special",onLeft:o,onRight:o})]),lazySink:e.getSink,toggleClass:n+"--active",parts:{menu:nc(0,t.columns,t.presets)},fetch:function(n){return n_(l(t.fetch,n))}}))).asSpec()}function Rf(t){return"separator"===t.type}function Vf(t,n,e,o){var r=He("primary-menu"),i=jT(t,e.shared.providers.menuItems());if(0===i.items.length)return Sh.none();var u=Cs(r,i.items,n,e,o),a=L(i.menus,(function(t,o){return Cs(o,t,n,e,!1)})),c=zv(a,me(r,u));return Sh.from(Ck.tieredData(r,c,i.expansions))}function Pf(t){return{isDisabled:function(){return tS.isDisabled(t)},setDisabled:function(n){return tS.set(t,n)},setActive:function(n){var e=t.element;n?($e(e,"tox-tbtn--enabled"),Ot(e,"aria-pressed",!0)):(Qe(e,"tox-tbtn--enabled"),Bt(e,"aria-pressed"))},isActive:function(){return Ze(t.element,"tox-tbtn--enabled")}}}function Hf(t,n,e,o){return If({text:t.text,icon:t.icon,tooltip:t.tooltip,role:o,fetch:function(n,o){t.fetch((function(t){o(Vf(t,uC.CLOSE_ON_EXECUTE,e,!1))}))},onSetup:t.onSetup,getApi:Pf,columns:1,presets:"normal",classes:[],dropdownBehaviours:[AO.config({})]},n,e.shared)}function zf(t,n,e,o,r,i){void 0===e&&(e=[]);var u=n.fold((function(){return{}}),(function(t){return{action:t}})),a=yh({buttonBehaviours:ex([YC((function(){return t.disabled||i.isDisabled()})),Bc(),AO.config({}),ra("button press",[Te("click"),Te("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),c=zv(a,{dom:o});return zv(c,{components:r})}function Nf(t,n,e,o){void 0===o&&(o=[]);var r={tag:"button",classes:["tox-tbtn"],attributes:t.tooltip.map((function(t){return{"aria-label":e.translate(t),title:e.translate(t)}})).getOr({})},i=t.icon.map((function(t){return Mf(t,e.icons)}));return zf(t,n,o,r,JC([i]),e)}function Lf(t,n,e,o){void 0===o&&(o=[]);var r=Nf(t,Sh.some(n),e,o);return Bk.sketch(r)}function Wf(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.translate(t.text),u=t.icon?t.icon.map((function(t){return Mf(t,e.icons)})):Sh.none(),a=u.isSome()?JC([u]):[],c=u.isSome()?{}:{innerHtml:i},s=g(g(g(g([],t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"],!0),u.isSome()?["tox-button--icon"]:[],!0),t.borderless?["tox-button--naked"]:[],!0),r,!0);return zf(t,n,o,yh(yh({tag:"button",classes:s},c),{attributes:{title:i}}),a,e)}function Uf(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=Wf(t,Sh.some(n),e,o,r);return Bk.sketch(i)}function jf(t,n){return function(e){"custom"===n?Se(e,zO,{name:t,value:{}}):"submit"===n?we(e,NO):"cancel"===n?we(e,HO):console.error("Unknown button type: ",n)}}function Gf(t,n,e){if("menu"===n){var o=t,r=Ba(Hf(yh(yh({},t),{onSetup:function(n){return n.setDisabled(t.disabled),i},fetch:(u=o.items,a=function(){return r},c=e,function(t){t(w(u,(function(t){var n,e,o=t.text.fold((function(){return{}}),(function(t){return{text:t}}));return yh(yh({type:t.type,active:!1},o),{onAction:function(t){var n=!t.isActive();t.setActive(n),e.storage.set(n),c.shared.getSink().each((function(t){a().getOpt(t).each((function(t){Ko(t.element),Se(t,zO,{name:e.name,value:e.storage.get()})}))}))},onSetup:(n=e=t,function(t){t.setActive(n.storage.get())})})})))})}),"tox-tbtn",e,Sh.none()));return r.asSpec()}var u,a,c;if("custom"===n||"cancel"===n||"submit"===n){var s=jf(t.name,n);return Uf(yh(yh({},t),{borderless:!1}),s,e.shared.providers,[])}console.error("Unknown footer button type: ",n)}function Xf(t,n){return Vw({factory:BO,name:t,overrides:function(t){return{fieldBehaviours:ex([ra("coupled-input-behaviour",[Ee(xb(),(function(e){Ii(e,t,n).bind(qw.getCurrent).each((function(n){Ii(e,t,"lock").each((function(o){uk.isOn(o)&&t.onLockedChange(e,n,o)}))}))}))])])}}})}function Yf(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t);if(null===n)return Bv.error(t);var e=parseFloat(n[1]),o=n[2];return Bv.value({value:e,unit:o})}function qf(t,n){function e(t){return Ah(o,t)}var o={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1};return t.unit===n?Sh.some(t.value):e(t.unit)&&e(n)?o[t.unit]===o[n]?Sh.some(t.value):Sh.some(t.value/o[t.unit]*o[n]):Sh.none()}function Kf(){return Sh.none()}function Jf(t,n){function e(t){return Pa(t,{tag:"span",classes:["tox-icon","tox-lock-icon__"+t]},n.icons)}function o(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}}function r(e){return BO.parts.field({factory:XO,inputClasses:["tox-textfield"],inputBehaviours:ex([tS.config({disabled:function(){return t.disabled||n.isDisabled()}}),Bc(),AO.config({}),ra("size-input-events",[Ee(hb(),(function(t){Se(t,a,{isField1:e})})),Ee(wb(),(function(n){Se(n,VO,{name:t.name})}))])]),selectOnFocus:!1})}function i(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}}var u=Kf,a=He("ratio-event"),c=YT.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(t.label.getOr("Constrain proportions"))}},components:[e("lock"),e("unlock")],buttonBehaviours:ex([tS.config({disabled:function(){return t.disabled||n.isDisabled()}}),Bc(),AO.config({})])}),s=YT.parts.field1(o([BO.parts.label(i("Width")),r(!0)])),l=YT.parts.field2(o([BO.parts.label(i("Height")),r(!1)]));return YT.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[s,l,o([i("&nbsp;"),c])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,n){Yf(pw.getValue(t)).each((function(t){u(t).each((function(t){var e,o,r,i;pw.setValue(n,(i=-1!==(i=(e=t).value.toFixed((o=e.unit)in(r={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4})?r[o]:1)).indexOf(".")?i.replace(/\.?0*$/,""):i)+e.unit)}))}))},coupledFieldBehaviours:ex([tS.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){YT.getField1(t).bind(BO.getField).each(tS.disable),YT.getField2(t).bind(BO.getField).each(tS.disable),YT.getLock(t).each(tS.disable)},onEnabled:function(t){YT.getField1(t).bind(BO.getField).each(tS.enable),YT.getField2(t).bind(BO.getField).each(tS.enable),YT.getLock(t).each(tS.enable)}}),Bc(),ra("size-input-events2",[Ee(a,(function(t,n){var e,o,r,i=n.event.isField1,a=i?YT.getField1(t):YT.getField2(t),c=i?YT.getField2(t):YT.getField1(t),s=a.map(pw.getValue).getOr("");e=c.map(pw.getValue).getOr(""),o=Yf(s).toOptional(),r=Yf(e).toOptional(),u=Fh(o,r,(function(t,n){return qf(t,n.unit).map((function(t){return n.value/t})).map((function(t){return e=t,o=n.unit,function(t){return qf(t,o).map((function(t){return{value:t*e,unit:o}}))};var e,o})).getOr(Kf)})).getOr(Kf)}))])])})}function $f(t,n){function e(t,e,o,r){return Ba(Uf({name:t,text:t,disabled:o,primary:r,icon:Sh.none(),borderless:!1},e,n))}function o(t,e,o,r){return Ba(Lf({name:t,icon:Sh.some(t),tooltip:Sh.some(e),disabled:r,primary:!1,borderless:!1},o,n))}function r(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(tS)&&tS.disable(e)}))}function u(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(tS)&&tS.enable(e)}))}function c(t,n,e){Se(t,n,e)}function s(t){return we(t,QT.disable()),0}function l(t){return we(t,QT.enable()),0}function f(t,n){s(t),c(t,qT.transform(),{transform:n}),l(t)}function d(t){return function(){J.getOpt(t).each((function(t){tk.set(t,[K])}))}}function m(t,n){s(t),c(t,qT.transformApply(),{transform:n,swap:d(t)}),l(t)}function g(){return e("Back",(function(t){return c(t,qT.back(),{swap:d(t)})}),!1,!1)}function p(){return Ba({dom:{tag:"div",classes:["tox-spacer"]},behaviours:ex([tS.config({})])})}function h(){return e("Apply",(function(t){return c(t,qT.apply(),{swap:d(t)})}),!0,!0)}function v(t,n){return function(e){return t(e,n)}}function b(t,n){var e,o=n;s(e=t),c(e,qT.tempTransform(),{transform:o}),l(e)}function y(t,e,o,r,i){var u=eT.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}),c=eT.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),s=eT.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Ba(eT.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:o,maxX:i,getInitialValue:a({x:r})},components:[u,c,s],sliderBehaviours:ex([ok.config({})]),onChoose:e}))}function x(t,n,e,o,i){var a,c,s,l,d,m,p=(a=t,c=n,s=e,l=o,d=i,[g(),(m=c,y(a,(function(t,n,e){f(t,v(m,e.x/100))}),s,l,d)),h()]);return TO.sketch({dom:k,components:p.map((function(t){return t.asSpec()})),containerBehaviours:ex([ra("image-tools-filter-panel-buttons-events",[Ee(QT.disable(),(function(t){r(p,t)})),Ee(QT.enable(),(function(t){u(p,t)}))])])})}function w(t){return y(t,(function(t){var n=L.getOpt(t),e=U.getOpt(t),o=W.getOpt(t);n.each((function(n){e.each((function(e){o.each((function(o){var r,i,u,a=pw.getValue(n).x/100,c=pw.getValue(o).x/100,s=pw.getValue(e).x/100,l=(r=a,i=c,u=s,function(t){return xf(t,(n=i,e=u,yf(bf(),[vf(r,0,2),0,0,0,0,0,vf(n,0,2),0,0,0,0,0,vf(e,0,2),0,0,0,0,0,1,0,0,0,0,0,1])));var n,e});f(t,l)}))}))}))}),0,100,200)}function S(t,n,e){return function(o){c(o,qT.swap(),{transform:n,swap:function(){J.getOpt(o).each((function(n){tk.set(n,[t]),e(n)}))}})}}var k={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},C=i,O=[g(),p(),e("Apply",(function(n){m(n,(function(n){var e,o,r,i,u,a,c,s,l,f=t.getRect();return e=f.x,o=f.y,r=f.w,i=f.h,a=e,c=o,s=r,l=i,(u=n).toCanvas().then((function(t){return HT(t,u.getType(),a,c,s,l)}))})),t.hideCrop()}),!1,!0)],_=TO.sketch({dom:k,components:O.map((function(t){return t.asSpec()})),containerBehaviours:ex([ra("image-tools-crop-buttons-events",[Ee(QT.disable(),(function(t){r(O,t)})),Ee(QT.enable(),(function(t){u(O,t)}))])])}),T=Ba(Jf({name:"size",label:Sh.none(),constrain:!0,disabled:!1},n)),E=[g(),p(),T,p(),e("Apply",(function(t){T.getOpt(t).each((function(n){var e,o,r=pw.getValue(n),i=parseInt(r.width,10),u=parseInt(r.height,10),a=(e=i,o=u,function(t){return r=e,i=o,(n=t).toCanvas().then((function(t){return IT(t,r,i).then((function(t){return pf(t,n.getType())}))}));var n,r,i});m(t,a)}))}),!1,!0)],D=TO.sketch({dom:k,components:E.map((function(t){return t.asSpec()})),containerBehaviours:ex([ra("image-tools-resize-buttons-events",[Ee(QT.disable(),(function(t){r(E,t)})),Ee(QT.enable(),(function(t){u(E,t)}))])])}),B=v(Ef,"h"),M=v(Ef,"v"),A=v(Df,-90),F=v(Df,90),I=[g(),p(),o("flip-horizontally","Flip horizontally",(function(t){b(t,B)}),!1),o("flip-vertically","Flip vertically",(function(t){b(t,M)}),!1),o("rotate-left","Rotate counterclockwise",(function(t){b(t,A)}),!1),o("rotate-right","Rotate clockwise",(function(t){b(t,F)}),!1),p(),h()],R=TO.sketch({dom:k,components:I.map((function(t){return t.asSpec()})),containerBehaviours:ex([ra("image-tools-fliprotate-buttons-events",[Ee(QT.disable(),(function(t){r(I,t)})),Ee(QT.enable(),(function(t){u(I,t)}))])])}),V=[g(),p(),h()],P=TO.sketch({dom:k,components:V.map((function(t){return t.asSpec()}))}),H=x("Brightness",_f,-100,0,100),z=x("Contrast",Tf,-100,0,100),N=x("Gamma",Of,-100,0,100),L=w("R"),W=w("G"),U=w("B"),j=[g(),L,W,U,h()],G=TO.sketch({dom:k,components:j.map((function(t){return t.asSpec()}))}),X=Sh.some(Cf),Y=Sh.some(kf),q=[o("crop","Crop",S(_,Sh.none(),(function(){t.showCrop()})),!1),o("resize","Resize",S(D,Sh.none(),(function(n){T.getOpt(n).each((function(n){var e=t.getMeasurements(),o=e.width,r=e.height;pw.setValue(n,{width:o,height:r})}))})),!1),o("orientation","Orientation",S(R,Sh.none(),C),!1),o("brightness","Brightness",S(H,Sh.none(),C),!1),o("sharpen","Sharpen",S(P,X,C),!1),o("contrast","Contrast",S(z,Sh.none(),C),!1),o("color-levels","Color levels",S(G,Sh.none(),C),!1),o("gamma","Gamma",S(N,Sh.none(),C),!1),o("invert","Invert",S(P,Y,C),!1)],K=TO.sketch({dom:k,components:q.map((function(t){return t.asSpec()}))}),J=Ba(TO.sketch({dom:{tag:"div"},components:[K],containerBehaviours:ex([tk.config({})])}));return{memContainer:J,getApplyButton:function(t){return J.getOpt(t).map((function(t){var n=t.components()[0];return n.components()[n.components().length-1]}))}}}function Qf(t){if(mh(t.changedTouches))for(var n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]}function Zf(t,n){return{uid:t.uid,dom:t.dom,components:n,behaviours:Si(t.formBehaviours,[pw.config({store:{mode:"manual",getValue:function(n){return L(Pi(n,t),(function(t,n){return t().bind((function(t){var e=qw.getCurrent(t),o=new Error("Cannot find a current component to extract the value from for form part '"+n+"': "+Pe(t.element));return e.fold((function(){return Bv.error(o)}),Bv.value)})).map(pw.getValue)}))},setValue:function(n,e){N(e,(function(e,o){Ii(n,t,o).each((function(t){qw.getCurrent(t).each((function(t){pw.setValue(t,e)}))}))}))}}})]),apis:{getField:function(n,e){return Ii(n,t,e).bind(qw.getCurrent)}}}}function td(){return qw.config({find:Sh.some})}function nd(t){return n=Re,e=Ve,nf(t,(function(t){return n(t.element)}),(function(t,n){return e(t.element,n)}));var n,e}function ed(t,n){function e(t){var e,r,i,u,f,g,b,y,x=t.raw,w=(e=Math.max,r=m.documentElement,i=m.body,u=e(r.scrollWidth,i.scrollWidth),f=e(r.clientWidth,i.clientWidth),g=e(r.offsetWidth,i.offsetWidth),b=e(r.scrollHeight,i.scrollHeight),y=e(r.clientHeight,i.clientHeight),{width:u<g?f:u,height:b<e(r.offsetHeight,i.offsetHeight)?y:b});Qf(x),t.prevent(),c=x.button,s=x.screenX,l=x.screenY;var S=Vt(h,"cursor");It(a=Ph.fromTag("div",m),{position:"absolute",top:"0",left:"0",width:w.width+"px",height:w.height+"px","z-index":"2147483647",opacity:"0.0001",cursor:S}),wv(mv(p),a),d.push(fr(p,"mousemove",o),fr(p,"touchmove",o),fr(p,"mouseup",v),fr(p,"touchend",v)),n.start(x)}function o(t){var e=t.raw;if(Qf(e),e.button!==c)return v(t);e.deltaX=e.screenX-s,e.deltaY=e.screenY-l,t.prevent(),n.drag(e)}var r,i,u,a,c,s,l,f=[],d=[],m=null!==(r=n.document)&&void 0!==r?r:document,g=null!==(i=n.root)&&void 0!==i?i:m,p=Ph.fromDom(m),h=Ph.fromDom(g.getElementById(null!==(u=n.handle)&&void 0!==u?u:t)),v=function(t){Qf(t.raw),Th(d,(function(t){return t.unbind()})),d=[],Sv(a),n.stop&&n.stop(t.raw)};return f.push(fr(h,"mousedown",e),fr(h,"touchstart",e)),{destroy:function(){Th(d.concat(f),(function(t){return t.unbind()})),d=[],f=[],mh(a)&&Sv(a)}}}function od(t,n,e,o,r){return Lf({name:t,icon:Sh.some(n),disabled:e,tooltip:Sh.some(t),primary:!1,borderless:!1},o,r)}function rd(t,n){n?tS.enable(t):tS.disable(t)}function id(t){function n(t){f.set(t)}function e(t){URL.revokeObjectURL(t.url)}function o(t){var o=r(t);n(o);var i=m.add(o).removed;return hT.each(i,e),o.url}function r(t){return{blob:t,url:URL.createObjectURL(t)}}function u(){d.on(e),d.clear()}var a,c,s,l,f=fe(t),d=lr(),m=(c=-1,{data:a=[],add:function(t){var n=a.splice(++c);return a.push(t),{state:t,removed:n}},undo:function(){if(s())return a[--c]},redo:function(){if(l())return a[++c]},canUndo:s=function(){return 0<c},canRedo:l=function(){return-1!==c&&c<a.length-1}});return m.add(t),{getBlobState:function(){return f.get()},setBlobState:n,addBlobState:o,getTempState:function(){return d.get().getOrThunk(f.get)},updateTempState:function(t){var n=r(t);return u(),d.set(n),n.url},addTempState:function(t){var n=r(t);return d.set(n),n.url},applyTempState:function(t){return d.get().fold(i,(function(n){o(n.blob),t()}))},destroyTempState:u,undo:function(){var t=m.undo();return n(t),t.url},redo:function(){var t=m.redo();return n(t),t.url},getHistoryStates:function(){return{undoEnabled:m.canUndo(),redoEnabled:m.canRedo()}}}}function ud(t,n){function e(t){var n=S.getHistoryStates();_.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),Se(t,QT.formActionEvent,{name:QT.saveState(),value:n.undoEnabled})}function o(t){return t.toBlob()}function r(t){Se(t,QT.formActionEvent,{name:QT.disable(),value:{}})}function u(t,n,i,u,a){r(t),hf(n).then(i).then(o).then(u).then((function(n){return C(t,n)})).then((function(){e(t),a(),k(t)})).catch((function(n){console.log(n),t.getSystem().isConnected()&&k(t)}))}function a(t,n,e){u(t,S.getBlobState().blob,n,(function(t){return S.updateTempState(t)}),e)}function c(t){var n=S.getBlobState().url;return S.destroyTempState(),e(t),n}function s(t,n){w.getOpt(t).each((function(t){var e=v.get(),o=Xt(t.element),r=Wt(t.element),i=n.dom.naturalWidth*e,u=n.dom.naturalHeight*e,a=Math.max(0,o/2-i/2),c=Math.max(0,r/2-u/2),s={left:a.toString()+"px",top:c.toString()+"px",width:i.toString()+"px",height:u.toString()+"px",position:"absolute"};It(n,s),h.getOpt(t).each((function(t){It(t.element,s)})),b.run((function(t){var n=y.get();t.setRect({x:n.x*e+a,y:n.y*e+c,w:n.w*e,h:n.h*e}),t.setClampRect({x:a,y:c,w:i,h:u}),t.setViewPortRect({x:0,y:0,w:o,h:r})}))}))}function l(t,n){var e,o=Ph.fromTag("img");return Ot(o,"src",n),e=o.dom,new Hk((function(t){var n=function(){e.removeEventListener("load",n),t(e)};e.complete?t(e):e.addEventListener("load",n)})).then((function(){t.getSystem().isConnected()&&w.getOpt(t).map((function(t){var n=ky({element:o});tk.replaceAt(t,1,Sh.some(n));var e=x.get(),r={x:0,y:0,w:o.dom.naturalWidth,h:o.dom.naturalHeight};x.set(r);var i,u=ZT.inflate(r,-20,-20);y.set(u),e.w===r.w&&e.h===r.h||(i=o,w.getOpt(t).each((function(t){var n=Xt(t.element),e=Wt(t.element),o=i.dom.naturalWidth,r=i.dom.naturalHeight,u=Math.min(n/o,e/r);1<=u?v.set(1):v.set(u)}))),s(t,o)}))}))}var f,d,m,g,p,h,v,b,y,x,w,S=id(t.currentState),k=function(t){T.getApplyButton(t).each((function(t){tS.enable(t)})),Se(t,QT.formActionEvent,{name:QT.enable(),value:{}})},C=function(t,n){return r(t),O.updateSrc(t,n)},O=(g=t.currentState.url,h=Ba({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),v=fe(1),p=cr(),b=yh(yh({},p),{run:function(t){return p.get().each(t)}}),y=fe({x:0,y:0,w:1,h:1}),x=fe({x:0,y:0,w:1,h:1}),{memContainer:w=Ba(TO.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[h.asSpec(),{dom:{tag:"img",attributes:{src:g}}},{dom:{tag:"div"},behaviours:ex([ra("image-panel-crop-events",[ny((function(t){w.getOpt(t).each((function(t){var n=t.element.dom,e=oE({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},n,i);e.toggleVisibility(!1),e.on("updateRect",(function(t){var n=t.rect,e=v.get(),o={x:Math.round(n.x/e),y:Math.round(n.y/e),w:Math.round(n.w/e),h:Math.round(n.h/e)};y.set(o)})),b.set(e)}))})),ey((function(){b.clear()}))])])}],containerBehaviours:ex([tk.config({}),ra("image-panel-events",[ny((function(t){l(t,g)}))])])})),updateSrc:l,zoom:function(t,n){var e=v.get(),o=0<n?Math.min(2,e+.1):Math.max(.1,e-.1);v.set(o),w.getOpt(t).each((function(t){var n=t.components()[1].element;s(t,n)}))},showCrop:function(){b.run((function(t){t.toggleVisibility(!0)}))},hideCrop:function(){b.run((function(t){t.toggleVisibility(!1)}))},getRect:function(){return y.get()},getMeasurements:function(){var t=x.get();return{width:t.w,height:t.h}}}),_=(d=Ba(od("Undo","undo",!0,(function(t){Se(t,qT.undo(),{direction:1})}),f=n)),m=Ba(od("Redo","redo",!0,(function(t){Se(t,qT.redo(),{direction:1})}),f)),{container:TO.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[d.asSpec(),m.asSpec(),od("Zoom in","zoom-in",!1,(function(t){Se(t,qT.zoom(),{direction:1})}),f),od("Zoom out","zoom-out",!1,(function(t){Se(t,qT.zoom(),{direction:-1})}),f)]}),updateButtonUndoStates:function(t,n,e){
d.getOpt(t).each((function(t){rd(t,n)})),m.getOpt(t).each((function(t){rd(t,e)}))}}),T=$f(O,n);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[T.memContainer.asSpec(),O.memContainer.asSpec(),_.container],behaviours:ex([pw.config({store:{mode:"manual",getValue:function(){return S.getBlobState()}}}),ra("image-tools-events",[Ee(qT.undo(),(function(t){var n=S.undo();C(t,n).then((function(){k(t),e(t)}))})),Ee(qT.redo(),(function(t){var n=S.redo();C(t,n).then((function(){k(t),e(t)}))})),Ee(qT.zoom(),(function(t,n){var e=n.event.direction;O.zoom(t,e)})),Ee(qT.back(),(function(t,n){var e,o=c(e=t);C(e,o).then((function(){k(e)})),(0,n.event.swap)(),O.hideCrop()})),Ee(qT.apply(),(function(t,n){S.applyTempState((function(){c(t),(0,n.event.swap)()}))})),Ee(qT.transform(),(function(t,n){return a(t,n.event.transform,i)})),Ee(qT.tempTransform(),(function(t,n){var e=n.event.transform;u(t,S.getTempState().blob,e,(function(t){return S.addTempState(t)}),i)})),Ee(qT.transformApply(),(function(t,n){var e=t,o=n.event.transform,r=n.event.swap,i=S.getBlobState().blob;u(e,i,o,(function(t){var n=S.addBlobState(t);return c(e),n}),r)})),Ee(qT.swap(),(function(t,n){_.updateButtonUndoStates(t,!1,!1);var e=n.event.transform,o=n.event.swap;e.fold((function(){o()}),(function(n){a(t,n,o)}))}))]),td()])}}function ad(t){return!Ah(t,"items")}function cd(t,n){function e(t){return{dom:{tag:"td",innerHtml:n.translate(t)}}}return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:w(t.header,(function(t){return{dom:{tag:"th",innerHtml:n.translate(t)}}}))}]},{dom:{tag:"tbody"},components:w(t.cells,(function(t){return{dom:{tag:"tr"},components:w(t,e)}}))}],behaviours:ex([AO.config({}),ok.config({})])}}function sd(t,n){var e=t.label.map((function(t){return Vs(t,n)})),o=[tS.config({disabled:function(){return t.disabled||n.isDisabled()}}),Bc(),QS.config({mode:"execution",useEnter:!0!==t.multiline,useControlEnter:!0===t.multiline,execute:function(t){return we(t,NO),Sh.some(!0)}}),ra("textfield-change",[Ee(xb(),(function(n){Se(n,VO,{name:t.name})})),Ee(Bb(),(function(n){Se(n,VO,{name:t.name})}))]),AO.config({})],r=t.validation.map((function(t){return u_.config({getRoot:function(t){return pt(t.element)},invalidClass:"tox-invalid",validator:{validate:function(n){var e=pw.getValue(n),o=t.validator(e);return e_(!0===o?Bv.value(e):Bv.error(o))},validateOnLoad:t.validateOnLoad}})})).toArray(),i=t.placeholder.fold(a({}),(function(t){return{placeholder:n.translate(t)}})),u=t.inputMode.fold(a({}),(function(t){return{inputmode:t}})),c=yh(yh({},i),u);return Rs(e,BO.parts.field({tag:!0===t.multiline?"textarea":"input",inputAttributes:c,inputClasses:[t.classname],inputBehaviours:ex(E([o,r])),selectOnFocus:!1,factory:XO}),(t.flex?["tox-form__group--stretched"]:[]).concat(t.maximized?["tox-form-group--maximize"]:[]),[tS.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){BO.getField(t).each(tS.disable)},onEnabled:function(t){BO.getField(t).each(tS.enable)}}),Bc()])}function ld(){var t=fe(null);return yy({readState:function(){return{timer:null!==t.get()?"set":"unset"}},setTimer:function(n){t.set(n)},cancel:function(){var n=t.get();null!==n&&n.cancel()}})}function fd(t,n,e){var o=pw.getValue(e);pw.setValue(n,o),fE(n)}function dd(t,n){var e=t.element,o=eo(e),r=e.dom;"number"!==Tt(e,"type")&&n(r,o)}function md(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:i}}function gd(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:void 0},onAction:i}}function pd(t,n){return e=t,w(k(n,(function(t){return t.type===e})),md);var e}function hd(t,n){var e=t.toLowerCase();return k(n,(function(t){return $((void 0!==t.meta&&void 0!==t.meta.text?t.meta:t).text.toLowerCase(),e)||$(t.value.toLowerCase(),e)}))}function vd(t,n,e){function o(n){var o=pw.getValue(n);e.addToHistory(o.value,t.filetype)}var r,u,a,c,s=n.shared.providers,l=BO.parts.field({factory:pE,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":yE,type:"url"},minChars:0,responseTime:0,fetch:function(o){var r,i,u,a,c=Vf((r=t.filetype,i=e,u=pw.getValue(o),a=void 0!==u.meta.text?u.meta.text:u.value,i.getLinkInformation().fold((function(){return[]}),(function(t){var n=hd(a,w(i.getHistory(r),(function(t){return gd(t,t)})));return"file"===r?O([n,hd(a,pd("header",t.targets)),hd(a,E([Sh.from(t.anchorTop).map((function(t){return gd("<top>",t)})).toArray(),pd("anchor",t.targets),Sh.from(t.anchorBottom).map((function(t){return gd("<bottom>",t)})).toArray()]))],(function(t,n){return 0===t.length||0===n.length?t.concat(n):t.concat(bE,n)}),[]):n}))),uC.BUBBLE_TO_SANDBOX,n,!1);return e_(c)},getHotspot:function(t){return h.getOpt(t)},onSetValue:function(t){t.hasConfigured(u_)&&u_.run(t).get(i)},typeaheadBehaviours:ex(E([e.getValidationHandler().map((function(n){return u_.config({getRoot:function(t){return pt(t.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){d.getOpt(t).each((function(t){Ot(t.element,"title",s.translate(n))}))}},validator:{validate:function(e){var o=pw.getValue(e);return vE((function(e){n({type:t.filetype,url:o.value},(function(t){var n,o;"invalid"===t.status?(n=Bv.error(t.message),e(n)):(o=Bv.value(t.message),e(o))}))}))},validateOnLoad:!1}})})).toArray(),[tS.config({disabled:function(){return t.disabled||s.isDisabled()}}),AO.config({}),ra("urlinput-events",E(["file"===t.filetype?[Ee(xb(),(function(n){Se(n,VO,{name:t.name})}))]:[],[Ee(wb(),(function(n){Se(n,VO,{name:t.name}),o(n)})),Ee(Bb(),(function(n){Se(n,VO,{name:t.name}),o(n)}))]]))]])),eventOrder:((r={})[xb()]=["streaming","urlinput-events","invalidating"],r),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:nc(0,0,"normal")},onExecute:function(t,n){Se(n,NO,{})},onItemExecute:function(n){o(n),Se(n,VO,{name:t.name})}}),f=t.label.map((function(t){return Vs(t,s)})),d=Ba((u="invalid",a=Sh.some(yE),Pa("warning",{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+u],attributes:yh({title:s.translate(c=void 0===c?u:c),"aria-live":"polite"},a.fold((function(){return{}}),(function(t){return{id:t}})))},s.icons))),m=Ba({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[d.asSpec()]}),g=e.getUrlPicker(t.filetype),p=He("browser.url.event"),h=Ba({dom:{tag:"div",classes:["tox-control-wrap"]},components:[l,m.asSpec()],behaviours:ex([tS.config({disabled:function(){return t.disabled||s.isDisabled()}})])}),v=Ba(Uf({name:t.name,icon:Sh.some("browse"),text:t.label.getOr(""),disabled:t.disabled,primary:!1,borderless:!0},(function(t){return we(t,p)}),s,[],["tox-browse-url"]));return BO.sketch({dom:RO([]),components:f.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:E([[h.asSpec()],g.map((function(){return v.asSpec()})).toArray()])}]),fieldBehaviours:ex([tS.config({disabled:function(){return t.disabled||s.isDisabled()},onDisabled:function(t){BO.getField(t).each(tS.disable),v.getOpt(t).each(tS.disable)},onEnabled:function(t){BO.getField(t).each(tS.enable),v.getOpt(t).each(tS.enable)}}),Bc(),ra("url-input-events",[Ee(p,(function(n){qw.getCurrent(n).each((function(e){var o=pw.getValue(e),r=yh({fieldname:t.name},o);g.each((function(o){o(r).get((function(o){pw.setValue(e,o),Se(n,VO,{name:t.name})}))}))}))}))])])})}function bd(t){return function(n,e,o){return G(e,"name").fold((function(){return t(e,o)}),(function(r){return n.field(r,t(e,o))}))}}function yd(t,n,e){var o=zv(e,{shared:{interpreter:function(n){return SE(t,n,o)}}});return SE(t,n,o)}function xd(t,n,e){function o(){return Ph.fromDom(t.getContentAreaContainer())}function r(){return p||!e()}var i,u,a,c,s,l,f,d,m,g,p=Cc(t);return{inlineDialog:(f=o,d=n,m=r,g={maxHeightFunction:xx()},function(){return m()?{type:"node",root:St(f()),node:Sh.from(f()),bubble:br(12,12,kE),layouts:{onRtl:function(){return[ka]},onLtr:function(){return[Sa]}},overrides:g}:{type:"hotspot",hotspot:d(),bubble:br(-12,12,kE),layouts:{onRtl:function(){return[Yy]},onLtr:function(){return[qy]}},overrides:g}}),banner:(c=o,s=n,l=r,function(){return l()?{type:"node",root:St(c()),node:Sh.from(c()),layouts:{onRtl:function(){return[Tk]},onLtr:function(){return[Tk]}}}:{type:"hotspot",hotspot:s(),layouts:{onRtl:function(){return[Qy]},onLtr:function(){return[Qy]}}}}),cursor:(u=t,function(){return{type:"selection",root:a(),getSelection:function(){var t=u.selection.getRng();return Sh.some(Vx.range(Ph.fromDom(t.startContainer),t.startOffset,Ph.fromDom(t.endContainer),t.endOffset))}}}),node:(i=a=function(){return Ph.fromDom(t.getBody())},function(t){return{type:"node",root:i(),node:t}})}}function wd(t){return Sh.from(t.getParam("style_formats")).filter(sh).map((function(n){function e(t){Th(t,(function(t){o.formatter.has(t.name)||o.formatter.register(t.name,t.format)}))}var o,r,i=(o=t,r=OE(n),o.formatter?e(r.customFormats):o.on("init",(function(){e(r.customFormats)})),r.formats);return t.getParam("style_formats_merge",!1,"boolean")?CE.concat(i):i})).getOr(CE)}function Sd(t,n,e){var o={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)};return zv(t,o)}function kd(t,n,e,o){var r=function(n){return w(n,(function(n){var i,u,c,s,l,f=Dh(n);if(X(n,"items")){var d=r(n.items);return zv(zv(n,{type:"submenu"}),{getStyleItems:a(d)})}return X(n,"format")?Sd(n,e,o):1===f.length&&_h(f,"title")?zv(n,{type:"separator"}):(s={type:"formatter",format:c="custom-"+(u=ah((i=n).name)?i.name:He(i.title)),isSelected:e(c),getStylePreview:o(c)},l=zv(i,s),t.formatter.register(u,l),l)}))};return r(n)}function Cd(t){return function(n){if(mh(e=n)&&1===e.nodeType){if(n.contentEditable===t)return!0;if(n.getAttribute("data-mce-contenteditable")===t)return!0}var e;return!1}}function Od(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}}function _d(t){return t.innerText||t.textContent}function Td(t){return t&&"A"===t.nodeName&&void 0!==(t.id||t.name)&&Zm(t)}function Ed(t){return t&&/^(H[1-6])$/.test(t.nodeName)}function Dd(t){return Ed(t)&&Zm(t)}function Bd(t){var n,e=t.id||He("h");return Od("header",_d(t),"#"+e,Ed(n=t)?parseInt(n.nodeName.substr(1),10):0,(function(){t.id=e}))}function Md(t){var n=t.id||t.name;return Od("anchor",_d(t)||"#"+n,"#"+n,0,i)}function Ad(t){return 0<_E(t.title).length}function Fd(t){return ah(t)&&/^https?/.test(t)}function Id(t){return ch(t)&&U(t,(function(t){return!(sh(n=t)&&n.length<=5&&B(n,Fd));var n})).isNone()}function Rd(){var t,n=cO.getItem(BE);if(null===n)return{};try{t=JSON.parse(n)}catch(t){if(t instanceof SyntaxError)return console.log("Local storage "+BE+" was not valid JSON",t),{};throw t}return Id(t)?t:(console.log("Local storage "+BE+" was not valid format",t),{})}function Vd(t){return G(Rd(),t).getOr([])}function Pd(t,n){var e,o;Fd(t)&&(o=k(G(e=Rd(),n).getOr([]),(function(n){return n!==t})),e[n]=[t].concat(o).slice(0,5),function(t){if(!Id(t))throw new Error("Bad format for history:\n"+JSON.stringify(t));cO.setItem(BE,JSON.stringify(t))}(e))}function Hd(t){return!!t}function zd(t){return L(hT.makeMap(t,/[, ]/),Hd)}function Nd(t){return Sh.from(t.getParam("file_picker_callback")).filter(gh)}function Ld(t){return Sh.from(t).filter(ah).getOrUndefined()}function Wd(t){return{getHistory:Vd,addToHistory:Pd,getLinkInformation:function(){return!1===(n=t).getParam("typeahead_urls")?Sh.none():Sh.some({targets:DE(n.getBody()),anchorTop:Ld(n.getParam("anchor_top","#top")),anchorBottom:Ld(n.getParam("anchor_bottom","#bottom"))});var n},getValidationHandler:function(){return Sh.from(void 0===(e=(n=t).getParam("file_picker_validator_handler",void 0,"function"))?n.getParam("filepicker_validator_handler",void 0,"function"):e);var n,e},getUrlPicker:function(n){return e=s=t,o=l=n,i=Sh.some((r=e).getParam("file_picker_types")).filter(Hd),u=Sh.some(r.getParam("file_browser_callback_types")).filter(Hd),a=i.or(u).map(zd),c=Nd(r).fold(hh,(function(){return a.fold(vh,(function(t){return 0<Dh(t).length&&t}))})),(fh(c)?c?Nd(e):Sh.none():c[o]?Nd(e):Sh.none()).map((function(t){return function(n){return n_((function(e){var o=yh({filetype:l,fieldname:n.fieldname},Sh.from(n.meta).getOr({}));t.call(s,(function(t,n){if(!ah(t))throw new Error("Expected value to be string");if(void 0!==n&&!ch(n))throw new Error("Expected meta to be a object");e({value:t,meta:n})}),n.value,o)}))}}));var e,o,r,i,u,a,c,s,l}}}function Ud(t,n,e){function o(t){return function(){return f.formatter.match(t)}}function r(t){return function(){var n=f.formatter.get(t);return void 0!==n?Sh.some({tag:0<n.length&&(n[0].inline||n[0].block)||"div",styles:f.dom.parseStyle(f.formatter.getCssText(t))}):Sh.none()}}var i,u,a,c,s,l,f,d,m,g,p,h,v,b=fe(!1),y={isPositionedAtTop:function(){return"top"===i.get()},getDockingMode:(i=fe(Sc(n)?"bottom":"top")).get,setDockingMode:i.set},x={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:Mk.translate,isDisabled:function(){return n.mode.isReadOnly()||n.ui.isDisabled()},getSetting:n.getParam.bind(n)},interpreter:function(t){return SE(wE,t,x)},anchors:xd(n,e,y.isPositionedAtTop),header:y,getSink:function(){return Bv.value(t)}},urlinput:Wd(n),styleselect:(m=fe([]),g=fe([]),p=fe([]),h=fe([]),v=fe(!(d=function(t){var n=t.items;return void 0!==n&&0<n.length?D(n,d):[t.format]})),(f=n).on("PreInit",(function(){var t=wd(f),n=kd(f,t,o,r);m.set(n),g.set(D(n,d))})),f.on("addStyleModifications",(function(t){var n=kd(f,t.items,o,r);p.set(n),v.set(t.replace),h.set(D(n,d))})),{getData:function(){var t=v.get()?[]:m.get(),n=p.get();return t.concat(n)},getFlattenedKeys:function(){var t=v.get()?[]:g.get(),n=h.get();return t.concat(n)}}),colorinput:{colorPicker:function(t,n){gO(l)(t,n)},hasCustomColors:function(){return ss(s)},getColors:function(){return ls(c)},getColorCols:(a=c=s=l=n,function(){return ds(a)})},dialog:{isDraggableModal:(u=n,function(){return u.getParam("draggable_modal",!1,"boolean")})},isContextMenuOpen:function(){return b.get()},setContextMenuState:function(t){return b.set(t)}};return x}function jd(t){return(Y(Pt(t,"position"),"fixed")?Sh.none():ht(t)).orThunk((function(){var n=Ph.fromTag("span");return pt(t).bind((function(t){wv(t,n);var e=ht(n);return Sv(n),e}))}))}function Gd(t){return jd(t).map(Gt).getOrThunk((function(){return vv(0,0)}))}function Xd(t,n){var e=t.element;$e(e,n.transitionClass),Qe(e,n.fadeOutClass),$e(e,n.fadeInClass),n.onShow(t)}function Yd(t,n){var e=t.element;$e(e,n.transitionClass),Qe(e,n.fadeInClass),$e(e,n.fadeOutClass),n.onHide(t)}function qd(t,n,e){return B(t,(function(t){switch(t){case"bottom":return n.bottom<=e.bottom;case"top":return n.y>=e.y}}))}function Kd(t,n){return n.getInitialPos().map((function(n){return Ov(n.bounds.x,n.bounds.y,Xt(t),Wt(t))}))}function Jd(t,n,e){return e.getInitialPos().bind((function(o){switch(e.clearInitialPos(),o.position){case"static":return Sh.some(LE.static());case"absolute":var r=jd(t).map(_v).getOrThunk((function(){return _v(dv())}));return Sh.some(LE.absolute(tr("absolute",G(o.style,"left").map((function(){return n.x-r.x})),G(o.style,"top").map((function(){return n.y-r.y})),G(o.style,"right").map((function(){return r.right-n.right})),G(o.style,"bottom").map((function(){return r.bottom-n.bottom})))));default:return Sh.none()}}))}function $d(t,n,e){var o,r,i,u=t.element;return Y(Pt(u,"position"),"fixed")?(r=n,Kd(o=u,i=e).filter((function(t){return qd(i.getModes(),t,r)})).bind((function(t){return Jd(o,t,i)}))):function(t,n,e){var o,r,i=_v(t);if(qd(e.getModes(),i,n))return Sh.none();o=t,r=i,e.setInitialPos({style:function(){var t={},n=o.dom;if(Z(n))for(var e=0;e<n.style.length;e++){var r=n.style.item(e);t[r]=n.style[r]}return t}(),position:Vt(o,"position")||"static",bounds:r});var u=Tv(),a=i.x-u.x,c=n.y-u.y,s=u.bottom-n.bottom,l=i.y<=n.y;return Sh.some(LE.fixed(tr("fixed",Sh.some(a),l?Sh.some(c):Sh.none(),Sh.none(),l?Sh.none():Sh.some(s))))}(u,n,e)}function Qd(t,n,e){e.setDocked(!1),Th(["left","right","top","bottom","position"],(function(n){return zt(t.element,n)})),n.onUndocked(t)}function Zd(t,n,e,o){var r="fixed"===o.position;e.setDocked(r),nr(t.element,o),(r?n.onDocked:n.onUndocked)(t)}function tm(t,n,e,o,r){void 0===r&&(r=!1),n.contextual.each((function(n){n.lazyContext(t).each((function(i){var u=i.y<o.bottom&&i.bottom>o.y;u!==e.isVisible()&&(e.setVisible(u),r&&!u?(to(t.element,[n.fadeOutClass]),n.onHide(t)):(u?Xd:Yd)(t,n))}))}))}function nm(t,n,e){var o,r,u,a,c,s;e.isDocked()&&(r=n,u=e,s=(o=t).element,u.setDocked(!1),Kd(c=o.element,a=u).bind((function(t){return Jd(c,t,a)})).each((function(t){t.fold((function(){return Qd(o,r,u)}),(function(t){return Zd(o,r,u,t)}),i)})),u.setVisible(!0),r.contextual.each((function(t){no(s,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(o)})),WE(o,r,u))}function em(t,n){return _h(GE.getModes(t),n)}function om(t){var n=t.element;pt(n).each((function(e){var o,r,i="padding-"+GE.getModes(t)[0];GE.isDocked(t)?(o=Xt(e),Ft(n,"width",o+"px"),Ft(e,i,Ut(r=n)+(parseInt(Vt(r,"margin-top"),10)||0)+(parseInt(Vt(r,"margin-bottom"),10)||0)+"px")):(zt(n,"width"),zt(e,i))}))}function rm(t,n){n?(Qe(t,YE.fadeOutClass),to(t,[YE.transitionClass,YE.fadeInClass])):(Qe(t,YE.fadeInClass),to(t,[YE.fadeOutClass,YE.transitionClass]))}function im(t,n){var e=Ph.fromDom(t.getContainer());n?($e(e,qE),Qe(e,KE)):($e(e,KE),Qe(e,qE))}function um(t,n){function e(t){u().each((function(n){return t(n.element)}))}function o(n){t.inline||om(n),im(t,GE.isDocked(n)),n.getSystem().broadcastOn([uw()],{}),u().each((function(t){return t.getSystem().broadcastOn([uw()],{})}))}var r,i=lr(),u=n.getSink,a=t.inline?[]:[ux.config({channels:((r={})[XE()]={onReceive:om},r)})];return g([ok.config({}),GE.config({contextual:yh({lazyContext:function(n){var e=Ut(n.element),o=t.inline?t.getContentAreaContainer():t.getContainer(),r=_v(Ph.fromDom(o)),i=r.height-e,u=r.y+(em(n,"top")?0:e);return Sh.some(Ov(r.x,u,r.width,i))},onShow:function(){e((function(t){return rm(t,!0)}))},onShown:function(t){e((function(t){return no(t,[YE.transitionClass,YE.fadeInClass])})),i.get().each((function(n){var e,o=t.element,r=ft(e=n);$o(r).filter((function(t){return!st(e,t)})).filter((function(t){return st(t,Ph.fromDom(r.dom.body))||lt(o,t)})).each((function(){return Ko(e)})),i.clear()}))},onHide:function(t){var n=t.element,o=u;Qo(n).orThunk((function(){return o().toOptional().bind((function(t){return Qo(t.element)}))})).fold(i.clear,i.set),e((function(t){return rm(t,!1)}))},onHidden:function(){e((function(t){return no(t,[YE.transitionClass])}))}},YE),lazyViewport:function(n){var e=Tv(),o=t.getParam("toolbar_sticky_offset",0,"number"),r=e.y+(em(n,"top")?o:0),i=e.height-(em(n,"bottom")?o:0);return Ov(e.x,r,e.width,i)},modes:[n.header.getDockingMode()],onDocked:o,onUndocked:o})],a,!0)}function am(t){return Vn("menubutton",ZE,t)}function cm(t,n){return n.getAnimationRoot.fold((function(){return t.element}),(function(n){return n(t)}))}function sm(t){return t.dimension.property}function lm(t,n){return t.dimension.getDimension(n)}function fm(t,n){no(cm(t,n),[n.shrinkingClass,n.growingClass])}function dm(t,n){Qe(t.element,n.openClass),$e(t.element,n.closedClass),Ft(t.element,sm(n),"0px"),Nt(t.element)}function mm(t,n){Qe(t.element,n.closedClass),$e(t.element,n.openClass),zt(t.element,sm(n))}function gm(t,n,e){e.setCollapsed(),Ft(t.element,sm(n),lm(n,t.element)),Nt(t.element),fm(t,n),dm(t,n),n.onStartShrink(t),n.onShrunk(t)}function pm(t,n,e){var o=lm(n,t.element);("0px"===o?gm:function(t,n,e,o){var r=o.getOrThunk((function(){return lm(n,t.element)}));e.setCollapsed(),Ft(t.element,sm(n),r),Nt(t.element);var i=cm(t,n);Qe(i,n.growingClass),$e(i,n.shrinkingClass),dm(t,n),n.onStartShrink(t)})(t,n,e,Sh.some(o))}function hm(t,n,e){var o=cm(t,n),r=Ze(o,n.shrinkingClass),i=lm(n,t.element);mm(t,n);var u=lm(n,t.element);(r?function(){Ft(t.element,sm(n),i),Nt(t.element)}:function(){dm(t,n)})(),Qe(o,n.shrinkingClass),$e(o,n.growingClass),mm(t,n),Ft(t.element,sm(n),u),e.setExpanded(),n.onStartGrow(t)}function vm(t,n){return!0===Ze(cm(t,n),n.growingClass)}function bm(t,n){return!0===Ze(cm(t,n),n.shrinkingClass)}function ym(t){return"<alloy.field."+t+">"}function xm(t){return{element:function(){return t.element.dom}}}function wm(t,n){qw.getCurrent(t).each((function(t){return tk.set(t,[(e=n,cD.sketch((function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:(n=t,r=w(Dh(o=e),(function(t){var n=o[t],e=Pn(Vn("sidebar",sD,n));return{name:t,getApi:xm,onSetup:e.onSetup,onShow:e.onShow,onHide:e.onHide}})),w(r,(function(t){var e=fe(i);return n.slot(t.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:AC([Ac(t,e),Fc(t,e),Ee(qb(),(function(t,n){var e=n.event;_(r,(function(t){return t.name===e.name})).each((function(n){(e.visible?n.onShow:n.onHide)(n.getApi(t))}))}))])})}))),slotBehaviours:AC([ny((function(t){return cD.hideAllSlots(t)}))])};var n,o,r})))]);var e}))}function Sm(t){return qw.getCurrent(t).bind((function(t){return rD.isGrowing(t)||rD.hasGrown(t)?qw.getCurrent(t).bind((function(t){return _(cD.getSlotNames(t),(function(n){return cD.isShowing(t,n)}))})):Sh.none()}))}function km(t){var n=Ph.fromHtml(t),e=vt(n),o=O(void 0!==n.dom.attributes?n.dom.attributes:[],(function(t,n){var e;return"class"===n.name?t:yh(yh({},t),((e={})[n.name]=n.value,e))}),{}),r=Array.prototype.slice.call(n.dom.classList,0),i=0===e.length?{}:{innerHtml:Re(n)};return yh({tag:nt(n),classes:r,attributes:o},i)}function Cm(t){return qw.getCurrent(t).each((function(t){return Ko(t.element)}))}function Om(t,n,e){function o(e){var o;!i.get()||"focusin"===(o=e).type&&(o.composed?P(o.composedPath()):Sh.from(o.target)).map(Ph.fromDom).filter(Nh).exists((function(t){return Ze(t,"mce-pastebin")}))||(e.preventDefault(),Cm(n()),t.editorManager.setActive(t))}function r(o){var r,u,a,c,s,l,f,d,m,g;o!==i.get()&&(i.set(o),r=t,u=n(),a=o,c=e.providers,d=u.element,m=a,g="data-mce-"+(s="tabindex"),Sh.from(r.iframeElement).map(Ph.fromDom).each((function(t){m?(Et(t,s).each((function(n){return Ot(t,g,n)})),Ot(t,s,-1)):(Bt(t,s),Et(t,g).each((function(n){Ot(t,s,n),Bt(t,g)})))})),a?(mD.block(u,(f=c,function(){return{dom:{tag:"div",attributes:{"aria-label":f.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:km('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}})),zt(d,"display"),Bt(d,"aria-hidden"),r.hasFocus()&&Cm(u)):(l=qw.getCurrent(u).exists((function(t){return Jo(t.element)})),mD.unblock(u),Ft(d,"display","none"),Ot(d,"aria-hidden","true"),l&&r.focus()),t.fire("AfterProgressState",{state:o}))}var i=fe(!1),u=lr();t.inline||t.on("PreInit",(function(){t.dom.bind(t.getWin(),"focusin",o),t.on("BeforeExecCommand",(function(t){"mcefocus"===t.command.toLowerCase()&&!0!==t.value&&o(t)}))})),t.on("ProgressState",(function(n){var e;u.on(Dk.clearTimeout),ph(n.time)?(e=Dk.setEditorTimeout(t,(function(){return r(n.state)}),n.time),u.set(e)):(r(n.state),u.clear())}))}function _m(t,n,e){return{within:t,extra:n,withinWidth:e}}function Tm(t,n,e){var o,r=(o=function(t,n){var o=e(t);return Sh.some({element:t,start:n,finish:n+o,width:o})},O(t,(function(t,n){return o(n,t.len).fold(a(t),(function(n){return{len:n.finish,list:t.list.concat([n])}}))}),{len:0,list:[]}).list),i=k(r,(function(t){return t.finish<=n})),u=C(i,(function(t,n){return t+n.width}),0);return{within:i,extra:r.slice(i.length),withinWidth:u}}function Em(t){return w(t,(function(t){return t.element}))}function Dm(t,n){var e=w(n,(function(t){return _y(t)}));HE.setGroups(t,e)}function Bm(t,n,e){var o,r,i,u,a,c,s,l,f,d,m,g,p,h,v,b,y,x,w,S,k=n.builtGroups.get();0!==k.length&&(o=Ri(t,n,"primary"),r=c_.getCoupled(t,"overflowGroup"),Ft(o.element,"visibility","hidden"),u=z(i=k.concat([r]),(function(t){return Qo(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))})),e([]),Dm(o,i),a=Xt(o.element),0===(s=a,l=n.builtGroups.get(),d=r,y=(0===(m=Tm(l,s,f=function(t){return Xt(t.element)})).extra.length?Sh.some(m):Sh.none()).getOrThunk((function(){return Tm(l,s-f(d),f)})),x=y.within,w=y.extra,S=y.withinWidth,(c=1===w.length&&w[0].width<=f(d)?(b=S,_m(Em(x.concat(w)),[],b)):1<=w.length?(p=w,h=d,v=S,_m(Em(x).concat([h]),Em(p),v)):(g=S,_m(Em(x),[],g))).extra.length)?(tk.remove(o,r),e([])):(Dm(o,c.within),e(c.extra)),zt(o.element,"visibility"),Nt(o.element),u.each(ok.focus))}function Mm(t,n){var e=c_.getCoupled(t,"toolbarSandbox");rw.isOpen(e)?rw.close(e):rw.open(e,n.toolbar())}function Am(t,n,e,o){var r=e.getBounds.map((function(t){return t()})),i=e.lazySink(t).getOrDie();$x.positionWithinBounds(i,n,{anchor:{type:"hotspot",hotspot:t,layouts:o,overrides:{maxWidthFunction:vD()}}},r)}function Fm(t,n,e,o,r){HE.setGroups(n,r),Am(t,n,e,o),uk.on(t)}function Im(t){return w(t,(function(t){return _y(t)}))}function Rm(t,n,e){Bm(t,e,(function(o){e.overflowGroups.set(o),n.getOpt(t).each((function(t){xD.setGroups(t,Im(o))}))}))}function Vm(t,n){Ii(t,n,"overflow-button").bind((function(){return Ii(t,n,"overflow")})).each((function(e){ng(t,n),rD.toggleGrow(e)}))}function Pm(t){var n=t.title.fold((function(){return{}}),(function(t){return{attributes:{title:t}}}));return{dom:yh({tag:"div",classes:["tox-toolbar__group"]},n),components:[kD.parts.items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:ex([AO.config({}),ok.config({})])}}function Hm(t){return kD.sketch(Pm(t))}function zm(t,n){var e=ny((function(n){var e=w(t.initGroups,Hm);HE.setGroups(n,e)}));return ex([qC(t.providers.isDisabled),Bc(),QS.config({mode:n,onEscape:t.onEscape,selector:".tox-toolbar__group"}),ra("toolbar-events",[e])])}function Nm(t){var n=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":Pm({title:Sh.none(),items:[]}),"overflow-button":Nf({name:"more",icon:Sh.some("more-drawer"),disabled:!1,tooltip:Sh.some("More..."),primary:!1,borderless:!1},Sh.none(),t.providers)},splitToolbarBehaviours:zm(t,n)}}function Lm(t){var n=t.cyclicKeying?"cyclic":"acyclic";return HE.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===eC.scrolling?["tox-toolbar--scrolling"]:[])},components:[HE.parts.groups({})],toolbarBehaviours:zm(t,n)})}function Wm(t){return"string"==typeof t?t.split(" "):t}function Um(t,n){var e=yh(yh({},VD),n.menus),o=0<Dh(n.menus).length,r=k(void 0===n.menubar||!0===n.menubar?Wm("file edit view insert format tools table help"):Wm(!1===n.menubar?"":n.menubar),(function(t){var e=Ah(VD,t);return o?e||G(n.menus,t).exists((function(t){return Ah(t,"items")})):e}));return k(w(r,(function(o){var r=e[o],i={title:r.title,items:Wm(r.items)},u=n,a=t.getParam("removed_menuitems","").split(/[ ,]/);return{text:i.title,getItems:function(){return D(i.items,(function(t){var n=t.toLowerCase();return 0===n.trim().length||b(a,(function(t){return t===n}))?[]:"separator"===n||"|"===n?[{type:"separator"}]:u.menuItems[n]?[u.menuItems[n]]:[]}))}}})),(function(t){return 0<t.getItems().length&&b(t.getItems(),(function(t){return"separator"!==t.type}))}))}function jm(t){function n(){t._skinLoaded=!0,t.fire("SkinLoaded")}return function(){t.initialized?n():t.on("init",n)}}function Gm(t,n,e){return new Hk((function(o,r){e.load(n,o,r),t.on("remove",(function(){return e.unload(n)}))}))}function Xm(t,n){var e,o,r,i,u,a,c,s,l,f=(r=(e=n).getParam("skin"),i=e.getParam("skin_url"),!1!==r&&(o=r||"oxide",i=i?e.documentBaseURI.toAbsolute(i):NC.baseURL+"/skins/ui/"+o),i);f&&n.contentCSS.push(f+(t?"/content.inline":"/content")+".min.css"),!1===n.getParam("skin")==0&&ah(f)?Hk.all([Gm(n,f+"/skin.min.css",n.ui.styleSheetLoader),(c=n,s=f,l=Ph.fromDom(c.getElement()),sv(l).isSome()?Gm(c,s+"/skin.shadowdom.min.css",zC.DOM.styleSheetLoader):Hk.resolve())]).then(jm(n),(u=n,a="Skin could not be loaded",function(){return u.fire("SkinLoadError",{message:a})})):jm(n)()}function Ym(t,n){return function(e){function o(){e.setActive(t.formatter.match(n));var o=t.formatter.formatChanged(n,e.setActive);r.set(o)}var r=sr();return t.initialized?o():t.once("init",o),function(){t.off("init",o),r.clear()}}}function qm(t,n,e){return function(o){function r(){return e(o)}function i(){e(o),t.on(n,r)}return t.initialized?i():t.once("init",i),function(){t.off("init",i),t.off(n,r)}}}function Km(t){return function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("mceToggleFormat",!1,n.format)}))}}}function Jm(t,n){return function(){return t.execCommand(n)}}function $m(t,n,e){function o(t,n,e,o){var r=i.shared.providers.translate(t.title);if("separator"===t.type)return Sh.some({type:"separator",text:r});if("submenu"!==t.type)return Sh.some(yh({type:"togglemenuitem",text:r,icon:t.icon,active:t.isSelected(o),disabled:e,onAction:u.onAction(t)},t.getStylePreview().fold((function(){return{}}),(function(t){return{meta:{style:t}}}))));var c=D(t.getStyleItems(),(function(t){return a(t,n,o)}));return 0===n&&c.length<=0?Sh.none():Sh.some({type:"nestedmenuitem",text:r,disabled:c.length<=0,getSubmenuItems:function(){return D(t.getStyleItems(),(function(t){return a(t,n,o)}))}})}function r(t){var n=u.getCurrentValue(),e=u.shouldHide?0:1;return D(t,(function(t){return a(t,e,n)}))}var i,u,a,c=e.dataset,s="basic"===c.type?function(){return w(c.data,(function(t){return Sd(t,e.isSelectedFor,e.getPreviewFor)}))}:c.getData;return{items:(i=n,u=e,a=function(t,n,e){var r="formatter"===t.type&&u.isInvalid(t);return 0===n?r?[]:o(t,n,!1,e).toArray():o(t,n,r,e).toArray()},{validateItems:r,getFetch:function(t,n){return function(e,o){o(Vf(r(n()),uC.CLOSE_ON_EXECUTE,t,!1))}}}),getStyleItems:s}}function Qm(t,n,e){var o=$m(0,n,e),r=o.items,i=o.getStyleItems,u=qm(t,"NodeChange",(function(t){var n=t.getComponent();e.updateText(n)}));return If({text:e.icon.isSome()?Sh.none():e.text,icon:e.icon,tooltip:Sh.from(e.tooltip),role:Sh.none(),fetch:r.getFetch(n,i),onSetup:u,getApi:function(t){return{getComponent:a(t)}},columns:1,presets:"normal",classes:e.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",n.shared)}function Zm(t){return function(t){for(;t=t.parentNode;){var n=t.contentEditable;if(n&&"inherit"!==n)return TE(t)}return!1}(t)&&!EE(t)}function tg(t,n){function e(){return Hi(t)}function o(n,e){return function(o,r){return Ii(o,t,r).map((function(t){return n(t,r)})).getOr(e)}}function r(t){return"true"!==Tt(t.element,"aria-hidden")}var i,u=o(r,!1),a=o((function(t,n){var e;r(t)&&(Ft(e=t.element,"display","none"),Ot(e,"aria-hidden","true"),Se(t,qb(),{name:n,visible:!1}))})),c=(i=a,function(t,n){Th(n,(function(n){return i(t,n)}))}),s=o((function(t,n){var e;r(t)||(zt(e=t.element,"display"),Bt(e,"aria-hidden"),Se(t,qb(),{name:n,visible:!0}))}));return{uid:t.uid,dom:t.dom,components:n,behaviours:wi(t.slotBehaviours),apis:{getSlotNames:e,getSlot:function(n,e){return Ii(n,t,e)},isShowing:u,hideSlot:a,hideAllSlots:function(t){return c(t,e())},showSlot:s}}}function ng(t,n){Ii(t,n,"overflow").each((function(e){Bm(t,n,(function(t){var n=w(t,(function(t){return _y(t)}));HE.setGroups(e,n)})),Ii(t,n,"overflow-button").each((function(t){rD.hasGrown(e)&&uk.on(t)})),rD.refresh(e)}))}function eg(t,n,e,o){var r;return{type:"basic",data:(r=t.getParam(n,e,"string"),w(o===h_.SemiColon?r.replace(/;$/,"").split(";"):r.split(" "),(function(t){var n=t,e=t,o=t.split("=");return 1<o.length&&(n=o[0],e=o[1]),{title:n,format:e}})))}}function og(t){var n={type:"basic",data:jD};return{tooltip:"Align",text:Sh.none(),icon:Sh.some("align-left"),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:Sh.none,getPreviewFor:function(){return Sh.none},onAction:function(n){return function(){return _(jD,(function(t){return t.format===n.format})).each((function(n){return t.execCommand(n.command)}))}},updateText:function(n){var e=_(jD,(function(n){return t.formatter.match(n.format)})).fold(a("left"),(function(t){return t.title.toLowerCase()}));Se(n,WT,{icon:"align-"+e})},dataset:n,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}}function rg(t){return w(t.split(/\s*,\s*/),(function(t){return t.replace(/^['"]+|['"]+$/g,"")}))}function ig(t){function n(){function n(t){return t?rg(t)[0]:""}var r=t.queryCommandValue("FontName"),i=o.data,u=r?r.toLowerCase():"";return{matchOpt:_(i,(function(t){var e=t.format;return e.toLowerCase()===u||n(e).toLowerCase()===n(u).toLowerCase()})).orThunk((function(){return K(0===(t=u).indexOf("-apple-system")&&(n=rg(t.toLowerCase()),B(GD,(function(t){return-1<n.indexOf(t.toLowerCase())}))),{title:e,format:u});var t,n})),
font:r}}var e="System Font",o=eg(t,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",h_.SemiColon);return{tooltip:"Fonts",text:Sh.some(e),icon:Sh.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getCurrentValue:function(){return n().matchOpt},getPreviewFor:function(t){return function(){return Sh.some({tag:"div",styles:-1===t.indexOf("dings")?{"font-family":t}:{}})}},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontName",!1,n.format)}))}},updateText:function(t){var e=n(),o=e.matchOpt,r=e.font,i=o.fold(a(r),(function(t){return t.title}));Se(t,LT,{text:i})},dataset:o,shouldHide:!1,isInvalid:hh}}function ug(t){function n(){var n=Sh.none(),e=o.data,r=t.queryCommandValue("FontSize");if(r)for(var i=function(t){var o,i,u,a,c=(i=t,/[0-9.]+px$/.test(o=r)?(u=72*parseInt(o,10)/96,a=Math.pow(10,i||0),Math.round(u*a)/a+"pt"):G(YD,o).getOr(o)),s=G(XD,c).getOr("");n=_(e,(function(t){return t.format===r||t.format===c||t.format===s}))},u=3;n.isNone()&&0<=u;u--)i(u);return{matchOpt:n,size:r}}var e=a(Sh.none),o=eg(t,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",h_.Space);return{tooltip:"Font sizes",text:Sh.some("12pt"),icon:Sh.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getPreviewFor:e,getCurrentValue:function(){return n().matchOpt},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontSize",!1,n.format)}))}},updateText:function(t){var e=n(),o=e.matchOpt,r=e.size,i=o.fold(a(r),(function(t){return t.title}));Se(t,LT,{text:i})},dataset:o,shouldHide:!1,isInvalid:hh}}function ag(t,n){var e=n(),o=w(e,(function(t){return t.format}));return Sh.from(t.formatter.closest(o)).bind((function(t){return _(e,(function(n){return n.format===t}))})).orThunk((function(){return K(t.formatter.match("p"),{title:"Paragraph",format:"p"})}))}function cg(t){var n=eg(t,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",h_.SemiColon);return{tooltip:"Blocks",text:Sh.some("Paragraph"),icon:Sh.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:Sh.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return Sh.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))})}},onAction:Km(t),updateText:function(e){var o=ag(t,(function(){return n.data})).fold(a("Paragraph"),(function(t){return t.title}));Se(e,LT,{text:o})},dataset:n,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}}function sg(t,n){return{tooltip:"Formats",text:Sh.some("Paragraph"),icon:Sh.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:Sh.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return void 0!==e?Sh.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):Sh.none()}},onAction:Km(t),updateText:function(n){var e=function(t){var n=t.items;return void 0!==n&&0<n.length?D(n,e):[{title:t.title,format:t.format}]},o=D(wd(t),e),r=ag(t,a(o)).fold(a("Paragraph"),(function(t){return t.title}));Se(n,LT,{text:r})},shouldHide:t.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(n){return!t.formatter.canApply(n.format)},dataset:n}}function lg(t){return{isDisabled:function(){return tS.isDisabled(t)},setDisabled:function(n){return tS.set(t,n)}}}function fg(t){return{setActive:function(n){uk.set(t,n)},isActive:function(){return uk.isOn(t)},isDisabled:function(){return tS.isDisabled(t)},setDisabled:function(n){return tS.set(t,n)}}}function dg(t,n){return t.map((function(t){return{"aria-label":n.translate(t),title:n.translate(t)}})).getOr({})}function mg(t,n,e,o,r,i){var u;return{dom:{tag:"button",classes:["tox-tbtn"].concat(n.isSome()?["tox-tbtn--select"]:[]),attributes:dg(e,i)},components:JC([t.map((function(t){return Mf(t,i.icons)})),n.map((function(t){return Ff(t,"tox-tbtn",i)}))]),eventOrder:((u={})[fb()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:ex([qC(i.isDisabled),Bc(),ra("common-button-display-events",[Ee(fb(),(function(t,n){n.event.prevent(),we(t,tB)}))])].concat(o.map((function(e){return JD.config({channel:e,initialData:{icon:t,text:n},renderComponents:function(t){return JC([t.icon.map((function(t){return Mf(t,i.icons)})),t.text.map((function(t){return Ff(t,"tox-tbtn",i)}))])}})})).toArray()).concat(r.getOr([])))}}function gg(t,n,e){var o,r=fe(i),u=mg(t.icon,t.text,t.tooltip,Sh.none(),Sh.none(),e);return Bk.sketch({dom:u.dom,components:u.components,eventOrder:NT,buttonBehaviours:ex([ra("toolbar-button-events",[(o={onAction:t.onAction,getApi:n.getApi},ry((function(t){Mc(o,t)((function(n){Se(t,zT,{buttonApi:n}),o.onAction(n)}))}))),Ac(n,r),Fc(n,r)]),qC((function(){return t.disabled||e.isDisabled()})),Bc()].concat(n.toolbarButtonBehaviours))})}function pg(t,n){return function(e,o,r){var i=t(e).mapError((function(t){return Qv(t)})).getOrDie();return n(i,o,r)}}function hg(t,n,e,o){var i,u=n.outerContainer,a=e.toolbar,c=e.buttons;r(a,ah)?(i=a.map((function(n){var r={toolbar:n,buttons:c,allowToolbarGroups:e.allowToolbarGroups};return uB(t,r,{backstage:o},Sh.none())})),RD.setToolbars(u,i)):RD.setToolbar(u,uB(t,e,{backstage:o},Sh.none()))}function vg(t){return/^[0-9\.]+(|px)$/i.test(""+t)?Sh.some(parseInt(""+t,10)):Sh.none()}function bg(t){return ph(t)?t+"px":t}function yg(t,n,e){var o=n.filter((function(n){return t<n})),r=e.filter((function(n){return n<t}));return o.or(r).getOr(t)}function xg(t){var n=dc(t),e=mc(t),o=pc(t);return vg(n).map((function(t){return yg(t,e,o)}))}function wg(t,n,e,o,r){function i(){return w.get()&&!t.removed}function u(t){return x?t.fold(a(0),(function(t){return 1<t.components().length?Wt(t.components()[1].element):0})):0}function c(){f.broadcastOn([uw()],{})}function s(t){var e,o,a,s,l;void 0===t&&(t=!1),i()&&(g||(e=h.getOrThunk((function(){var t=vg(Vt(dv(),"margin-left")).getOr(0);return Xt(dv())-Gt(n).left+t})),Ft(r.get().element,"max-width",e+"px")),x&&RD.refreshToolbar(d),g||(o=u(RD.getToolbar(d)),a=_v(n),s=b()?Math.max(a.y-Wt(r.get().element)+o,0):a.bottom,It(d.element,{position:"absolute",top:Math.round(s)+"px",left:Math.round(a.x)+"px"})),p&&(l=r.get(),t?GE.reset(l):GE.refresh(l)),c())}function l(e){var o,a;void 0===e&&(e=!0),!g&&p&&i()&&(o=v.getDockingMode(),(a=function(e){switch(wc(t)){case rC.auto:var o=u(RD.getToolbar(d)),r=Wt(e.element)-o,i=_v(n);if(i.y>r)return"top";var a=mt(n),c=Math.max(a.dom.scrollHeight,Wt(a));return i.bottom<c-r||Tv().bottom<i.bottom-r?"bottom":"top";case rC.bottom:return"bottom";default:return rC.top,"top"}}(r.get()))!==o&&(function(t){var n=r.get();GE.setModes(n,[t]),v.setDockingMode(t);var e=b()?lx.TopToBottom:lx.BottomToTop;Ot(n.element,Ox,e)}(a),e&&s(!0)))}var f=e.uiMothership,d=e.outerContainer,m=zC.DOM,g=Cc(t),p=Tc(t),h=pc(t).or(xg(t)),v=o.shared.header,b=v.isPositionedAtTop,y=xc(t),x=y===eC.sliding||y===eC.floating,w=fe(!1);return{isVisible:i,isPositionedAtTop:b,show:function(){w.set(!0),Ft(d.element,"display","flex"),m.addClass(t.getBody(),"mce-edit-focus"),zt(f.element,"display"),l(!1),s()},hide:function(){w.set(!1),e.outerContainer&&(Ft(d.element,"display","none"),m.removeClass(t.getBody(),"mce-edit-focus")),Ft(f.element,"display","none")},update:s,updateMode:l,repositionPopups:c}}function Sg(t,n){var e=_v(t);return{pos:n?e.y:e.bottom,bounds:e}}function kg(t,n){return Ee(zT,(function(e,o){var r,i=t.get(e),u=(r=i,{hide:function(){return we(r,Vb())},getValue:function(){return pw.getValue(r)}});n.onAction(u,o.event.buttonApi)}))}function Cg(t,n,e){return n.bottom-t.y>=(e=void 0===e?.01:e)&&t.bottom-n.y>=e}function Og(t){var n=function(t){var n=t.getBoundingClientRect();if(n.height<=0&&n.width<=0){var e=xt(Ph.fromDom(t.startContainer),t.startOffset).element;return(Lh(e)?pt(e):Sh.some(e)).filter(Nh).map((function(t){return t.dom.getBoundingClientRect()})).getOr(n)}return n}(t.selection.getRng());if(t.inline){var e=en();return Ov(e.left+n.left,e.top+n.top,n.width,n.height)}var o=cn(Ph.fromDom(t.getBody()));return Ov(o.x+n.left,o.y+n.top,n.width,n.height)}function _g(t,n,e,o){void 0===o&&(o=0);var r,i,u,a,c=un(window),s=_v(Ph.fromDom(t.getContentAreaContainer())),l=vc(t)||bc(t)||LC(t),f=(r=s,i=c,u=o,{x:a=Math.max(r.x+u,i.x),width:Math.min(r.right-u,i.right)-a}),d=f.x,m=f.width;if(t.inline&&!l)return Ov(d,c.y,m,c.height);var g=function(t,n,e,o,r,i){var u=Ph.fromDom(t.getContainer()),a=po(u,".tox-editor-header").getOr(u),c=_v(a),s=c.y>=n.bottom,l=o&&!s;if(t.inline&&l)return{y:Math.max(c.bottom+i,e.y),bottom:e.bottom};if(t.inline&&!l)return{y:e.y,bottom:Math.min(c.y-i,e.bottom)};var f="line"===r?_v(u):n;return l?{y:Math.max(c.bottom+i,e.y),bottom:Math.min(f.bottom-i,e.bottom)}:{y:Math.max(f.y+i,e.y),bottom:Math.min(c.y-i,e.bottom)}}(t,s,c,n.header.isPositionedAtTop(),e,o),p=g.y,h=g.bottom;return Ov(d,p,m,h-p)}function Tg(t){return"node"===t}function Eg(t,n,e,o,r){var i=Og(t),u=o.lastElement().exists((function(t){return st(e,t)})),a=e,c=t.selection.getRng(),s=xt(Ph.fromDom(c.startContainer),c.startOffset);return c.startContainer===c.endContainer&&c.startOffset===c.endOffset-1&&st(s.element,a)?u?Ta:Tk:u?function(t,e){var r=Pt(t,"position");Ft(t,"position",e);var u=Cg(i,_v(n))&&!o.isReposition()?Da:Ta;return r.each((function(n){return Ft(t,"position",n)})),u}(n,o.getMode()):("fixed"===o.getMode()?r.y+en().top:r.y)+(Wt(n)+12)<=i.y?Tk:Ek}function Dg(t,n){var e=S(k(n,(function(n){return n.predicate(t.dom)})),(function(t){return"contexttoolbar"===t.type}));return{contextToolbars:e.pass,contextForms:e.fail}}function Bg(t,n){function e(t){return st(t,r)}var o,r=Ph.fromDom(n.getBody()),i=Ph.fromDom(n.selection.getNode());return e(o=i)||lt(r,o)?function(t,n,e){var o=Dg(t,n);if(0<o.contextForms.length)return Sh.some({elem:t,toolbars:[o.contextForms[0]]});var r=Dg(t,e);if(0<r.contextForms.length)return Sh.some({elem:t,toolbars:[r.contextForms[0]]});if(0<o.contextToolbars.length||0<r.contextToolbars.length){var i=function(t){function n(n){return b(t,(function(t){return t.position===n}))}function e(n){return k(t,(function(t){return t.position===n}))}if(t.length<=1)return t;var o=n("selection"),r=n("node");if(o||r){if(r&&o){var i=e("node"),u=w(e("selection"),(function(t){return yh(yh({},t),{position:"node"})}));return i.concat(u)}return e(o?"selection":"node")}return e("line")}(o.contextToolbars.concat(r.contextToolbars));return Sh.some({elem:t,toolbars:i})}return Sh.none()}(i,t.inNodeScope,t.inEditorScope).orThunk((function(){return r=t,(n=e)(o=i)?Sh.none():he(o,(function(t){function n(t){return _(a,(function(n){return n.position===t}))}if(Nh(t)){var e=Dg(t,r.inNodeScope),o=e.contextToolbars,i=e.contextForms,u=0<i.length?i:(a=o).length<=1?a:n("selection").orThunk((function(){return n("node")})).orThunk((function(){return n("line")})).map((function(t){return t.position})).fold((function(){return[]}),(function(t){return k(a,(function(n){return n.position===t}))}));return 0<u.length?Sh.some({elem:t,toolbars:u}):Sh.none()}var a;return Sh.none()}),n);var n,o,r})):Sh.none()}function Mg(t,n){var e={},o=[],r=[],i={},u={},a=Dh(t);return Th(a,(function(a){var c,s,l,f,d,m=t[a];"contextform"===m.type?(l=a,d=Pn(Vn("ContextForm",tC,f=m)),(e[l]=d).launch.map((function(t){i["form:"+l]=yh(yh({},f.launch),{type:"contextformtogglebutton"===t.type?"togglebutton":"button",onAction:function(){n(d)}})})),("editor"===d.scope?r:o).push(d),u[l]=d):"contexttoolbar"===m.type&&(c=a,Vn("ContextToolbar",nC,s=m).each((function(t){("editor"===s.scope?r:o).push(t),u[c]=t})))})),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:u,formNavigators:i}}function Ag(t,n,e,o){function r(){var n=x.get().getOr("node"),e=Tg(n)?1:0;return _g(t,h,n,e)}function u(){return!(t.removed||v()&&p.isContextMenuOpen())}function a(){if(u()){var n=r(),e=Y(x.get(),"node")?(o=t,b.get().filter(fv).map(cn).getOrThunk((function(){return Og(o)}))):Og(t);return n.height<=0||!Cg(e,n)}return 1;var o}function c(){b.clear(),y.clear(),x.clear(),Ok.hide(S)}function s(){var t;Ok.isOpen(S)&&(zt(t=S.element,"display"),a()?Ft(t,"display","none"):(y.set(0),Ok.reposition(S)))}function l(n){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[n],behaviours:ex([QS.config({mode:"acyclic"}),ra("pop-dialog-wrap-events",[ny((function(n){t.shortcuts.add("ctrl+F9","focus statusbar",(function(){return QS.focusIn(n)}))})),ey((function(){t.shortcuts.remove("ctrl+F9")}))])])}}function f(n,o){function r(t){return Tg(f)?[(n=t,function(t,e,o,r,i){var u=Eg(s,r,n,l,i),a=yh(yh({},t),{y:i.y,height:i.height});return yh(yh({},u(a,e,o,r,i)),{alwaysFit:!0})})]:[];var n}var i,u,a,c,s,l,f,d="node"===n?h.anchors.node(o):h.anchors.cursor(),m=(i=t,u=n,a=v(),c={lastElement:b.get,isReposition:function(){return Y(y.get(),0)},getMode:function(){return $x.getMode(e)}},"line"===u?{bubble:br(12,0,mB),layouts:{onLtr:function(){return[Vo]},onRtl:function(){return[Po]}},overrides:gB}:{bubble:br(0,12,mB,1/12),layouts:(s=i,l=c,f=u,a?{onLtr:function(t){return[Qy,Yy,qy,Ky,Jy,$y].concat(r(t))},onRtl:function(t){return[Qy,qy,Yy,Jy,Ky,$y].concat(r(t))}}:{onLtr:function(t){return[$y,Qy,Ky,Yy,Jy,qy].concat(r(t))},onRtl:function(t){return[$y,Qy,Jy,qy,Ky,Yy].concat(r(t))}}),overrides:gB});return zv(d,m)}function d(t,n){var o,i,c,s;O.cancel(),u()&&(o=C(t),c=f(i=t[0].position,n),x.set(i),y.set(1),zt(s=S.element,"display"),Y(Fh(n,b.get(),st),!0)||(Qe(s,yB),$x.reset(e,S)),Ok.showWithinBounds(S,l(o),{anchor:c,transition:{classes:[yB],mode:"placement"}},(function(){return Sh.some(r())})),n.fold(b.clear,b.set),a()&&Ft(s,"display","none"))}var m,g,p=o.backstage,h=p.shared,v=rv().deviceType.isTouch,b=lr(),y=lr(),x=lr(),S=Oy((m={sink:e,onEscape:function(){return t.focus(),Sh.some(!0)}},g=fe([]),Ok.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){g.set([]),Ok.getContent(t).each((function(t){zt(t.element,"visibility")})),Qe(t.element,bB),zt(t.element,"width")},inlineBehaviours:ex([ra("context-toolbar-events",[Ie(Cb(),(function(t,n){"width"===n.event.raw.propertyName&&(Qe(t.element,bB),zt(t.element,"width"))})),Ee(vB,(function(t,n){var e=t.element;zt(e,"width");var o=Xt(e);Ok.setContent(t,n.event.contents),$e(e,bB);var r=Xt(e);Ft(e,"width",o+"px"),Ok.getContent(t).each((function(t){n.event.focus.bind((function(t){return Ko(t),Qo(e)})).orThunk((function(){return QS.focusIn(t),$o(cv(e))}))})),Dk.setTimeout((function(){Ft(t.element,"width",r+"px")}),0)})),Ee(pB,(function(t,n){Ok.getContent(t).each((function(n){g.set(g.get().concat([{bar:n,focus:$o(cv(t.element))}]))})),Se(t,vB,{contents:n.event.forwardContents,focus:Sh.none()})})),Ee(hB,(function(t){H(g.get()).each((function(n){g.set(g.get().slice(0,g.get().length-1)),Se(t,vB,{contents:_y(n.bar),focus:n.focus})}))}))]),QS.config({mode:"special",onEscape:function(t){return H(g.get()).fold((function(){return m.onEscape()}),(function(){return we(t,hB),Sh.some(!0)}))}})]),lazySink:function(){return Bv.value(m.sink)}}))),k=ot((function(){return Mg(n,(function(t){var n=C([t]);Se(S,pB,{forwardContents:l(n)})}))})),C=function(n){var e=t.ui.registry.getAll().buttons,r=k(),i=yh(yh({},e),r.formNavigators),u=xc(t)===eC.scrolling?eC.scrolling:eC.default,a=E(w(n,(function(n){return"contexttoolbar"===n.type?uB(t,{buttons:i,toolbar:n.items,allowToolbarGroups:!1},o,Sh.some(["form:"])):(e=h.providers,dB(n,e));var e})));return Lm({type:u,uid:He("context-toolbar"),initGroups:a,onEscape:Sh.none,cyclicKeying:!0,providers:h.providers})},O=La((function(){t.hasFocus()&&!t.removed&&(Ze(S.element,yB)?O.throttle():Bg(k(),t).fold(c,(function(t){d(t.toolbars,Sh.some(t.elem))})))}),17);t.on("init",(function(){t.on("remove",c),t.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",s),t.on("click keyup focus SetContent",O.throttle),t.on(fB,c),t.on("contexttoolbar-show",(function(n){G(k().lookupTable,n.toolbarKey).each((function(e){d([e],K(n.target!==t,n.target)),Ok.getContent(S).each(QS.focusIn)}))})),t.on("focusout",(function(){Dk.setEditorTimeout(t,(function(){Qo(e.element).isNone()&&Qo(S.element).isNone()&&c()}),0)})),t.on("SwitchMode",(function(){t.mode.isReadOnly()&&c()})),t.on("AfterProgressState",(function(n){n.state?c():t.hasFocus()&&O.throttle()})),t.on("NodeChange",(function(){Qo(S.element).fold(O.throttle,i)}))}))}function Fg(t){return"(?:"+t+")?"}function Ig(t,n){function e(){var e=n.getOptions(t),o=n.getCurrent(t).map(n.hash),r=lr();return w(e,(function(e){return{type:"togglemenuitem",text:n.display(e),onSetup:function(i){function u(t){t&&(r.on((function(t){return t.setActive(!1)})),r.set(i)),i.setActive(t)}u(Y(o,n.hash(e)));var a=n.watcher(t,e,u);return function(){r.clear(),a()}},onAction:function(){return n.setCurrent(t,e)}}}))}t.ui.registry.addMenuButton(n.name,{tooltip:n.text,icon:n.icon,fetch:function(t){return t(e())},onSetup:n.onToolbarSetup}),t.ui.registry.addNestedMenuItem(n.name,{type:"nestedmenuitem",text:n.text,getSubmenuItems:e,onSetup:n.onMenuSetup})}function Rg(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}}function Vg(t){var n,e;!function(t){hT.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onSetup:Ym(t,n.name),onAction:Rg(t,n.name)})}));for(var n=1;n<=6;n++){var e="h"+n;t.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+n,onSetup:Ym(t,e),onAction:Rg(t,e)})}}(t),n=t,hT.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(t){n.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:Jm(n,t.action)})})),e=t,hT.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(t){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:Jm(e,t.action),onSetup:Ym(e,t.name)})}))}function Pg(t,n){return qm(t,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",(function(e){e.setDisabled(t.mode.isReadOnly()||!t.undoManager[n]())}))}function Hg(t){var n;t.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:Jm(t,"mceToggleVisualAid")}),t.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:qm(n=t,"VisualAid",(function(t){t.setActive(n.hasVisual)})),onAction:Jm(t,"mceToggleVisualAid")})}function zg(t,n){var e,o,r,i,u,c,s,l,f,d,m,g,p,h,v,b,y,x,w,S,k,C,O,_,T,E=t;Th([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],(function(t){E.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:Jm(E,t.cmd),onSetup:Ym(E,t.name)})})),E.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onAction:Jm(E,"JustifyNone")}),Vg(_=t),T=_,hT.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(t){T.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:Jm(T,t.action)})})),T.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:Rg(T,"code")}),O=$m(0,m=f=n,og(d=l=t)),d.ui.registry.addNestedMenuItem("align",{text:m.shared.providers.translate("Align"),getSubmenuItems:function(){return O.items.validateItems(O.getStyleItems())}}),h=$m(0,p=f,ig(g=l)),g.ui.registry.addNestedMenuItem("fontformats",{text:p.shared.providers.translate("Fonts"),getSubmenuItems:function(){return h.items.validateItems(h.getStyleItems())}}),v=l,y=yh({type:"advanced"},(b=f).styleselect),x=$m(0,b,sg(v,y)),v.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return x.items.validateItems(x.getStyleItems())}}),S=$m(0,f,cg(w=l)),w.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return S.items.validateItems(S.getStyleItems())}}),C=$m(0,f,ug(k=l)),k.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return C.items.validateItems(C.getStyleItems())}}),(c=u=t).ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:Pg(c,"hasUndo"),onAction:Jm(c,"undo")}),c.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:Pg(c,"hasRedo"),onAction:Jm(c,"redo")}),(s=u).ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",disabled:!0,onSetup:Pg(s,"hasUndo"),onAction:Jm(s,"undo")}),s.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",disabled:!0,onSetup:Pg(s,"hasRedo"),onAction:Jm(s,"redo")}),function(t){var n;(n=t).addCommand("mceApplyTextcolor",(function(t,e){var o,r=t,i=e;(o=n).undoManager.transact((function(){o.focus(),o.formatter.apply(r,{value:i}),o.nodeChanged()}))})),n.addCommand("mceRemoveTextcolor",(function(t){var e,o=t;(e=n).undoManager.transact((function(){e.focus(),e.formatter.remove(o,{value:null},null,!0),e.nodeChanged()}))}));var e=fe(mO),o=fe(mO);bs(t,"forecolor","forecolor","Text color",e),bs(t,"backcolor","hilitecolor","Background color",o),ys(t,"forecolor","forecolor","Text color"),ys(t,"backcolor","hilitecolor","Background color")}(t),Hg(t),(r=t).ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:qm(i=r,"NodeChange",(function(t){t.setDisabled(!i.queryCommandState("outdent"))})),onAction:Jm(r,"outdent")}),r.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:Jm(r,"indent")}),Ig(e=t,SB),o=e,Sh.from(o.getParam("content_langs",void 0,"array")).map((function(t){return{name:"language",text:"Language",icon:"language",getOptions:a(t),hash:function(t){return dh(t.customCode)?t.code:t.code+"/"+t.customCode},display:function(t){return t.title},watcher:function(t,n,e){return t.formatter.formatChanged("lang",e,!1,{value:n.code,customValue:n.customCode}).unbind},getCurrent:function(t){return ve(Ph.fromDom(t.selection.getNode()),(function(t){return Sh.some(t).filter(Nh).bind((function(t){return Et(t,"lang").map((function(n){return{code:n,customCode:Et(t,"data-mce-lang").getOrUndefined(),title:""}}))}))}))},setCurrent:function(t,n){return t.execCommand("Lang",!1,n)},onToolbarSetup:function(t){var n=sr();return t.setActive(o.formatter.match("lang",{},void 0,!0)),n.set(o.formatter.formatChanged("lang",t.setActive,!0)),n.clear}}})).each((function(t){return Ig(e,t)}))}function Ng(t,n){return{type:"makeshift",x:t,y:n}}function Lg(t){return"longpress"===t.type||0===t.type.indexOf("touch")}function Wg(t,n){return"contextmenu"===n.type||"longpress"===n.type?t.inline?function(t){if(Lg(t)){var n=t.touches[0];return Ng(n.pageX,n.pageY)}return Ng(t.pageX,t.pageY)}(n):(e=t.getContentAreaContainer(),o=function(t){if(Lg(t)){var n=t.touches[0];return Ng(n.clientX,n.clientY)}return Ng(t.clientX,t.clientY)}(n),i=(r=zC.DOM.getPos(e)).x,u=r.y,Ng(o.x+i,o.y+u)):kB(t);var e,o,r,i,u}function Ug(t,n,e){switch(e){case"node":return{type:"node",node:Sh.some(Ph.fromDom((o=t).selection.getNode())),root:Ph.fromDom(o.getBody())};case"point":return Wg(t,n);case"selection":return kB(t)}var o}function jg(t,n,e,o,r,i){function u(){var u,a,c,m,g,p,h,v,b,y;c=e(),m=o,g=r,h=!(f||s||l&&d),b=Ug(u=t,a=n,v=p=i),y=yh({bubble:br(0,"point"===v?12:0,OB),layouts:CB,overrides:{maxWidthFunction:vD(),maxHeightFunction:xx()}},b),Vf(c,uC.CLOSE_ON_EXECUTE,m,!0).map((function(t){a.preventDefault(),Ok.showMenuWithinBounds(g,{anchor:y},{menu:{markers:tc("normal"),highlightImmediately:h},data:t,type:"horizontal"},(function(){return Sh.some(_g(u,m.shared,"node"===p?"node":"selection"))})),u.fire(fB)}))}var a,c=rv(),s=c.os.isiOS(),l=c.os.isOSX(),f=c.os.isAndroid(),d=c.deviceType.isTouch();(l||s)&&"node"!==i?(a=function(){(function(t){function n(){Dk.setEditorTimeout(t,(function(){t.selection.setRng(r)}),10),i()}function e(t){t.preventDefault(),t.stopImmediatePropagation()}function o(){return i()}var r=t.selection.getRng();t.once("touchend",n),t.on("mousedown",e,!0),t.once("longpresscancel",o);var i=function(){t.off("touchend",n),t.off("longpresscancel",o),t.off("mousedown",e)}})(t),u()},function(t,n){var e=t.selection;if(!(e.isCollapsed()||n.touches.length<1)){var o=n.touches[0],r=e.getRng();return Lr(t.getWin(),Vx.domRange(r)).exists((function(t){return t.left<=o.clientX&&t.right>=o.clientX&&t.top<=o.clientY&&t.bottom>=o.clientY}))}}(t,n)?a():(t.once("selectionchange",a),t.once("touchend",(function(){return t.off("selectionchange",a)})))):u()}function Gg(t){return"string"==typeof t?t.split(/[ ,]/):t}function Xg(t){return t.getParam("contextmenu_never_use_native",!1,"boolean")}function Yg(t){return ah(t)?"|"===t:"separator"===t.type}function qg(t,n){if(0===n.length)return t;var e=H(t).filter((function(t){return!Yg(t)})).fold((function(){return[]}),(function(){return[_B]}));return t.concat(e).concat(n).concat([_B])}function Kg(t,n){return"longpress"!==n.type&&(2!==n.button||n.target===t.getBody()&&""===n.pointerType)}function Jg(t,n){return Kg(t,n)?t.selection.getStart(!0):n.target}function $g(t,n,e){function o(){return Ok.hide(u)}function r(n){var o;Xg(t)&&n.preventDefault(),n.ctrlKey&&!Xg(t)||!1===t.getParam("contextmenu")||(o=function(t,n){var e=t.getParam("contextmenu_avoid_overlap","","string"),o=Kg(t,n)?"selection":"point";if(Q(e)){var r=Jg(t,n);return _s(Ph.fromDom(r),e)?"node":o}return o}(t,n),(i()?jg:function(t,n,e,o,r,i){var u=e(),a=Ug(t,n,i);Vf(u,uC.CLOSE_ON_EXECUTE,o,!1).map((function(t){n.preventDefault(),Ok.showMenuAt(r,{anchor:a},{menu:{markers:tc("normal")},data:t})}))})(t,n,(function(){var e,o,r,i=Jg(t,n),u=t.ui.registry.getAll(),a=(r=(o=t).ui.registry.getAll().contextMenus,Sh.from(o.getParam("contextmenu")).map(Gg).getOrThunk((function(){return k(Gg("link linkchecker image imagetools table spellchecker configurepermanentpen"),(function(t){return Ah(r,t)}))}))),c=u.contextMenus,s=i;return 0<(e=O(a,(function(t,n){return G(c,n.toLowerCase()).map((function(n){var e=n.update(s);if(ah(e))return qg(t,e.split(" "));if(0<e.length){var o=w(e,TB);return qg(t,o)}return t})).getOrThunk((function(){return t.concat([n])}))}),[])).length&&Yg(e[e.length-1])&&e.pop(),e}),e,u,o))}var i=rv().deviceType.isTouch,u=Oy(Ok.sketch({dom:{tag:"div"},lazySink:n,onEscape:function(){return t.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:ex([ra("dismissContextMenu",[Ee(Gb(),(function(n){rw.close(n),t.focus()}))])])}));t.on("init",(function(){var n="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(i()?"":" ResizeWindow");t.on(n,o),t.on("longpress contextmenu",r)}))}function Qg(t){return function(n){return n.translate(-t.left,-t.top)}}function Zg(t){return function(n){return n.translate(t.left,t.top)}}function tp(t){return function(n,e){return O(t,(function(t,n){return n(t)}),vv(n,e))}}function np(t,n,e){return t.fold(tp([Zg(e),Qg(n)]),tp([Qg(n)]),tp([]))}function ep(t,n,e){return t.fold(tp([Zg(e)]),tp([]),tp([Zg(n)]))}function op(t,n,e){return t.fold(tp([]),tp([Qg(e)]),tp([Zg(n),Qg(e)]))}function rp(t,n,e){var o=t.fold((function(t,n){return{position:Sh.some("absolute"),left:Sh.some(t+"px"),top:Sh.some(n+"px")}}),(function(t,n){return{position:Sh.some("absolute"),left:Sh.some(t-e.left+"px"),top:Sh.some(n-e.top+"px")}}),(function(t,n){return{position:Sh.some("fixed"),left:Sh.some(t+"px"),top:Sh.some(n+"px")}}));return yh({right:Sh.none(),bottom:Sh.none()},o)}function ip(t,n,e,o){function r(t,r){return function(i,u){var a=t(n,e,o);return r(i.getOr(a.left),u.getOr(a.top))}}return t.fold(r(op,DB),r(ep,BB),r(np,MB))}function up(t,n){var e=Tt(t,n);return dh(e)?NaN:parseInt(e,10)}function ap(t,n,e,o,r,i){var u,a,c,s,l,f,d=(u=e,a=o,l=up(s=t.element,(c=n).leftAttr),f=up(s,c.topAttr),(isNaN(l)||isNaN(f)?Sh.none():Sh.some(vv(l,f))).fold((function(){return u}),(function(t){return MB(t.left+a.left,t.top+a.top)}))),m=(n.mustSnap?AB:FB)(t,n,d,r,i),g=np(d,r,i),p=n,h=g,v=t.element;return Ot(v,p.leftAttr,h.left+"px"),Ot(v,p.topAttr,h.top+"px"),m.fold((function(){return{coord:MB(g.left,g.top),extra:Sh.none()}}),(function(t){return{coord:t.output,extra:t.extra}}))}function cp(t,n,e,o){return z(t,(function(t){var r,i,u=t.sensor,a=t.range.left,c=t.range.top,s=ep(n,r=e,i=o),l=ep(u,r,i);return Math.abs(s.left-l.left)<=a&&Math.abs(s.top-l.top)<=c?Sh.some({output:ip(t.output,n,e,o),extra:t.extra}):Sh.none()}))}function sp(t,n){var e;t.getSystem().addToGui(n),pt((e=n).element).filter(Nh).each((function(t){Pt(t,"z-index").each((function(n){Ot(t,RB,n)})),Ft(t,"z-index",Vt(e.element,"z-index"))}))}function lp(t){pt(t.element).filter(Nh).each((function(t){Et(t,RB).fold((function(){return zt(t,"z-index")}),(function(n){return Ft(t,"z-index",n)})),Bt(t,RB)})),t.getSystem().removeFromGui(t)}function fp(t,n,e){return t.getSystem().build(TO.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:e}))}function dp(t,n){return{bounds:t.getBounds(),height:Ut(n.element),width:Yt(n.element)}}function mp(t,n,e,o,r){var i=e.update(o,r),u=e.getStartData().getOrThunk((function(){return dp(n,t)}));i.each((function(e){var o,r,i,c,s,l,f,d,m,g,p,h,v,b,y,x,w,S,k,C,O,_,T,E,D,B=t,M=u,A=e,F=(o=n).getTarget(B.element);o.repositionTarget&&(r=en(ft(B.element)),i=Gd(F),_=Pt(O=F,"left"),T=Pt(O,"top"),E=Pt(O,"position"),D=function(t,n,e){return("fixed"===e?MB:DB)(parseInt(t,10),parseInt(n,10))},c=(_.isSome()&&T.isSome()&&E.isSome()?Sh.some(D(_.getOrDie(),T.getOrDie(),E.getOrDie())):Sh.none()).getOrThunk((function(){var t=Gt(O);return BB(t.left,t.top)})),s=B,l=o.snaps,f=c,d=r,m=i,g=A,p=M,v=l.fold((function(){var t,n,e=np((t=g.left,n=g.top,f.fold((function(e,o){return DB(e+t,o+n)}),(function(e,o){return BB(e+t,o+n)}),(function(e,o){return MB(e+t,o+n)}))),d,m);return MB(e.left,e.top)}),(function(t){var n=ap(s,t,f,g,d,m);return n.extra.each((function(n){t.onSensor(s,n)})),n.coord})),b=d,y=m,x=(h=p).bounds,w=ep(v,b,y),S=Gy(w.left,x.x,x.x+x.width-h.width),k=Gy(w.top,x.y,x.y+x.height-h.height),C=BB(S,k),Rt(F,rp(v.fold((function(){var t=op(C,b,y);return DB(t.left,t.top)}),a(C),(function(){var t=np(C,b,y);return MB(t.left,t.top)})),0,i))),o.onDrag(B,F,A)}))}function gp(t,n,e,o){n.each(lp),e.snaps.each((function(n){var e,o;e=n,Bt(o=t.element,e.leftAttr),Bt(o,e.topAttr)}));var r=e.getTarget(t.element);o.reset(),e.onDrop(t,r)}function pp(t){return function(n,e){function o(t){
e.setStartData(dp(n,t))}return ty(g([Ee(Lb(),(function(t){e.getStartData().each((function(){return o(t)}))}))],t(n,e,o),!0))}}function hp(t,n,e){return[Ee(fb(),(function(o,r){var i,u,a,c,s;0===r.event.raw.button&&(r.stop(),a={drop:i=function(){return gp(o,Sh.some(c),t,n)},delayDrop:(u=Ts(i,200)).schedule,forceDrop:i,move:function(e){u.cancel(),mp(o,t,n,HB,e)}},c=fp(o,t.blockerClass,(s=a,ty([Ee(fb(),s.forceDrop),Ee(gb(),s.drop),Ee(db(),(function(t,n){s.move(n.event)})),Ee(mb(),s.delayDrop)]))),e(o),sp(o,c))}))]}function vp(t,n,e){function o(e){gp(e,r.get(),t,n),r.clear()}var r=lr();return[Ee(ab(),(function(i,u){function a(){return o(i)}u.stop();var c,s,l,f=fp(i,t.blockerClass,(s=c=a,l=function(e){mp(i,t,n,NB,e)},ty([Ee(ab(),s),Ee(sb(),c),Ee(lb(),c),Ee(cb(),(function(t,n){l(n.event)}))])));r.set(f),e(i),sp(i,f)})),Ee(cb(),(function(e,o){o.stop(),mp(e,t,n,NB,o.event)})),Ee(sb(),(function(t,n){n.stop(),o(t)})),Ee(lb(),o)]}function bp(t,n,e,o,r,i){return t.fold((function(){return UB.snap({sensor:BB(e-20,o-20),range:vv(r,i),output:BB(Sh.some(e),Sh.some(o)),extra:{td:n}})}),(function(t){var r=e-20,i=o-20,u=t.element.dom.getBoundingClientRect();return UB.snap({sensor:BB(r,i),range:vv(40,40),output:BB(Sh.some(e-u.width/2),Sh.some(o-u.height/2)),extra:{td:n}})}))}function yp(t,n,e){return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,o){var r=o.td,i=n.get(),u=r;i.exists((function(t){return st(t,u)}))||(n.set(r),e(r))},mustSnap:!0}}function xp(t){return Ba(Bk.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:ex([UB.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:t}),S_.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))}function wp(t,n){function e(t){var e=cn(t);return bp(g.getOpt(n),t,e.x,e.y,e.width,e.height)}function o(t){var e=cn(t);return bp(p.getOpt(n),t,e.right,e.bottom,e.width,e.height)}function r(n,e,o,r){var i=o(e);UB.snapTo(n,i),function(n){var o=e.dom.getBoundingClientRect();zt(n.element,"display");var i=gt(Ph.fromDom(t.getBody())).dom.innerHeight,u=o[r]<0,a=o[r]>i;(u||a)&&Ft(n.element,"display","none")}(n)}function i(t){return r(h,t,e,"top")}function u(t){return r(v,t,o,"bottom")}var a=fe([]),c=fe([]),s=fe(!1),l=lr(),f=lr(),d=yp((function(){return w(a.get(),e)}),l,(function(n){f.get().each((function(e){t.fire("TableSelectorChange",{start:n,finish:e})}))})),m=yp((function(){return w(c.get(),o)}),f,(function(n){l.get().each((function(e){t.fire("TableSelectorChange",{start:e,finish:n})}))})),g=xp(d),p=xp(m),h=Oy(g.asSpec()),v=Oy(p.asSpec());rv().deviceType.isTouch()&&(t.on("TableSelectionChange",(function(t){s.get()||(oi(n,h),oi(n,v),s.set(!0)),l.set(t.start),f.set(t.finish),t.otherCells.each((function(n){a.set(n.upOrLeftCells),c.set(n.downOrRightCells),i(t.start),u(t.finish)}))})),t.on("ResizeEditor ResizeWindow ScrollContent",(function(){l.get().each(i),f.get().each(u)})),t.on("TableSelectionClear",(function(){s.get()&&(ii(h),ii(v),s.set(!1)),l.clear(),f.clear()})))}function Sp(t,n,e){var o,r,i,u,a,c,s=Ph.fromDom(t.getContainer());N((o=t,r=n,i=e,u=Wt(s),a=Xt(s),(c={}).height=yg(u+r.top,gc(o),hc(o)),i===WD.Both&&(c.width=yg(a+r.left,mc(o),pc(o))),c),(function(t,n){return Ft(s,n,bg(t)),0})),t.fire("ResizeEditor")}function kp(t,n,e,o){return Sp(t,vv(20*e,20*o),n),Sh.some(!0)}function Cp(t,n){function e(t,n,e){return tk.set(t,[co(m.translate(["{0} "+e,n[e]]))])}var o,r,i,u,a,c,s,l,f,d,m,g,p,h,v,b;return{dom:{tag:"div",classes:["tox-statusbar"]},components:(b=[],t.getParam("elementpath",!0,"boolean")&&b.push((p=t,v=n,(h={}).delimiter||(h.delimiter="\xbb"),{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:ex([QS.config({mode:"flow",selector:"div[role=button]"}),tS.config({disabled:v.isDisabled}),Bc(),AO.config({}),tk.config({}),ra("elementPathEvents",[ny((function(t){p.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return QS.focusIn(t)})),p.on("NodeChange",(function(n){var e,o,r=function(t){for(var n=[],e=t.length;0<e--;){var o=t[e];if(1===o.nodeType&&!function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return 1;if("bookmark"===t.getAttribute("data-mce-type"))return 1}}(o)){var r=p.fire("ResolveName",{name:o.nodeName.toLowerCase(),target:o});if(r.isDefaultPrevented()||n.push({name:r.name,element:o}),r.isPropagationStopped())break}}return n}(n.parents);0<r.length?tk.set(t,(e=w(r||[],(function(t,n){return Bk.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":n,"tab-index":-1,"aria-level":n+1},innerHtml:t.name},action:function(){p.focus(),p.selection.select(t.element),p.nodeChanged()},buttonBehaviours:ex([YC(v.isDisabled),Bc()])})})),o={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+h.delimiter+" "}},O(e.slice(1),(function(t,n){var e=t;return e.push(o),e.push(n),e}),[e[0]]))):tk.set(t,[])}))}))])]),components:[]})),t.hasPlugin("wordcount")&&b.push((d=t,m=n,Bk.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:ex([YC(m.isDisabled),Bc(),AO.config({}),tk.config({}),pw.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),ra("wordcount-events",[ry((function(t){var n=pw.getValue(t),o="words"===n.mode?"characters":"words";pw.setValue(t,{mode:o,count:n.count}),e(t,n.count,o)})),ny((function(t){d.on("wordCountUpdate",(function(n){var o=pw.getValue(t).mode;pw.setValue(t,{mode:o,count:n.wordCount}),e(t,n.wordCount,o)}))}))])]),eventOrder:((g={})[Ab()]=["disabling","alloy.base.behaviour","wordcount-events"],g)}))),t.getParam("branding",!0,"boolean")&&b.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(f=Mk.translate(["Powered by {0}","Tiny"]))+'">'+f+"</a>"}}),o=0<b.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:b}]:[],u=n,c=!(a=i=t).hasPlugin("autoresize"),r=(l=!1===(s=a.getParam("resize",c))?WD.None:"both"===s?WD.Both:WD.Vertical)===WD.None?Sh.none():Sh.some(Pa("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:u.translate("Resize")},behaviours:[UB.config({mode:"mouse",repositionTarget:!1,onDrag:function(t,n,e){return Sp(i,e,l)},blockerClass:"tox-blocker"}),QS.config({mode:"special",onLeft:function(){return kp(i,l,-1,0)},onRight:function(){return kp(i,l,1,0)},onUp:function(){return kp(i,l,0,-1)},onDown:function(){return kp(i,l,0,1)}}),AO.config({}),ok.config({})]},u.icons)),o.concat(r.toArray()))}}function Op(t){function n(){return C.bind(RD.getHeader)}function e(){return Bv.value(F)}function o(){return C.bind((function(t){return RD.getThrobber(t)})).getOrDie("Could not find throbber element")}function r(){var n,e,o,r,i,u,a=bg((r=fc(o=e=t),i=gc(o),u=hc(o),vg(r).map((function(t){return yg(t,i,u)})).getOr(fc(e)))),c=bg(xg(n=t).getOr(dc(n)));return t.inline||(Ht("div","width",c)&&Ft(nt.element,"width",c),Ht("div","height",a)?Ft(nt.element,"height",a):Ft(nt.element,"height","200px")),a}function u(t,n){Th([ot,rt],(function(e){e.broadcastEvent(t,n)}))}function a(t,n){Th([ot,rt],(function(e){e.broadcastOn([t],n)}))}function c(t){return a(iw(),{target:t.target})}function s(t){return a(iw(),{target:Ph.fromDom(t.target)})}function l(t){0===t.button&&a(aw(),{target:Ph.fromDom(t.target)})}function f(){Th(et.editorManager.get(),(function(t){et!==t&&t.fire("DismissPopups",{relatedTarget:et})}))}function d(t){return u(Lb(),hx(t))}function m(t){a(uw(),{}),u(Wb(),hx(t))}function g(){return a(uw(),{})}function p(t){t.state&&a(iw(),{target:Ph.fromDom(et.getContainer())})}function h(t){a(iw(),{target:Ph.fromDom(t.relatedTarget.getContainer())})}var v,b,y,x,w=t.inline,S=w?lB:sB,k=Tc(t)?JE:NE,C=Sh.none(),O=rv(),_=O.browser.isIE()?["tox-platform-ie"]:[],T=O.deviceType.isTouch()?["tox-platform-touch"]:[],D=Sc(t),B=Oc(t),M=Mk.isRtl()?{attributes:{dir:"rtl"}}:{},A={attributes:((v={})[Ox]=D?lx.BottomToTop:lx.TopToBottom,v)},F=Oy((b=st(dv(),B)&&"grid"===Vt(B,"display"),y={dom:yh({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(_).concat(T)},M),behaviours:ex([$x.config({useFixed:function(){return k.isDocked(n)}})])},x={dom:{styles:{width:document.body.clientWidth+"px"}},events:ty([Ee(Wb(),(function(){Ft(mt.element,"width",document.body.clientWidth+"px")}))])},zv(y,b?x:{}))),I=Ba({dom:{tag:"div",classes:["tox-anchorbar"]}}),R=Ud(F,t,(function(){return C.bind((function(t){return I.getOpt(t)})).getOrDie("Could not find a anchor bar element")})),V=RD.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:R,onEscape:function(){t.focus()}}),P=xc(t),H=RD.parts.toolbar(yh({dom:{tag:"div",classes:["tox-toolbar"]},getSink:e,providers:R.shared.providers,onEscape:function(){t.focus()},type:P,lazyToolbar:function(){return C.bind((function(t){return RD.getToolbar(t)})).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return n().getOrDie("Could not find header element")}},A)),z=RD.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:R.shared.providers,onEscape:function(){t.focus()},type:P}),N=RD.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),W=RD.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),U=RD.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:R}),j=t.getParam("statusbar",!0,"boolean")&&!w?Sh.some(Cp(t,R.shared.providers)):Sh.none(),G={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[N,W]},X=LC(t),q=bc(t),K=vc(t),J=RD.parts.header({dom:yh({tag:"div",classes:["tox-editor-header"]},A),components:E([K?[V]:[],X?[z]:q?[H]:[],Cc(t)?[]:[I.asSpec()]]),sticky:Tc(t),editor:t,sharedBackstage:R.shared}),$=E([D?[]:[J],w?[]:[G],D?[J]:[]]),Q=E([[{dom:{tag:"div",classes:["tox-editor-container"]},components:$}],w?[]:j.toArray(),[U]]),Z=_c(t),tt=yh(yh({role:"application"},Mk.isRtl()?{dir:"rtl"}:{}),Z?{"aria-hidden":"true"}:{}),nt=Oy(RD.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(w?["tox-tinymce-inline"]:[]).concat(D?["tox-tinymce--toolbar-bottom"]:[]).concat(T).concat(_),styles:yh({visibility:"hidden"},Z?{opacity:"0",border:"0"}:{}),attributes:tt},components:Q,behaviours:ex([Bc(),tS.config({disableClass:"tox-tinymce--disabled"}),QS.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])}));C=Sh.some(nt);t.shortcuts.add("alt+F9","focus menubar",(function(){RD.focusMenubar(nt)})),t.shortcuts.add("alt+F10","focus toolbar",(function(){RD.focusToolbar(nt)})),t.addCommand("ToggleToolbarDrawer",(function(){RD.toggleToolbarDrawer(nt)})),t.addQueryStateHandler("ToggleToolbarDrawer",(function(){return RD.isToolbarDrawerToggled(nt)}));var et,ot,rt,it,ut,at,ct,lt,ft,dt=Is(nt),mt=Is(F);return et=t,ot=dt,rt=mt,it=qo(),ut=fr(it,"touchstart",c),at=fr(it,"touchmove",(function(t){return u(zb(),t)})),ct=fr(it,"touchend",(function(t){return u(Nb(),t)})),lt=fr(it,"mousedown",c),ft=fr(it,"mouseup",(function(t){0===t.raw.button&&a(aw(),{target:t.target})})),et.on("PostRender",(function(){et.on("click",s),et.on("tap",s),et.on("mouseup",l),et.on("mousedown",f),et.on("ScrollWindow",d),et.on("ResizeWindow",m),et.on("ResizeEditor",g),et.on("AfterProgressState",p),et.on("DismissPopups",h)})),et.on("remove",(function(){et.off("click",s),et.off("tap",s),et.off("mouseup",l),et.off("mousedown",f),et.off("ScrollWindow",d),et.off("ResizeWindow",m),et.off("ResizeEditor",g),et.off("AfterProgressState",p),et.off("DismissPopups",h),lt.unbind(),ut.unbind(),at.unbind(),ct.unbind(),ft.unbind()})),et.on("detach",(function(){ci(ot),ci(rt),ot.destroy(),rt.destroy()})),{mothership:dt,uiMothership:mt,backstage:R,renderUI:function(){var i,u;k.setup(t,R.shared,n),zg(t,R),$g(t,e,R),u=(i=t).ui.registry.getAll().sidebars,Th(Dh(u),(function(t){function n(){return Y(Sh.from(i.queryCommandValue("ToggleSidebar")),t)}var e=u[t];i.ui.registry.addToggleButton(t,{icon:e.icon,tooltip:e.tooltip,onAction:function(e){i.execCommand("ToggleSidebar",!1,t),e.setActive(n())},onSetup:function(t){function e(){return t.setActive(n())}return i.on("ToggleSidebar",e),function(){i.off("ToggleSidebar",e)}}})})),Om(t,o,R.shared),L(t.getParam("toolbar_groups",{},"object"),(function(n,e){t.ui.registry.addGroupToolbarButton(e,n)}));var a,c=t.ui.registry.getAll(),s=c.buttons,l=c.menuItems,f=c.contextToolbars,d=c.sidebars,m=yc(t),g={menuItems:l,menus:(a=t.getParam("menu"))?L(a,(function(t){return yh(yh({},t),{items:t.items})})):{},menubar:t.getParam("menubar"),toolbar:m.getOrThunk((function(){return t.getParam("toolbar",!0)})),allowToolbarGroups:P===eC.floating,buttons:s,sidebar:d};Ag(t,f,F,{backstage:R}),wp(t,F);var p=t.getElement(),h=r();return S.render(t,{mothership:dt,uiMothership:mt,outerContainer:nt},g,R,{targetNode:p,height:h})},getUi:function(){return{channels:{broadcastAll:mt.broadcast,broadcastOn:mt.broadcastOn,register:i}}}}}function _p(t){return Zv("items","items",bn(),Bn(In((function(n){return Vn("Checking item of "+t,ZM,n).fold((function(t){return Bv.error(Qv(t))}),(function(t){return Bv.value(t)}))}))))}function Tp(t){return ah(t.type)&&ah(t.name)}function Ep(t){return{internalDialog:Pn(Vn("dialog",aA,t)),dataValidator:(n=D(k(lA(t),Tp),(function(t){return Sh.from(fA[t.type]).fold((function(){return[]}),(function(n){return[Wn(t.name,n)]}))})),Uv(n)),initialData:t.initialData};var n}function Dp(t){var n=[],e={};return N(t,(function(t,o){t.fold((function(){n.push(o)}),(function(t){e[o]=t}))})),0<n.length?Bv.error(n):Bv.value(e)}function Bp(t,n){Ft(t,"height",n+"px"),rv().browser.isIE()?zt(t,"flex-basis"):Ft(t,"flex-basis",n+"px")}function Mp(t,n,e){go(t,'[role="dialog"]').each((function(t){po(t,'[role="tablist"]').each((function(o){e.get().map((function(e){return Ft(n,"height","0"),Ft(n,"flex-basis","0"),Math.min(e,(i=n,u=o,a=mt(r=t).dom,c="fixed"===Vt(go(r,".tox-dialog-wrap").getOr(r),"position")?Math.max(a.clientHeight,window.innerHeight):Math.max(a.offsetHeight,a.scrollHeight),s=Wt(i),l=i.dom.offsetLeft>=u.dom.offsetLeft+Xt(u)?Math.max(Wt(u),s):s,f=parseInt(Vt(r,"margin-top"),10)||0,d=parseInt(Vt(r,"margin-bottom"),10)||0,c-(Wt(r)+f+d-l)));var r,i,u,a,c,s,l,f,d})).each((function(t){Bp(n,t)}))}))}))}function Ap(t){return po(t,'[role="tabpanel"]')}function Fp(t,n){function e(t){var n=Dp(pw.getValue(t)).getOr({}),e=u.get(),o=zv(e,n);u.set(o)}function o(t){var n=u.get();pw.setValue(t,n)}var r,i,u=fe({}),a=fe(null),c=w(t.tabs,(function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:n.shared.providers.translate(t.title)},view:function(){return[aT.sketch((function(r){return{dom:{tag:"div",classes:["tox-form"]},components:w(t.items,(function(t){return yd(r,t,n)})),formBehaviours:ex([QS.config({mode:"acyclic",useTabstopAt:f(cf)}),ra("TabView.form.events",[ny(o),ey(e)]),ux.config({channels:ge([{key:wA,value:{onReceive:e}},{key:SA,value:{onReceive:o}}])})])}}))]}}})),s=(r=c,i=lr(),{extraEvents:[ny((function(t){var n=t.element;Ap(n).each((function(e){var o;Ft(e,"visibility","hidden"),t.getSystem().getByDom(e).toOptional().each((function(t){var n,o,u;P(R((o=e,u=t,w(n=r,(function(t,e){tk.set(u,n[e].view());var r=o.dom.getBoundingClientRect();return tk.set(u,[]),r.height}))),(function(t,n){return n<t?-1:t<n?1:0}))).fold(i.clear,i.set)})),Mp(n,e,i),zt(e,"visibility"),o=t,P(r).each((function(t){return xA.showTab(o,t.value)})),Dk.requestAnimationFrame((function(){Mp(n,e,i)}))}))})),Ee(Wb(),(function(t){var n=t.element;Ap(n).each((function(t){Mp(n,t,i)}))})),Ee(jO,(function(t){var n=t.element;Ap(n).each((function(t){var e=$o(cv(t));Ft(t,"visibility","hidden");var o=Pt(t,"height").map((function(t){return parseInt(t,10)}));zt(t,"height"),zt(t,"flex-basis");var r=t.dom.getBoundingClientRect().height;o.forall((function(t){return t<r}))?(i.set(r),Mp(n,t,i)):o.each((function(n){Bp(t,n)})),zt(t,"visibility"),e.each(Ko)}))}))],selectFirst:!1});return xA.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n){var e=pw.getValue(n);Se(t,UO,{name:e,oldName:a.get()}),a.set(e)},tabs:c,components:[xA.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[hA.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:ex([AO.config({})])}),xA.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:s.selectFirst,tabSectionBehaviours:ex([ra("tabpanel",s.extraEvents),QS.config({mode:"acyclic"}),qw.config({find:function(t){return P(xA.getViewItems(t))}}),pw.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([wA],{}),u.get()},setValue:function(t,n){u.set(n),t.getSystem().broadcastOn([SA],{})}}})])})}function Ip(t,n,e,o){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:yh(yh({},n.map((function(t){return{id:t}})).getOr({})),o?{"aria-live":"polite"}:{})},components:[],behaviours:ex([mT(0),JD.config({channel:OA,updateState:function(t,n){return Sh.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},renderComponents:function(t){return"tabpanel"!==t.body.type?[(n=t.body,o=e,{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[(r=Ba(aT.sketch((function(t){return{dom:{tag:"div",classes:["tox-form"].concat(n.classes)},components:w(n.items,(function(n){return yd(t,n,o)}))}})))).asSpec()]}],behaviours:ex([QS.config({mode:"acyclic",useTabstopAt:f(cf)}),dT(r),bT(r,{postprocess:function(t){return Dp(t).fold((function(t){return console.error(t),{}}),c)}})])})]:[Fp(t.body,e)];var n,o,r},initialData:t})])}}function Rp(t,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,n]}}function Vp(t,n){return qB.parts.close(Bk.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:ex([AO.config({})])}))}function Pp(){return qB.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})}function Hp(t,n){return qB.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:km("<p>"+n.translate(t)+"</p>")}]}]})}function zp(t){return qB.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})}function Np(t,n){return[TO.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),TO.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]}function Lp(t){var n,e="tox-dialog",o=e+"-wrap",r=o+"__backdrop",i=e+"__disable-scroll";return qB.sketch({lazySink:t.lazySink,onEscape:function(n){return t.onEscape(n),Sh.some(!0)},useTabstopAt:function(t){return!cf(t)},dom:{tag:"div",classes:[e].concat(t.extraClasses),styles:yh({position:"relative"},t.extraStyles)},components:g([t.header,t.body],t.footer.toArray(),!0),parts:{blocker:{dom:km('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:EA?[r,r+"--opaque"]:[r]}}]}},dragBlockClass:o,modalBehaviours:ex(g([ok.config({}),ra("dialog-events",t.dialogEvents.concat([Ie(hb(),(function(t){QS.focusIn(t)}))])),ra("scroll-lock",[ny((function(){$e(dv(),i)})),ey((function(){Qe(dv(),i)}))])],t.extraBehaviours,!0)),eventOrder:yh(((n={})[Ab()]=["dialog-events"],n[Ub()]=["scroll-lock","dialog-events","alloy.base.behaviour"],n[jb()]=["alloy.base.behaviour","dialog-events","scroll-lock"],n),t.eventOrder)})}function Wp(t){return Bk.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[Pa("close",{tag:"div",classes:["tox-icon"]},t.icons)],action:function(t){we(t,HO)}})}function Up(t,n,e){function o(t){return[co(e.translate(t.title))]}return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:yh({},n.map((function(t){return{id:t}})).getOr({}))},components:o(t),behaviours:ex([JD.config({channel:CA,renderComponents:o})])}}function jp(){return{dom:km('<div class="tox-dialog__draghandle"></div>')}}function Gp(t,n){return e={title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},o=n.shared.providers,r=qB.parts.title(Up(e,Sh.none(),o)),i=qB.parts.draghandle(jp()),u=qB.parts.close(Wp(o)),a=[r].concat(e.draggable?[i]:[]).concat([u]),TO.sketch({dom:km('<div class="tox-dialog__header"></div>'),components:a});var e,o,r,i,u,a}function Xp(t,n,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.translate(t)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:n,components:[{dom:km('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}}function Yp(t,n,e){return{onClose:function(){return e.closeWindow()},onBlock:function(e){qB.setBusy(t(),(function(t,o){return Xp(e.message,o,n)}))},onUnblock:function(){qB.setIdle(t())}}}function qp(t,n,e,o){var r;return Oy(Lp(yh(yh({},t),{lazySink:o.shared.getSink,extraBehaviours:g([JD.config({channel:kA,updateState:function(t,n){return Sh.some(n)},initialData:n}),xT({})],t.extraBehaviours,!0),onEscape:function(t){we(t,HO)},dialogEvents:e,eventOrder:((r={})[Mb()]=[JD.name(),ux.name()],r[Ub()]=["scroll-lock",JD.name(),"messages","dialog-events","alloy.base.behaviour"],r[jb()]=["alloy.base.behaviour","dialog-events","messages",JD.name(),"scroll-lock"],r)})))}function Kp(t){return w(t,(function(t){return"menu"===t.type?(e=w((n=t).items,(function(t){var n=fe(!1);return yh(yh({},t),{storage:n})})),yh(yh({},n),{items:e})):t;var n,e}))}function Jp(t){return O(t,(function(t,n){return"menu"!==n.type?t:O(n.items,(function(t,n){return t[n.name]=n.storage,t}),t)}),{})}function $p(t,n){return[Ae(hb(),af),t(PO,(function(t,e){n.onClose(),e.onClose()})),t(HO,(function(t,n,e,o){n.onCancel(t),we(o,PO)})),Ee(WO,(function(){return n.onUnblock()})),Ee(LO,(function(t,e){return n.onBlock(e.event)}))]}function Qp(t,n){function e(t,n){return TO.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:w(n,(function(t){return t.memento.asSpec()}))})}var o=S(n.map((function(t){return t.footerButtons})).getOr([]),(function(t){return"start"===t.align}));return[e("start",o.pass),e("end",o.fail)]}function Zp(t,n){return{dom:km('<div class="tox-dialog__footer"></div>'),components:[],behaviours:ex([JD.config({channel:_A,initialData:t,updateState:function(t,e){var o=w(e.buttons,(function(t){var e=Ba(Gf(t,t.type,n));return{name:t.name,align:t.align,memento:e}}));return Sh.some({lookupByName:function(t,n){return e=t,r=n,_(o,(function(t){return t.name===r})).bind((function(t){return t.memento.getOpt(e)}));var e,r},footerButtons:o})},renderComponents:Qp})])}}function th(t,n){return qB.parts.footer(Zp(t,n))}function nh(t,n){if(t.getRoot().getSystem().isConnected()){var e=qw.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper());return aT.getField(e,n).fold((function(){var o=t.getFooter();return JD.getState(o).get().bind((function(t){return t.lookupByName(e,n)}))}),(function(t){return Sh.some(t)}))}return Sh.none()}function eh(t,n,e){function o(n){var e=t.getRoot();e.getSystem().isConnected()&&n(e)}var r={getData:function(){var n=t.getRoot(),o=n.getSystem().isConnected()?t.getFormWrapper():n,r=pw.getValue(o),i=L(e,(function(t){return t.get()}));return yh(yh({},r),i)},setData:function(n){o((function(){var o,i,u=r.getData(),a=yh(yh({},u),n),c=(o=a,i=t.getRoot(),JD.getState(i).get().map((function(t){return Pn(Vn("data",t.dataValidator,o))})).getOr(o)),s=t.getFormWrapper();pw.setValue(s,c),N(e,(function(t,n){Ah(a,n)&&t.set(a[n])}))}))},disable:function(n){nh(t,n).each(tS.disable)},enable:function(n){nh(t,n).each(tS.enable)},focus:function(n){nh(t,n).each(ok.focus)},block:function(t){if(!ah(t))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");o((function(n){Se(n,LO,{message:t})}))},unblock:function(){o((function(t){we(t,WO)}))},showTab:function(n){o((function(){var e=t.getBody();JD.getState(e).get().exists((function(t){return t.isTabPanel()}))&&qw.getCurrent(e).each((function(t){xA.showTab(t,n)}))}))},redial:function(t){o((function(e){var o=n(t);e.getSystem().broadcastOn([kA],o),e.getSystem().broadcastOn([CA],o.internalDialog),e.getSystem().broadcastOn([OA],o.internalDialog),e.getSystem().broadcastOn([_A],o.internalDialog),r.setData(o.initialData)}))},close:function(){o((function(t){we(t,PO)}))}};return r}function oh(t){return ch(t)&&-1!==FA.indexOf(t.mceAction)}function rh(t,n,e,o){function r(t){a.getSystem().isConnected()&&t(a)}var i,u,a,c=Gp(t.title,o),s=(u={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[rf({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:ex([AO.config({}),ok.config({})])})]}],behaviours:ex([QS.config({mode:"acyclic",useTabstopAt:f(cf)})])},qB.parts.body(u)),l=t.buttons.bind((function(t){return 0===t.length?Sh.none():Sh.some(th({buttons:t},o))})),d=DA((function(){return y}),Yp((function(){return b}),o.shared.providers,n)),m=yh(yh({},t.height.fold((function(){return{}}),(function(t){return{height:t+"px","max-height":t+"px"}}))),t.width.fold((function(){return{}}),(function(t){return{width:t+"px","max-width":t+"px"}}))),g=t.width.isNone()&&t.height.isNone()?["tox-dialog--width-lg"]:[],p=new AA(t.url,{base_uri:new AA(window.location.href)}),h=p.protocol+"://"+p.host+(p.port?":"+p.port:""),v=sr(),b=qp({header:c,body:s,footer:l,extraClasses:g,extraBehaviours:[ra("messages",[ny((function(){var n=fr(Ph.fromDom(window),"message",(function(n){var o,r;p.isSameOrigin(new AA(n.raw.origin))&&(oh(o=n.raw.data)?function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content);break;case"setContent":t.setContent(e.content);break;case"execCommand":var o=!!fh(e.ui)&&e.ui;t.execCommand(e.cmd,o,e.value);break;case"close":n.close();break;case"block":n.block(e.message);break;case"unblock":n.unblock()}}(e,y,o):!oh(r=o)&&ch(r)&&Ah(r,"mceAction")&&t.onMessage(y,o))}));v.set(n)})),ey(v.clear)]),ux.config({channels:((i={})[TA]={onReceive:function(t,n){po(t.element,"iframe").each((function(t){t.dom.contentWindow.postMessage(n,h)}))}},i)})],extraStyles:m},t,d,o),y={block:function(t){if(!ah(t))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");r((function(n){Se(n,LO,{message:t})}))},unblock:function(){r((function(t){we(t,WO)}))},close:function(){r((function(t){we(t,PO)}))},sendMessage:function(t){r((function(n){n.getSystem().broadcastOn([TA],t)}))}};return{dialog:a=b,instanceApi:y}}function ih(t){function n(t,n){return dA.open((function(t,e,o){var r,i,u,s,l,f,d,m,g,p,h,v,b,y,x=e,w=(i={redial:dA.redial,closeWindow:function(){qB.hide(w.dialog),n(w.instanceApi)}},u=c,f=Gp((r={dataValidator:o,initialData:x,internalDialog:t}).internalDialog.title,u),s=u,l=Ip({body:r.internalDialog.body},Sh.none(),s,!1),d=qB.parts.body(l),g=Jp(m=Kp(r.internalDialog.buttons)),p=th({buttons:m},u),h=BA((function(){return y}),Yp((function(){return b}),u.shared.providers,i),u.shared.getSink),v=function(){switch(r.internalDialog.size){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}}(),b=qp({header:f,body:d,footer:Sh.some(p),extraClasses:v,extraBehaviours:[],extraStyles:{}},r,h,u),y=eh({getRoot:a(b),getBody:function(){return qB.getBody(b)},getFooter:function(){return qB.getFooter(b)},getFormWrapper:function(){var t=qB.getBody(b);return qw.getCurrent(t).getOr(t)}},i.redial,g),{dialog:b,instanceApi:y});return qB.show(w.dialog),w.instanceApi.setData(x),w.instanceApi}),t)}function e(t,n,e,o){return dA.open((function(t,r,i){function u(){return V.on((function(t){Ok.reposition(t),GE.refresh(t)}))}var f,d,m,p,h,v,b,y,x,w,S,k,C,O,_,T,E,D,B,M,A,F,I,R=Pn(Vn("data",i,r)),V=lr(),P=c.shared.header.isPositionedAtTop(),H=(d={dataValidator:i,initialData:R,internalDialog:t},m={redial:dA.redial,closeWindow:function(){V.on(Ok.hide),s.off("ResizeEditor",u),V.clear(),e(H.instanceApi)}},p=c,h=o,O=He("dialog-label"),_=He("dialog-content"),T=Ba((y={title:d.internalDialog.title,draggable:!0},x=O,w=p.shared.providers,TO.sketch({dom:km('<div class="tox-dialog__header"></div>'),components:[Up(y,Sh.some(x),w),jp(),Wp(w)],containerBehaviours:ex([UB.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return ho(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),E=Ba((S={body:d.internalDialog.body},k=p,C=h,Ip(S,Sh.some(_),k,C))),B=Jp(D=Kp(d.internalDialog.buttons)),M=Ba(MA({buttons:D},p)),A=BA((function(){return I}),{onBlock:function(t){mD.block(F,(function(n,e){return Xp(t.message,e,p.shared.providers)}))},onUnblock:function(){mD.unblock(F)},onClose:function(){return m.closeWindow()}},p.shared.getSink),F=Oy({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:((v={role:"dialog"})["aria-labelledby"]=O,v["aria-describedby"]=_,v)},eventOrder:((b={})[Mb()]=[JD.name(),ux.name()],b[Ab()]=["execute-on-form"],b[Ub()]=["reflecting","execute-on-form"],b),behaviours:ex([QS.config({mode:"cyclic",onEscape:function(t){return we(t,PO),Sh.some(!0)},useTabstopAt:function(t){return!cf(t)&&("button"!==nt(t)||"disabled"!==Tt(t,"disabled"))}}),JD.config({channel:kA,updateState:function(t,n){return Sh.some(n)},initialData:d}),ok.config({}),ra("execute-on-form",A.concat([Ie(hb(),(function(t){QS.focusIn(t)}))])),mD.config({getRoot:function(){return Sh.some(F)}}),tk.config({}),xT({})]),components:[T.asSpec(),E.asSpec(),M.asSpec()]}),I=eh({getRoot:a(F),getFooter:function(){return M.get(F)},getBody:function(){return E.get(F)},getFormWrapper:function(){var t=E.get(F);return qw.getCurrent(t).getOr(t)}},m.redial,B),{dialog:F,instanceApi:I}),z=Oy(Ok.sketch(yh(yh({lazySink:c.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},P?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:ex(g([ra("window-manager-inline-events",[Ee(Gb(),(function(){we(H.dialog,HO)}))])],(f=s,l&&P?[]:[GE.config({contextual:{lazyContext:function(){return Sh.some(_v(Ph.fromDom(f.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]),!0)),isExtraPart:function(t,n){return _s(e=n,".tox-alert-dialog")||_s(e,".tox-confirm-dialog");var e}})));return V.set(z),Ok.showWithin(z,_y(H.dialog),{anchor:n},Sh.some(dv())),l&&P||(GE.refresh(z),s.on("ResizeEditor",u)),H.instanceApi.setData(R),QS.focusIn(H.dialog),H.instanceApi}),t)}var o,r,i,u,c=t.backstage,s=t.editor,l=Tc(s),f=(r=(o=t).backstage.shared,{open:function(t,n){function e(){qB.hide(c),n()}var i=Ba(Gf({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:Sh.none()},"cancel",o.backstage)),u=Pp(),a=Vp(e,r.providers),c=Oy(Lp({lazySink:function(){return r.getSink()},header:Rp(u,a),body:Hp(t,r.providers),footer:Sh.some(zp(Np([],[i.asSpec()]))),onEscape:e,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Ee(HO,e)],eventOrder:{}}));qB.show(c);var s=i.get(c);ok.focus(s)}}),d=(u=(i=t).backstage.shared,{open:function(t,n){function e(t){qB.hide(s),n(t)}var o=Ba(Gf({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:Sh.none()},"submit",i.backstage)),r=Gf({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:Sh.none()},"cancel",i.backstage),a=Pp(),c=Vp((function(){return e(!1)}),u.providers),s=Oy(Lp({lazySink:function(){return u.getSink()},header:Rp(a,c),body:Hp(t,u.providers),footer:Sh.some(zp(Np([],[r,o.asSpec()]))),onEscape:function(){return e(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Ee(HO,(function(){return e(!1)})),Ee(NO,(function(){return e(!0)}))],eventOrder:{}}));qB.show(s);var l=o.get(s);ok.focus(l)}});return{open:function(t,o,r){return void 0!==o&&"toolbar"===o.inline?e(t,c.shared.anchors.inlineDialog(),r,o.ariaAttrs):void 0!==o&&"cursor"===o.inline?e(t,c.shared.anchors.cursor(),r,o.ariaAttrs):n(t,r)},openUrl:function(t,n){return e=n,dA.openUrl((function(t){var n=rh(t,{closeWindow:function(){qB.hide(n.dialog),e(n.instanceApi)}},s,c);return qB.show(n.dialog),n.instanceApi}),t);var e},alert:function(t,n){f.open(t,(function(){n()}))},close:function(t){t.close()},confirm:function(t,n){
d.open(t,(function(t){n(t)}))}}}var uh,ah=t("string"),ch=t("object"),sh=t("array"),lh=e(null),fh=n("boolean"),dh=e(void 0),mh=function(t){return!o(t)},gh=n("function"),ph=n("number"),hh=a(!1),vh=a(!0),bh=tinymce.util.Tools.resolve("tinymce.ThemeManager"),yh=function(){return(yh=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},xh={fold:function(t){return t()},isSome:hh,isNone:vh,getOr:c,getOrThunk:h,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:a(null),getOrUndefined:a(void 0),or:c,orThunk:h,map:p,each:i,bind:p,exists:hh,forall:vh,filter:function(){return xh},toArray:function(){return[]},toString:a("none()")},wh=function(t){function n(){return r}function e(n){return n(t)}var o=a(t),r={fold:function(n,e){return e(t)},isSome:vh,isNone:hh,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:n,orThunk:n,map:function(n){return wh(n(t))},each:function(n){n(t)},bind:e,exists:e,forall:e,filter:function(n){return n(t)?r:xh},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return r},Sh={some:wh,none:p,from:function(t){return null==t?xh:wh(t)}},kh=Array.prototype.slice,Ch=Array.prototype.indexOf,Oh=Array.prototype.push,_h=function(t,n){return-1<v(t,n)},Th=function(t,n){for(var e=0,o=t.length;e<o;e++)n(t[e],e)},Eh=gh(Array.from)?Array.from:function(t){return kh.call(t)},Dh=Object.keys,Bh=Object.hasOwnProperty,Mh=function(t,n){var e={};return N(t,(function(t,o){var r=n(t,o);e[r.k]=r.v})),e},Ah=function(t,n){return Bh.call(t,n)},Fh=function(t,n,e){return t.isSome()&&n.isSome()?Sh.some(e(t.getOrDie(),n.getOrDie())):Sh.none()},Ih=function(t,n){return J(t,n,0)},Rh=function(t,n){return J(t,n,t.length-n.length)},Vh=(uh=/^\s+|\s+$/g,function(t){return t.replace(uh,"")}),Ph={fromHtml:function(t,n){var e=(n||document).createElement("div");if(e.innerHTML=t,!e.hasChildNodes()||1<e.childNodes.length)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return tt(e.childNodes[0])},fromTag:function(t,n){return tt((n||document).createElement(t))},fromText:function(t,n){return tt((n||document).createTextNode(t))},fromDom:tt,fromPoint:function(t,n,e){return Sh.from(t.dom.elementFromPoint(n,e)).map(tt)}};"undefined"!=typeof window||Function("return this;")();var Hh,zh,Nh=et(1),Lh=et(3),Wh=et(9),Uh=et(11),jh=function(t,n){return{major:t,minor:n}},Gh={nu:jh,detect:function(t,n){function e(t){return Number(o.replace(r,"$"+t))}var o,r,i=String(n).toLowerCase();return 0===t.length?sn():(r=function(t,n){for(var e=0;e<t.length;e++){var o=t[e];if(o.test(n))return o}}(t,o=i))?jh(e(1),e(2)):{major:0,minor:0}},unknown:sn},Xh=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Yh={browsers:a([{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return $(t,"edge/")&&$(t,"chrome")&&$(t,"safari")&&$(t,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Xh],search:function(t){return $(t,"chrome")&&!$(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return $(t,"msie")||$(t,"trident")}},{name:"Opera",versionRegexes:[Xh,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:it("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:it("firefox")},{name:"Safari",versionRegexes:[Xh,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return($(t,"safari")||$(t,"mobile/"))&&$(t,"applewebkit")}}]),oses:a([{name:"Windows",search:it("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return $(t,"iphone")||$(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:it("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:it("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:it("linux"),versionRegexes:[]},{name:"Solaris",search:it("sunos"),versionRegexes:[]},{name:"FreeBSD",search:it("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:it("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}])},qh="Firefox",Kh=function(){return ln({current:void 0,version:Gh.unknown()})},Jh=ln,$h=(a("Edge"),a("Chrome"),a("IE"),a("Opera"),a(qh),a("Safari"),"Windows"),Qh="Android",Zh="Solaris",tv="FreeBSD",nv="ChromeOS",ev=function(){return fn({current:void 0,version:Gh.unknown()})},ov=fn,rv=(a($h),a("iOS"),a(Qh),a("Linux"),a("OSX"),a(Zh),a(tv),a(nv),ot((function(){return t=navigator.userAgent,n=Sh.from(navigator.userAgentData),e=ut,h=Yh.browsers(),v=Yh.oses(),b=n.bind((function(t){return n=h,z(t.brands,(function(t){var e=t.brand.toLowerCase();return _(n,(function(t){var n;return e===(null===(n=t.brand)||void 0===n?void 0:n.toLowerCase())})).map((function(n){return{current:n.name,version:Gh.nu(parseInt(t.version,10),0)}}))}));var n})).orThunk((function(){return rt(h,n=t).map((function(t){var e=Gh.detect(t.versionRegexes,n);return{current:t.name,version:e}}));var n})).fold(Kh,Jh),y=rt(v,o=t).map((function(t){var n=Gh.detect(t.versionRegexes,o);return{current:t.name,version:n}})).fold(ev,ov),{browser:b,os:y,deviceType:(i=b,u=t,c=e,s=(r=y).isiOS()&&!0===/ipad/i.test(u),l=r.isiOS()&&!s,d=(f=r.isiOS()||r.isAndroid())||c("(pointer:coarse)"),m=s||!l&&f&&c("(min-device-width:768px)"),g=l||f&&!m,p=i.isSafari()&&r.isiOS()&&!1===/safari/i.test(u),{isiPad:a(s),isiPhone:a(l),isTablet:a(m),isPhone:a(g),isTouch:a(d),isAndroid:r.isAndroid,isiOS:r.isiOS,isWebView:a(p),isDesktop:a(!g&&!m&&!p)})};var t,n,e,o,r,i,u,c,s,l,f,d,m,g,p,h,v,b,y}))),iv=pt,uv=gh(Element.prototype.attachShadow)&&gh(Node.prototype.getRootNode),av=a(uv),cv=uv?function(t){return Ph.fromDom(t.dom.getRootNode())}:dt,sv=function(t){var n=cv(t);return wt(n)?Sh.some(n):Sh.none()},lv=function(t){return mh(t.dom.shadowRoot)},fv=function(t){var n=Lh(t)?t.dom.parentNode:t.dom;if(null==n||null===n.ownerDocument)return!1;var e,o,r=n.ownerDocument;return sv(Ph.fromDom(n)).fold((function(){return r.body.contains(n)}),(e=fv,o=kt,function(t){return e(o(t))}))},dv=function(){return mv(Ph.fromDom(document))},mv=function(t){var n=t.dom.body;if(null==n)throw new Error("Body is not available yet");return Ph.fromDom(n)},gv=function(t,n){return Z(t)?t.style.getPropertyValue(n):""},pv=Lt("height",(function(t){var n=t.dom;return fv(t)?n.getBoundingClientRect().height:n.offsetHeight})),hv=function(t,n){return{left:t,top:n,translate:function(e,o){return hv(t+e,n+o)}}},vv=hv,bv=function(t){var n,e=t.dom,o=e.ownerDocument.body;return o===e?vv(o.offsetLeft,o.offsetTop):fv(t)?(n=e.getBoundingClientRect(),vv(n.left,n.top)):vv(0,0)},yv=Lt("width",(function(t){return t.dom.offsetWidth})),xv=function(t,n,e,o){t.dom.removeEventListener(n,e,o)},wv=function(t,n){t.dom.appendChild(n.dom)},Sv=function(t){var n=t.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},kv=function(t,n){return t.view(n).fold(a([]),(function(n){var e=t.owner(n),o=kv(t,e);return[n].concat(o)}))},Cv=Object.freeze({__proto__:null,view:function(t){var n;return(t.dom===document?Sh.none():Sh.from(null===(n=t.dom.defaultView)||void 0===n?void 0:n.frameElement)).map(Ph.fromDom)},owner:ft}),Ov=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},_v=function(t){var n=Gt(t),e=Yt(t),o=Ut(t);return Ov(n.left,n.top,e,o)},Tv=function(){return un(window)},Ev=function(t){return{isValue:vh,isError:hh,getOr:a(t),getOrThunk:a(t),getOrDie:a(t),or:function(){return Ev(t)},orThunk:function(){return Ev(t)},fold:function(n,e){return e(t)},map:function(n){return Ev(n(t))},mapError:function(){return Ev(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOptional:function(){return Sh.some(t)}}},Dv=function(t){return{isValue:hh,isError:vh,getOr:c,getOrThunk:function(t){return t()},getOrDie:function(){return d(String(t))()},or:c,orThunk:function(t){return t()},fold:function(n){return n(t)},map:function(){return Dv(t)},mapError:function(n){return Dv(n(t))},each:i,bind:function(){return Dv(t)},exists:hh,forall:vh,toOptional:Sh.none}},Bv={value:Ev,error:Dv,fromOption:function(t,n){return t.fold((function(){return Dv(n)}),Ev)}};(zh=Hh={})[zh.Error=0]="Error",zh[zh.Value=1]="Value";var Mv=function(t){return dn(t,Bv.error,Bv.value)},Av=mn,Fv=gn,Iv=function(t,n){return t.stype===Hh.Value?n(t.svalue):t},Rv=function(t,n){return t.stype===Hh.Error?n(t.serror):t},Vv=function(t,n){return t.stype===Hh.Value?{stype:Hh.Value,svalue:n(t.svalue)}:t},Pv=function(t,n){return t.stype===Hh.Error?{stype:Hh.Error,serror:n(t.serror)}:t},Hv=dn,zv=vn((function(t,n){return ch(t)&&ch(n)?zv(t,n):n})),Nv=vn((function(t,n){return n})),Lv=function(t){var n,e,o=(n=[],e=[],Th(t,(function(t){dn(t,(function(t){return e.push(t)}),(function(t){return n.push(t)}))})),{values:n,errors:e});return 0<o.errors.length?u(Fv,E)(o.errors):Av(o.values)},Wv=On(Av),Uv=function(t){return{extract:function(n,e){for(var o={},r=[],i=0,u=t;i<u.length;i++)hn(u[i],(function(t,i,u,a){var c=Tn(u,n,e,t,a);Hv(c,(function(t){r.push.apply(r,t)}),(function(t){o[i]=t}))}),(function(t,n){o[t]=n(e)}));return 0<r.length?Fv(r):Av(o)},toString:function(){return"obj{\n"+w(t,(function(t){return hn(t,(function(t,n,e,o){return t+" -> "+o.toString()}),(function(t){return"state("+t+")"}))})).join("\n")+"}"}}},jv=u(Bn,Uv),Gv=a(Wv),Xv=An(ph,"number"),Yv=An(ah,"string"),qv=An(fh,"boolean"),Kv=An(gh,"function"),Jv=function(t){if(Object(t)!==t)return!0;switch({}.toString.call(t).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(t).every((function(n){return Jv(t[n])}));default:return!1}},$v=On((function(t){return Jv(t)?Av(t):Fv("Expected value to be acceptable for sending via postMessage")})),Qv=function(t){return"Errors: \n"+w(10<(n=t.errors).length?n.slice(0,10).concat([{path:[],getErrorInfo:a("... (only showing first ten failures)")}]):n,(function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()})).join("\n")+"\n\nInput object: "+kn(t.input);var n},Zv=pn,tb=function(t,n){return{tag:"custom",newKey:t,instantiator:n}};de([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);var nb,eb,ob,rb,ib={can:vh,abort:hh,run:i},ub=a,ab=ub("touchstart"),cb=ub("touchmove"),sb=ub("touchend"),lb=ub("touchcancel"),fb=ub("mousedown"),db=ub("mousemove"),mb=ub("mouseout"),gb=ub("mouseup"),pb=ub("mouseover"),hb=ub("focusin"),vb=ub("focusout"),bb=ub("keydown"),yb=ub("keyup"),xb=ub("input"),wb=ub("change"),Sb=ub("click"),kb=ub("transitioncancel"),Cb=ub("transitionend"),Ob=ub("transitionstart"),_b=ub("selectstart"),Tb={tap:xe("tap")},Eb=xe("focus"),Db=xe("blur.post"),Bb=xe("paste.post"),Mb=xe("receive"),Ab=xe("execute"),Fb=xe("focus.item"),Ib=Tb.tap,Rb=xe("longpress"),Vb=xe("sandbox.close"),Pb=xe("typeahead.cancel"),Hb=xe("system.init"),zb=xe("system.touchmove"),Nb=xe("system.touchend"),Lb=xe("system.scroll"),Wb=xe("system.resize"),Ub=xe("system.attached"),jb=xe("system.detached"),Gb=xe("system.dismissRequested"),Xb=xe("system.repositionRequested"),Yb=xe("focusmanager.shifted"),qb=xe("slotcontainer.visibility"),Kb=xe("change.tab"),Jb=xe("dismiss.tab"),$b=xe("highlight"),Qb=xe("dehighlight"),Zb=function(t,n,e,o){var r=yh({target:n},o);t.getSystem().triggerEvent(e,n,r)},ty=ge,ny=Be(Ub()),ey=Be(jb()),oy=Be(Hb()),ry=(nb=Ab(),function(t){return Ee(nb,t)}),iy=ty([{key:Eb(),value:ye({can:function(t,n){var e,o=n.event,r=o.originator,i=o.target;return!(st(e=r,t.element)&&!st(e,i)&&(console.warn(Eb()+" did not get interpreted by the desired target. \nOriginator: "+Pe(r)+"\nTarget: "+Pe(i)+"\nCheck the "+Eb()+" event handlers"),1))}})}]),uy=Object.freeze({__proto__:null,events:iy}),ay=0,cy=a("alloy-id-"),sy=a("data-alloy-id"),ly=cy(),fy=sy(),dy=function(t,n){Object.defineProperty(t.dom,fy,{value:n,writable:!0})},my=He,gy=c,py=Ne(),hy=function(t){return w(t,(function(t){return Rh(t,"/*")?t.substring(0,t.length-"/*".length):t}))},vy=He("alloy-premade"),by={init:function(){return yy({readState:a("No State required")})}},yy=function(t){return t},xy=function(t,n){var e,o,r,i,u,a,c=W(t,(function(t,e){return(1===t.length?Bv.value(t[0].handler):qe(t,n,e)).map((function(o){var r,i,u=(i=gh(r=o)?{can:vh,abort:hh,run:r}:r,function(t,n){for(var e=[],o=2;o<arguments.length;o++)e[o-2]=arguments[o];var r=[t,n].concat(e);i.abort.apply(void 0,r)?n.stop():i.can.apply(void 0,r)&&i.run.apply(void 0,r)}),a=1<t.length?k(n[e],(function(n){return b(t,(function(t){return t.name===n}))})).join(" > "):t[0].name;return me(e,{handler:u,purpose:a})}))}));return e={},o=[],r=[],Th(c,(function(t){t.fold((function(t){o.push(t)}),(function(t){r.push(t)}))})),0<(a={errors:o,values:r}).errors.length?Bv.error(E(a.errors)):(u=e,0===(i=a.values).length?Bv.value(u):Bv.value(zv(u,Nv.apply(void 0,i))))},wy="alloy.base.behaviour",Sy=Uv([Zv("dom","dom",bn(),Uv([Ln("tag"),ee("styles",{}),ee("classes",[]),ee("attributes",{}),Kn("value"),Kn("innerHtml")])),Ln("components"),Ln("uid"),ee("events",{}),ee("apis",{}),Zv("eventOrder","eventOrder",((eb={})[Ab()]=["disabling",wy,"toggling","typeaheadevents"],eb[Eb()]=[wy,"focusing","keying"],eb[Hb()]=[wy,"disabling","toggling","representing"],eb[xb()]=[wy,"representing","streaming","invalidating"],eb[jb()]=[wy,"representing","item-events","tooltipping"],eb[fb()]=["focusing",wy,"item-type-events"],eb[ab()]=["focusing",wy,"item-type-events"],eb[pb()]=["item-type-events","tooltipping"],eb[Mb()]=["receiving","reflecting","tooltipping"],Sn(a(eb))),Gv()),Kn("domModification")]),ky=function(t){var n=Hn("external.component",Dn([Ln("element"),Kn("uid")]),t),e=fe(Ne()),o=n.uid.getOrThunk((function(){return my("external")}));dy(n.element,o);var r={uid:o,getSystem:e.get,config:Sh.none,hasConfigured:hh,connect:function(t){e.set(t)},disconnect:function(){e.set(Ne((function(){return r})))},getApis:function(){return{}},element:n.element,spec:t,readState:a("No state"),syncComponents:i,components:a([]),events:{}};return We(r)},Cy=my,Oy=function(t){return G(t,vy).getOrThunk((function(){return ao(Ah(t,"uid")?t:yh({uid:Cy("")},t)).getOrDie()}))},_y=We,Ty=function(t,n){return mo(n,(function(n){return st(n,t.element)}),hh)||(e=t,fo(n,(function(t){if(!Nh(t))return!1;var n=Tt(t,"id");return void 0!==n&&-1<n.indexOf("aria-owns")})).bind((function(t){var n=Tt(t,"id");return po(cv(t),'[aria-owns="'+n+'"]')})).exists((function(t){return Ty(e,t)})));var e},Ey="unknown";(rb=ob=ob||{})[rb.STOP=0]="STOP",rb[rb.NORMAL=1]="NORMAL",rb[rb.LOGGING=2]="LOGGING";var Dy=fe({}),By=["alloy/data/Fields","alloy/debugging/Debugging"],My=a({logEventCut:i,logEventStopped:i,logNoParent:i,logEventNoHandlers:i,logEventResponse:i,write:i}),Ay=a([Ln("menu"),Ln("selectedMenu")]),Fy=a([Ln("item"),Ln("selectedItem")]);a(Uv(Fy().concat(Ay())));var Iy=a(Uv(Fy())),Ry=a(Xn("initSize",[Ln("numColumns"),Ln("numRows")])),Vy=de([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Py=Vy.southeast,Hy=Vy.southwest,zy=Vy.northeast,Ny=Vy.northwest,Ly=Vy.south,Wy=Vy.north,Uy=Vy.east,jy=Vy.west,Gy=function(t,n,e){return Math.min(Math.max(t,n),e)},Xy="layout",Yy=function(t,n,e){return Eo(t.x,Io(t),e.southeast(),Py(),"southeast",Bo(t,{left:1,top:3}),Xy)},qy=function(t,n,e){return Eo(Ao(t,n),Io(t),e.southwest(),Hy(),"southwest",Bo(t,{right:0,top:3}),Xy)},Ky=function(t,n,e){return Eo(t.x,Fo(t,n),e.northeast(),zy(),"northeast",Bo(t,{left:1,bottom:2}),Xy)},Jy=function(t,n,e){return Eo(Ao(t,n),Fo(t,n),e.northwest(),Ny(),"northwest",Bo(t,{right:0,bottom:2}),Xy)},$y=function(t,n,e){return Eo(Mo(t,n),Fo(t,n),e.north(),Wy(),"north",Bo(t,{bottom:2}),Xy)},Qy=function(t,n,e){return Eo(Mo(t,n),Io(t),e.south(),Ly(),"south",Bo(t,{top:3}),Xy)},Zy=Object.freeze({__proto__:null,events:function(t){return ty([Ee(Mb(),(function(n,e){var o,r=t.channels,i=Dh(r),u=e,a=(o=u).universal?i:k(i,(function(t){return _h(o.channels,t)}));Th(a,(function(t){var e=r[t],o=e.schema,i=Hn("channel["+t+"] data\nReceiver: "+Pe(n.element),o,u.data);e.onReceive(n,i)}))}))])}}),tx=[Wn("channels",Rn(Bv.value,Dn([Co("onReceive"),ee("schema",Gv())])))],nx=function(t,n,e,o,r,i,u){function c(t){return X(t,e)?t[e]():Sh.none()}var s=L(r,(function(t,n){return o=e,u=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];var u=[t].concat(n);return t.config({name:a(o)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+o+". Using API: "+i)}),(function(n){var e=Array.prototype.slice.call(u,1);return r.apply(void 0,[t,n.config,n.state].concat(e))}))},c=i=n,l=(s=(r=t).toString()).indexOf(")")+1,f=s.indexOf("("),d=s.substring(f+1,l-1).split(/,\s*/),u.toFunctionAnnotation=function(){return{name:c,parameters:hy(d.slice(0,1).concat(d.slice(3)))}},u;var o,r,i,u,c,s,l,f,d})),f=L(i,Le),d=yh(yh(yh({},f),s),{revoke:l(Go,e),config:function(n){var o=Hn(e+"-config",t,n);return{key:e,value:{config:o,me:d,configAsRaw:ot((function(){return Hn(e+"-config",t,n)})),initialConfig:n,state:u}}},schema:a(n),exhibit:function(t,n){return Fh(c(t),G(o,"exhibit"),(function(t,e){return e(n,t.config,t.state)})).getOrThunk((function(){return Ge({})}))},name:a(e),handlers:function(t){return c(t).map((function(t){return G(o,"events").getOr((function(){return{}}))(t.config,t.state)})).getOr({})}});return d},ex=ge,ox=Dn([Ln("fields"),Ln("name"),ee("active",{}),ee("apis",{}),ee("state",by),ee("extra",{})]),rx=Dn([Ln("branchKey"),Ln("branches"),Ln("name"),ee("active",{}),ee("apis",{}),ee("state",by),ee("extra",{})]),ix=a(void 0),ux=Xo({fields:tx,name:"receiving",active:Zy}),ax=Object.freeze({__proto__:null,exhibit:function(t,n){return Ge({classes:[],styles:n.useFixed()?{}:{position:"relative"}})}}),cx=de([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),sx=function(t,n,e){var o=vv(n,e);return t.fold(a(o),a(o),(function(){var t=en();return o.translate(-t.left,-t.top)}))};cx.none;var lx,fx=cx.relative,dx=cx.fixed,mx="data-alloy-placement",gx=de([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),px=vh,hx=qt,vx=["top","bottom","right","left"],bx="data-alloy-transition-timer",yx=a((function(t,n){hr(t,n),It(t,{"overflow-x":"hidden","overflow-y":"auto"})})),xx=a((function(t,n){hr(t,n)})),wx=function(t,n,e,o){var r,i,u,a,c=pr(t,n,e,o),s=n,l=c,f=or((r=o).origin,l);return r.transition.each((function(t){gr(s,r.origin,f,t,l,r.lastPlacement)})),nr(s,f),a=c.placement,Ot(n,mx,a),no(i=n,(u=c.classes).off),to(i,u.on),(0,o.maxHeightFunction)(n,c.maxHeight),(0,o.maxWidthFunction)(n,c.maxWidth),{layout:c.layout,placement:c.placement}},Sx=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],kx=c,Cx=function(t){return"rtl"===Vt(t,"direction")?"rtl":"ltr"};(lx=lx||{}).TopToBottom="toptobottom",lx.BottomToTop="bottomtotop";var Ox="data-alloy-vertical-dir",_x=[Ln("hotspot"),Kn("bubble"),ee("overrides",{}),Sr(),_o("placement",(function(t,n,e){var o=rr(e,n.hotspot.element),r=kr(t.element,n,Wo(),Uo(),No(),Lo(),Sh.some(n.hotspot.element));return Sh.some(kx({anchorBox:o,bubble:n.bubble.getOr(yr()),overrides:n.overrides,layouts:r,placer:Sh.none()}))}))],Tx=[Ln("x"),Ln("y"),ee("height",0),ee("width",0),ee("bubble",yr()),ee("overrides",{}),Sr(),_o("placement",(function(t,n,e){var o=sx(e,n.x,n.y),r=Ov(o.left,o.top,n.width,n.height),i=kr(t.element,n,Ho(),zo(),Ho(),zo(),Sh.none());return Sh.some(kx({anchorBox:r,bubble:n.bubble,overrides:n.overrides,layouts:i,placer:Sh.none()}))}))],Ex=de([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Dx=Ex.screen,Bx=Ex.absolute,Mx=[Ln("node"),Ln("root"),Kn("bubble"),Sr(),ee("overrides",{}),ee("showAbove",!1),_o("placement",(function(t,n,e){var o=Er(t,0,n);return n.node.filter(fv).bind((function(r){var i=r.dom.getBoundingClientRect(),u=Dr(i.left,i.top,i.width,i.height),a=n.node.getOr(t.element);return Br(u,o,n,e,a)}))}))],Ax=function(t,n,e,o){return{start:t,soffset:n,finish:e,foffset:o}},Fx=de([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Ix=(Fx.before,Fx.on,Fx.after,function(t){return t.fold(c,c,c)}),Rx=de([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Vx={domRange:Rx.domRange,relative:Rx.relative,exact:Rx.exact,exactFromRange:function(t){return Rx.exact(t.start,t.soffset,t.finish,t.foffset)},getWin:function(t){return gt(t.match({domRange:function(t){return Ph.fromDom(t.startContainer)},relative:function(t){return Ix(t)},exact:function(t){return t}}))},range:Ax},Px=de([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]);Px.ltr,Px.rtl;var Hx,zx,Nx,Lx,Wx=(Hx=Lh,{get:function(t){if(!Hx(t))throw new Error("Can only get text value of a text node");return zx(t).getOr("")},getOption:zx=function(t){return Hx(t)?Sh.from(t.dom.nodeValue):Sh.none()},set:function(t,n){if(!Hx(t))throw new Error("Can only set raw text value of a text node");t.dom.nodeValue=n}}),Ux=["img","br"],jx=[Kn("getSelection"),Ln("root"),Kn("bubble"),Sr(),ee("overrides",{}),ee("showAbove",!1),_o("placement",(function(t,n,e){var o=gt(n.root).dom,r=Er(t,0,n);return Br(jr(o,n).bind((function(t){return(0<(n=Rr(o,Vx.exactFromRange(t)).getBoundingClientRect()).width||0<n.height?Sh.some(n).map(Fr):Sh.none()).orThunk((function(){var n=Ph.fromText("\ufeff");Jt(t.start,n);var e=Lr(o,Vx.exact(n,0,n,1));return Sv(n),e})).bind((function(t){return Dr(t.left,t.top,t.width,t.height)}));var n})),r,n,e,jr(o,n).bind((function(t){return Nh(t.start)?Sh.some(t.start):iv(t.start)})).getOr(t.element))}))],Gx="link-layout",Xx=zn("type",{selection:jx,node:Mx,hotspot:_x,submenu:[Ln("item"),Sr(),ee("overrides",{}),_o("placement",(function(t,n,e){var o=rr(e,n.item.element),r=kr(t.element,n,Qr(),Zr(),Qr(),Zr(),Sh.none());return Sh.some(kx({anchorBox:o,bubble:yr(),overrides:n.overrides,layouts:r,placer:Sh.none()}))}))],makeshift:Tx}),Yx=[qn("classes",Yv),ue("mode","all",["all","layout","placement"])],qx=[ee("useFixed",hh),Kn("getBounds")],Kx=[Wn("anchor",Xx),ne("transition",Yx)],Jx=function(t,n,e,o,r,i){var u=Hn("placement.info",Uv(Kx),r),c=u.anchor,s=o.element,l=e.get(o.uid);Zo((function(){Ft(s,"position","fixed");var r=Pt(s,"visibility");Ft(s,"visibility","hidden");var f,d,m,g,p=n.useFixed()?(g=document.documentElement,dx(0,0,g.clientWidth,g.clientHeight)):(d=Gt((f=t).element),m=f.element.dom.getBoundingClientRect(),fx(d.left,d.top,m.width,m.height)),h=c.placement,v=i.map(a).or(n.getBounds);h(t,c,p).each((function(n){var r=n.placer.getOr(ti)(t,p,n,v,o,l,u.transition);e.set(o.uid,r)})),r.fold((function(){zt(s,"visibility")}),(function(t){Ft(s,"visibility",t)})),Pt(s,"left").isNone()&&Pt(s,"top").isNone()&&Pt(s,"right").isNone()&&Pt(s,"bottom").isNone()&&Y(Pt(s,"position"),"fixed")&&zt(s,"position")}),s)},$x=Xo({fields:qx,name:"positioning",active:ax,apis:Object.freeze({__proto__:null,position:function(t,n,e,o,r){fu(t,n,e,o,r,Sh.none())},positionWithin:fu,positionWithinBounds:Jx,getMode:function(t,n){return n.useFixed()?"fixed":"absolute"},reset:function(t,n,e,o){var r=o.element;Th(["position","left","right","top","bottom"],(function(t){return zt(r,t)})),Bt(r,mx),e.clear(o.uid)}}),state:Object.freeze({__proto__:null,init:function(){var t={};return yy({readState:function(){return t},clear:function(n){mh(n)?delete t[n]:t={}},set:function(n,e){t[n]=e},get:function(n){return G(t,n)}})}})}),Qx=function(t){we(t,jb());var n=t.components();Th(n,Qx)},Zx=function(t){var n=t.components();Th(n,Zx),we(t,Ub())},tw=function(t,n,e){t.getSystem().addToWorld(n),e(t.element,n.element),fv(t.element)&&Zx(n),t.syncComponents()},nw=function(t,n,e){e(t,n.element);var o=vt(n.element);Th(o,(function(t){n.getByDom(t).each(Zx)}))},ew=Object.freeze({__proto__:null,cloak:du,decloak:mu,open:li,openWhileCloaked:function(t,n,e,o,r){du(t,n),li(t,n,e,o),r(),mu(t,n)},close:fi,isOpen:di,isPartOf:function(t,n,e,o){return di(0,0,e)&&e.get().exists((function(e){return n.isPartOf(t,e,o)}))},getState:function(t,n,e){return e.get()},setContent:function(t,n,e,o){return e.get().map((function(){return si(t,n,e,o)}))}}),ow=Object.freeze({__proto__:null,events:function(t,n){return ty([Ee(Vb(),(function(e){fi(e,t,n)}))])}}),rw=Xo({fields:[So("onOpen"),So("onClose"),Ln("isPartOf"),Ln("getAttachPoint"),ee("cloakVisibilityAttr","data-precloak-visibility")],name:"sandboxing",active:ow,apis:ew,state:Object.freeze({__proto__:null,init:function(){var t=lr(),n=a("not-implemented");return yy({readState:n,isOpen:t.isSet,clear:t.clear,set:t.set,get:t.get})}})}),iw=a("dismiss.popups"),uw=a("reposition.popups"),aw=a("mouse.released"),cw=Dn([ee("isExtraPart",hh),ne("fireEventInstead",[ee("event",Gb())])]),sw=Dn([ne("fireEventInstead",[ee("event",Xb())]),Gn("doReposition")]),lw=Object.freeze({__proto__:null,onLoad:pi,onUnload:hi,setValue:function(t,n,e,o){n.store.manager.setValue(t,n,e,o)},getValue:function(t,n,e){return n.store.manager.getValue(t,n,e)},getState:function(t,n,e){return e}}),fw=Object.freeze({__proto__:null,events:function(t,n){var e=t.resetOnDom?[ny((function(e){pi(e,t,n)})),ey((function(e){hi(e,t,n)}))]:[jo(t,n,pi)];return ty(e)}}),dw=Object.freeze({__proto__:null,memory:vi,dataset:bi,manual:function(){return yy({readState:i})},init:function(t){return t.store.manager.state(t)}}),mw=[Kn("initialValue"),Ln("getFallbackEntry"),Ln("getDataKey"),Ln("setValue"),_o("manager",{setValue:yi,getValue:function(t,n,e){var o=n.store,r=o.getDataKey(t);return e.lookup(r).getOrThunk((function(){return o.getFallbackEntry(r)}))},onLoad:function(t,n,e){n.store.initialValue.each((function(o){yi(t,n,e,o)}))},onUnload:function(t,n,e){e.clear()},state:bi})],gw=[Ln("getValue"),ee("setValue",i),Kn("initialValue"),_o("manager",{setValue:function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},getValue:function(t,n){return n.store.getValue(t)},onLoad:function(t,n){n.store.initialValue.each((function(e){n.store.setValue(t,e)}))},onUnload:i,state:by.init})],pw=Xo({fields:[oe("store",{mode:"memory"},zn("mode",{memory:[Kn("initialValue"),_o("manager",{setValue:function(t,n,e,o){e.set(o),n.onSetValue(t,o)},getValue:function(t,n,e){return e.get()},onLoad:function(t,n,e){n.store.initialValue.each((function(t){e.isNotSet()&&e.set(t)}))},onUnload:function(t,n,e){e.clear()},state:vi})],manual:gw,dataset:mw})),So("onSetValue"),ee("resetOnDom",!1)],name:"representing",active:fw,apis:lw,extra:{setValueFrom:function(t,n){var e=pw.getValue(n);pw.setValue(t,e)}},state:dw}),hw=xi,vw=Si,bw="placeholder",yw=de([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),xw=function(t,n,e,o){return r=t,u=o,(ki(i=e)&&i.uiType===bw?(l=i,f=u,(s=r).exists((function(t){return t!==l.owner}))?yw.single(!0,a(l)):G(f,l.name).fold((function(){throw new Error("Unknown placeholder component: "+l.name+"\nKnown: ["+Dh(f)+"]\nNamespace: "+s.getOr("none")+"\nSpec: "+JSON.stringify(l,null,2))}),(function(t){return t.replace()}))):yw.single(!1,a(i))).fold((function(r,i){var u=ki(e)?i(n,e.config,e.validated):i(n),a=D(G(u,"components").getOr([]),(function(e){return xw(t,n,e,o)}));return[yh(yh({},u),{components:a})]}),(function(t,o){if(ki(e)){var r=o(n,e.config,e.validated);return e.validated.preprocess.getOr(c)(r)}return o(n)}));var r,i,u,s,l,f},ww=yw.single,Sw=yw.multiple,kw=a(bw),Cw=de([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Ow=ee("factory",{sketch:c}),_w=ee("schema",[]),Tw=Ln("name"),Ew=Zv("pname","pname",yn((function(t){return"<alloy."+He(t.name)+">"})),Gv()),Dw=tb("schema",(function(){return[Kn("preprocess")]})),Bw=ee("defaults",a({})),Mw=ee("overrides",a({})),Aw=Uv([Ow,_w,Tw,Ew,Bw,Mw]),Fw=Uv([Ow,_w,Tw,Bw,Mw]),Iw=Uv([Ow,_w,Tw,Ew,Bw,Mw]),Rw=Uv([Ow,Dw,Tw,Ln("unit"),Ew,Bw,Mw]),Vw=_i(Cw.required,Aw),Pw=_i(Cw.external,Fw),Hw=_i(Cw.optional,Iw),zw=_i(Cw.group,Rw),Nw=a("entirety"),Lw=Object.freeze({__proto__:null,required:Vw,external:Pw,optional:Hw,group:zw,asNamedPart:Ci,name:Oi,asCommon:function(t){return t.fold(c,c,c,c)},original:Nw}),Ww=function(t,n){return{uiType:kw(),owner:t,name:n}},Uw=Object.freeze({__proto__:null,generate:Ei,generateOne:Di,schemas:Bi,names:Mi,substitutes:Ai,components:Fi,defaultUids:Ni,defaultUidsSchema:Li,getAllParts:Pi,getAllPartNames:Hi,getPart:Ii,getPartOrDie:Ri,getParts:Vi,getPartsOrDie:zi}),jw=function(t){return Ah(t,"uid")?t:yh(yh({},t),{uid:my("uid")})},Gw=Dn([Ln("name"),Ln("factory"),Ln("configFields"),ee("apis",{}),ee("extraApis",{})]),Xw=Dn([Ln("name"),Ln("factory"),Ln("configFields"),Ln("partFields"),ee("apis",{}),ee("extraApis",{})]),Yw=Object.freeze({__proto__:null,getCurrent:function(t,n){return n.find(t)}}),qw=Xo({fields:[Ln("find")],name:"composing",apis:Yw}),Kw=["input","button","textarea","select"],Jw=function(t,n){n.disableClass.each((function(n){$e(t.element,n)})),(qi(t,n)?function(t){Ot(t.element,"disabled","disabled")}:function(t){Ot(t.element,"aria-disabled","true")})(t),n.onDisabled(t)},$w=function(t,n){n.disableClass.each((function(n){Qe(t.element,n)})),(qi(t,n)?function(t){Bt(t.element,"disabled")}:function(t){Ot(t.element,"aria-disabled","false")})(t),n.onEnabled(t)},Qw=Object.freeze({__proto__:null,enable:$w,disable:Jw,isDisabled:Ki,onLoad:Yi,set:function(t,n,e,o){(o?Jw:$w)(t,n)}}),Zw=Object.freeze({__proto__:null,exhibit:function(t,n){return Ge({classes:n.disabled()?n.disableClass.toArray():[]})},events:function(t,n){return ty([_e(Ab(),(function(n){return Ki(n,t)})),jo(t,n,Yi)])}}),tS=Xo({fields:[ce("disabled",hh),ee("useNative",!0),Kn("disableClass"),So("onDisabled"),So("onEnabled")],name:"disabling",active:Zw,apis:Qw}),nS=Object.freeze({__proto__:null,dehighlightAll:function(t,n){return Ji(t,n,0,[])},dehighlight:function(t,n,e,o){gu(0,n,0,o)&&(Qe(o.element,n.highlightClass),n.onDehighlight(t,o),we(o,Qb()))},highlight:$i,highlightFirst:function(t,n){pu(t,n).each((function(e){$i(t,n,0,e)}))},highlightLast:function(t,n){hu(t,n).each((function(e){$i(t,n,0,e)}))},highlightAt:function(t,n,e,o){var r,i,u;i=o,u=Hr((r=t).element,"."+n.itemClass),Sh.from(u[i]).fold((function(){return Bv.error(new Error("No element found with index "+i))}),r.getSystem().getByDom).fold((function(t){throw t}),(function(e){$i(t,n,0,e)}))},highlightBy:function(t,n,e,o){_(vu(t,n),o).each((function(e){$i(t,n,0,e)}))},isHighlighted:gu,getHighlighted:function(t,n){return po(t.element,"."+n.highlightClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},getFirst:pu,getLast:hu,getPrevious:function(t,n){return Qi(t,n,0,-1)},getNext:function(t,n){return Qi(t,n,0,1)},getCandidates:vu}),eS=Xo({fields:[Ln("highlightClass"),Ln("itemClass"),So("onHighlight"),So("onDehighlight")],name:"highlighting",apis:nS}),oS=[8],rS=[9],iS=[13],uS=[27],aS=[32],cS=[37],sS=[38],lS=[39],fS=[40],dS=f(iu);(Lx=Nx=Nx||{}).OnFocusMode="onFocus",Lx.OnEnterOrSpaceMode="onEnterOrSpace",Lx.OnApiMode="onApi";var mS,gS,pS=yu(tb("cyclic",hh)),hS=yu(tb("cyclic",vh)),vS=bu([ee("execute",xu),ee("useSpace",!1),ee("useEnter",!0),ee("useControlEnter",!1),ee("useDown",!1)],by.init,(function(t,n,e){var o=e.useSpace&&!Xi(t.element)?aS:[],r=e.useEnter?iS:[],i=e.useDown?fS:[];return[au(ou(o.concat(r).concat(i)),Su)].concat(e.useControlEnter?[au(ru([uu,ou(iS)]),Su)]:[])}),(function(t,n,e){return e.useSpace&&!Xi(t.element)?[au(ou(aS),wu)]:[]}),(function(){return Sh.none()})),bS=Object.freeze({__proto__:null,flatgrid:ku,init:function(t){return t.state(t)}}),yS=function(t,n,e,o,r){return o.focusManager.get(n).bind((function(e){return t(n.element,e,o,r)})).map((function(t){return o.focusManager.set(n,t),!0}))},xS=Tu,wS=Tu,SS=Tu,kS=Ru((function(t,n,e,o){return Au(t,n,e,o,-1)})),CS=Ru((function(t,n,e,o){return Au(t,n,e,o,1)})),OS=Ru((function(t,n,e,o){return Fu(t,n,e,o,-1)})),_S=Ru((function(t,n,e,o){return Fu(t,n,e,o,1)})),TS=bu([Ln("selector"),ee("execute",xu),ko("onEscape"),ee("captureTab",!1),Ry()],ku,a([au(ou(cS),Ou(kS,CS)),au(ou(lS),_u(kS,CS)),au(ou(sS),xS(OS)),au(ou(fS),wS(_S)),au(ru([iu,ou(rS)]),Vu),au(ru([dS,ou(rS)]),Vu),au(ou(uS),(function(t,n,e){return e.onEscape(t,n)})),au(ou(aS.concat(iS)),(function(t,n,e){return(o=e).focusManager.get(t).bind((function(t){return ho(t,o.selector)})).bind((function(o){return e.execute(t,n,o)}));var o}))]),a([au(ou(aS),wu)]),(function(){return Sh.some(Iu)})),ES=[Ln("selector"),ee("getInitial",Sh.none),ee("execute",xu),ko("onEscape"),ee("executeOnMove",!1),ee("allowVertical",!0)],DS=a([au(ou(aS),wu)]),BS=bu(ES,by.init,(function(t,n,e){var o=cS.concat(e.allowVertical?sS:[]),r=lS.concat(e.allowVertical?fS:[])
;return[au(ou(o),Wu(Ou(Nu,Lu))),au(ou(r),Wu(_u(Nu,Lu))),au(ou(iS),Hu),au(ou(aS),Hu),au(ou(uS),Uu)]}),DS,(function(){return Sh.some(zu)})),MS=[Xn("selectors",[Ln("row"),Ln("cell")]),ee("cycles",!0),ee("previousSelector",Sh.none),ee("execute",xu)],AS=Ju((function(t,n,e){return Gu(t,n,e,-1)}),(function(t,n,e){return Yu(t,n,e,-1)})),FS=Ju((function(t,n,e){return Gu(t,n,e,1)}),(function(t,n,e){return Yu(t,n,e,1)})),IS=Ju((function(t,n,e){return Xu(t,e,n,-1)}),(function(t,n,e){return qu(t,e,n,-1)})),RS=Ju((function(t,n,e){return Xu(t,e,n,1)}),(function(t,n,e){return qu(t,e,n,1)})),VS=a([au(ou(cS),Ou(AS,FS)),au(ou(lS),_u(AS,FS)),au(ou(sS),xS(IS)),au(ou(fS),wS(RS)),au(ou(aS.concat(iS)),(function(t,n,e){return Qo(t.element).bind((function(o){return e.execute(t,n,o)}))}))]),PS=a([au(ou(aS),wu)]),HS=bu(MS,by.init,VS,PS,(function(){return Sh.some(Ku)})),zS=[Ln("selector"),ee("execute",xu),ee("moveOnTab",!1)],NS=a([au(ou(sS),SS(Zu)),au(ou(fS),SS(ta)),au(ru([iu,ou(rS)]),(function(t,n,e,o){return e.moveOnTab?SS(Zu)(t,n,e,o):Sh.none()})),au(ru([dS,ou(rS)]),(function(t,n,e,o){return e.moveOnTab?SS(ta)(t,n,e,o):Sh.none()})),au(ou(iS),$u),au(ou(aS),$u)]),LS=a([au(ou(aS),wu)]),WS=bu(zS,by.init,NS,LS,(function(){return Sh.some(Qu)})),US=bu([ko("onSpace"),ko("onEnter"),ko("onShiftEnter"),ko("onLeft"),ko("onRight"),ko("onTab"),ko("onShiftTab"),ko("onUp"),ko("onDown"),ko("onEscape"),ee("stopSpaceKeyup",!1),Kn("focusIn")],by.init,(function(t,n,e){return[au(ou(aS),e.onSpace),au(ru([dS,ou(iS)]),e.onEnter),au(ru([iu,ou(iS)]),e.onShiftEnter),au(ru([iu,ou(rS)]),e.onShiftTab),au(ru([dS,ou(rS)]),e.onTab),au(ou(sS),e.onUp),au(ou(fS),e.onDown),au(ou(cS),e.onLeft),au(ou(lS),e.onRight),au(ou(aS),e.onSpace),au(ou(uS),e.onEscape)]}),(function(t,n,e){return e.stopSpaceKeyup?[au(ou(aS),wu)]:[]}),(function(t){return t.focusIn})),jS=pS.schema(),GS=hS.schema(),XS=BS.schema(),YS=TS.schema(),qS=HS.schema(),KS=vS.schema(),JS=WS.schema(),$S=US.schema(),QS=Yo({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:jS,cyclic:GS,flow:XS,flatgrid:YS,matrix:qS,execution:KS,menu:JS,special:$S}),name:"keying",active:{events:function(t,n){return t.handler.toEvents(t,n)}},apis:{focusIn:function(t,n,e){n.sendFocusIn(n).fold((function(){t.getSystem().triggerFocus(t.element,t.element)}),(function(o){o(t,n,e)}))},setGridSize:function(t,n,e,o,r){X(e,"setGridSize")?e.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:bS}),ZS=function(t){return t.components()},tk=Xo({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(t,n,e,o){na(t,0,wv,o)},prepend:function(t,n,e,o){na(t,0,Qt,o)},remove:ea,replaceAt:oa,replaceBy:function(t,n,e,o,r){return T(ZS(t),o).bind((function(n){return oa(t,0,0,n,r)}))},set:function(t,n,e,o){Zo((function(){var n=w(o,t.getSystem().build);ei(t,n)}),t.element)},contents:ZS})}),nk=Object.freeze({__proto__:null,focus:ia,blur:function(t,n){n.ignore||t.element.dom.blur()},isFocused:function(t){return Jo(t.element)}}),ek=Object.freeze({__proto__:null,exhibit:function(t,n){return Ge(n.ignore?{}:{attributes:{tabindex:"-1"}})},events:function(t){return ty([Ee(Eb(),(function(n,e){ia(n,t),e.stop()}))].concat(t.stopMousedown?[Ee(fb(),(function(t,n){n.event.prevent()}))]:[]))}}),ok=Xo({fields:[So("onFocus"),ee("stopMousedown",!1),ee("ignore",!1)],name:"focusing",active:ek,apis:nk}),rk=Object.freeze({__proto__:null,onLoad:fa,toggle:ca,isOn:function(t,n,e){return e.get()},on:sa,off:la,set:Ha}),ik=Object.freeze({__proto__:null,exhibit:function(){return Ge({})},events:function(t,n){var e,o,r,i=(e=t,o=n,r=ca,ry((function(t){r(t,e,o)}))),u=jo(t,n,fa);return ty(E([t.toggleOnExecute?[i]:[],[u]]))}}),uk=Xo({fields:[ee("selected",!1),Kn("toggleClass"),ee("toggleOnExecute",!0),oe("aria",{mode:"none"},zn("mode",{pressed:[ee("syncWithExpanded",!1),_o("update",(function(t,n,e){Ot(t.element,"aria-pressed",e),n.syncWithExpanded&&za(t,0,e)}))],checked:[_o("update",(function(t,n,e){Ot(t.element,"aria-checked",e)}))],expanded:[_o("update",za)],selected:[_o("update",(function(t,n,e){Ot(t.element,"aria-selected",e)}))],none:[_o("update",i)]}))],name:"toggling",active:ik,apis:rk,state:{init:function(){var t=fe(!1);return{get:function(){return t.get()},set:function(n){return t.set(n)},clear:function(){return t.set(!1)},readState:function(){return t.get()}}}}}),ak="alloy.item-hover",ck="alloy.item-focus",sk=a(ak),lk=a(ck),fk=[Ln("data"),Ln("components"),Ln("dom"),ee("hasSubmenu",!1),Kn("toggling"),hw("itemBehaviours",[uk,ok,QS,pw]),ee("ignoreFocus",!1),ee("domModification",{}),_o("builder",(function(t){return{dom:t.dom,domModification:yh(yh({},t.domModification),{attributes:yh(yh(yh({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:vw(t.itemBehaviours,[t.toggling.fold(uk.revoke,(function(t){return uk.config(yh({aria:{mode:"checked"}},t))})),ok.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){pa(t)}}),QS.config({mode:"execution"}),pw.config({store:{mode:"memory",initialValue:t.data}}),ra("item-type-events",g(g([],da(),!0),[Ee(pb(),ga),Ee(Fb(),ok.focus)],!1))]),components:t.components,eventOrder:t.eventOrder}})),ee("eventOrder",{})],dk=[Ln("dom"),Ln("components"),_o("builder",(function(t){return{dom:t.dom,components:t.components,events:ty([Ee(Fb(),(function(t,n){n.stop()}))])}}))],mk=a("item-widget"),gk=a([Vw({name:"widget",overrides:function(t){return{behaviours:ex([pw.config({store:{mode:"manual",getValue:function(){return t.data},setValue:i}})])}}})]),pk=zn("type",{widget:[Ln("uid"),Ln("data"),Ln("components"),Ln("dom"),ee("autofocus",!1),ee("ignoreFocus",!1),hw("widgetBehaviours",[pw,ok,QS]),ee("domModification",{}),Li(gk()),_o("builder",(function(t){function n(n){return Ii(n,t,"widget").map((function(t){return QS.focusIn(t),t}))}function e(n,e){return Xi(e.event.target)||t.autofocus&&e.setSource(n.element),Sh.none()}var o=Ai(mk(),t,gk()),r=Fi(mk(),t,o.internals());return{dom:t.dom,components:r,domModification:t.domModification,events:ty([ry((function(t,e){n(t).each((function(){e.stop()}))})),Ee(pb(),ga),Ee(Fb(),(function(e){t.autofocus?n(e):ok.focus(e)}))]),behaviours:vw(t.widgetBehaviours,[pw.config({store:{mode:"memory",initialValue:t.data}}),ok.config({ignore:t.ignoreFocus,onFocus:function(t){pa(t)}}),QS.config({mode:"special",focusIn:t.autofocus?function(t){n(t)}:ix(),onLeft:e,onRight:e,onEscape:function(n,e){return ok.isFocused(n)||t.autofocus?(t.autofocus&&e.setSource(n.element),Sh.none()):(ok.focus(n),Sh.some(!0))}})])}}))],item:fk,separator:dk}),hk=a([zw({factory:{sketch:function(t){var n=Hn("menu.spec item",pk,t);return n.builder(n)}},name:"items",unit:"item",defaults:function(t,n){return Ah(n,"uid")?n:yh(yh({},n),{uid:my("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),vk=a([Ln("value"),Ln("items"),Ln("dom"),Ln("components"),ee("eventOrder",{}),xi("menuBehaviours",[eS,pw,qw,QS]),oe("movement",{mode:"menu",moveOnTab:!0},zn("mode",{grid:[Ry(),_o("config",(function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}}))],matrix:[_o("config",(function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}})),Ln("rowSelector")],menu:[ee("moveOnTab",!0),_o("config",(function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}}))]})),Wn("markers",Iy()),ee("fakeFocus",!1),ee("focusManager",su()),So("onHighlight")]),bk=a("alloy.menu-focus"),yk=Gi({name:"Menu",configFields:vk(),partFields:hk(),factory:function(t,n){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Si(t.menuBehaviours,[eS.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),pw.config({store:{mode:"memory",initialValue:t.value}}),qw.config({find:Sh.some}),QS.config(t.movement.config(t,t.movement))]),events:ty([Ee(lk(),(function(t,n){var e=n.event;t.getSystem().getByDom(e.target).each((function(e){eS.highlight(t,e),n.stop(),Se(t,bk(),{menu:t,item:e})}))})),Ee(sk(),(function(t,n){var e=n.event.item;eS.highlight(t,e)}))]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),xk=function(t,n,e,o){return G(e,o).bind((function(o){return G(t,o).bind((function(o){var r=xk(t,n,e,o);return Sh.some([o].concat(r))}))})).getOr([])},wk=function(){function t(t){return a(t).bind(Na)}function n(t){return G(e.get(),t)}var e=fe({}),o=fe({}),r=fe({}),i=lr(),u=fe({}),a=function(t){return G(o.get(),t)};return{setMenuBuilt:function(t,n){var e;o.set(yh(yh({},o.get()),((e={})[t]={type:"prepared",menu:n},e)))},setContents:function(t,n,a,c){i.set(t),e.set(a),o.set(n),u.set(c);var s=function(t,n){var e={};N(t,(function(t,n){Th(t,(function(t){e[t]=n}))}));var o=n,r=Mh(n,(function(t,n){return{k:t,v:n}})),i=L(r,(function(t,n){return[n].concat(xk(e,o,r,n))}));return L(e,(function(t){return G(i,t).getOr([t])}))}(c,a);r.set(s)},expand:function(t){return G(e.get(),t).map((function(n){var e=G(r.get(),t).getOr([]);return[n].concat(e)}))},refresh:function(t){return G(r.get(),t)},collapse:function(t){return G(r.get(),t).bind((function(t){return 1<t.length?Sh.some(t.slice(1)):Sh.none()}))},lookupMenu:a,lookupItem:n,otherMenus:function(t){var n=u.get();return A(Dh(n),t)},getPrimary:function(){return i.get().bind(t)},getMenus:function(){return o.get()},clear:function(){e.set({}),o.set({}),r.set({}),i.clear()},isClear:function(){return i.get().isNone()},getTriggeringPath:function(o,u){var a=k(n(o).toArray(),(function(n){return t(n).isSome()}));return G(r.get(),o).bind((function(n){var o=M(a.concat(n));return function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e];if(!o.isSome())return Sh.none();n.push(o.getOrDie())}return Sh.some(n)}(D(o,(function(n,r){return a=n,c=u,s=o.slice(0,r+1),t(a).bind((function(t){return n=a,U(e.get(),(function(t){return t===n})).bind((function(n){return c(n).map((function(n){return{triggeredMenu:t,triggeringItem:n,triggeringPath:s}}))}));var n})).fold((function(){return Y(i.get(),n)?[]:[Sh.none()]}),(function(t){return[Sh.some(t)]}));var a,c,s})))}))}}},Sk=Na,kk=a("collapse-item"),Ck=ji({name:"TieredMenu",configFields:[Oo("onExecute"),Oo("onEscape"),Co("onOpenMenu"),Co("onOpenSubmenu"),So("onRepositionMenu"),So("onCollapseMenu"),ee("highlightImmediately",!0),Xn("data",[Ln("primary"),Ln("menus"),Ln("expansions")]),ee("fakeFocus",!1),So("onHighlight"),So("onHover"),yo(),Ln("dom"),ee("navigateOnHover",!0),ee("stayInDom",!1),xi("tmenuBehaviours",[QS,eS,qw,tk]),ee("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)},repositionMenus:function(t,n){t.repositionMenus(n)}},factory:function(t){function n(n){var e,o,r=(e=n,o=t.data.primary,L(t.data.menus,(function(n,r){function i(){return yk.sketch(yh(yh({},n),{value:r,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:t.onHighlight,focusManager:(t.fakeFocus?lu:su)()}))}return r===o?{type:"prepared",menu:e.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))),i=L(t.data.menus,(function(t){return D(t.items,(function(t){return"separator"===t.type?[]:[t.data.value]}))}));return h.setContents(t.data.primary,r,t.data.expansions,i),h.getPrimary()}function e(t){return pw.getValue(t).value}function o(t,n){eS.highlight(t,n),eS.getHighlighted(n).orThunk((function(){return eS.getFirst(n)})).each((function(n){Ce(t,n.element,Fb())}))}function r(t,n){return q(w(n,(function(n){return t.lookupMenu(n).bind((function(t){return"prepared"===t.type?Sh.some(t.menu):Sh.none()}))})))}function u(n,e,o){var i=r(e,e.otherMenus(o));Th(i,(function(e){no(e.element,[t.markers.backgroundMenu]),t.stayInDom||tk.remove(n,e)}))}function a(n,o){var r;N((r=n,p.get().getOrThunk((function(){var n={},o=k(Hr(r.element,"."+t.markers.item),(function(t){return"true"===Tt(t,"aria-haspopup")}));return Th(o,(function(t){r.getSystem().getByDom(t).each((function(t){var o=e(t);n[o]=t}))})),p.set(n),n}))),(function(t,n){var e=_h(o,n);Ot(t.element,"aria-expanded",e)}))}function c(n,e,i){return Sh.from(i[0]).bind((function(a){return e.lookupMenu(a).bind((function(a){if("notbuilt"===a.type)return Sh.none();var c=a.menu,s=r(e,i.slice(1));return Th(s,(function(n){$e(n.element,t.markers.backgroundMenu)})),fv(c.element)||tk.append(n,_y(c)),no(c.element,[t.markers.backgroundMenu]),o(n,c),u(n,e,i),Sh.some(c)}))}))}function s(n,o,r){if(void 0===r&&(r=m.HighlightSubmenu),o.hasConfigured(tS)&&tS.isDisabled(o))return Sh.some(o);var i=e(o);return h.expand(i).bind((function(e){return a(n,e),Sh.from(e[0]).bind((function(i){return h.lookupMenu(i).bind((function(u){var a=function(t,n,e){if("notbuilt"!==e.type)return e.menu;var o=t.getSystem().build(e.nbMenu());return h.setMenuBuilt(n,o),o}(n,i,u);return fv(a.element)||tk.append(n,_y(a)),t.onOpenSubmenu(n,o,a,M(e)),r===m.HighlightSubmenu?(eS.highlightFirst(a),c(n,h,e)):(eS.dehighlightAll(a),Sh.some(o))}))}))}))}function l(n,o){var r=e(o);return h.collapse(r).bind((function(e){return a(n,e),c(n,h,e).map((function(e){return t.onCollapseMenu(n,o,e),e}))}))}function f(n){return function(e,o){return ho(o.getSource(),"."+t.markers.item).bind((function(t){return e.getSystem().getByDom(t).toOptional().bind((function(t){return n(e,t).map(vh)}))}))}}function d(t){return eS.getHighlighted(t).bind(eS.getHighlighted)}var m,g,p=lr(),h=wk();(g=m={})[g.HighlightSubmenu=0]="HighlightSubmenu",g[g.HighlightParent=1]="HighlightParent";var v=ty([Ee(bk(),(function(t,n){var o=n.event.item;h.lookupItem(e(o)).each((function(){var o=n.event.menu;eS.highlight(t,o);var r=e(n.event.item);h.refresh(r).each((function(n){return u(t,h,n)}))}))})),ry((function(n,o){var r=o.event.target;n.getSystem().getByDom(r).each((function(o){0===e(o).indexOf("collapse-item")&&l(n,o),s(n,o,m.HighlightSubmenu).fold((function(){t.onExecute(n,o)}),i)}))})),ny((function(e){n(e).each((function(n){tk.append(e,_y(n)),t.onOpenMenu(e,n),t.highlightImmediately&&o(e,n)}))}))].concat(t.navigateOnHover?[Ee(sk(),(function(n,o){var r=o.event.item,i=n,u=e(r);h.refresh(u).bind((function(t){return a(i,t),c(i,h,t)})),s(n,r,m.HighlightParent),t.onHover(n,r)}))]:[])),b={collapseMenu:function(t){d(t).each((function(n){l(t,n)}))},highlightPrimary:function(t){h.getPrimary().each((function(n){o(t,n)}))},repositionMenus:function(n){h.getPrimary().bind((function(t){return d(n).bind((function(t){var n=e(t),o=q(w(j(h.getMenus()),Sk));return h.getTriggeringPath(n,(function(t){return n=t,z(o,(function(t){return t.getSystem().isConnected()?_(eS.getCandidates(t),(function(t){return e(t)===n})):Sh.none()}));var n}))})).map((function(n){return{primary:t,triggeringPath:n}}))})).fold((function(){Sh.from(n.components()[0]).filter((function(t){return"menu"===Tt(t.element,"role")})).each((function(e){t.onRepositionMenu(n,e,[])}))}),(function(e){var o=e.primary,r=e.triggeringPath;t.onRepositionMenu(n,o,r)}))}};return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Si(t.tmenuBehaviours,[QS.config({mode:"special",onRight:f((function(t,n){return Xi(n.element)?Sh.none():s(t,n,m.HighlightSubmenu)})),onLeft:f((function(t,n){return Xi(n.element)?Sh.none():l(t,n)})),onEscape:f((function(n,e){return l(n,e).orThunk((function(){return t.onEscape(n,e).map((function(){return n}))}))})),focusIn:function(t){h.getPrimary().each((function(n){Ce(t,n.element,Fb())}))}}),eS.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),qw.config({find:function(t){return eS.getHighlighted(t)}}),tk.config({})]),eventOrder:t.eventOrder,apis:b,events:v}},extraApis:{tieredData:function(t,n,e){return{primary:t,menus:n,expansions:e}},singleData:function(t,n){return{primary:t,menus:me(t,n),expansions:{}}},collapseItem:function(t){return{value:He(kk()),meta:{text:t}}}}}),Ok=ji({name:"InlineView",configFields:[Ln("lazySink"),So("onShow"),So("onHide"),Zn("onEscape"),xi("inlineBehaviours",[rw,pw,ux]),ne("fireDismissalEventInstead",[ee("event",Gb())]),ne("fireRepositionEventInstead",[ee("event",Xb())]),ee("getRelated",Sh.none),ee("isExtraPart",hh),ee("eventOrder",Sh.none)],factory:function(t,n){function e(n){rw.isOpen(n)&&pw.getValue(n).each((function(e){switch(e.mode){case"menu":rw.getState(n).each(Ck.repositionMenus);break;case"position":var o=t.lazySink(n).getOrDie();$x.positionWithinBounds(o,n,e.config,e.getBounds())}}))}function o(t,n,e,o){i(t,n,e,(function(){return o.map((function(t){return _v(t)}))}))}function r(n,e,o,r){function i(){return a.lazySink(c)}function u(t){return 2===t.length?f:{}}var a,c,s,l,f,d=(a=t,c=n,s=e,l=r,f="horizontal"===o.type?{layouts:{onLtr:Wo,onRtl:Uo}}:{},Ck.sketch({dom:{tag:"div"},data:o.data,markers:o.menu.markers,highlightImmediately:o.menu.highlightImmediately,onEscape:function(){return rw.close(c),a.onEscape.map((function(t){return t(c)})),Sh.some(!0)},onExecute:function(){return Sh.some(!0)},onOpenMenu:function(t,n){$x.positionWithinBounds(i().getOrDie(),n,s,l())},onOpenSubmenu:function(t,n,e,o){var r=i().getOrDie();$x.position(r,e,{anchor:yh({type:"submenu",item:n},u(o))})},onRepositionMenu:function(t,n,e){var o=i().getOrDie();$x.positionWithinBounds(o,n,s,l()),Th(e,(function(t){var n=u(t.triggeringPath);$x.position(o,t.triggeredMenu,{anchor:yh({type:"submenu",item:t.triggeringItem},n)})}))}}));rw.open(n,d),pw.setValue(n,Sh.some({mode:"menu",menu:d}))}var i=function(n,e,o,r){var i=t.lazySink(n).getOrDie();rw.openWhileCloaked(n,e,(function(){return $x.positionWithinBounds(i,n,o,r())})),pw.setValue(n,Sh.some({mode:"position",config:o,getBounds:r}))},u={setContent:function(t,n){rw.setContent(t,n)},showAt:function(t,n,e){o(t,n,e,Sh.none())},showWithin:o,showWithinBounds:i,showMenuAt:function(t,n,e){r(t,n,e,Sh.none)},showMenuWithinBounds:r,hide:function(t){rw.isOpen(t)&&(pw.setValue(t,Sh.none()),rw.close(t))},getContent:function(t){return rw.getState(t)},reposition:e,isOpen:rw.isOpen};return{uid:t.uid,dom:t.dom,behaviours:Si(t.inlineBehaviours,[rw.config({isPartOf:function(n,e,o){return Ty(e,o)||(r=o,t.getRelated(n).exists((function(t){return Ty(t,r)})));var r},getAttachPoint:function(n){return t.lazySink(n).getOrDie()},onOpen:function(n){t.onShow(n)},onClose:function(n){t.onHide(n)}}),pw.config({store:{mode:"memory",initialValue:Sh.none()}}),ux.config({channels:yh(yh({},mi(yh({isExtraPart:n.isExtraPart},t.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),gi(yh(yh({},t.fireRepositionEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})),{doReposition:e})))})]),eventOrder:t.eventOrder,apis:u}},apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showWithinBounds:function(t,n,e,o,r){t.showWithinBounds(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},showMenuWithinBounds:function(t,n,e,o,r){t.showMenuWithinBounds(n,e,o,r)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)},reposition:function(t,n){t.reposition(n)}}}),_k="layout-inset",Tk=function(t,n,e){return Eo(ha(t,n),t.y,e.insetNorth(),Ly(),"north",Bo(t,{top:2}),_k)},Ek=function(t,n,e){return Eo(ha(t,n),ba(t,n),e.insetSouth(),Wy(),"south",Bo(t,{bottom:3}),_k)},Dk=tinymce.util.Tools.resolve("tinymce.util.Delay"),Bk=ji({name:"Button",factory:function(t){function n(n){return G(t.dom,"attributes").bind((function(t){return G(t,n)}))}var e=ma(t.action),o=t.dom.tag;return{uid:t.uid,dom:t.dom,components:t.components,events:e,behaviours:vw(t.buttonBehaviours,[ok.config({}),QS.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==o)return{role:n("role").getOr("button")};var t=n("type").getOr("button"),e=n("role").map((function(t){return{role:t}})).getOr({});return yh({type:t},e)}()},eventOrder:t.eventOrder}},configFields:[ee("uid",void 0),Ln("dom"),ee("components",[]),hw("buttonBehaviours",[ok,QS]),Kn("action"),Kn("role"),ee("eventOrder",{})]}),Mk=tinymce.util.Tools.resolve("tinymce.util.I18n"),Ak={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},Fk="temporary-placeholder",Ik={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},Rk=ji({name:"Notification",factory:function(t){function n(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}}function e(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}}var o,r,i,u,a=Ba({dom:{tag:"p",innerHtml:t.translationProvider(t.text)},behaviours:ex([tk.config({})])}),c=Ba({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[n(0)]},e(0)],behaviours:ex([tk.config({})])}),s={updateProgress:function(t,o){t.getSystem().isConnected()&&c.getOpt(t).each((function(t){tk.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[n(o)]},e(o)])}))},updateText:function(t,n){var e;t.getSystem().isConnected()&&(e=a.get(t),tk.set(e,[co(n)]))}},l=E([t.icon.toArray(),t.level.toArray(),t.level.bind((function(t){return Sh.from(Ik[t])})).toArray()]),f=Ba(Bk.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[Pa("close",{tag:"div",classes:["tox-icon"],attributes:{"aria-label":t.translationProvider("Close")}},t.iconProvider)],action:function(n){t.onAction(n)}})),d=[(o=l,r={tag:"div",classes:["tox-notification__icon"]},i=t.iconProvider,u=i(),Va(r,_(o,(function(t){return Ah(u,Aa(t,u))})).getOr(Fk),u,Sh.none())),{dom:{tag:"div",classes:["tox-notification__body"]},components:[a.asSpec()],behaviours:ex([tk.config({})])}];return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map((function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]})).getOr(["tox-notification","tox-notification--in"])},behaviours:ex([ok.config({}),ra("notification-events",[Ee(hb(),(function(t){f.getOpt(t).each(ok.focus)}))])]),components:d.concat(t.progress?[c.asSpec()]:[]).concat(t.closeButton?[f.asSpec()]:[]),apis:s}},configFields:[Kn("level"),Ln("progress"),Ln("icon"),Ln("onAction"),Ln("text"),Ln("iconProvider"),Ln("translationProvider"),ae("closeButton",!0)],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}}),Vk=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),Pk=function(t){return ho(t,"[data-mce-autocompleter]")},Hk=tinymce.util.Tools.resolve("tinymce.util.Promise"),zk=function(t){if(3===t.nodeType)return qa(t,t.data.length);var n=t.childNodes;return 0<n.length?zk(n[n.length-1]):qa(t,n.length)},Nk=function(t,n){var e=t.childNodes;return 0<e.length&&n<e.length?Nk(e[n],0):0<e.length&&1===t.nodeType&&e.length===n?zk(e[e.length-1]):qa(t,n)},Lk=Uv([Un("type"),Qn("text")]),Wk=Uv([ee("type","autocompleteitem"),ee("active",!1),ee("disabled",!1),ee("meta",{}),Un("value"),Qn("text"),Qn("icon")]),Uk=Uv([Un("type"),Un("ch"),re("minChars",1),ee("columns",1),re("maxResults",10),Zn("matches"),Gn("fetch"),Gn("onAction"),se("highlightOn",[],Yv)]),jk=[ae("disabled",!1),Qn("tooltip"),Qn("icon"),Qn("text"),ce("onSetup",(function(){return i}))],Gk=Uv([Un("type"),Gn("onAction")].concat(jk)),Xk=[ae("active",!1)].concat(jk),Yk=Uv(Xk.concat([Un("type"),Gn("onAction")])),qk=[ce("predicate",hh),ue("scope","node",["node","editor"]),ue("position","selection",["node","selection","line"])],Kk=jk.concat([ee("type","contextformbutton"),ee("primary",!1),Gn("onAction"),tb("original",c)]),Jk=Xk.concat([ee("type","contextformbutton"),ee("primary",!1),Gn("onAction"),tb("original",c)]),$k=jk.concat([ee("type","contextformbutton")]),Qk=Xk.concat([ee("type","contextformtogglebutton")]),Zk=zn("type",{contextformbutton:Kk,contextformtogglebutton:Jk}),tC=Uv([ee("type","contextform"),ce("initValue",a("")),Qn("label"),qn("commands",Zk),Jn("launch",zn("type",{contextformbutton:$k,contextformtogglebutton:Qk}))].concat(qk)),nC=Uv([ee("type","contexttoolbar"),Un("items")].concat(qk));(gS=mS={})[gS.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",gS[gS.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var eC,oC,rC,iC,uC=mS,aC="tox-menu-nav__js",cC="tox-collection__item",sC={normal:aC,color:"tox-swatch"},lC="tox-collection__item--enabled",fC="tox-collection__item-icon",dC="tox-collection__item-label",mC="tox-collection__item-caret",gC="tox-collection__item--active",pC="tox-collection__item-container",hC="tox-collection__item-container--row",vC=[yk.parts.items({})],bC=[Un("type"),Un("src"),Qn("alt"),se("classes",[],Yv)],yC=Uv(bC),xC=[Un("type"),Un("text"),Qn("name"),se("classes",["tox-collection__item-label"],Yv)],wC=Uv(xC),SC=En((function(){return Fn("type",{cardimage:yC,cardtext:wC,cardcontainer:kC})})),kC=Uv([Un("type"),ie("direction","horizontal"),ie("align","left"),ie("valign","middle"),qn("items",SC)]),CC=[ae("disabled",!1),Qn("text"),Qn("shortcut"),Zv("value","value",yn((function(){return He("menuitem-value")})),Gv()),ee("meta",{})],OC=Uv([Un("type"),Qn("label"),qn("items",SC),ce("onSetup",(function(){return i})),ce("onAction",i)].concat(CC)),_C=Uv([Un("type"),ae("active",!1),Qn("icon")].concat(CC)),TC=[Un("type"),Un("fancytype"),ce("onAction",i)],EC=zn("fancytype",{inserttable:[ee("initData",{})].concat(TC),colorswatch:[le("initData",{},[ae("allowCustomColors",!0),te("colors",Gv())])].concat(TC)}),DC=Uv([Un("type"),ce("onSetup",(function(){return i})),ce("onAction",i),Qn("icon")].concat(CC)),BC=Uv([Un("type"),Gn("getSubmenuItems"),ce("onSetup",(function(){return i})),Qn("icon")].concat(CC)),MC=Uv([Un("type"),Qn("icon"),ae("active",!1),ce("onSetup",(function(){return i})),Gn("onAction")].concat(CC)),AC=function(t){return n=He("unnamed-events"),ex([ra(n,t)]);var n},FC=He("tooltip.exclusive"),IC=He("tooltip.show"),RC=He("tooltip.hide"),VC=Object.freeze({__proto__:null,hideAllExclusive:lc,setComponents:function(t,n,e,o){e.getTooltip().each((function(t){t.getSystem().isConnected()&&tk.set(t,o)}))}}),PC=Object.freeze({__proto__:null,events:function(t,n){function e(e){n.getTooltip().each((function(o){ii(o),t.onHide(e,o),n.clearTooltip()})),n.clearTimer()}return ty(E([[Ee(IC,(function(e){n.resetTimer((function(){var o,r,i=e;n.isShowing()||(lc(i),o=t.lazySink(i).getOrDie(),r=i.getSystem().build({dom:t.tooltipDom,components:t.tooltipComponents,events:ty("normal"===t.mode?[Ee(pb(),(function(){we(i,IC)})),Ee(mb(),(function(){we(i,RC)}))]:[]),behaviours:ex([tk.config({})])}),n.setTooltip(r),oi(o,r),t.onShow(i,r),$x.position(o,r,{anchor:t.anchor(i)}))}),t.delay)})),Ee(RC,(function(o){n.resetTimer((function(){e(o)}),t.delay)})),Ee(Mb(),(function(t,n){n.universal||_h(n.channels,FC)&&e(t)})),ey((function(t){e(t)}))],"normal"===t.mode?[Ee(hb(),(function(t){we(t,IC)})),Ee(Db(),(function(t){we(t,RC)})),Ee(pb(),(function(t){we(t,IC)})),Ee(mb(),(function(t){we(t,RC)}))]:[Ee($b(),(function(t){we(t,IC)})),Ee(Qb(),(function(t){we(t,RC)}))]]))}}),HC=Xo({fields:[Ln("lazySink"),Ln("tooltipDom"),ee("exclusive",!0),ee("tooltipComponents",[]),ee("delay",300),ue("mode","normal",["normal","follow-highlight"]),ee("anchor",(function(t){return{type:"hotspot",hotspot:t,layouts:{onLtr:a([Qy,$y,Yy,Ky,qy,Jy]),onRtl:a([Qy,$y,Yy,Ky,qy,Jy])}}})),So("onHide"),So("onShow")],name:"tooltipping",active:PC,state:Object.freeze({__proto__:null,init:function(){function t(){n.on(clearTimeout)}var n=lr(),e=lr(),o=a("not-implemented");return yy({getTooltip:e.get,isShowing:e.isSet,setTooltip:e.set,clearTooltip:e.clear,clearTimer:t,resetTimer:function(e,o){t(),n.set(setTimeout(e,o))},readState:o})}}),apis:VC}),zC=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),NC=tinymce.util.Tools.resolve("tinymce.EditorManager"),LC=function(t){return yc(t).fold((function(){return 0<t.getParam("toolbar",[],"string[]").length}),vh)};(oC=eC=eC||{}).default="wrap",oC.floating="floating",oC.sliding="sliding",oC.scrolling="scrolling",(iC=rC=rC||{}).auto="auto",iC.top="top",iC.bottom="bottom";var WC,UC,jC,GC="silver.readonly",XC=Uv([Wn("readonly",qv)]),YC=function(t){return tS.config({disabled:t})},qC=function(t){return tS.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},KC=((WC={})[Ab()]=["disabling","alloy.base.behaviour","toggling","item-events"],WC),JC=q,$C=tinymce.util.Tools.resolve("tinymce.Env"),QC=function(t,n){return w(t,(function(t){switch(t.type){case"cardcontainer":return i=QC((r=t).items,n),u="vertical"===r.direction?"tox-collection__item-container--column":hC,a="left"===r.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right",{dom:{tag:"div",classes:[pC,u,a,function(){switch(r.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}}()]},components:i};case"cardimage":return o=t.src,{dom:{tag:"img",classes:t.classes,attributes:{src:o,alt:t.alt.getOr("")}}};case"cardtext":var e=t.name.exists((function(t){return _h(n.cardText.highlightOn,t)}))?Sh.from(n.cardText.matchText).getOr(""):"";return Hc(Gc(t.text,e),t.classes)}var o,r,i,u,a}))},ZC=Ei(mk(),gk()),tO=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,nO=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,eO=Math.min,oO=Math.max,rO=Math.round,iO=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,uO=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,aO=Jc(255,0,0,1),cO=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),sO="tinymce-custom-colors",lO="choiceitem",fO=[{type:lO,text:"Light Green",value:"#BFEDD2"},{type:lO,text:"Light Yellow",value:"#FBEEB8"},{type:lO,text:"Light Red",value:"#F8CAC6"},{type:lO,text:"Light Purple",value:"#ECCAFA"},{type:lO,text:"Light Blue",value:"#C2E0F4"},{type:lO,text:"Green",value:"#2DC26B"},{type:lO,text:"Yellow",value:"#F1C40F"},{type:lO,text:"Red",value:"#E03E2D"},{type:lO,text:"Purple",value:"#B96AD9"},{type:lO,text:"Blue",value:"#3598DB"},{type:lO,text:"Dark Turquoise",value:"#169179"},{type:lO,text:"Orange",value:"#E67E23"},{type:lO,text:"Dark Red",value:"#BA372A"},{type:lO,text:"Dark Purple",value:"#843FA1"},{type:lO,text:"Dark Blue",value:"#236FA1"},{type:lO,text:"Light Gray",value:"#ECF0F1"},{type:lO,text:"Medium Gray",value:"#CED4D9"},{type:lO,text:"Gray",value:"#95A5A6"},{type:lO,text:"Dark Gray",value:"#7E8C8D"},{type:lO,text:"Navy Blue",value:"#34495E"},{type:lO,text:"Black",value:"#000000"},{type:lO,text:"White",value:"#ffffff"}],dO=function(t){function n(t){i.splice(t,1)}void 0===t&&(t=10);var e,o=cO.getItem(sO),r=ah(o)?JSON.parse(o):[],i=t-(e=r).length<0?e.slice(0,t):e;return{add:function(e){var o;(-1===(o=v(i,e))?Sh.none():Sh.some(o)).each(n),i.unshift(e),i.length>t&&i.pop(),cO.setItem(sO,JSON.stringify(i))},state:function(){return i.slice(0)}}}(10),mO="#000000",gO=function(t){return function(n,e){var o=!1;t.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{colorpicker:e},onAction:function(t,n){"hex-valid"===n.name&&(o=n.value)},onSubmit:function(e){var r=e.getData().colorpicker;o?(n(Sh.from(r)),e.close()):t.windowManager.alert(t.translate(["Invalid hex color code: {0}",r]))},onClose:i,onCancel:function(){n(Sh.none())}})}},pO=function(t,n,e,o,r,u,a){return q(w(t,(function(c){return"choiceitem"===c.type?Vn("choicemenuitem",_C,c).fold(uc,(function(s){return Sh.some(function(t,n,e,o,r,u,a,c){void 0===c&&(c=!0);var s=Uc({presets:e,textContent:n?t.text:Sh.none(),htmlContent:Sh.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:n?t.shortcut:Sh.none(),checkMark:n?Sh.some(Lc(a.icons)):Sh.none(),caret:Sh.none(),value:t.value},a,c);return zv(Ic({data:Rc(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){uk.set(t,n)},isActive:function(){return uk.isOn(t)},isDisabled:function(){return tS.isDisabled(t)},setDisabled:function(n){return tS.set(t,n)}}},onAction:function(){return o(t.value)},onSetup:function(t){return t.setActive(r),i},triggersSubmenu:!1,itemBehaviours:[]},s,u,a),{toggling:{toggleClass:lC,toggleOnExecute:!1,selected:t.active}})}(s,1===e,o,n,u(c.value),r,a,ic(t)))})):Sh.none()})))},hO=He("cell-over"),vO=He("cell-execute"),bO={inserttable:function(t){var n=He("size-label"),e=function(t){for(var n=[],e=0;e<10;e++){for(var o=[],r=0;r<10;r++)o.push(function(t,n,e){function o(e){return Se(e,vO,{row:t,col:n})}
function r(t,n){n.stop(),o(t)}var i;return Oy({dom:{tag:"div",attributes:((i={role:"button"})["aria-labelledby"]=e,i)},behaviours:ex([ra("insert-table-picker-cell",[Ee(pb(),ok.focus),Ee(Ab(),o),Ee(Sb(),r),Ee(Ib(),r)]),uk.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),ok.config({onFocus:function(e){return Se(e,hO,{row:t,col:n})}})])})}(e,r,t));n.push(o)}return n}(n),o=Ss(0,0),r=Ba({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:n}},components:[o],behaviours:ex([tk.config({})])});return{type:"widget",data:{value:He("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[ZC.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:D(e,(function(t){return w(t,_y)})).concat(r.asSpec()),behaviours:ex([ra("insert-table-picker",[ny((function(t){tk.set(r.get(t),[o])})),Ae(hO,(function(t,n,o){var i=o.event,u=i.row,a=i.col;!function(t,n,e){for(var o=0;o<10;o++)for(var r=0;r<10;r++)uk.set(t[o][r],o<=n&&r<=e)}(e,u,a),tk.set(r.get(t),[Ss(u+1,a+1)])})),Ae(vO,(function(n,e,o){var r=o.event,i=r.row,u=r.col;t.onAction({numRows:i+1,numColumns:u+1}),we(n,Vb())}))]),QS.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(t,n){var e,o,r,i=(o=n,r=(e=t).initData.allowCustomColors&&o.colorinput.hasCustomColors(),e.initData.colors.fold((function(){return ps(o.colorinput.getColors(),r)}),(function(t){return t.concat(ms(r))}))),u=n.colorinput.getColorCols(),a=xs(He("menu-value"),i,(function(n){t.onAction({value:n})}),u,"color",uC.CLOSE_ON_EXECUTE,hh,n.shared.providers),c=yh(yh({},a),{markers:tc("color"),movement:ws(u,"color")});return{type:"widget",data:{value:He("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[ZC.widget(yk.sketch(c))]}}},yO=function(t){var n=t.text.fold((function(){return{}}),(function(t){return{innerHtml:t}}));return{type:"separator",dom:yh({tag:"div",classes:[cC,"tox-collection__group-heading"]},n),components:[]}},xO=function(t,n,e,o){void 0===o&&(o=!0);var r=Uc({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:Sh.none(),ariaLabel:t.text,caret:Sh.none(),checkMark:Sh.none(),shortcutContent:t.shortcut},e,o);return Ic({data:Rc(t),getApi:function(t){return{isDisabled:function(){return tS.isDisabled(t)},setDisabled:function(n){return tS.set(t,n)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e)},wO=function(t,n,e,o,r){void 0===o&&(o=!0);var u=(r=void 0!==r&&r)?Vc("chevron-down",e.icons,[mC]):Vc("chevron-right",e.icons,[mC]),a=Uc({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:Sh.none(),ariaLabel:t.text,caret:Sh.some(u),checkMark:Sh.none(),shortcutContent:t.shortcut},e,o);return Ic({data:Rc(t),getApi:function(t){return{isDisabled:function(){return tS.isDisabled(t)},setDisabled:function(n){return tS.set(t,n)}}},disabled:t.disabled,onAction:i,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},a,n,e)},SO=function(t,n,e,o){void 0===o&&(o=!0);var r=Uc({iconContent:t.icon,textContent:t.text,htmlContent:Sh.none(),ariaLabel:t.text,checkMark:Sh.some(Lc(e.icons)),caret:Sh.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,o);return zv(Ic({data:Rc(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){uk.set(t,n)},isActive:function(){return uk.isOn(t)},isDisabled:function(){return tS.isDisabled(t)},setDisabled:function(n){return tS.set(t,n)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e),{toggling:{toggleClass:lC,toggleOnExecute:!1,selected:t.active}})},kO=function(t,n){return G(bO,t.fancytype).map((function(e){return e(t,n)}))};(jC=UC={})[jC.ContentFocus=0]="ContentFocus",jC[jC.UiFocus=1]="UiFocus";var CO=de([{stopped:[]},{resume:["element"]},{complete:[]}]),OO=function(t,n,e,o,r,i){return As(t,n,e,o,r,i).fold(vh,(function(o){return OO(t,n,e,o,r,i)}),hh)},_O=function(t,n,e,o,r){var i=Ms(e,o);return OO(t,n,e,o,i,r)},TO=ji({name:"Container",factory:function(t){var n=t.dom,e=n.attributes,o=m(n,["attributes"]);return{uid:t.uid,dom:yh({tag:"div",attributes:yh({role:"presentation"},e)},o),components:t.components,behaviours:wi(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[ee("components",[]),xi("containerBehaviours",[]),ee("events",{}),ee("domModification",{}),ee("eventOrder",{})]}),EO=a([ee("prefix","form-field"),xi("fieldBehaviours",[qw,pw])]),DO=a([Hw({schema:[Ln("dom")],name:"label"}),Hw({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Ln("text")],name:"aria-descriptor"}),Vw({factory:{sketch:function(t){var n,e,o=(n=["factory"],e={},N(t,(function(t,o){_h(n,o)||(e[o]=t)})),e);return t.factory.sketch(o)}},schema:[Ln("factory")],name:"field"})]),BO=Gi({name:"FormField",configFields:EO(),partFields:DO(),factory:function(t,n){var e=Si(t.fieldBehaviours,[qw.config({find:function(n){return Ii(n,t,"field")}}),pw.config({store:{mode:"manual",getValue:function(t){return qw.getCurrent(t).bind(pw.getValue)},setValue:function(t,n){qw.getCurrent(t).each((function(t){pw.setValue(t,n)}))}}})]),o=ty([ny((function(n){var e=Vi(n,t,["label","field","aria-descriptor"]);e.field().each((function(n){var o=He(t.prefix);e.label().each((function(t){Ot(t.element,"for",o),Ot(n.element,"id",o)})),e["aria-descriptor"]().each((function(e){var o=He(t.prefix);Ot(e.element,"id",o),Ot(n.element,"aria-describedby",o)}))}))}))]);return{uid:t.uid,dom:t.dom,components:n,behaviours:e,events:o,apis:{getField:function(n){return Ii(n,t,"field")},getLabel:function(n){return Ii(n,t,"label")}}}},apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),MO=Object.freeze({__proto__:null,exhibit:function(t,n){return Ge({attributes:ge([{key:n.tabAttr,value:"true"}])})}}),AO=Xo({fields:[ee("tabAttr","data-alloy-tabstop")],name:"tabstopping",active:MO}),FO=tinymce.util.Tools.resolve("tinymce.html.Entities"),IO=function(t,n,e,o){return{dom:RO(e),components:t.toArray().concat([n]),fieldBehaviours:ex(o)}},RO=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},VO=He("form-component-change"),PO=He("form-close"),HO=He("form-cancel"),zO=He("form-action"),NO=He("form-submit"),LO=He("form-block"),WO=He("form-unblock"),UO=He("form-tabchange"),jO=He("form-resize"),GO=a([Kn("data"),ee("inputAttributes",{}),ee("inputStyles",{}),ee("tag","input"),ee("inputClasses",[]),So("onSetValue"),ee("styles",{}),ee("eventOrder",{}),xi("inputBehaviours",[pw,ok]),ee("selectOnFocus",!0)]),XO=ji({name:"Input",configFields:GO(),factory:function(t){return{uid:t.uid,dom:Hs(t),components:[],behaviours:yh(yh({},Ps(n=t)),Si(n.inputBehaviours,[pw.config({store:yh(yh({mode:"manual"},n.data.map((function(t){return{initialValue:t}})).getOr({})),{getValue:function(t){return eo(t.element)},setValue:function(t,n){eo(t.element)!==n&&oo(t.element,n)}}),onSetValue:n.onSetValue})])),eventOrder:t.eventOrder};var n}}),YO={},qO={exports:YO};!function(){var t=this,n=function(){function t(){}function n(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],a(t,this)}function e(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,n._immediateFn((function(){var n,i=1===t._state?e.onFulfilled:e.onRejected;if(null!==i){try{n=i(t._value)}catch(n){return void r(e.promise,n)}o(e.promise,n)}else(1===t._state?o:r)(e.promise,t._value)}))):t._deferreds.push(e)}function o(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var o=e.then;if(e instanceof n)return t._state=3,t._value=e,void i(t);if("function"==typeof o)return void a((u=o,c=e,function(){u.apply(c,arguments)}),t)}t._state=1,t._value=e,i(t)}catch(e){r(t,e)}var u,c}function r(t,n){t._state=2,t._value=n,i(t)}function i(t){2===t._state&&0===t._deferreds.length&&n._immediateFn((function(){t._handled||n._unhandledRejectionFn(t._value)}));for(var o=0,r=t._deferreds.length;o<r;o++)e(t,t._deferreds[o]);t._deferreds=null}function u(t,n,e){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.promise=e}function a(t,n){var e=!1;try{t((function(t){e||(e=!0,o(n,t))}),(function(t){e||(e=!0,r(n,t))}))}catch(t){if(e)return;e=!0,r(n,t)}}var c,s,l,f={exports:{}};c=f,s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},l=setTimeout,n.prototype.catch=function(t){return this.then(null,t)},n.prototype.then=function(n,o){var r=new this.constructor(t);return e(this,new u(n,o,r)),r},n.all=function(t){var e=Array.prototype.slice.call(t);return new n((function(t,n){if(0===e.length)return t([]);for(var o=e.length,r=0;r<e.length;r++)!function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a)return a.call(u,(function(t){r(i,t)}),n),0}e[i]=u,0==--o&&t(e)}catch(u){n(u)}}(r,e[r])}))},n.resolve=function(t){return t&&"object"==typeof t&&t.constructor===n?t:new n((function(n){n(t)}))},n.reject=function(t){return new n((function(n,e){e(t)}))},n.race=function(t){return new n((function(n,e){for(var o=0,r=t.length;o<r;o++)t[o].then(n,e)}))},n._immediateFn="function"==typeof setImmediate?function(t){setImmediate(t)}:function(t){l(t,0)},n._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},n._setImmediateFn=function(t){n._immediateFn=t},n._setUnhandledRejectionFn=function(t){n._unhandledRejectionFn=t},c.exports?c.exports=n:s.Promise||(s.Promise=n);var d=f.exports;return{boltExport:("undefined"!=typeof window?window:Function("return this;")()).Promise||d}};"object"==typeof YO&&void 0!==qO?qO.exports=n():(t="undefined"!=typeof globalThis?globalThis:t||self).EphoxContactWrapper=n()}();var KO,JO,$O=qO.exports.boltExport,QO=function(t){function n(t){r()?i(t):o.push(t)}var e=Sh.none(),o=[],r=function(){return e.isSome()},i=function(t){e.each((function(n){setTimeout((function(){t(n)}),0)}))};return t((function(t){r()||(e=Sh.some(t),Th(o,i),o=[])})),{get:n,map:function(t){return QO((function(e){n((function(n){e(t(n))}))}))},isReady:r}},ZO={nu:QO,pure:function(t){return QO((function(n){n(t)}))}},t_=function(t){function n(n){t().then(n,Ns)}return{map:function(n){return t_((function(){return t().then(n)}))},bind:function(n){return t_((function(){return t().then((function(t){return n(t).toPromise()}))}))},anonBind:function(n){return t_((function(){return t().then((function(){return n.toPromise()}))}))},toLazy:function(){return ZO.nu(n)},toCached:function(){var n=null;return t_((function(){return n=null===n?t():n}))},toPromise:t,get:n}},n_=function(t){return t_((function(){return new $O(t)}))},e_=function(t){return t_((function(){return $O.resolve(t)}))},o_=["input","textarea"],r_=Object.freeze({__proto__:null,markValid:Ws,markInvalid:Us,query:js,run:Gs,isInvalid:function(t,n){return Ze(n.getRoot(t).getOr(t.element),n.invalidClass)}}),i_=Object.freeze({__proto__:null,events:function(t){return t.validator.map((function(n){return ty([Ee(n.onEvent,(function(n){Gs(n,t).get(c)}))].concat(n.validateOnLoad?[ny((function(n){Gs(n,t).get(i)}))]:[]))})).getOr({})}}),u_=Xo({fields:[Ln("invalidClass"),ee("getRoot",Sh.none),ne("notify",[ee("aria","alert"),ee("getContainer",Sh.none),ee("validHtml",""),So("onValid"),So("onInvalid"),So("onValidate")]),ne("validator",[Ln("validate"),ee("onEvent","input"),ee("validateOnLoad",!0)])],name:"invalidating",active:i_,apis:r_,extra:{validation:function(t){return function(n){var e=pw.getValue(n);return e_(t(e))}}}}),a_=Object.freeze({__proto__:null,getCoupled:function(t,n,e,o){return e.getOrCreate(t,n,o)}}),c_=Xo({fields:[Wn("others",Rn(Bv.value,Gv()))],name:"coupling",apis:a_,state:Object.freeze({__proto__:null,init:function(){var t={},n=a({});return yy({readState:n,getOrCreate:function(n,e,o){var r=Dh(e.others);if(r)return G(t,o).getOrThunk((function(){var r=G(e.others,o).getOrDie("No information found for coupled component: "+o)(n),i=n.getSystem().build(r);return t[o]=i}));throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(r,null,2))}})}})}),s_=a("sink"),l_=a(Hw({name:s_(),overrides:a({dom:{tag:"div"},behaviours:ex([$x.config({useFixed:vh})]),events:ty([Fe(bb()),Fe(fb()),Fe(Sb())])})}));(JO=KO=KO||{})[JO.HighlightFirst=0]="HighlightFirst",JO[JO.HighlightNone=1]="HighlightNone";var f_,d_,m_,g_,p_,h_,v_,b_=function(t,n){return t.getSystem().getByUid(n.uid+"-"+s_()).map((function(t){return function(){return Bv.value(t)}})).getOrThunk((function(){return n.lazySink.fold((function(){return function(){return Bv.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(n){return function(){return n(t)}}))}))},y_=a([Ln("dom"),Ln("fetch"),So("onOpen"),ko("onExecute"),ee("getHotspot",Sh.some),ee("getAnchorOverrides",a({})),Sr(),xi("dropdownBehaviours",[uk,c_,QS,ok]),Ln("toggleClass"),ee("eventOrder",{}),Kn("lazySink"),ee("matchWidth",!1),ee("useMinWidth",!1),Kn("role")].concat(Qs())),x_=a([Pw({schema:[yo()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),l_()]),w_=Gi({name:"Dropdown",configFields:y_(),partFields:x_(),factory:function(t,n,e,o){function r(t){rw.getState(t).each((function(t){Ck.highlightPrimary(t)}))}function u(t){return ke(t),Sh.some(!0)}var a,s={expand:function(n){uk.isOn(n)||qs(t,c,n,o,i,KO.HighlightNone).get(i)},open:function(n){uk.isOn(n)||qs(t,c,n,o,i,KO.HighlightFirst).get(i)},isOpen:uk.isOn,close:function(n){uk.isOn(n)&&qs(t,c,n,o,i,KO.HighlightFirst).get(i)},repositionMenus:function(t){uk.isOn(t)&&$s(t)}};return{uid:t.uid,dom:t.dom,components:n,behaviours:Si(t.dropdownBehaviours,[uk.config({toggleClass:t.toggleClass,aria:{mode:"expanded"}}),c_.config({others:{sandbox:function(n){return Js(t,n,{onOpen:function(){return uk.on(n)},onClose:function(){return uk.off(n)}})}}}),QS.config({mode:"special",onSpace:u,onEnter:u,onDown:function(t){return w_.isOpen(t)?r(c_.getCoupled(t,"sandbox")):w_.open(t),Sh.some(!0)},onEscape:function(t){return w_.isOpen(t)?(w_.close(t),Sh.some(!0)):Sh.none()}}),ok.config({})]),events:ma(Sh.some((function(n){qs(t,c,n,o,r,KO.HighlightFirst).get(i)}))),eventOrder:yh(yh({},t.eventOrder),((a={})[Ab()]=["disabling","toggling","alloy.base.behaviour"],a)),apis:s,domModification:{attributes:yh(yh({"aria-haspopup":"true"},t.role.fold((function(){return{}}),(function(t){return{role:t}}))),"button"===t.dom.tag?{type:G(t.dom,"attributes").bind((function(t){return G(t,"type")})).getOr("button")}:{})}}},apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)},repositionMenus:function(t,n){return t.repositionMenus(n)}}}),S_=Xo({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return ty([_e(_b(),vh)])},exhibit:function(){return Ge({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),k_=He("color-input-change"),C_=He("color-swatch-change"),O_=He("color-picker-cancel"),__=Hw({schema:[Ln("dom")],name:"label"}),T_=Zs("top-left"),E_=Zs("top"),D_=Zs("top-right"),B_=Zs("right"),M_=Zs("bottom-right"),A_=Zs("bottom"),F_=Zs("bottom-left"),I_=[__,Zs("left"),B_,E_,A_,T_,D_,F_,M_,Vw({name:"thumb",defaults:a({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:ty([Me(ab(),t,"spectrum"),Me(cb(),t,"spectrum"),Me(sb(),t,"spectrum"),Me(fb(),t,"spectrum"),Me(db(),t,"spectrum"),Me(gb(),t,"spectrum")])}}}),Vw({schema:[tb("mouseIsDown",(function(){return fe(!1)}))],name:"spectrum",overrides:function(t){function n(n,o){return e.getValueFromEvent(o).map((function(o){return e.setValueFrom(n,t,o)}))}var e=t.model.manager;return{behaviours:ex([QS.config({mode:"special",onLeft:function(n){return e.onLeft(n,t)},onRight:function(n){return e.onRight(n,t)},onUp:function(n){return e.onUp(n,t)},onDown:function(n){return e.onDown(n,t)}}),ok.config({})]),events:ty([Ee(ab(),n),Ee(cb(),n),Ee(fb(),n),Ee(db(),(function(e,o){t.mouseIsDown.get()&&n(e,o)}))])}}})],R_=a("slider.change.value"),V_="left",P_=Wl(-1),H_=Wl(1),z_=Sh.none,N_=Sh.none,L_={"top-left":Sh.none(),top:Sh.none(),"top-right":Sh.none(),right:Sh.some((function(t,n){Ol(t,{x:al(n)})})),"bottom-right":Sh.none(),bottom:Sh.none(),"bottom-left":Sh.none(),left:Sh.some((function(t,n){Ol(t,{x:ol(n)})}))},W_=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=Ll(t,n,e);return Nl(t,{x:o}),o},setToMin:function(t,n){Nl(t,{x:nl(n)})},setToMax:function(t,n){Nl(t,{x:il(n)})},findValueOfOffset:Ll,getValueFromEvent:function(t){return tl(t).map((function(t){return t.left}))},findPositionOfValue:Ul,setPositionFromValue:function(t,n,e,o){var r=kl(e),i=Ul(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=Xt(n.element)/2;Ft(n.element,"left",i-u+"px")},onLeft:P_,onRight:H_,onUp:z_,onDown:N_,edgeActions:L_}),U_=Sh.none,j_=Sh.none,G_=Xl(-1),X_=Xl(1),Y_={"top-left":Sh.none(),top:Sh.some((function(t,n){Ol(t,{y:rl(n)})})),"top-right":Sh.none(),right:Sh.none(),"bottom-right":Sh.none(),bottom:Sh.some((function(t,n){Ol(t,{y:cl(n)})})),"bottom-left":Sh.none(),left:Sh.none()},q_=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=Gl(t,n,e);return jl(t,{y:o}),o},setToMin:function(t,n){jl(t,{y:el(n)})},setToMax:function(t,n){jl(t,{y:ul(n)})},findValueOfOffset:Gl,getValueFromEvent:function(t){return tl(t).map((function(t){return t.top}))},findPositionOfValue:Yl,setPositionFromValue:function(t,n,e,o){var r=kl(e),i=Yl(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),u=Wt(n.element)/2;Ft(n.element,"top",i-u+"px")},onLeft:U_,onRight:j_,onUp:G_,onDown:X_,edgeActions:Y_}),K_=tl,J_=Jl(-1,!1),$_=Jl(1,!1),Q_=Jl(-1,!0),Z_=Jl(1,!0),tT={"top-left":Sh.some((function(t,n){Ol(t,Cl(ol(n),rl(n)))})),top:Sh.some((function(t,n){Ol(t,Cl(dl(n),rl(n)))})),"top-right":Sh.some((function(t,n){Ol(t,Cl(al(n),rl(n)))})),right:Sh.some((function(t,n){Ol(t,Cl(al(n),ml(n)))})),"bottom-right":Sh.some((function(t,n){Ol(t,Cl(al(n),cl(n)))})),bottom:Sh.some((function(t,n){Ol(t,Cl(dl(n),cl(n)))})),"bottom-left":Sh.some((function(t,n){Ol(t,Cl(ol(n),cl(n)))})),left:Sh.some((function(t,n){Ol(t,Cl(ol(n),ml(n)))}))},nT=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=Kl(Ll(t,n,e.left),Gl(t,n,e.top));return ql(t,o),o},setToMin:function(t,n){ql(t,Kl(nl(n),el(n)))},setToMax:function(t,n){ql(t,Kl(il(n),ul(n)))},getValueFromEvent:K_,setPositionFromValue:function(t,n,e,o){var r=kl(e),i=Ul(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=Yl(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),a=Xt(n.element)/2,c=Wt(n.element)/2;Ft(n.element,"left",i-a+"px"),Ft(n.element,"top",u-c+"px")},onLeft:J_,onRight:$_,onUp:Q_,onDown:Z_,edgeActions:tT}),eT=Gi({name:"Slider",configFields:[ee("stepSize",1),ee("onChange",i),ee("onChoose",i),ee("onInit",i),ee("onDragStart",i),ee("onDragEnd",i),ee("snapToGrid",!1),ee("rounded",!0),Kn("snapStart"),Wn("model",zn("mode",{x:[ee("minX",0),ee("maxX",100),tb("value",(function(t){return fe(t.mode.minX)})),Ln("getInitialValue"),_o("manager",W_)],y:[ee("minY",0),ee("maxY",100),tb("value",(function(t){return fe(t.mode.minY)})),Ln("getInitialValue"),_o("manager",q_)],xy:[ee("minX",0),ee("maxX",100),ee("minY",0),ee("maxY",100),tb("value",(function(t){return fe({x:t.mode.minX,y:t.mode.minY})})),Ln("getInitialValue"),_o("manager",nT)]})),xi("sliderBehaviours",[QS,pw]),tb("mouseIsDown",(function(){return fe(!1)}))],partFields:I_,factory:function(t,n){function e(n){return Ri(n,t,"thumb")}function o(n){return Ri(n,t,"spectrum")}function r(n){return Ii(n,t,"left-edge")}function i(n){return Ii(n,t,"right-edge")}function u(n){return Ii(n,t,"top-edge")}function a(n){return Ii(n,t,"bottom-edge")}function c(n,e){p.setPositionFromValue(n,e,t,{getLeftEdge:r,getRightEdge:i,getTopEdge:u,getBottomEdge:a,getSpectrum:o})}function s(t,n){g.value.set(n),c(t,e(t))}function l(n){var e=t.mouseIsDown.get();t.mouseIsDown.set(!1),e&&Ii(n,t,"thumb").each((function(e){var o=g.value.get();t.onChoose(n,e,o)}))}function f(n,o){o.stop(),t.mouseIsDown.set(!0),t.onDragStart(n,e(n))}function d(n,o){o.stop(),t.onDragEnd(n,e(n)),l(n)}var m,g=t.model,p=g.manager;return{uid:t.uid,dom:t.dom,components:n,behaviours:Si(t.sliderBehaviours,[QS.config({mode:"special",focusIn:function(n){return Ii(n,t,"spectrum").map(QS.focusIn).map(vh)}}),pw.config({store:{mode:"manual",getValue:function(){return g.value.get()}}}),ux.config({channels:((m={})[aw()]={onReceive:l},m)})]),events:ty([Ee(R_(),(function(n,o){!function(n,o){s(n,o);var r=e(n);t.onChange(n,r,o),Sh.some(!0)}(n,o.event.value)})),ny((function(n){var r=g.getInitialValue();g.value.set(r);var i=e(n);c(n,i);var u=o(n);t.onInit(n,i,u,g.value.get())})),Ee(ab(),f),Ee(sb(),d),Ee(fb(),f),Ee(gb(),d)]),apis:{resetToMin:function(n){p.setToMin(n,t)},resetToMax:function(n){p.setToMax(n,t)},setValue:s,refresh:c},domModification:{styles:{position:"relative"}}}},apis:{setValue:function(t,n,e){t.setValue(n,e)},resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),oT=He("rgb-hex-update"),rT=He("slider-update"),iT=He("palette-update"),uT=[xi("formBehaviours",[pw])],aT={getField:Ue((function(t,n,e){return t.getField(n,e)})),sketch:function(t){var n,e={field:function(t,e){return n.push(t),Di("form",$l(t),e)},record:a(n=[])},o=t(e),r=w(e.record(),(function(t){return Vw({name:t,pname:$l(t)})}));return Ui("form",uT,r,Zf,o)}},cT=He("valid-input"),sT=He("invalid-input"),lT=He("validating-input"),fT="colorcustom.rgb.",dT=function(t){return qw.config({find:t.getOpt})},mT=function(t){return qw.config({find:function(n){return bt(n.element,t).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))}})},gT={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},pT=tinymce.util.Tools.resolve("tinymce.Resource"),hT=tinymce.util.Tools.resolve("tinymce.util.Tools"),vT=Uv([ee("preprocess",c),ee("postprocess",c)]),bT=function(t,n){var e=Hn("RepresentingConfigs.memento processors",vT,n);return pw.config({store:{mode:"manual",getValue:function(n){var o=t.get(n),r=pw.getValue(o);return e.postprocess(r)},setValue:function(n,o){var r=e.preprocess(o),i=t.get(n);pw.setValue(i,r)}}})},yT=nf,xT=function(t){return pw.config({store:{mode:"memory",initialValue:t}})},wT=He("alloy-fake-before-tabstop"),ST=He("alloy-fake-after-tabstop"),kT=!(rv().browser.isIE()||rv().browser.isEdge()),CT=function(t){return t.getContext("2d")},OT=function(t,n,e){return t.width=n,t.height=e,t},_T=function(t){URL.revokeObjectURL(t.src)},TT=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],ET=function(t,n,e){var o=CT(t),r=function(t){for(var n,o,r,i,u=t.data,a=e[0],c=e[1],s=e[2],l=e[3],f=e[4],d=e[5],m=e[6],g=e[7],p=e[8],h=e[9],v=e[10],b=e[11],y=e[12],x=e[13],w=e[14],S=e[15],k=e[16],C=e[17],O=e[18],_=e[19],T=0;T<u.length;T+=4)n=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=n*a+o*c+r*s+i*l+f,u[T+1]=n*d+o*m+r*g+i*p+h,u[T+2]=n*v+o*b+r*y+i*x+w,u[T+3]=n*S+o*k+r*C+i*O+_;return t}(o.getImageData(0,0,t.width,t.height));return o.putImageData(r,0,0),pf(t,n)},DT=(f_=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1],function(t){return xf(t,f_)}),BT=wf((function(t,n){return yf(t,[1,0,0,0,n=vf(255*n,-255,255),0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])})),MT=wf((function(t,n){var e;return n=vf(n,-1,1),yf(t,[(e=(n*=100)<0?127+n/100*127:127*(0==(e=n%1)?TT[n]:TT[Math.floor(n)]*(1-e)+TT[Math.floor(n)+1]*e)+127)/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])})),AT=(d_=[0,-1,0,-1,5,-1,0,-1,0],function(t){return e=d_,(n=t).toCanvas().then((function(t){return o=t,r=n.getType(),i=e,a=function(t,n,e){for(var o=function(t,n,e){return e<t?t=e:t<n&&(t=n),t},r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=t.data,a=n.data,c=t.width,s=t.height,l=0;l<s;l++)for(var f=0;f<c;f++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(f+h-i,0,c-1),b=4*(o(l+p-i,0,s-1)*c+v),y=e[p*r+h];d+=u[b]*y,m+=u[1+b]*y,g+=u[2+b]*y}var x=4*(l*c+f);a[x]=o(d,0,255),a[1+x]=o(m,0,255),a[2+x]=o(g,0,255)}return n}((u=CT(o)).getImageData(0,0,o.width,o.height),u.getImageData(0,0,o.width,o.height),i),u.putImageData(a,0,0),pf(o,r);var o,r,i,u,a}));var n,e}),FT=(m_=function(t,n){return 255*Math.pow(t/255,1-n)},function(t,n){return t.toCanvas().then((function(e){return function(t,n,e){for(var o=CT(t),r=new Array(256),i=0;i<r.length;i++)r[i]=m_(i,e);var u=function(t,n){for(var e=t.data,o=0;o<e.length;o+=4)e[o]=n[e[o]],e[o+1]=n[e[o+1]],e[o+2]=n[e[o+2]];return t}(o.getImageData(0,0,t.width,t.height),r);return o.putImageData(u,0,0),pf(t,n)}(e,t.getType(),n)}))}),IT=function(t,n,e){var o=ff(t),r=df(t),i=n/o,u=e/r,a=!1;(i<.5||2<i)&&(i=i<.5?.5:2,a=!0),(u<.5||2<u)&&(u=u<.5?.5:2,a=!0);var c=RT(t,i,u);return a?c.then((function(t){return IT(t,n,e)})):c},RT=function(t,n,e){return new $O((function(o){var r=ff(t),i=df(t),u=Math.floor(r*n),a=Math.floor(i*e),c=sf(u,a);CT(c).drawImage(t,0,0,r,i,0,0,u,a),o(c)}))},VT=function(t,n,e){var o=(e<0?360+e:e)*Math.PI/180,r=t.width,i=t.height,u=Math.sin(o),a=Math.cos(o),c=Sf(Math.abs(r*a)+Math.abs(i*u)),s=Sf(Math.abs(r*u)+Math.abs(i*a)),l=sf(c,s),f=CT(l);return f.translate(c/2,s/2),f.rotate(o),f.drawImage(t,-r/2,-i/2),pf(l,n)},PT=function(t,n,e){var o=sf(t.width,t.height),r=CT(o);return"v"===e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),pf(o,n)},HT=function(t,n,e,o,r,i){var u=sf(r,i);return CT(u).drawImage(t,-e,-o),pf(u,n)},zT=He("toolbar.button.execute"),NT=((g_={})[Ab()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],g_),LT=He("update-menu-text"),WT=He("update-menu-icon"),UT={type:"separator"},jT=function(t,n){var e,o,r;return C((e=ah(t)?t.split(" "):t,o=n,0<(r=O(e,(function(t,n){return ah(n)?""===n?t:"|"===n?0<t.length&&!Rf(t[t.length-1])?t.concat([UT]):t:Ah(o,n.toLowerCase())?t.concat([o[n.toLowerCase()]]):t:t.concat([n])}),[])).length&&Rf(r[r.length-1])&&r.pop(),r),(function(t,e){var o,r,i,u,a,c,s=function(t){if(Rf(t))return t;var n=G(t,"value").getOrThunk((function(){return He("generated-menu-item")}));return zv({value:n},t)}(e),l=(r=n,Ah(o=s,"getSubmenuItems")?(u=r,a=(i=o).getSubmenuItems(),c=jT(a,u),{item:i,menus:zv(c.menus,me(i.value,c.items)),expansions:zv(c.expansions,me(i.value,i.value))}):{item:o,menus:{},expansions:{}});return{menus:zv(t.menus,l.menus),items:[l.item].concat(t.items),expansions:zv(t.expansions,l.expansions)}}),{menus:{},expansions:{},items:[]})},GT=a([ee("field1Name","field1"),ee("field2Name","field2"),Co("onLockedChange"),xo(["lockClass"]),ee("locked",!1),hw("coupledFieldBehaviours",[qw,pw])]),XT=a([Xf("field1","field2"),Xf("field2","field1"),Vw({factory:Bk,schema:[Ln("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:ex([uk.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),YT=Gi({name:"FormCoupledInputs",configFields:GT(),partFields:XT(),factory:function(t,n){return{uid:t.uid,dom:t.dom,components:n,behaviours:vw(t.coupledFieldBehaviours,[qw.config({find:Sh.some}),pw.config({store:{mode:"manual",getValue:function(n){var e=zi(n,t,["field1","field2"]),o={};return o[t.field1Name]=pw.getValue(e.field1()),o[t.field2Name]=pw.getValue(e.field2()),o},setValue:function(n,e){var o=zi(n,t,["field1","field2"]);X(e,t.field1Name)&&pw.setValue(o.field1(),e[t.field1Name]),X(e,t.field2Name)&&pw.setValue(o.field2(),e[t.field2Name])}}})]),apis:{getField1:function(n){return Ii(n,t,"field1")},getField2:function(n){return Ii(n,t,"field2")},getLock:function(n){return Ii(n,t,"lock")}}}},apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),qT={undo:a(He("undo")),redo:a(He("redo")),zoom:a(He("zoom")),back:a(He("back")),apply:a(He("apply")),swap:a(He("swap")),transform:a(He("transform")),tempTransform:a(He("temp-transform")),transformApply:a(He("transform-apply"))},KT=a("save-state"),JT=a("disable"),$T=a("enable"),QT={formActionEvent:zO,saveState:KT,disable:JT,enable:$T},ZT=tinymce.util.Tools.resolve("tinymce.geom.Rect"),tE=tinymce.util.Tools.resolve("tinymce.util.Observable"),nE=tinymce.util.Tools.resolve("tinymce.util.VK"),eE=0,oE=function(t,n,e,o,r){function i(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}}function u(n,o,r,u){var a=o.x+r*n.deltaX,c=o.y+u*n.deltaY,s=Math.max(20,o.w+r*n.deltaW),l=Math.max(20,o.h+u*n.deltaH),f=(t=ZT.clamp({x:a,y:c,w:s,h:l},e,"move"===n.name),i(e,t));y.fire("updateRect",{rect:f}),b(f)}function a(n){c(t=n)}function c(t){function e(t,n){po(p,"#"+m+"-"+t).each((function(t){It(t,{left:n.x+"px",top:n.y+"px",width:Math.max(0,n.w)+"px",height:Math.max(0,n.h)+"px"})}))}Th(h,(function(n){po(p,"#"+m+"-"+n.name).each((function(e){It(e,{left:t.w*n.xMul+t.x+"px",top:t.h*n.yMul+t.y+"px"})}))})),e("top",{x:n.x,y:n.y,w:n.w,h:t.y-n.y}),e("right",{x:t.x+t.w,y:t.y,w:n.w-t.x-t.w+n.x,h:t.h}),e("bottom",{x:n.x,y:t.y+t.h,w:n.w,h:n.h-t.y-t.h+n.y}),e("left",{x:n.x,y:t.y,w:t.x-n.x,h:t.h}),e("move",t)}function s(t){Ot(t.target,"aria-grabbed","focus"===t.raw.type?"true":"false")}var l,f,d=[],m="tox-crid-"+eE++,p=Ph.fromDom(o),h=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],v=["top","right","bottom","left"],b=function(t){var n;a((n=e,{x:t.x+n.x,y:t.y+n.y,w:t.w,h:t.h}))};_t(f=Ph.fromTag("div"),{id:m,class:"tox-croprect-container",role:"grid","aria-dropeffect":"execute"}),wv(p,f),Th(v,(function(t){po(p,"#"+m).each((function(n){var e=Ph.fromTag("div");_t(e,{id:m+"-"+t,class:"tox-croprect-block","data-mce-bogus":"all"}),Ft(e,"display","none"),wv(n,e)}))})),Th(h,(function(t){po(p,"#"+m).each((function(n){var e=Ph.fromTag("div");_t(e,{id:m+"-"+t.name,"aria-label":t.label,"aria-grabbed":"false","data-mce-bogus":"all",role:"gridcell",tabindex:"-1",title:t.label}),to(e,["tox-croprect-handle","tox-croprect-handle-"+t.name]),Ft(e,"display","none"),wv(n,e)}))})),l=w(h,(function(n){var e;return ed(m,{document:o.ownerDocument,root:cv(p).dom,handle:m+"-"+n.name,start:function(){e=t},drag:function(t){u(n,e,t.deltaX,t.deltaY)}})})),c(t),d.push(fr(p,"focusin",s),fr(p,"focusout",s),fr(p,"keydown",(function(n){function e(t,n,e,r,i){t.stopPropagation(),t.preventDefault(),u(o,e,r,i)}var o;switch(Th(h,(function(t){if(Tt(n.target,"id")===m+"-"+t.name)return o=t,!1})),n.raw.keyCode){case nE.LEFT:e(n,0,t,-10,0);break;case nE.RIGHT:e(n,0,t,10,0);break;case nE.UP:e(n,0,t,0,-10);break;case nE.DOWN:e(n,0,t,0,10);break;case nE.ENTER:case nE.SPACEBAR:n.prevent(),r()}})));var y=yh(yh({},tE),{toggleVisibility:function(t){var n=g(g([],w(h,(function(t){return"#"+m+"-"+t.name})),!0),w(v,(function(t){return"#"+m+"-"+t})),!0).join(","),e=Hr(p,n);Th(e,t?function(t){return zt(t,"display")}:function(t){
return Ft(t,"display","none")})},setClampRect:function(n){e=n,c(t)},setRect:a,getInnerRect:function(){return i(e,t)},setInnerRect:b,setViewPortRect:function(e){n=e,c(t)},destroy:function(){Th(l,(function(t){return t.destroy()})),l=[],Th(d,(function(t){return t.unbind()})),d=[]}});return y},rE="data-value",iE=function(t,n,e,o){return w(e,(function(e){return ad(e)?{type:"togglemenuitem",text:e.text,value:e.value,active:e.value===o,onAction:function(){pw.setValue(t,e.value),Se(t,VO,{name:n}),ok.focus(t)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:function(){return iE(t,n,e.items,o)}}}))},uE=function(t,n){return z(t,(function(t){return ad(t)?K(t.value===n,t):uE(t.items,n)}))},aE=ji({name:"HtmlSelect",configFields:[Ln("options"),xi("selectBehaviours",[ok,pw]),ee("selectClasses",[]),ee("selectAttributes",{}),Kn("data")],factory:function(t){var n=w(t.options,(function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}})),e=t.data.map((function(t){return me("initialValue",t)})).getOr({});return{uid:t.uid,dom:{tag:"select",classes:t.selectClasses,attributes:t.selectAttributes},components:n,behaviours:Si(t.selectBehaviours,[ok.config({}),pw.config({store:yh({mode:"manual",getValue:function(t){return eo(t.element)},setValue:function(n,e){_(t.options,(function(t){return t.value===e})).isSome()&&oo(n.element,e)}},e)})])}}}),cE=Object.freeze({__proto__:null,events:function(t,n){var e=t.stream.streams.setup(t,n);return ty([Ee(t.event,e),ey((function(){return n.cancel()}))].concat(t.cancelEvent.map((function(t){return[Ee(t,(function(){return n.cancel()}))]})).getOr([])))}}),sE=Object.freeze({__proto__:null,throttle:ld,init:function(t){return t.stream.streams.state(t)}}),lE=Xo({fields:[Wn("stream",zn("mode",{throttle:[Ln("delay"),ee("stopEvent",!0),_o("streams",{setup:function(t,n){var e=t.stream,o=La(t.onStream,e.delay);return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},state:ld})]})),ee("event","input"),Kn("cancelEvent"),Co("onStream")],name:"streaming",active:cE,state:sE}),fE=function(t){dd(t,(function(t,n){return t.setSelectionRange(n.length,n.length)}))},dE=a("alloy.typeahead.itemexecute"),mE=a([Kn("lazySink"),Ln("fetch"),ee("minChars",5),ee("responseTime",1e3),So("onOpen"),ee("getHotspot",Sh.some),ee("getAnchorOverrides",a({})),ee("layouts",Sh.none()),ee("eventOrder",{}),le("model",{},[ee("getDisplayText",(function(t){return void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.value})),ee("selectsOver",!0),ee("populateFromBrowse",!0)]),So("onSetValue"),ko("onExecute"),So("onItemExecute"),ee("inputClasses",[]),ee("inputAttributes",{}),ee("inputStyles",{}),ee("matchWidth",!0),ee("useMinWidth",!1),ee("dismissOnBlur",!0),xo(["openClass"]),Kn("initialData"),xi("typeaheadBehaviours",[ok,pw,lE,QS,uk,c_]),tb("previewing",(function(){return fe(!0)}))].concat(GO()).concat(Qs())),gE=a([Pw({schema:[yo()],name:"menu",overrides:function(t){return{fakeFocus:!0,onHighlight:function(n,e){t.previewing.get()?n.getSystem().getByUid(t.uid).each((function(o){(function(t,n,e){if(t.selectsOver){var o=pw.getValue(n),r=t.getDisplayText(o),i=pw.getValue(e);return 0===t.getDisplayText(i).indexOf(r)?Sh.some((function(){var t;fd(0,n,e),t=r.length,dd(n,(function(n,e){return n.setSelectionRange(t,e.length)}))})):Sh.none()}return Sh.none()})(t.model,o,e).fold((function(){return eS.dehighlight(n,e)}),(function(t){return t()}))})):n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&fd(t.model,n,e)})),t.previewing.set(!1)},onExecute:function(n,e){return n.getSystem().getByUid(t.uid).toOptional().map((function(t){return Se(t,dE(),{item:e}),!0}))},onHover:function(n,e){t.previewing.set(!1),n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&fd(t.model,n,e)}))}}}})]),pE=Gi({name:"Typeahead",configFields:mE(),partFields:gE(),factory:function(t,n,e,o){function r(n,e,r){t.previewing.set(!1);var a=c_.getCoupled(n,"sandbox");rw.isOpen(a)?qw.getCurrent(a).each((function(t){eS.getHighlighted(t).fold((function(){r(t)}),(function(){Oe(a,t.element,"keydown",e)}))})):Ys(t,u(n),n,a,o,(function(t){qw.getCurrent(t).each(r)}),KO.HighlightFirst).get(i)}function u(t){return function(n){return n.map((function(n){var e=D(j(n.menus),(function(t){return k(t.items,(function(t){return"item"===t.type}))}));return pw.getState(t).update(w(e,(function(t){return t.data}))),n}))}}var a=Ps(t),c=[ok.config({}),pw.config({onSetValue:t.onSetValue,store:yh({mode:"dataset",getDataKey:function(t){return eo(t.element)},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(n,e){oo(n.element,t.model.getDisplayText(e))}},t.initialData.map((function(t){return me("initialValue",t)})).getOr({}))}),lE.config({stream:{mode:"throttle",delay:t.responseTime,stopEvent:!1},onStream:function(n){var e,r=c_.getCoupled(n,"sandbox");ok.isFocused(n)&&eo(n.element).length>=t.minChars&&(e=qw.getCurrent(r).bind((function(t){return eS.getHighlighted(t).map(pw.getValue)})),t.previewing.set(!0),Ys(t,u(n),n,r,o,(function(){qw.getCurrent(r).each((function(n){e.fold((function(){t.model.selectsOver&&eS.highlightFirst(n)}),(function(t){eS.highlightBy(n,(function(n){return pw.getValue(n).value===t.value})),eS.getHighlighted(n).orThunk((function(){return eS.highlightFirst(n),Sh.none()}))}))}))}),KO.HighlightFirst).get(i))},cancelEvent:Pb()}),QS.config({mode:"special",onDown:function(t,n){return r(t,n,eS.highlightFirst),Sh.some(!0)},onEscape:function(t){var n=c_.getCoupled(t,"sandbox");return rw.isOpen(n)?(rw.close(n),Sh.some(!0)):Sh.none()},onUp:function(t,n){return r(t,n,eS.highlightLast),Sh.some(!0)},onEnter:function(n){var e=c_.getCoupled(n,"sandbox"),o=rw.isOpen(e);if(o&&!t.previewing.get())return qw.getCurrent(e).bind((function(t){return eS.getHighlighted(t)})).map((function(t){return Se(n,dE(),{item:t}),!0}));var r=pw.getValue(n);return we(n,Pb()),t.onExecute(e,n,r),o&&rw.close(e),Sh.some(!0)}}),uk.config({toggleClass:t.markers.openClass,aria:{mode:"expanded"}}),c_.config({others:{sandbox:function(n){return Js(t,n,{onOpen:function(){return uk.on(n)},onClose:function(){return uk.off(n)}})}}}),ra("typeaheadevents",[ry((function(n){qs(t,u(n),n,o,i,KO.HighlightFirst).get(i)})),Ee(dE(),(function(n,e){var o=c_.getCoupled(n,"sandbox");fd(t.model,n,e.event.item),we(n,Pb()),t.onItemExecute(n,o,e.event.item,pw.getValue(n)),rw.close(o),fE(n)}))].concat(t.dismissOnBlur?[Ee(Db(),(function(t){var n=c_.getCoupled(t,"sandbox");Qo(n.element).isNone()&&rw.close(n)}))]:[]))];return{uid:t.uid,dom:Hs(zv(t,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:yh(yh({},a),Si(t.typeaheadBehaviours,c)),eventOrder:t.eventOrder}}}),hE=function(t){return yh(yh({},t),{toCached:function(){return hE(t.toCached())},bindFuture:function(n){return hE(t.bind((function(t){return t.fold((function(t){return e_(Bv.error(t))}),(function(t){return n(t)}))})))},bindResult:function(n){return hE(t.map((function(t){return t.bind(n)})))},mapResult:function(n){return hE(t.map((function(t){return t.map(n)})))},mapError:function(n){return hE(t.map((function(t){return t.mapError(n)})))},foldResult:function(n,e){return t.map((function(t){return t.fold(n,e)}))},withTimeout:function(n,e){return hE(n_((function(o){var r=!1,i=setTimeout((function(){r=!0,o(Bv.error(e()))}),n);t.get((function(t){r||(clearTimeout(i),o(t))}))})))}})},vE=function(t){return hE(n_(t))},bE={type:"separator"},yE=He("aria-invalid"),xE={bar:bd((function(t,n){return e=n.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:w(t.items,e.interpreter)};var e})),collection:bd((function(t,n){function e(t){return function(n,e){ho(e.event.target,"[data-collection-item-value]").each((function(o){t(n,e,o,Tt(o,"data-collection-item-value"))}))}}function o(t,n){return w(Hr(t.element,".tox-collection__item"),n)}return r=t,i=n.shared.providers,s=r.label.map((function(t){return Vs(t,i)})),l=e((function(t,n,e,o){n.stop(),i.isDisabled()||Se(t,zO,{name:r.name,value:o})})),f=[Ee(pb(),e((function(t,n,e){Ko(e)}))),Ee(Sb(),l),Ee(Ib(),l),Ee(hb(),e((function(t,n,e){po(t.element,"."+gC).each((function(t){Qe(t,gC)})),$e(e,gC)}))),Ee(vb(),e((function(t){po(t.element,"."+gC).each((function(t){Qe(t,gC)}))}))),ry(e((function(t,n,e,o){Se(t,zO,{name:r.name,value:o})})))],Rs(s,BO.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==r.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:c},behaviours:ex([tS.config({disabled:i.isDisabled,onDisabled:function(t){o(t,(function(t){$e(t,"tox-collection__item--state-disabled"),Ot(t,"aria-disabled",!0)}))},onEnabled:function(t){o(t,(function(t){Qe(t,"tox-collection__item--state-disabled"),Bt(t,"aria-disabled")}))}}),Bc(),tk.config({}),pw.config({store:{mode:"memory",initialValue:[]},onSetValue:function(t,n){var e=t,o=w(n,(function(t){var n=Mk.translate(t.text),e=1===r.columns?'<div class="tox-collection__item-label">'+n+"</div>":"",o='<div class="tox-collection__item-icon">'+t.icon+"</div>",u={_:" "," - ":" ","-":" "},a=n.replace(/\_| \- |\-/g,(function(t){return u[t]}));return'<div class="tox-collection__item'+(i.isDisabled()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+FO.encodeAllRaw(t.value)+'" title="'+a+'" aria-label="'+a+'">'+o+e+"</div>"})),u=w("auto"!==r.columns&&1<r.columns?x(o,r.columns):[o],(function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"}));Ve(e.element,u.join("")),"auto"===r.columns&&sc(t,5,"tox-collection__item").each((function(n){var e=n.numRows,o=n.numColumns;QS.setGridSize(t,e,o)})),we(t,jO)}}),AO.config({}),QS.config(1===(a=r.columns)?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===a?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:".tox-collection__group",cell:"."+cC}}),ra("collection-events",f)]),eventOrder:((u={})[Ab()]=["disabling","alloy.base.behaviour","collection-events"],u)}),["tox-form__group--collection"],[]);var r,i,u,a,s,l,f})),alertbanner:bd((function(t,n){return o=n.shared.providers,TO.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+(e=t).level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[Bk.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:Ia(e.icon,o.icons),attributes:{title:o.translate(e.iconTooltip)}},action:function(t){Se(t,zO,{name:"alert-banner",value:e.url})},buttonBehaviours:ex([Ra()])})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:o.translate(e.text)}}]});var e,o})),input:bd((function(t,n){return o=n.shared.providers,sd({name:(e=t).name,multiline:!1,label:e.label,inputMode:e.inputMode,placeholder:e.placeholder,flex:!1,disabled:e.disabled,classname:"tox-textfield",validation:Sh.none(),maximized:e.maximized},o);var e,o})),textarea:bd((function(t,n){return o=n.shared.providers,sd({name:(e=t).name,multiline:!0,label:e.label,inputMode:Sh.none(),placeholder:e.placeholder,flex:!0,disabled:e.disabled,classname:"tox-textarea",validation:Sh.none(),maximized:e.maximized},o);var e,o})),label:bd((function(t,n){return r={dom:{tag:"label",innerHtml:(o=n.shared).providers.translate((e=t).label),classes:["tox-label"]}},i=w(e.items,o.interpreter),{dom:{tag:"div",classes:["tox-form__group"]},components:[r].concat(i),behaviours:ex([td(),tk.config({}),nd(Sh.none()),QS.config({mode:"acyclic"})])};var e,o,r,i})),iframe:(p_=function(t,n){return e=t,o=n.shared.providers,u=kT&&e.sandboxed,a=yh(yh({},e.label.map((function(t){return{title:t}})).getOr({})),u?{sandbox:"allow-scripts allow-same-origin"}:{}),r=u,i=fe(""),c={getValue:function(){return i.get()},setValue:function(t,n){var e;r?Ot(t.element,"srcdoc",n):(Ot(t.element,"src","javascript:''"),(e=t.element.dom.contentWindow.document).open(),e.write(n),e.close()),i.set(n)}},Rs(e.label.map((function(t){return Vs(t,o)})),BO.parts.field({factory:{sketch:function(t){return rf({uid:t.uid,dom:{tag:"iframe",attributes:a},behaviours:ex([AO.config({}),ok.config({}),yT(Sh.none(),c.getValue,c.setValue)])})}}}),["tox-form__group--stretched"],[]);var e,o,r,i,u,a,c},function(t,n,e){var o=zv(n,{source:"dynamic"});return bd(p_)(t,o,e)}),button:bd((function(t,n){return e=t,o=n.shared.providers,r=jf(e.name,"custom"),Rs(Sh.none(),BO.parts.field(yh({factory:Bk},Wf(e,Sh.some(r),o,[xT(""),td()]))),[],[]);var e,o,r})),checkbox:bd((function(t,n){function e(t){return t.element.dom.click(),Sh.some(!0)}function o(t){return Pa("checked"===t?"selected":"unselected",{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t]},i.icons)}return r=t,i=n.shared.providers,u=pw.config({store:{mode:"manual",getValue:function(t){return t.element.dom.checked},setValue:function(t,n){t.element.dom.checked=n}}}),a=BO.parts.field({factory:{sketch:c},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:ex([td(),tS.config({disabled:function(){return r.disabled||i.isDisabled()}}),AO.config({}),ok.config({}),u,QS.config({mode:"special",onEnter:e,onSpace:e,stopSpaceKeyup:!0}),ra("checkbox-events",[Ee(wb(),(function(t){Se(t,VO,{name:r.name})}))])])}),s=BO.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:i.translate(r.label)},behaviours:ex([S_.config({})])}),l=Ba({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[o("checked"),o("unchecked")]}),BO.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[a,l.asSpec(),s],fieldBehaviours:ex([tS.config({disabled:function(){return r.disabled||i.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(t){BO.getField(t).each(tS.disable)},onEnabled:function(t){BO.getField(t).each(tS.enable)}}),Bc()])});var r,i,u,a,s,l})),colorinput:bd((function(t,n){function e(t,n){Se(t,C_,{value:n})}return o=t,r=n.shared,u=n.colorinput,s=BO.parts.field({factory:XO,inputClasses:["tox-textfield"],onSetValue:function(t){return u_.run(t).get(i)},inputBehaviours:ex([tS.config({disabled:r.providers.isDisabled}),Bc(),AO.config({}),u_.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return pt(t.element)},notify:{onValid:function(t){var n=pw.getValue(t);Se(t,k_,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=pw.getValue(t);if(0===n.length)return e_(Bv.value(!0));var e=Ph.fromTag("span");Ft(e,"background-color",n);var o=Pt(e,"background-color").fold((function(){return Bv.error("blah")}),(function(){return Bv.value(n)}));return e_(o)}}})]),selectOnFocus:!1}),l=o.label.map((function(t){return Vs(t,r.providers)})),f=Ba((a={dom:{tag:"span",attributes:{"aria-label":r.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[qy,Yy,Qy]},onLtr:function(){return[Yy,qy,Qy]}},components:[],fetch:hs(u.getColors(),u.hasCustomColors()),columns:u.getColorCols(),presets:"color",onItemAction:function(t,n){f.getOpt(t).each((function(t){"custom"===n?u.colorPicker((function(n){n.fold((function(){return we(t,O_)}),(function(n){e(t,n),fs(n)}))}),"#ffffff"):e(t,"remove"===n?"":n)}))}},w_.sketch({dom:a.dom,components:a.components,toggleClass:"mce-active",dropdownBehaviours:ex([YC((c=r).providers.isDisabled),Bc(),S_.config({}),AO.config({})]),layouts:a.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:c.getSink,fetch:function(t){return n_((function(t){return a.fetch(t)})).map((function(n){return Sh.from(Os(zv(xs(He("menu-value"),n,(function(n){a.onItemAction(t,n)}),a.columns,a.presets,uC.CLOSE_ON_EXECUTE,hh,c.providers),{movement:ws(a.columns,a.presets)})))}))},parts:{menu:nc(0,0,a.presets)}}))),BO.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:l.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[s,f.asSpec()]}]),fieldBehaviours:ex([ra("form-field-events",[Ee(k_,(function(t,n){f.getOpt(t).each((function(t){Ft(t.element,"background-color",n.event.color)})),Se(t,VO,{name:o.name})})),Ee(C_,(function(t,n){BO.getField(t).each((function(e){pw.setValue(e,n.event.value),qw.getCurrent(t).each(ok.focus)}))})),Ee(O_,(function(t){BO.getField(t).each((function(){qw.getCurrent(t).each(ok.focus)}))}))])])});var o,r,u,a,c,s,l,f})),colorpicker:bd((function(){var t=Ba(Zl(tf,(function(t){return"tox-"+t})).sketch({dom:{tag:"div",classes:["tox-color-picker-container"],attributes:{role:"presentation"}},onValidHex:function(t){Se(t,zO,{name:"hex-valid",value:!0})},onInvalidHex:function(t){Se(t,zO,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[t.asSpec()],behaviours:ex([pw.config({store:{mode:"manual",getValue:function(n){var e=t.get(n);return qw.getCurrent(e).bind((function(t){return pw.getValue(t).hex})).map((function(t){return"#"+t})).getOr("")},setValue:function(n,e){var o=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(e),r=t.get(n);qw.getCurrent(r).fold((function(){console.log("Can not find form")}),(function(t){pw.setValue(t,{hex:Sh.from(o[1]).getOr("")}),aT.getField(t,"hex").each((function(t){we(t,xb())}))}))}}}),td()])}})),dropzone:bd((function(t,n){return ef(t,n.shared.providers)})),grid:bd((function(t,n){return e=n.shared,{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+t.columns+"col"]},components:w(t.items,e.interpreter)};var e})),listbox:bd((function(t,n){return e=t,r=(o=n).shared.providers,u=P(e.items).filter(ad),c=e.label.map((function(t){return Vs(t,r)})),s={dom:{tag:"div",classes:["tox-listboxfield"]},components:[BO.parts.field({dom:{},factory:{sketch:function(t){return If({uid:t.uid,text:u.map((function(t){return t.text})),icon:Sh.none(),tooltip:e.label,role:Sh.none(),fetch:function(t,n){n(Vf(iE(t,e.name,e.items,pw.getValue(t)),uC.CLOSE_ON_EXECUTE,o,!1))},onSetup:a(i),getApi:a({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[AO.config({}),pw.config({store:{mode:"manual",initialValue:u.map((function(t){return t.value})).getOr(""),getValue:function(t){return Tt(t.element,rE)},setValue:function(t,n){uE(e.items,n).each((function(n){Ot(t.element,rE,n.value),Se(t,LT,{text:n.text})}))}}})]},"tox-listbox",o.shared)}}})]},BO.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:E([c.toArray(),[s]]),fieldBehaviours:ex([tS.config({disabled:a(e.disabled),onDisabled:function(t){BO.getField(t).each(tS.disable)},onEnabled:function(t){BO.getField(t).each(tS.enable)}})])});var e,o,r,u,c,s})),selectbox:bd((function(t,n){return e=t,o=n.shared.providers,r=w(e.items,(function(t){return{text:o.translate(t.text),value:t.value}})),i=e.label.map((function(t){return Vs(t,o)})),u={dom:{tag:"div",classes:["tox-selectfield"]},components:E([[BO.parts.field({dom:{},selectAttributes:{size:e.size},options:r,factory:aE,selectBehaviours:ex([tS.config({disabled:function(){return e.disabled||o.isDisabled()}}),AO.config({}),ra("selectbox-change",[Ee(wb(),(function(t){Se(t,VO,{name:e.name})}))])])})],(1<e.size?Sh.none():Sh.some(Pa("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},o.icons))).toArray()])},BO.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:E([i.toArray(),[u]]),fieldBehaviours:ex([tS.config({disabled:function(){return e.disabled||o.isDisabled()},onDisabled:function(t){BO.getField(t).each(tS.disable)},onEnabled:function(t){BO.getField(t).each(tS.enable)}}),Bc()])});var e,o,r,i,u})),sizeinput:bd((function(t,n){return Jf(t,n.shared.providers)})),urlinput:bd((function(t,n){return vd(t,n,n.urlinput)})),customeditor:bd((function(t){var n=lr(),e=Ba({dom:{tag:t.tag}}),o=lr();return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:ex([ra("custom-editor-events",[ny((function(r){e.getOpt(r).each((function(e){(Ah(t,"init")?t.init(e.element.dom):pT.load(t.scriptId,t.scriptUrl).then((function(n){return n(e.element.dom,t.settings)}))).then((function(t){o.on((function(n){t.setValue(n)})),o.clear(),n.set(t)}))}))}))]),pw.config({store:{mode:"manual",getValue:function(){return n.get().fold((function(){return o.get().getOr("")}),(function(t){return t.getValue()}))},setValue:function(t,e){n.get().fold((function(){o.set(e)}),(function(t){return t.setValue(e)}))}}}),td()]),components:[e.asSpec()]}})),htmlpanel:bd((function(t){return"presentation"===t.presets?TO.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):TO.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:ex([AO.config({}),ok.config({})])})})),imagetools:bd((function(t,n){return ud(t,n.shared.providers)})),table:bd((function(t,n){return cd(t,n.shared.providers)})),panel:bd((function(t,n){return{dom:{tag:"div",classes:t.classes},components:w(t.items,n.shared.interpreter)}}))},wE={field:function(t,n){return n}},SE=function(t,n,e){return G(xE,n.type).fold((function(){return console.error('Unknown factory type "'+n.type+'", defaulting to container: ',n),n}),(function(o){return o(t,n,e)}))},kE={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},CE=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],OE=function(t){return O(t,(function(t,n){if(Ah(n,"items")){var e=OE(n.items);return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(Ah(n,"inline")||Ah(n,"block")||Ah(n,"selector")){var o="custom-"+(ah(n.name)?n.name:n.title.toLowerCase());return{customFormats:t.customFormats.concat([{name:o,format:n}]),formats:t.formats.concat([{title:n.title,format:o,icon:n.icon}])}}return yh(yh({},t),{formats:t.formats.concat(n)})}),{customFormats:[],formats:[]})},_E=hT.trim,TE=Cd("true"),EE=Cd("false"),DE=function(t){var n=w(Hr(Ph.fromDom(t),"h1,h2,h3,h4,h5,h6,a:not([href])"),(function(t){return t.dom}));return k(w(k(n,Dd),Bd).concat(w(k(n,Td),Md)),Ad)},BE="tinymce-url-history",ME=Uw,AE=Lw,FE=a([ee("shell",!1),Ln("makeItem"),ee("setupItem",i),hw("listBehaviours",[tk])]),IE=a([Hw({name:"items",overrides:function(){return{behaviours:ex([tk.config({})])}}})]),RE=Gi({name:a("CustomList")(),configFields:FE(),partFields:IE(),factory:function(t,n){var e=t.shell?{behaviours:[tk.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:e.components,behaviours:Si(t.listBehaviours,e.behaviours),apis:{setItems:function(n,e){var o;o=n,(t.shell?Sh.some(o):Ii(o,t,"items")).fold((function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(o){var r=tk.contents(o),i=e.length,u=i-r.length,a=0<u?y(u,(function(){return t.makeItem()})):[],c=r.slice(i);Th(c,(function(t){return tk.remove(o,t)})),Th(a,(function(t){return tk.append(o,t)}));var s=tk.contents(o);Th(s,(function(o,r){t.setupItem(n,o,e[r],r)}))}))}}}},apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),VE=a([Ln("dom"),ee("shell",!0),xi("toolbarBehaviours",[tk])]),PE=a([Hw({name:"groups",overrides:function(){return{behaviours:ex([tk.config({})])}}})]),HE=Gi({name:"Toolbar",configFields:VE(),partFields:PE(),factory:function(t,n){var e=t.shell?{behaviours:[tk.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:e.components,behaviours:Si(t.toolbarBehaviours,e.behaviours),apis:{setGroups:function(n,e){var o;o=n,(t.shell?Sh.some(o):Ii(o,t,"groups")).fold((function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(t){tk.set(t,e)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),zE=a([]),NE=Object.freeze({__proto__:null,setup:i,isDocked:hh,getBehaviours:zE}),LE=de([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),WE=function(t,n,e){var o,r,i,u;t.getSystem().isConnected()&&(i=e,u=(r=n).lazyViewport(o=t),i.isDocked()&&tm(o,r,i,u),$d(o,u,i).each((function(t){t.fold((function(){return Qd(o,r,i)}),(function(t){return Zd(o,r,i,t)}),(function(t){tm(o,r,i,u,!0),Zd(o,r,i,t)}))})))},UE=Object.freeze({__proto__:null,refresh:WE,reset:nm,isDocked:function(t,n,e){return e.isDocked()},getModes:function(t,n,e){return e.getModes()},setModes:function(t,n,e,o){return e.setModes(o)}}),jE=Object.freeze({__proto__:null,events:function(t,n){return ty([Ie(Cb(),(function(e,o){t.contextual.each((function(t){Ze(e.element,t.transitionClass)&&(no(e.element,[t.transitionClass,t.fadeInClass]),(n.isVisible()?t.onShown:t.onHidden)(e)),o.stop()}))})),Ee(Lb(),(function(e){WE(e,t,n)})),Ee(Wb(),(function(e){nm(e,t,n)}))])}}),GE=Xo({fields:[ne("contextual",[Un("fadeInClass"),Un("fadeOutClass"),Un("transitionClass"),Gn("lazyContext"),So("onShow"),So("onShown"),So("onHide"),So("onHidden")]),ce("lazyViewport",Tv),se("modes",["top","bottom"],Yv),So("onDocked"),So("onUndocked")],name:"docking",active:jE,apis:UE,state:Object.freeze({__proto__:null,init:function(t){var n=fe(!1),e=fe(!0),o=lr(),r=fe(t.modes);return yy({isDocked:n.get,setDocked:n.set,getInitialPos:o.get,setInitialPos:o.set,clearInitialPos:o.clear,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+n.get()+", visible: "+e.get()+", modes: "+r.get().join(",")}})}})}),XE=a(He("toolbar-height-change")),YE={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},qE="tox-tinymce--toolbar-sticky-on",KE="tox-tinymce--toolbar-sticky-off",JE=Object.freeze({__proto__:null,setup:function(t,n,e){t.inline||(n.header.isPositionedAtTop()||t.on("ResizeEditor",(function(){e().each(GE.reset)})),t.on("ResizeWindow ResizeEditor",(function(){e().each(om)})),t.on("SkinLoaded",(function(){e().each((function(t){GE.isDocked(t)?GE.reset(t):GE.refresh(t)}))})),t.on("FullscreenStateChanged",(function(){e().each(GE.reset)}))),t.on("AfterScrollIntoView",(function(t){e().each((function(n){GE.refresh(n);var e,o,r,i,u,a,c,s,l,f,d,m,g,p,h,v,b=n.element;Eu(b)&&(e=t,i=(r=ft(o=b)).dom.defaultView.innerHeight,u=en(r),c=cn(a=Ph.fromDom(e.elm)),s=Wt(a),f=(l=c.y)+s,d=Gt(o),m=Wt(o),p=(g=d.top)+m,h=Math.abs(g-u.top)<2,v=Math.abs(p-(u.top+i))<2,h&&l<p?on(u.left,l-m,r):v&&g<f&&on(u.left,l-i+s+m,r))}))})),t.on("PostRender",(function(){im(t,!1)}))},isDocked:function(t){return t().map(GE.isDocked).getOr(!1)},getBehaviours:um}),$E=Uv([Un("type"),Wn("items",Mn([jv([Un("name"),qn("items",Yv)]),Yv]))].concat(jk)),QE=[Qn("text"),Qn("tooltip"),Qn("icon"),Gn("fetch"),ce("onSetup",(function(){return i}))],ZE=Uv(g([Un("type")],QE,!0)),tD=Uv([Un("type"),Qn("tooltip"),Qn("icon"),Qn("text"),Zn("select"),Gn("fetch"),ce("onSetup",(function(){return i})),ue("presets","normal",["normal","color","listpreview"]),ee("columns",1),Gn("onAction"),Gn("onItemAction")]),nD=ji({factory:function(t,n){var e={focus:QS.focusIn,setMenus:function(t,e){var o=w(e,(function(t){return Hf(am({type:"menubutton",text:t.text,fetch:function(n){n(t.getItems())}}).mapError((function(t){return Qv(t)})).getOrDie(),"tox-mbtn",n.backstage,Sh.some("menuitem"))}));tk.set(t,o)}};return{uid:t.uid,dom:t.dom,components:[],behaviours:ex([tk.config({}),ra("menubar-events",[ny((function(n){t.onSetup(n)})),Ee(pb(),(function(t,n){po(t.element,".tox-mbtn--active").each((function(e){ho(n.event.target,".tox-mbtn").each((function(n){st(e,n)||t.getSystem().getByDom(e).each((function(e){t.getSystem().getByDom(n).each((function(t){w_.expand(t),w_.close(e),ok.focus(t)}))}))}))}))})),Ee(Yb(),(function(t,n){n.event.prevFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(e){n.event.newFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(t){w_.isOpen(e)&&(w_.expand(t),w_.close(e))}))}))}))]),QS.config({mode:"flow",selector:".tox-mbtn",onEscape:function(n){return t.onEscape(n),Sh.some(!0)}}),AO.config({})]),apis:e,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[Ln("dom"),Ln("uid"),Ln("onEscape"),Ln("backstage"),ee("onSetup",i)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),eD=Object.freeze({__proto__:null,refresh:function(t,n,e){var o;e.isExpanded()&&(zt(t.element,sm(n)),o=lm(n,t.element),Ft(t.element,sm(n),o))},grow:function(t,n,e){e.isExpanded()||hm(t,n,e)},shrink:function(t,n,e){e.isExpanded()&&pm(t,n,e)},immediateShrink:function(t,n,e){e.isExpanded()&&gm(t,n,e)},hasGrown:function(t,n,e){return e.isExpanded()},hasShrunk:function(t,n,e){return e.isCollapsed()},isGrowing:vm,isShrinking:bm,isTransitioning:function(t,n){return vm(t,n)||bm(t,n)},toggleGrow:function(t,n,e){(e.isExpanded()?pm:hm)(t,n,e)},disableTransitions:fm}),oD=Object.freeze({__proto__:null,exhibit:function(t,n){return Ge(n.expanded?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:me(n.dimension.property,"0px")})},events:function(t,n){return ty([Ie(Cb(),(function(e,o){o.event.raw.propertyName===t.dimension.property&&(fm(e,t),n.isExpanded()&&zt(e.element,t.dimension.property),(n.isExpanded()?t.onGrown:t.onShrunk)(e))}))])}}),rD=Xo({fields:[Ln("closedClass"),Ln("openClass"),Ln("shrinkingClass"),Ln("growingClass"),Kn("getAnimationRoot"),So("onShrunk"),So("onStartShrink"),So("onGrown"),So("onStartGrow"),ee("expanded",!1),Wn("dimension",zn("property",{width:[_o("property","width"),_o("getDimension",(function(t){return Xt(t)+"px"}))],height:[_o("property","height"),_o("getDimension",(function(t){return Wt(t)+"px"}))]}))],name:"sliding",active:oD,apis:eD,state:Object.freeze({__proto__:null,init:function(t){var n=fe(t.expanded);return yy({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:l(n.set,!1),setExpanded:l(n.set,!0),readState:function(){return"expanded: "+n.get()}})}})}),iD="container",uD=[xi("slotBehaviours",[])],aD=L({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},Ue),cD=yh(yh({},aD),{sketch:function(t){var n,e={slot:function(t,e){return n.push(t),Di(iD,ym(t),e)},record:a(n=[])},o=t(e),r=w(e.record(),(function(t){return Vw({name:t,pname:ym(t)})}));return Ui(iD,uD,r,tg,o)}}),sD=Uv([Qn("icon"),Qn("tooltip"),ce("onShow",i),ce("onHide",i),ce("onSetup",(function(){return i}))]),lD=He("FixSizeEvent"),fD=He("AutoSizeEvent"),dD=Object.freeze({__proto__:null,block:function(t,n,e,o){Ot(t.element,"aria-busy",!0);var r=n.getRoot(t).getOr(t),i=ex([QS.config({mode:"special",onTab:function(){return Sh.some(!0)},onShiftTab:function(){return Sh.some(!0)}}),ok.config({})]),u=o(r,i),a=r.getSystem().build(u);tk.append(r,_y(a)),a.hasConfigured(QS)&&n.focus&&QS.focusIn(a),e.isBlocked()||n.onBlock(t),e.blockWith((function(){return tk.remove(r,a)}))},unblock:function(t,n,e){Bt(t.element,"aria-busy"),e.isBlocked()&&n.onUnblock(t),e.clear()}}),mD=Xo({fields:[ce("getRoot",Sh.none),ae("focus",!0),So("onBlock"),So("onUnblock")],name:"blocking",apis:dD,state:Object.freeze({__proto__:null,init:function(){var t=cr();return yy({readState:t.isSet,blockWith:function(n){t.set({destroy:n})},clear:t.clear,isBlocked:t.isSet})}})}),gD=a([xi("splitToolbarBehaviours",[c_]),tb("builtGroups",(function(){return fe([])}))]),pD=a([xo(["overflowToggledClass"]),Zn("getOverflowBounds"),Ln("lazySink"),tb("overflowGroups",(function(){return fe([])}))].concat(gD())),hD=a([Vw({factory:HE,schema:VE(),name:"primary"}),Pw({schema:VE(),name:"overflow"}),Pw({name:"overflow-button"}),Pw({name:"overflow-group"})]),vD=a((function(t,n){var e=t,o=Math.floor(n);Ft(e,"max-width",yv.max(e,o,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"])+"px")})),bD=a([xo(["toggledClass"]),Ln("lazySink"),Gn("fetch"),Zn("getBounds"),ne("fireDismissalEventInstead",[ee("event",Gb())]),Sr()]),yD=a([Pw({
name:"button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:ex([uk.config({toggleClass:t.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),Pw({factory:HE,schema:VE(),name:"toolbar",overrides:function(t){return{toolbarBehaviours:ex([QS.config({mode:"cyclic",onEscape:function(n){return Ii(n,t,"button").each(ok.focus),Sh.none()}})])}}})]),xD=Gi({name:"FloatingToolbarButton",factory:function(t,n,e,o){return yh(yh({},Bk.sketch(yh(yh({},o.button()),{action:function(t){Mm(t,o)},buttonBehaviours:vw({dump:o.button().buttonBehaviours},[c_.config({others:{toolbarSandbox:function(n){return o=n,r=e,i=t,{dom:{tag:"div",attributes:{id:(u=vo()).id}},behaviours:ex([QS.config({mode:"special",onEscape:function(t){return rw.close(t),Sh.some(!0)}}),rw.config({onOpen:function(t,n){i.fetch().get((function(t){Fm(o,n,i,r.layouts,t),u.link(o.element),QS.focusIn(n)}))},onClose:function(){uk.off(o),ok.focus(o),u.unlink(o.element)},isPartOf:function(t,n,e){return Ty(n,e)||Ty(o,e)},getAttachPoint:function(){return i.lazySink(o).getOrDie()}}),ux.config({channels:yh(yh({},mi(yh({isExtraPart:hh},i.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),gi({doReposition:function(){rw.getState(c_.getCoupled(o,"toolbarSandbox")).each((function(t){Am(o,t,i,r.layouts)}))}}))})])};var o,r,i,u}}})])}))),{apis:{setGroups:function(n,o){rw.getState(c_.getCoupled(n,"toolbarSandbox")).each((function(r){Fm(n,r,t,e.layouts,o)}))},reposition:function(n){rw.getState(c_.getCoupled(n,"toolbarSandbox")).each((function(o){Am(n,o,t,e.layouts)}))},toggle:function(t){Mm(t,o)},getToolbar:function(t){return rw.getState(c_.getCoupled(t,"toolbarSandbox"))},isOpen:function(t){return rw.isOpen(c_.getCoupled(t,"toolbarSandbox"))}}})},configFields:bD(),partFields:yD(),apis:{setGroups:function(t,n,e){t.setGroups(n,e)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},getToolbar:function(t,n){return t.getToolbar(n)},isOpen:function(t,n){return t.isOpen(n)}}}),wD=a([Ln("items"),xo(["itemSelector"]),xi("tgroupBehaviours",[QS])]),SD=a([zw({name:"items",unit:"item"})]),kD=Gi({name:"ToolbarGroup",configFields:wD(),partFields:SD(),factory:function(t,n){return{uid:t.uid,dom:t.dom,components:n,behaviours:Si(t.tgroupBehaviours,[QS.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),CD=Gi({name:"SplitFloatingToolbar",configFields:pD(),partFields:hD(),factory:function(t,n,e,o){var r=Ba(xD.sketch({fetch:function(){return n_((function(n){n(Im(t.overflowGroups.get()))}))},layouts:{onLtr:function(){return[qy,Yy]},onRtl:function(){return[Yy,qy]},onBottomLtr:function(){return[Jy,Ky]},onBottomRtl:function(){return[Ky,Jy]}},getBounds:e.getOverflowBounds,lazySink:t.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:t.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:t.uid,dom:t.dom,components:n,behaviours:Si(t.splitToolbarBehaviours,[c_.config({others:{overflowGroup:function(){return kD.sketch(yh(yh({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(n,e){t.builtGroups.set(w(e,n.getSystem().build)),Rm(n,r,t)},refresh:function(n){return Rm(n,r,t)},toggle:function(t){r.getOpt(t).each((function(t){xD.toggle(t)}))},isOpen:function(t){return r.getOpt(t).map(xD.isOpen).getOr(!1)},reposition:function(t){r.getOpt(t).each((function(t){xD.reposition(t)}))},getOverflow:function(t){return r.getOpt(t).bind(xD.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)},getOverflow:function(t,n){return t.getOverflow(n)}}}),OD=a([xo(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),So("onOpened"),So("onClosed")].concat(gD())),_D=a([Vw({factory:HE,schema:VE(),name:"primary"}),Vw({factory:HE,schema:VE(),name:"overflow",overrides:function(t){return{toolbarBehaviours:ex([rD.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:function(n){Ii(n,t,"overflow-button").each((function(t){uk.off(t),ok.focus(t)})),t.onClosed(n)},onGrown:function(n){QS.focusIn(n),t.onOpened(n)},onStartGrow:function(n){Ii(n,t,"overflow-button").each(uk.on)}}),QS.config({mode:"acyclic",onEscape:function(n){return Ii(n,t,"overflow-button").each(ok.focus),Sh.some(!0)}})])}}}),Pw({name:"overflow-button",overrides:function(t){return{buttonBehaviours:ex([uk.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),Pw({name:"overflow-group"})]),TD=Gi({name:"SplitSlidingToolbar",configFields:OD(),partFields:_D(),factory:function(t,n,e,o){var r="alloy.toolbar.toggle";return{uid:t.uid,dom:t.dom,components:n,behaviours:Si(t.splitToolbarBehaviours,[c_.config({others:{overflowGroup:function(t){return kD.sketch(yh(yh({},o["overflow-group"]()),{items:[Bk.sketch(yh(yh({},o["overflow-button"]()),{action:function(){we(t,r)}}))]}))}}}),ra("toolbar-toggle-events",[Ee(r,(function(n){Vm(n,t)}))])]),apis:{setGroups:function(n,e){var o=w(e,n.getSystem().build);t.builtGroups.set(o),ng(n,t)},refresh:function(n){return ng(n,t)},toggle:function(n){return Vm(n,t)},isOpen:function(n){return Ii(n,t,"overflow").map(rD.hasGrown).getOr(!1)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)}}}),ED=AE.optional({factory:nD,name:"menubar",schema:[Ln("backstage")]}),DD=AE.optional({factory:{sketch:function(t){return RE.sketch({uid:t.uid,dom:t.dom,listBehaviours:ex([QS.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return Lm({type:t.type,uid:He("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:function(){return t.onEscape(),Sh.some(!0)}})},setupItem:function(t,n,e){HE.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[Ln("dom"),Ln("onEscape")]}),BD=AE.optional({factory:{sketch:function(t){return(t.type===eC.sliding?function(t){var n=TD.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=TD.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=Nm(t);return TD.sketch(yh(yh({},o),{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([XE()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([XE()],{type:"closed"})}}))}:t.type===eC.floating?function(t){var n=Nm(t),e=CD.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return CD.sketch(yh(yh({},n),{lazySink:t.getSink,getOverflowBounds:function(){var n=t.moreDrawerData.lazyHeader().element,e=cn(n),o=mt(n),r=cn(o),i=Math.max(o.dom.scrollHeight,r.height);return Ov(e.x+4,r.y,e.width-8,i)},parts:yh(yh({},n.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:t.attributes}}}),components:[e],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))}:Lm)({type:t.type,uid:t.uid,onEscape:function(){return t.onEscape(),Sh.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes})}},name:"toolbar",schema:[Ln("dom"),Ln("onEscape"),Ln("getSink")]}),MD=AE.optional({factory:{sketch:function(t){var n=t.editor,e=t.sticky?um:zE;return{uid:t.uid,dom:t.dom,components:t.components,behaviours:ex(e(n,t.sharedBackstage))}}},name:"header",schema:[Ln("dom")]}),AD=AE.optional({name:"socket",schema:[Ln("dom")]}),FD=AE.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:ex([AO.config({}),ok.config({}),rD.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){qw.getCurrent(t).each(cD.hideAllSlots),we(t,fD)},onGrown:function(t){we(t,fD)},onStartGrow:function(t){Se(t,lD,{width:Pt(t.element,"width").getOr("")})},onStartShrink:function(t){Se(t,lD,{width:Xt(t.element)+"px"})}}),tk.config({}),qw.config({find:function(t){return P(tk.contents(t))}})])}],behaviours:ex([mT(0),ra("sidebar-sliding-events",[Ee(lD,(function(t,n){Ft(t.element,"width",n.event.width)})),Ee(fD,(function(t){zt(t.element,"width")}))])])}}},name:"sidebar",schema:[Ln("dom")]}),ID=AE.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:ex([tk.config({}),mD.config({focus:!1}),qw.config({find:function(t){return P(t.components())}})]),components:[]}}},name:"throbber",schema:[Ln("dom")]}),RD=Gi({name:"OuterContainer",factory:function(t,n){return{uid:t.uid,dom:t.dom,components:n,apis:{getSocket:function(n){return ME.getPart(n,t,"socket")},setSidebar:function(n,e){ME.getPart(n,t,"sidebar").each((function(t){return wm(t,e)}))},toggleSidebar:function(n,e){ME.getPart(n,t,"sidebar").each((function(t){var n=e;qw.getCurrent(t).each((function(t){qw.getCurrent(t).each((function(e){rD.hasGrown(t)?cD.isShowing(e,n)?rD.shrink(t):(cD.hideAllSlots(e),cD.showSlot(e,n)):(cD.hideAllSlots(e),cD.showSlot(e,n),rD.grow(t))}))}))}))},whichSidebar:function(n){return ME.getPart(n,t,"sidebar").bind(Sm).getOrNull()},getHeader:function(n){return ME.getPart(n,t,"header")},getToolbar:function(n){return ME.getPart(n,t,"toolbar")},setToolbar:function(n,e){ME.getPart(n,t,"toolbar").each((function(t){t.getApis().setGroups(t,e)}))},setToolbars:function(n,e){ME.getPart(n,t,"multiple-toolbar").each((function(t){RE.setItems(t,e)}))},refreshToolbar:function(n){ME.getPart(n,t,"toolbar").each((function(t){return t.getApis().refresh(t)}))},toggleToolbarDrawer:function(n){ME.getPart(n,t,"toolbar").each((function(t){var n=t.getApis().toggle;null!=n?Sh.some(function(n){return n(t)}(n)):Sh.none()}))},isToolbarDrawerToggled:function(n){return ME.getPart(n,t,"toolbar").bind((function(t){return Sh.from(t.getApis().isOpen).map((function(n){return n(t)}))})).getOr(!1)},getThrobber:function(n){return ME.getPart(n,t,"throbber")},focusToolbar:function(n){ME.getPart(n,t,"toolbar").orThunk((function(){return ME.getPart(n,t,"multiple-toolbar")})).each((function(t){QS.focusIn(t)}))},setMenubar:function(n,e){ME.getPart(n,t,"menubar").each((function(t){nD.setMenus(t,e)}))},focusMenubar:function(n){ME.getPart(n,t,"menubar").each((function(t){nD.focus(t)}))}},behaviours:t.behaviours}},configFields:[Ln("dom"),Ln("behaviours")],partFields:[MD,ED,BD,DD,AD,FD,ID],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getHeader:function(t,n){return t.getHeader(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){var o=w(e,Hm);t.setToolbar(n,o)},setToolbars:function(t,n,e){var o=w(e,(function(t){return w(t,Hm)}));t.setToolbars(n,o)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},toggleToolbarDrawer:function(t,n){t.toggleToolbarDrawer(n)},isToolbarDrawerToggled:function(t,n){return t.isToolbarDrawerToggled(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),VD={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},PD=l(Xm,!1),HD=l(Xm,!0);(v_=h_=h_||{})[v_.SemiColon=0]="SemiColon",v_[v_.Space=1]="Space";var zD,ND,LD,WD,UD,jD=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],GD=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],XD={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},YD={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},qD=Object.freeze({__proto__:null,events:function(t,n){function e(e,o){t.updateState.each((function(t){var r=t(e,o);n.set(r)})),t.renderComponents.each((function(t){var r=w(t(o,n.get()),e.getSystem().build);ei(e,r)}))}return ty([Ee(Mb(),(function(n,o){var r,i=o;i.universal||(r=t.channel,_h(i.channels,r)&&e(n,i.data))})),ny((function(n){t.initialData.each((function(t){e(n,t)}))}))])}}),KD=Object.freeze({__proto__:null,getState:function(t,n,e){return e}}),JD=Xo({fields:[Ln("channel"),Kn("renderComponents"),Kn("updateState"),Kn("initialData")],name:"reflecting",active:qD,apis:KD,state:Object.freeze({__proto__:null,init:function(){var t=fe(Sh.none());return{readState:function(){return t.get().getOr("none")},get:t.get,set:t.set,clear:function(){return t.set(Sh.none())}}}})}),$D=a([Ln("toggleClass"),Ln("fetch"),Co("onExecute"),ee("getHotspot",Sh.some),ee("getAnchorOverrides",a({})),Sr(),Co("onItemExecute"),Kn("lazySink"),Ln("dom"),So("onOpen"),xi("splitDropdownBehaviours",[c_,QS,ok]),ee("matchWidth",!1),ee("useMinWidth",!1),ee("eventOrder",{}),Kn("role")].concat(Qs())),QD=a([Vw({factory:Bk,schema:[Ln("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:ex([ok.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each(ke)},buttonBehaviours:ex([uk.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])}}}),Vw({factory:Bk,schema:[Ln("dom")],name:"button",defaults:function(){return{buttonBehaviours:ex([ok.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each((function(e){t.onExecute(e,n)}))}}}}),Hw({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Ln("text")],name:"aria-descriptor"}),Pw({schema:[yo()],name:"menu",defaults:function(t){return{onExecute:function(n,e){n.getSystem().getByUid(t.uid).each((function(o){t.onItemExecute(o,n,e)}))}}}}),l_()]),ZD=Gi({name:"SplitDropdown",configFields:$D(),partFields:QD(),factory:function(t,n,e,o){function r(t){qw.getCurrent(t).each((function(t){eS.highlightFirst(t),QS.focusIn(t)}))}function u(n){qs(t,c,n,o,r,KO.HighlightFirst).get(i)}function a(n){return ke(Ri(n,t,"button")),Sh.some(!0)}var s,l=yh(yh({},ty([ny((function(n){Ii(n,t,"aria-descriptor").each((function(t){var e=He("aria");Ot(t.element,"id",e),Ot(n.element,"aria-describedby",e)}))}))])),ma(Sh.some(u))),f={repositionMenus:function(t){uk.isOn(t)&&$s(t)}};return{uid:t.uid,dom:t.dom,components:n,apis:f,eventOrder:yh(yh({},t.eventOrder),((s={})[Ab()]=["disabling","toggling","alloy.base.behaviour"],s)),events:l,behaviours:Si(t.splitDropdownBehaviours,[c_.config({others:{sandbox:function(n){var e=Ri(n,t,"arrow");return Js(t,n,{onOpen:function(){uk.on(e),uk.on(n)},onClose:function(){uk.off(e),uk.off(n)}})}}}),QS.config({mode:"special",onSpace:a,onEnter:a,onDown:function(t){return u(t),Sh.some(!0)}}),ok.config({}),uk.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:t.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(t,n){return t.repositionMenus(n)}}}),tB=He("focus-button"),nB=function(t,n,e){return gg(t,{toolbarButtonBehaviours:[].concat(0<e.length?[ra("toolbarButtonWith",e)]:[]),getApi:lg,onSetup:t.onSetup},n)},eB=function(t,n,e){return zv(gg(t,{toolbarButtonBehaviours:[tk.config({}),uk.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<e.length?[ra("toolbarToggleButtonWith",e)]:[]),getApi:fg,onSetup:t.onSetup},n))},oB=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],rB={button:pg(Ka,(function(t,n){return e=n.backstage.shared.providers,nB(t,e,[]);var e})),togglebutton:pg(Ja,(function(t,n){return e=n.backstage.shared.providers,eB(t,e,[]);var e})),menubutton:pg(am,(function(t,n){return Hf(t,"tox-tbtn",n.backstage,Sh.none())})),splitbutton:pg((function(t){return Vn("SplitButton",tD,t)}),(function(t,n){function e(t){return{isDisabled:function(){return tS.isDisabled(t)},setDisabled:function(n){return tS.set(t,n)},setIconFill:function(n,e){po(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){Ot(t,"fill",e)}))},setIconStroke:function(n,e){po(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){Ot(t,"stroke",e)}))},setActive:function(n){Ot(t.element,"aria-pressed",n),po(t.element,"span").each((function(e){t.getSystem().getByDom(e).each((function(t){return uk.set(t,n)}))}))},isActive:function(){return po(t.element,"span").exists((function(n){return t.getSystem().getByDom(n).exists(uk.isOn)}))}}}return o=t,r=n.backstage.shared,l=He("channel-update-split-dropdown-display"),f=fe(i),d={getApi:e,onSetup:o.onSetup},ZD.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:yh({"aria-pressed":!1},dg(o.tooltip,r.providers))},onExecute:function(t){o.onAction(e(t))},onItemExecute:function(){},splitDropdownBehaviours:ex([cs(r.providers.isDisabled),Bc(),ra("split-dropdown-events",[Ee(tB,ok.focus),Ac(d,f),Fc(d,f)]),S_.config({})]),eventOrder:((u={})[Ub()]=["alloy.base.behaviour","split-dropdown-events"],u),toggleClass:"tox-tbtn--enabled",lazySink:r.getSink,fetch:(a=e,c=o,s=r.providers,function(t){return n_((function(t){return c.fetch(t)})).map((function(n){return Sh.from(Os(zv(xs(He("menu-value"),n,(function(n){c.onItemAction(a(t),n)}),c.columns,c.presets,uC.CLOSE_ON_EXECUTE,c.select.getOr(hh),s),{movement:ws(c.columns,c.presets),menuBehaviours:AC("auto"!==c.columns?[]:[ny((function(t){sc(t,4,Qa(c.presets)).each((function(n){var e=n.numRows,o=n.numColumns;QS.setGridSize(t,e,o)}))}))])})))}))}),parts:{menu:nc(0,o.columns,o.presets)},components:[ZD.parts.button(mg(o.icon,o.text,Sh.none(),Sh.some(l),Sh.some([uk.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),r.providers)),ZD.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:Ia("chevron-down",r.providers.icons)},buttonBehaviours:ex([cs(r.providers.isDisabled),Bc(),Ra()])}),ZD.parts["aria-descriptor"]({text:r.providers.translate("To open the popup, press Shift+Enter")})]});var o,r,u,a,c,s,l,f,d})),grouptoolbarbutton:pg((function(t){return Vn("GroupToolbarButton",$E,t)}),(function(t,n,e){var o,r,i,u,a,c,s=e.ui.registry.getAll().buttons,l=((o={})[Ox]=n.backstage.shared.header.isPositionedAtTop()?lx.TopToBottom:lx.BottomToTop,o);if(xc(e)!==eC.floating)throw new Error("Toolbar groups are only supported when using floating toolbar mode");return i=n.backstage,u=function(t){return uB(e,{buttons:s,toolbar:t,allowToolbarGroups:!1},n,Sh.none())},a=l,c=i.shared,xD.sketch({lazySink:c.getSink,fetch:function(){return n_((function(t){t(w(u(r.items),Hm))}))},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:mg((r=t).icon,r.text,r.tooltip,Sh.none(),Sh.none(),c.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:a}}}})})),styleSelectButton:function(t,n){return Qm(t,e=n.backstage,sg(t,yh({type:"advanced"},e.styleselect)));var e},fontsizeSelectButton:function(t,n){return Qm(t,n.backstage,ug(t))},fontSelectButton:function(t,n){return Qm(t,n.backstage,ig(t))},formatButton:function(t,n){return Qm(t,n.backstage,cg(t))},alignMenuButton:function(t,n){return Qm(t,n.backstage,og(t))}},iB={styleselect:rB.styleSelectButton,fontsizeselect:rB.fontsizeSelectButton,fontselect:rB.fontSelectButton,formatselect:rB.formatButton,align:rB.alignMenuButton},uB=function(t,n,e,o){var i,u,a,c,s=(a=n.toolbar,c=n.buttons,!1===a?[]:void 0===a||!0===a?(i=c,u=w(oB,(function(t){var n=k(t.items,(function(t){return Ah(i,t)||Ah(iB,t)}));return{name:t.name,items:n}})),k(u,(function(t){return 0<t.items.length}))):ah(a)?w(a.split("|"),(function(t){return{items:t.trim().split(" ")}})):r(a,(function(t){return Ah(t,"name")&&Ah(t,"items")}))?a:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[]));return k(w(s,(function(r){var i=D(r.items,(function(r){return 0===r.trim().length?[]:(i=t,u=n.buttons,a=r,c=n.allowToolbarGroups,s=e,l=o,G(u,a.toLowerCase()).orThunk((function(){return l.bind((function(t){return z(t,(function(t){return G(u,t+a.toLowerCase())}))}))})).fold((function(){return G(iB,a.toLowerCase()).map((function(t){return t(i,s)})).orThunk((function(){return Sh.none()}))}),(function(t){return"grouptoolbarbutton"!==t.type||c?(e=s,o=i,G(rB,(n=t).type).fold((function(){return console.error("skipping button defined by",n),Sh.none()}),(function(t){return Sh.some(t(n,e,o))}))):(console.warn("Ignoring the '"+a+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),Sh.none());var n,e,o})).toArray());var i,u,a,c,s,l}));return{title:Sh.from(t.translate(r.name)),items:i}})),(function(t){return 0<t.items.length}))},aB=rv(),cB=aB.os.isiOS()&&aB.os.version.major<=12,sB=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=fe(0),u=n.outerContainer;PD(t);var a=Ph.fromDom(r.targetNode),c=St(cv(a)),s=n.mothership;nw(a,s,$t),ai(c,n.uiMothership),t.on("PostRender",(function(){hg(t,n,e,o),i.set(t.getWin().innerWidth),RD.setMenubar(u,Um(t,e)),RD.setSidebar(u,e.sidebar),function(t,n){function e(){var n=c.get();n.left===u.innerWidth&&n.top===u.innerHeight||(c.set(vv(u.innerWidth,u.innerHeight)),os(t))}function o(){var n=t.getDoc().documentElement,e=s.get();e.left===n.offsetWidth&&e.top===n.offsetHeight||(s.set(vv(n.offsetWidth,n.offsetHeight)),os(t))}function r(n){return t.fire("ScrollContent",n)}var i=t.dom,u=t.getWin(),a=t.getDoc().documentElement,c=fe(vv(u.innerWidth,u.innerHeight)),s=fe(vv(a.offsetWidth,a.offsetHeight));i.bind(u,"resize",e),i.bind(u,"scroll",r);var l=dr(Ph.fromDom(t.getBody()),"load",o),f=n.uiMothership.element;t.on("hide",(function(){Ft(f,"display","none")})),t.on("show",(function(){zt(f,"display")})),t.on("NodeChange",o),t.on("remove",(function(){l.unbind(),i.unbind(u,"resize",e),i.unbind(u,"scroll",r),u=null}))}(t,n)}));var l,f,d,m,g=RD.getSocket(u).getOrDie("Could not find expected socket element");cB&&(It(g.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"}),f=function(){t.fire("ScrollContent")},d=null,m=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];lh(d)&&(d=setTimeout((function(){d=null,f.apply(null,t)}),20))},l=fr(g.element,"scroll",m),t.on("remove",l.unbind)),Dc(t,n),t.addCommand("ToggleSidebar",(function(n,e){RD.toggleSidebar(u,e),t.fire("ToggleSidebar")})),t.addQueryValueHandler("ToggleSidebar",(function(){return RD.whichSidebar(u)}));var p=xc(t);p!==eC.sliding&&p!==eC.floating||t.on("ResizeWindow ResizeEditor ResizeContent",(function(){var e=t.getWin().innerWidth;e!==i.get()&&(RD.refreshToolbar(n.outerContainer),i.set(e))}));var h={enable:function(){Ec(n,!1)},disable:function(){Ec(n,!0)},isDisabled:function(){return tS.isDisabled(u)}};return{iframeContainer:g.element.dom,editorContainer:u.element.dom,api:h}}}),lB=Object.freeze({__proto__:null,render:function(t,n,e,o,r){function i(){var r;l.get()?d.show():(l.set(RD.getHeader(s).getOrDie()),ai(r=Oc(t),a),ai(r,c),hg(t,n,e,o),RD.setMenubar(s,Um(t,e)),d.show(),function(t,n,e,o){function r(o){var r=Sg(n,e.isPositionedAtTop()),u=r.pos,a=r.bounds,c=i.get(),s=c.pos,l=c.bounds,f=a.height!==l.height||a.width!==l.width;i.set({pos:u,bounds:a}),f&&os(t,o),e.isVisible()&&(s!==u?e.update(!0):f&&(e.updateMode(),e.repositionPopups()))}var i=fe(Sg(n,e.isPositionedAtTop()));o||(t.on("activate",e.show),t.on("deactivate",e.hide)),t.on("SkinLoaded ResizeWindow",(function(){return e.update(!0)})),t.on("NodeChange keydown",(function(t){Dk.requestAnimationFrame((function(){return r(t)}))})),t.on("ScrollWindow",(function(){return e.updateMode()}));var u=sr();u.set(dr(Ph.fromDom(t.getBody()),"load",r)),t.on("remove",(function(){u.clear()}))}(t,f,d,m),t.nodeChanged())}function u(){return Dk.setEditorTimeout(t,i,0)}var a=n.mothership,c=n.uiMothership,s=n.outerContainer,l=fe(null),f=Ph.fromDom(r.targetNode),d=wg(t,f,n,o,l),m=t.getParam("toolbar_persist",!1,"boolean");HD(t),t.on("show",i),t.on("hide",d.hide),m||(t.on("focus",u),t.on("blur",d.hide)),t.on("init",(function(){(t.hasFocus()||m)&&u()})),Dc(t,n);var g={show:function(){d.show()},hide:function(){d.hide()},enable:function(){Ec(n,!1)},disable:function(){Ec(n,!0)},isDisabled:function(){return tS.isDisabled(s)}};return{editorContainer:s.element.dom,api:g}}}),fB="contexttoolbar-hide",dB=function(t,n){var e,o,r,u,a=t.label.fold((function(){return{}}),(function(t){return{"aria-label":t}})),c=Ba(XO.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:a,selectOnFocus:!0,inputBehaviours:ex([QS.config({mode:"special",onEnter:function(t){return s.findPrimary(t).map((function(t){return ke(t),!0}))},onLeft:function(t,n){return n.cut(),Sh.none()},onRight:function(t,n){return n.cut(),Sh.none()}})])})),s=(e=c,o=t.commands,r=n,u=w(o,(function(t){return Ba(("contextformtogglebutton"===t.type?function(t,n,e){var o=n.original;o.primary;var r=m(o,["primary"]),u=Pn(Ja(yh(yh({},r),{type:"togglebutton",onAction:i})));return eB(u,e.backstage.shared.providers,[kg(t,n)])}:function(t,n,e){var o=n.original;o.primary;var r=m(o,["primary"]),u=Pn(Ka(yh(yh({},r),{type:"button",onAction:i})));return nB(u,e.backstage.shared.providers,[kg(t,n)])})(e,t,{backstage:{shared:{providers:r}}}))})),{asSpecs:function(){return w(u,(function(t){return t.asSpec()}))},findPrimary:function(t){return z(o,(function(n,e){return n.primary?Sh.from(u[e]).bind((function(n){return n.getOpt(t)})).filter(f(tS.isDisabled)):Sh.none()}))}});return[{title:Sh.none(),items:[c.asSpec()]},{title:Sh.none(),items:s.asSpecs()}]},mB={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},gB={maxHeightFunction:xx(),maxWidthFunction:vD()},pB=He("forward-slide"),hB=He("backward-slide"),vB=He("change-slide-event"),bB="tox-pop--resizing",yB="tox-pop--transition",xB={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},wB=(LD=["Infinity",(zD="[0-9]+")+"\\."+Fg(zD)+Fg(ND="[eE][+-]?[0-9]+"),"\\."+zD+Fg(ND),zD+Fg(ND)].join("|"),new RegExp("^([+-]?(?:"+LD+"))(.*)$")),SB={name:"lineheight",text:"Line height",icon:"line-height",getOptions:function(t){return t.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" ")},hash:function(t){return n=["fixed","relative","empty"],Sh.from(wB.exec(t)).bind((function(t){var e=Number(t[1]),o=t[2],r=o;return b(n,(function(t){return b(xB[t],(function(t){return r===t}))}))?Sh.some({value:e,unit:o}):Sh.none()})).map((function(t){return t.value+t.unit})).getOr(t);var n},display:c,watcher:function(t,n,e){return t.formatter.formatChanged("lineheight",e,!1,{value:n}).unbind},getCurrent:function(t){return Sh.from(t.queryCommandValue("LineHeight"))},setCurrent:function(t,n){return t.execCommand("LineHeight",!1,n)}},kB=function(t){return{type:"selection",root:Ph.fromDom(t.selection.getNode())}},CB={onLtr:function(){return[Qy,Yy,qy,Ky,Jy,$y,Tk,Ek,ka,wa,Sa,xa]},onRtl:function(){return[Qy,qy,Yy,Jy,Ky,$y,Tk,Ek,Sa,xa,ka,wa]}},OB={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},_B={type:"separator"},TB=function(t){function n(t){return{text:t.text,icon:t.icon,disabled:t.disabled,shortcut:t.shortcut}}var e;if(ah(t))return t;switch(t.type){case"separator":return _B;case"submenu":return yh(yh({type:"nestedmenuitem"},n(t)),{getSubmenuItems:function(){var n=t.getSubmenuItems();return ah(n)?n:w(n,TB)}});default:return yh(yh({type:"menuitem"},n(t)),{onAction:(e=t.onAction,function(){return e()})})}},EB=de([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),DB=EB.offset,BB=EB.absolute,MB=EB.fixed,AB=function(t,n,e,o,r){var i=n.getSnapPoints(t);return cp(i,e,o,r).orThunk((function(){return O(i,(function(t,n){var i,u,a,c,s,l,f,d=(i=n.sensor,n.range.left,n.range.top,c=ep(e,u=o,a=r),s=ep(i,u,a),l=Math.abs(c.left-s.left),f=Math.abs(c.top-s.top),vv(l,f));return t.deltas.fold((function(){return{deltas:Sh.some(d),snap:Sh.some(n)}}),(function(e){return(d.left+d.top)/2<=(e.left+e.top)/2?{deltas:Sh.some(d),snap:Sh.some(n)}:t}))}),{deltas:Sh.none(),snap:Sh.none()}).snap.map((function(t){return{output:ip(t.output,e,o,r),extra:t.extra}}))}))},FB=function(t,n,e,o,r){return cp(n.getSnapPoints(t),e,o,r)},IB=Object.freeze({__proto__:null,snapTo:function(t,n,e,o){var r,i,u,a=n.getTarget(t.element);n.repositionTarget&&(r=en(ft(t.element)),i=Gd(a),Rt(a,rp([ip((u=o).output,u.output,r,i),u.extra][0],0,i)))}}),RB="data-initial-z-index",VB=ne("snaps",[Ln("getSnapPoints"),So("onSensor"),Ln("leftAttr"),Ln("topAttr"),ee("lazyViewport",Tv),ee("mustSnap",!1)]),PB=[ee("useFixed",hh),Ln("blockerClass"),ee("getTarget",c),ee("onDrag",i),ee("repositionTarget",!0),ee("onDrop",i),ce("getBounds",Tv),VB],HB=Object.freeze({__proto__:null,getData:function(t){return Sh.from(vv(t.x,t.y))},getDelta:function(t,n){return vv(n.left-t.left,n.top-t.top)}}),zB=g(g([],PB,!0),[_o("dragger",{handlers:pp(hp)})],!1),NB=Object.freeze({__proto__:null,getData:function(t){var n,e=t.raw.touches;return 1===e.length?(n=e[0],Sh.some(vv(n.clientX,n.clientY))):Sh.none()},getDelta:function(t,n){return vv(n.left-t.left,n.top-t.top)}}),LB=g(g([],PB,!0),[_o("dragger",{handlers:pp(vp)})],!1),WB=g(g([],PB,!0),[_o("dragger",{handlers:pp((function(t,n,e){return g(g([],hp(t,n,e),!0),vp(t,n,e),!0)}))})],!1),UB=Yo({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:zB,touch:LB,mouseOrTouch:WB}),name:"dragging",active:{events:function(t,n){return t.dragger.handlers(t,n)}},extra:{snap:function(t){return{sensor:t.sensor,range:t.range,output:t.output,extra:Sh.from(t.extra)}}},state:Object.freeze({__proto__:null,init:function(){var t=Sh.none(),n=Sh.none(),e=a({});return yy({readState:e,reset:function(){t=Sh.none(),n=Sh.none()},update:function(n,e){return n.getData(e).bind((function(e){return o=n,r=e,i=t.map((function(t){return o.getDelta(t,r)})),t=Sh.some(r),i;var o,r,i}))},getStartData:function(){return n},setStartData:function(t){n=Sh.some(t)}})}}),apis:IB});(UD=WD=WD||{})[UD.None=0]="None",UD[UD.Both=1]="Both",UD[UD.Vertical=2]="Vertical";var jB,GB=a([Ln("lazySink"),Kn("dragBlockClass"),ce("getBounds",Tv),ee("useTabstopAt",vh),ee("eventOrder",{}),xi("modalBehaviours",[QS]),ko("onExecute"),Oo("onEscape")]),XB={sketch:c},YB=a([Hw({name:"draghandle",overrides:function(t,n){return{behaviours:ex([UB.config({mode:"mouse",getTarget:function(t){
return go(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),Vw({schema:[Ln("dom")],name:"title"}),Vw({factory:XB,schema:[Ln("dom")],name:"close"}),Vw({factory:XB,schema:[Ln("dom")],name:"body"}),Hw({factory:XB,schema:[Ln("dom")],name:"footer"}),Pw({factory:{sketch:function(t,n){return yh(yh({},t),{dom:n.dom,components:n.components})}},schema:[ee("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),ee("components",[])],name:"blocker"})]),qB=Gi({name:"ModalDialog",configFields:GB(),partFields:YB(),factory:function(t,n,e,o){var r,i=lr(),u=He("modal-events"),a=yh(yh({},t.eventOrder),((r={})[Ub()]=[u].concat(t.eventOrder["alloy.system.attached"]||[]),r));return{uid:t.uid,dom:t.dom,components:n,apis:{show:function(n){i.set(n);var e=t.lazySink(n).getOrDie(),r=o.blocker(),u=e.getSystem().build(yh(yh({},r),{components:r.components.concat([_y(n)]),behaviours:ex([ok.config({}),ra("dialog-blocker-events",[Ie(hb(),(function(){QS.focusIn(n)}))])])}));oi(e,u),QS.focusIn(n)},hide:function(t){i.clear(),pt(t.element).each((function(n){t.getSystem().getByDom(n).each((function(t){ii(t)}))}))},getBody:function(n){return Ri(n,t,"body")},getFooter:function(n){return Ri(n,t,"footer")},setIdle:function(t){mD.unblock(t)},setBusy:function(t,n){mD.block(t,n)}},eventOrder:a,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Si(t.modalBehaviours,[tk.config({}),QS.config({mode:"cyclic",onEnter:t.onExecute,onEscape:t.onEscape,useTabstopAt:t.useTabstopAt}),mD.config({getRoot:i.get}),ra(u,[ny((function(n){var e,o,r,i=n.element,u=Ri(n,t,"title").element,a=Et(i,"id").fold((function(){var t=He("dialog-label");return Ot(u,"id",t),t}),c);Ot(i,"aria-labelledby",a),e=n.element,o=Ri(n,t,"body").element,r=Sh.from(Tt(e,"id")).fold((function(){var t=He("dialog-describe");return Ot(o,"id",t),t}),c),Ot(e,"aria-describedby",r)}))])])}},apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),KB=Uv([Un("type"),Un("name")].concat(CC)),JB=qv,$B=[Zv("name","name",yn((function(){return He("button-name")})),Yv),Qn("icon"),ue("align","end",["start","end"]),ae("primary",!1),ae("disabled",!1)],QB=g(g([],$B,!0),[Un("text")],!1),ZB=g([jn("type",["submit","cancel","custom"])],QB,!0),tM=zn("type",{submit:ZB,cancel:ZB,custom:ZB,menu:g([jn("type",["menu"]),Qn("text"),Qn("tooltip"),Qn("icon"),qn("items",KB)],$B,!0)}),nM=[Un("type"),Un("text"),jn("level",["info","warn","error","success"]),Un("icon"),ee("url","")],eM=Uv(nM),oM=[Un("type"),Un("text"),ae("disabled",!1),ae("primary",!1),Zv("name","name",yn((function(){return He("button-name")})),Yv),Qn("icon"),ae("borderless",!1)],rM=Uv(oM),iM=[Un("type"),Un("name"),Un("label"),ae("disabled",!1)],uM=Uv(iM),aM=qv,cM=[Un("type"),Un("name")],sM=cM.concat([Qn("label")]),lM=sM.concat([ee("columns","auto")]),fM=Uv(lM),dM=jv([Un("value"),Un("text"),Un("icon")]),mM=Uv(sM),gM=Yv,pM=Uv(sM),hM=Yv,vM=cM.concat([ie("tag","textarea"),Un("scriptId"),Un("scriptUrl"),oe("settings",void 0,$v)]),bM=cM.concat([ie("tag","textarea"),Gn("init")]),yM=In((function(t){return Vn("customeditor.old",Dn(bM),t).orThunk((function(){return Vn("customeditor.new",Dn(vM),t)}))})),xM=Yv,wM=Uv(sM),SM=Bn(Wv),kM=[Un("type"),Un("html"),ue("presets","presentation",["presentation","document"])],CM=Uv(kM),OM=sM.concat([ae("sandboxed",!0)]),_M=Uv(OM),TM=Yv,EM=sM.concat([Wn("currentState",Uv([Ln("blob"),Un("url")]))]),DM=Uv(EM),BM=sM.concat([Qn("inputMode"),Qn("placeholder"),ae("maximized",!1),ae("disabled",!1)]),MM=Uv(BM),AM=Yv,FM=[Un("text"),Un("value")],IM=[Un("text"),qn("items",(jB=ot((function(){return RM})),{extract:function(t,n){return jB().extract(t,n)},toString:function(){return jB().toString()}}))],RM=Mn([Uv(FM),Uv(IM)]),VM=sM.concat([qn("items",RM),ae("disabled",!1)]),PM=Uv(VM),HM=Yv,zM=sM.concat([Yn("items",[Un("text"),Un("value")]),re("size",1),ae("disabled",!1)]),NM=Uv(zM),LM=Yv,WM=sM.concat([ae("constrain",!0),ae("disabled",!1)]),UM=Uv(WM),jM=Uv([Un("width"),Un("height")]),GM=[Un("type"),qn("header",Yv),qn("cells",Bn(Yv))],XM=Uv(GM),YM=sM.concat([Qn("placeholder"),ae("maximized",!1),ae("disabled",!1)]),qM=Uv(YM),KM=Yv,JM=sM.concat([ue("filetype","file",["image","media","file"]),ee("disabled",!1)]),$M=Uv(JM),QM=Uv([Un("value"),ee("meta",{})]),ZM=En((function(){return Fn("type",{alertbanner:eM,bar:Uv((e=_p("bar"),[Un("type"),e])),button:rM,checkbox:uM,colorinput:mM,colorpicker:pM,dropzone:wM,grid:Uv((t=_p("grid"),[Un("type"),Wn("columns",Xv),t])),iframe:_M,input:MM,listbox:PM,selectbox:NM,sizeinput:UM,textarea:qM,urlinput:$M,customeditor:yM,htmlpanel:CM,imagetools:DM,collection:fM,label:Uv((n=_p("label"),[Un("type"),Un("label"),n])),table:XM,panel:nA});var t,n,e})),tA=[Un("type"),ee("classes",[]),qn("items",ZM)],nA=Uv(tA),eA=[Zv("name","name",yn((function(){return He("tab-name")})),Yv),Un("title"),qn("items",ZM)],oA=[Un("type"),Yn("tabs",eA)],rA=Uv(oA),iA=QB,uA=tM,aA=Uv([Un("title"),Wn("body",Fn("type",{panel:nA,tabpanel:rA})),ie("size","normal"),qn("buttons",uA),ee("initialData",{}),ce("onAction",i),ce("onChange",i),ce("onSubmit",i),ce("onClose",i),ce("onCancel",i),ee("onTabChange",i)]),cA=Uv(g([jn("type",["cancel","custom"])],iA,!0)),sA=Uv([Un("title"),Un("url"),$n("height"),$n("width"),te("buttons",cA),ce("onAction",i),ce("onCancel",i),ce("onClose",i),ce("onMessage",i)]),lA=function(t){return ch(t)?[t].concat(D(j(t),lA)):sh(t)?D(t,lA):[]},fA={checkbox:aM,colorinput:gM,colorpicker:hM,dropzone:SM,input:AM,iframe:TM,sizeinput:jM,selectbox:LM,listbox:HM,size:jM,textarea:KM,urlinput:QM,customeditor:xM,collection:dM,togglemenuitem:JB},dA={open:function(t,n){var e=Ep(n);return t(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(t,n){return t(Pn(Vn("dialog",sA,n)))},redial:Ep},mA=ji({name:"TabButton",configFields:[ee("uid",void 0),Ln("value"),Zv("dom","dom",Sn((function(){return{attributes:{role:"tab",id:He("aria"),"aria-selected":"false"}}})),Gv()),Kn("action"),ee("domModification",{}),xi("tabButtonBehaviours",[ok,QS,pw]),Ln("view")],factory:function(t){return{uid:t.uid,dom:t.dom,components:t.components,events:ma(t.action),behaviours:Si(t.tabButtonBehaviours,[ok.config({}),QS.config({mode:"execution",useSpace:!0,useEnter:!0}),pw.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),gA=a([Ln("tabs"),Ln("dom"),ee("clickToDismiss",!1),xi("tabbarBehaviours",[eS,QS]),xo(["tabClass","selectedClass"])]),pA=a([zw({factory:mA,name:"tabs",unit:"tab",overrides:function(t){return{action:function(n){var e=n.getSystem().getByUid(t.uid).getOrDie(),o=eS.isHighlighted(e,n);(o&&t.clickToDismiss?function(t,n){eS.dehighlight(t,n),Se(t,Jb(),{tabbar:t,button:n})}:o?i:function(t,n){eS.highlight(t,n),Se(t,Kb(),{tabbar:t,button:n})})(e,n)},domModification:{classes:[t.markers.tabClass]}}}})]),hA=Gi({name:"Tabbar",configFields:gA(),partFields:pA(),factory:function(t,n){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Si(t.tabbarBehaviours,[eS.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){Ot(n.element,"aria-selected","true")},onDehighlight:function(t,n){Ot(n.element,"aria-selected","false")}}),QS.config({mode:"flow",getInitial:function(t){return eS.getHighlighted(t).map((function(t){return t.element}))},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),vA=ji({name:"Tabview",configFields:[xi("tabviewBehaviours",[tk])],factory:function(t){return{uid:t.uid,dom:t.dom,behaviours:Si(t.tabviewBehaviours,[tk.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),bA=a([ee("selectFirst",!0),So("onChangeTab"),So("onDismissTab"),ee("tabs",[]),xi("tabSectionBehaviours",[])]),yA=a([Vw({factory:hA,schema:[Ln("dom"),Xn("markers",[Ln("tabClass"),Ln("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),Vw({factory:vA,name:"tabview"})]),xA=Gi({name:"TabSection",configFields:bA(),partFields:yA(),factory:function(t,n){function e(n,e){Ii(n,t,"tabbar").each((function(t){e(t).each(ke)}))}return{uid:t.uid,dom:t.dom,components:n,behaviours:wi(t.tabSectionBehaviours),events:ty(E([t.selectFirst?[ny((function(t){e(t,eS.getFirst)}))]:[],[Ee(Kb(),(function(n,e){var o=e.event.button,r=pw.getValue(o);Ii(o,t,"tabview").each((function(n){_(t.tabs,(function(t){return t.value===r})).each((function(e){var r=e.view();Et(o.element,"id").each((function(t){Ot(n.element,"aria-labelledby",t)})),tk.set(n,r),t.onChangeTab(n,o,r)}))}))})),Ee(Jb(),(function(n,e){var o=e.event.button;t.onDismissTab(n,o)}))]])),apis:{getViewItems:function(n){return Ii(n,t,"tabview").map((function(t){return tk.contents(t)})).getOr([])},showTab:function(t,n){e(t,(function(t){return _(eS.getCandidates(t),(function(t){return pw.getValue(t)===n})).filter((function(n){return!eS.isHighlighted(t,n)}))}))}}}},apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),wA="send-data-to-section",SA="send-data-to-view",kA=He("update-dialog"),CA=He("update-title"),OA=He("update-body"),_A=He("update-footer"),TA=He("body-send-message"),EA=$C.deviceType.isTouch(),DA=function(t,n){function e(n,e){return Ee(n,(function(n,o){var r,i;r=n,i=function(r){e(t(),r,o.event,n)},JD.getState(r).get().each((function(t){i(t,r)}))}))}return g(g([],$p(e,n),!0),[e(zO,(function(t,n,e){n.onAction(t,{name:e.name})}))],!1)},BA=function(t,n,e){function o(n,e){return Ee(n,(function(n,o){var r,i;r=n,i=function(r){e(t(),r,o.event,n)},JD.getState(r).get().each((function(t){i(t.internalDialog,r)}))}))}return g(g([],$p(o,n),!0),[o(NO,(function(t,n){return n.onSubmit(t)})),o(VO,(function(t,n,e){n.onChange(t,{name:e.name})})),o(zO,(function(t,n,o,r){function i(){return QS.focusIn(r)}function u(t){return Dt(t,"disabled")||Et(t,"aria-disabled").exists((function(t){return"true"===t}))}var a=cv(r.element),c=$o(a);n.onAction(t,{name:o.name,value:o.value}),$o(a).fold(i,(function(t){u(t)||c.exists((function(n){return lt(t,n)&&u(n)}))?i():e().toOptional().filter((function(n){return!lt(n.element,t)})).each(i)}))})),o(UO,(function(t,n,e){n.onTabChange(t,{newTabName:e.name,oldTabName:e.oldName})})),ey((function(n){var e=t();pw.setValue(n,e.getData())}))],!1)},MA=Zp,AA=tinymce.util.Tools.resolve("tinymce.util.URI"),FA=["insertContent","setContent","execCommand","close","block","unblock"];bh.add("silver",(function(t){var n=Op(t),e=n.uiMothership,o=n.backstage,r=n.renderUI,i=n.getUi;return zs(t,o.shared),{renderUI:r,getWindowManagerImpl:a(ih({editor:t,backstage:o})),getNotificationManagerImpl:function(){return n=t,r=e,i={backstage:o}.backstage.shared,{open:function(t,e){function o(){e(),Ok.hide(s)}function u(){var t=_v(Ph.fromDom(n.getContentAreaContainer())),e=Tv(),o=Gy(e.x,t.x,t.right),r=Gy(e.y,t.y,t.bottom),i=Math.max(t.right,e.right),u=Math.max(t.bottom,e.bottom);return Sh.some(Ov(o,r,i-o,u-r))}var a=!t.closeButton&&t.timeout&&(0<t.timeout||t.timeout<0),c=Oy(Rk.sketch({text:t.text,level:_h(["success","error","warning","warn","info"],t.type)?t.type:void 0,progress:!0===t.progressBar,icon:Sh.from(t.icon),closeButton:!a,onAction:o,iconProvider:i.providers.icons,translationProvider:i.providers.translate})),s=Oy(Ok.sketch(yh({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:i.getSink,fireDismissalEventInstead:{}},i.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));return r.add(s),0<t.timeout&&Dk.setTimeout((function(){o()}),t.timeout),{close:o,moveTo:function(t,n){Ok.showAt(s,_y(c),{anchor:{type:"makeshift",x:t,y:n}})},moveRel:function(t,n){var e,o,r,a=_y(c),l={maxHeightFunction:xx()};"banner"!==n&&mh(t)?(e=function(){switch(n){case"bc-bc":return Ek;case"tc-tc":return Tk;case"tc-bc":return $y;default:return Qy}}(),o={type:"node",root:dv(),node:Sh.some(Ph.fromDom(t)),overrides:l,layouts:{onRtl:function(){return[e]},onLtr:function(){return[e]}}},Ok.showWithinBounds(s,a,{anchor:o},u)):(r=yh(yh({},i.anchors.banner()),{overrides:l}),Ok.showWithinBounds(s,a,{anchor:r},u))},text:function(t){Rk.updateText(c,t)},settings:t,getEl:function(){return c.element.dom},progressBar:{value:function(t){Rk.updateProgress(c,t)}}}},close:function(t){t.close()},reposition:function(t){0<t.length&&Th(t,(function(n,e){0===e?n.moveRel(null,"banner"):n.moveRel(t[e-1].getEl(),"bc-tc")}))},getArgs:function(t){return t.settings}};var n,r,i},ui:i()}}))}();