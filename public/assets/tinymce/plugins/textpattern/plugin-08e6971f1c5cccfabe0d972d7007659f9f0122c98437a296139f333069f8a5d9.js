!function(){"use strict";function t(t,n,r){if(r||2===arguments.length)for(var e,o=0,a=n.length;a>o;o++)!e&&o in n||((e=e||Array.prototype.slice.call(n,0,o))[o]=n[o]);return t.concat(e||Array.prototype.slice.call(n))}function n(t){return function(n){return e=typeof(r=n),(null===r?"null":"object"==e&&(Array.prototype.isPrototypeOf(r)||r.constructor&&"Array"===r.constructor.name)?"array":"object"==e&&(String.prototype.isPrototypeOf(r)||r.constructor&&"String"===r.constructor.name)?"string":e)===t;var r,e}}function r(){}function e(t){return function(){return t}}function o(t){return t}function a(){return Z}function i(t){return t()}function u(t,n){return-1<rt.call(t,n)}function f(t,n){for(var r=t.length,e=new Array(r),o=0;r>o;o++){var a=t[o];e[o]=n(a,o)}return e}function c(t,n){for(var r=0,e=t.length;e>r;r++)n(t[r],r)}function s(t,n){for(var r=[],e=0,o=t.length;o>e;e++){var a=t[e];n(a,e)&&r.push(a)}return r}function l(t,n,r){return function(t){for(var e,o=t.length-1;o>=0;o--)e=t[o],r=n(r,e,o)}(t),r}function d(t,n){for(var r=0,e=t.length;e>r;++r)if(!0!==n(t[r],r))return;return 1}function m(t){var n=[],r=[];return c(t,function(t){t.fold(function(t){n.push(t)},function(t){r.push(t)})}),{errors:n,values:r}}function g(t){return"inline-command"===t.type||"inline-format"===t.type}function p(t){return"block-command"===t.type||"block-format"===t.type}function h(t){function n(n){return ut.error({message:n,pattern:t})}function r(r,e,o){if(void 0===t.format)return void 0!==t.cmd?K(t.cmd)?ut.value(o(t.cmd,t.value)):n(r+" pattern has non-string `cmd` parameter"):n(r+" pattern is missing both `format` and `cmd` parameters");var a=void 0;if(z(t.format)){if(!d(t.format,K))return n(r+" pattern has non-string items in the `format` array");a=t.format}else{if(!K(t.format))return n(r+" pattern has non-string `format` parameter");a=[t.format]}return ut.value(e(a))}if(!X(t))return n("Raw pattern is not an object");if(!K(t.start))return n("Raw pattern is missing `start` parameter");if(void 0===t.end)return void 0!==t.replacement?K(t.replacement)?0===t.start.length?n("Replacement pattern has empty `start` parameter"):ut.value({type:"inline-command",start:"",end:t.start,cmd:"mceInsertContent",value:t.replacement}):n("Replacement pattern has non-string `replacement` parameter"):0===t.start.length?n("Block pattern has empty `start` parameter"):r("Block",function(n){return{type:"block-format",start:t.start,format:n[0]}},function(n,r){return{type:"block-command",start:t.start,cmd:n,value:r}});if(!K(t.end))return n("Inline pattern has non-string `end` parameter");if(0===t.start.length&&0===t.end.length)return n("Inline pattern has empty `start` and `end` parameters");var e=t.start,o=t.end;return 0===o.length&&(o=e,e=""),r("Inline",function(t){return{type:"inline-format",start:e,end:o,format:t}},function(t,n){return{type:"inline-command",start:e,end:o,cmd:t,value:n}})}function v(t){return"block-command"===t.type?{start:t.start,cmd:t.cmd,value:t.value}:"block-format"===t.type?{start:t.start,format:t.format}:"inline-command"===t.type?"mceInsertContent"===t.cmd&&""===t.start?{start:t.end,replacement:t.value}:{start:t.start,end:t.end,cmd:t.cmd,value:t.value}:"inline-format"===t.type?{start:t.start,end:t.end,format:1===t.format.length?t.format[0]:t.format}:void 0}function y(t){return{inlinePatterns:s(t,g),blockPatterns:(n=s(t,p),r=function(t,n){return t.start.length===n.start.length?0:t.start.length>n.start.length?-1:1},(e=nt.call(n,0)).sort(r),e)};var n,r,e}function b(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=ft.console;r&&(r.error||r.log).apply(r,t)}function k(t){var n=t.getParam("forced_root_block","p");return!1===n?"":!0===n?"p":n}function O(t,n){return{container:t,offset:n}}function w(t){return t.nodeType===Node.TEXT_NODE}function C(t,n,r,e){void 0===e&&(e=!0);var o=n.startContainer.parentNode,a=n.endContainer.parentNode;n.deleteContents(),e&&!r(n.startContainer)&&(w(n.startContainer)&&0===n.startContainer.data.length&&t.remove(n.startContainer),w(n.endContainer)&&0===n.endContainer.data.length&&t.remove(n.endContainer),pt(t,o,r),o!==a&&pt(t,a,r))}function E(t,n){var r,e=n.get(t);return z(e)&&(0<(r=e).length?tt.some(r[0]):tt.none()).exists(function(t){return ot.call(t,"block")})}function x(t){return 0===t.start.length}function R(t,n){var r=tt.from(t.dom.getParent(n.startContainer,t.dom.isBlock));return""===k(t)?r.orThunk(function(){return tt.some(t.getBody())}):r}function T(t){return function(n){return t===n?-1:0}}function P(t,n,r){if(w(t)&&n>=0)return tt.some(O(t,n));var e=gt(ht);return tt.from(e.backwards(t,n,T(t),r)).map(function(t){return O(t.container,t.container.data.length)})}function N(t,n,r){if(w(n)&&(0>r||r>n.data.length))return[];for(var e=[r],o=n;o!==t&&o.parentNode;){for(var a=o.parentNode,i=0;i<a.childNodes.length;i++)if(a.childNodes[i]===o){e.push(i);break}o=a}return o===t?e.reverse():[]}function S(t,n,r,e,o){return{start:N(t,n,r),end:N(t,e,o)}}function M(t,n){var r=n.slice(),e=r.pop(),o=r,a=function(t,n){return t.bind(function(t){return tt.from(t.childNodes[n])})},i=tt.some(t);return c(o,function(t,n){i=a(i,t)}),i.bind(function(t){return w(t)&&(0>e||e>t.data.length)?tt.none():tt.some({node:t,offset:e})})}function A(t,n){return M(t,n.start).bind(function(r){var e=r.node,o=r.offset;return M(t,n.end).map(function(t){var n=t.node,r=t.offset,a=document.createRange();return a.setStart(e,o),a.setEnd(n,r),a})})}function B(t,n,r){!function(t,n){if(w(t)&&t.length<=0)return tt.some(O(t,0));var r=gt(ht);return tt.from(r.forwards(t,0,T(t),n)).map(function(t){return O(t.container,0)})}(n,n).each(function(e){var o=e.container;yt(o,r.start.length,n).each(function(r){var e=t.createRng();e.setStart(o,0),e.setEnd(r.container,r.offset),C(t,e,function(t){return t===n})})})}function D(t,n){var r=t.dom,e=t.selection.getRng();return R(t,e).filter(function(n){var e=k(t),o=""===e&&r.is(n,"body")||r.is(n,e);return null!==n&&o}).bind(function(t){var e,o=t.textContent,a=n,i=(e=o).replace("\xa0"," ");return function(t,n,r){for(var e=0,o=t.length;o>e;e++){var a=t[e];if(n(a,e))return tt.some(a);if(r(a,e))break}return tt.none()}(a,function(t){return 0===e.indexOf(t.start)||0===i.indexOf(t.start)},Q).map(function(n){return dt.trim(o).length===n.start.length?[]:[{pattern:n,range:S(r.getRoot(),t,0,t,0)}]})}).getOr([])}function I(t,n){return t.create("span",{"data-mce-type":"bookmark",id:n})}function j(t,n){var r=t.createRng();return r.setStartAfter(n.start),r.setEndBefore(n.end),r}function _(t,n,r){var e=A(t.getRoot(),r).getOrDie("Unable to resolve path range"),o=e.startContainer,a=e.endContainer,i=0===e.endOffset?a:a.splitText(e.endOffset),u=0===e.startOffset?o:o.splitText(e.startOffset);return{prefix:n,end:i.parentNode.insertBefore(I(t,n+"-end"),i),start:u.parentNode.insertBefore(I(t,n+"-start"),u)}}function U(t,n,r){pt(t,t.get(n.prefix+"-end"),r),pt(t,t.get(n.prefix+"-start"),r)}function L(t,n,r){t.selection.setRng(r),"inline-format"===n.type?c(n.format,function(n){t.formatter.apply(n)}):t.execCommand(n.cmd,!1,n.value)}function V(t,n,r){var e=t.selection.getRng();return!1===e.collapsed?[]:R(t,e).bind(function(o){var a=e.startOffset-(r?1:0);return Ot(t,n,e.startContainer,a,o)}).fold(function(){return[]},function(t){return t.matches})}function W(t,n){var r,e,o,a,i,u,f;0!==n.length&&(r=t.dom,e=t.selection.getBookmark(),o=r,a=n,i=(new Date).getTime(),u="mce_textpattern_"+Math.floor(1e9*Math.random())+ ++bt+String(i),f=l(a,function(t,n){var r=_(o,u+"_end"+t.length,n.endRng);return t.concat([J(J({},n),{endMarker:r})])},[]),c(l(f,function(t,n){var r=f.length-t.length-1,e=x(n.pattern)?n.endMarker:_(o,u+"_start"+r,n.startRng);return t.concat([J(J({},n),{startMarker:e})])},[]),function(n){function e(t){return t===h}var o,a,i,u,f,c,s,l,d,m,g,p,h=r.getParent(n.startMarker.start,r.isBlock);x(n.pattern)?(a=n.pattern,i=n.endMarker,u=e,f=j((o=t).dom,i),C(o.dom,f,u),L(o,a,f)):(c=t,s=n.pattern,l=n.startMarker,d=n.endMarker,m=e,g=c.dom,p=j(g,d),C(g,j(g,l),m),C(g,p,m),L(c,s,j(g,{prefix:l.prefix,start:l.end,end:d.start}))),U(r,n.endMarker,e),U(r,n.startMarker,e)}),t.selection.moveToBookmark(e))}function q(t,n){var r=V(t,n.inlinePatterns,!0);0<r.length&&t.undoManager.transact(function(){W(t,r)})}function F(t,n,r){for(var e=0;e<t.length;e++)if(r(t[e],n))return 1}function G(t,n){var r=[",",".",";",":","!","?"],e=[32];t.on("keydown",function(r){13!==r.keyCode||lt.modifierPressed(r)||!function(t,n){if(t.selection.isCollapsed()){var r=V(t,n.inlinePatterns,!1),e=D(t,n.blockPatterns);return(0<e.length||0<r.length)&&(t.undoManager.add(),t.undoManager.extra(function(){t.execCommand("mceInsertNewLine")},function(){var n,o,a;t.insertContent("\ufeff"),W(t,r),n=t,0!==(o=e).length&&(a=n.selection.getBookmark(),c(o,function(t){return o=(r=n).dom,a=(e=t).pattern,i=A(o.getRoot(),e.range).getOrDie("Unable to resolve path range"),R(r,i).each(function(t){"block-format"===a.type?E(a.format,r.formatter)&&r.undoManager.transact(function(){B(r.dom,t,a),r.formatter.apply(a.format)}):"block-command"===a.type&&r.undoManager.transact(function(){B(r.dom,t,a),r.execCommand(a.cmd,!1,a.value)})}),1;var r,e,o,a,i}),n.selection.moveToBookmark(a));var i=t.selection.getRng(),u=P(i.startContainer,i.startOffset,t.dom.getRoot());t.execCommand("mceInsertNewLine"),u.each(function(n){var r=n.container;"\ufeff"===r.data.charAt(n.offset-1)&&(r.deleteData(n.offset-1,1),pt(t.dom,r.parentNode,function(n){return n===t.dom.getRoot()}))})}),1)}}(t,n.get())||r.preventDefault()},!0),t.on("keyup",function(r){F(e,r,function(t,n){return t===n.keyCode&&!1===lt.modifierPressed(n)})&&q(t,n.get())}),t.on("keypress",function(e){F(r,e,function(t,n){return t.charCodeAt(0)===n.charCode})&&st.setEditorTimeout(t,function(){q(t,n.get())})})}var H=tinymce.util.Tools.resolve("tinymce.PluginManager"),J=function(){return(J=Object.assign||function(t){for(var n,r=1,e=arguments.length;e>r;r++)for(var o in n=arguments[r])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},K=n("string"),X=n("object"),z=n("array"),Q=e(!1),Y=e(!0),Z={fold:function(t,n){return t()},isSome:Q,isNone:Y,getOr:o,getOrThunk:i,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:e(null),getOrUndefined:e(void 0),or:o,orThunk:i,map:a,each:r,bind:a,exists:Q,forall:Y,filter:function(){return Z},toArray:function(){return[]},toString:e("none()")},$=function(t){function n(){return a}function r(n){return n(t)}var o=e(t),a={fold:function(n,r){return r(t)},isSome:Y,isNone:Q,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:n,orThunk:n,map:function(n){return $(n(t))},each:function(n){n(t)},bind:r,exists:r,forall:r,filter:function(n){return n(t)?a:Z},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return a},tt={some:$,none:a,from:function(t){return null==t?Z:$(t)}},nt=Array.prototype.slice,rt=Array.prototype.indexOf,et=Object.keys,ot=Object.hasOwnProperty;!function(t){if(!z(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var n=[],r={};c(t,function(e,o){var a=et(e);if(1!==a.length)throw new Error("one and only one name per case");var i=a[0],f=e[i];if(void 0!==r[i])throw new Error("duplicate key detected:"+i);if("cata"===i)throw new Error("cannot have a case named cata (sorry)");if(!z(f))throw new Error("case arguments must be an array");n.push(i),r[i]=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var a=r.length;if(a!==f.length)throw new Error("Wrong number of arguments to case "+i+". Expected "+f.length+" ("+f+"), got "+a);return{fold:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(n.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+n.length);return n[o].apply(null,r)},match:function(t){var e=et(t);if(n.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+e.join(","));if(!d(n,function(t){return u(e,t)}))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+n.join(", "));return t[i].apply(null,r)},log:function(t){console.log(t,{constructors:n,constructor:i,params:r})}}}})}([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);var at=function(t){return{isValue:Y,isError:Q,getOr:e(t),getOrThunk:e(t),getOrDie:e(t),or:function(n){return at(t)},orThunk:function(n){return at(t)},fold:function(n,r){return r(t)},map:function(n){return at(n(t))},mapError:function(n){return at(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOptional:function(){return tt.some(t)}}},it=function(t){return{isValue:Q,isError:Y,getOr:o,getOrThunk:function(t){return t()},getOrDie:function(){return n=String(t),function(){throw new Error(n)}();var n},or:o,orThunk:function(t){return t()},fold:function(n,r){return n(t)},map:function(n){return it(t)},mapError:function(n){return it(n(t))},each:r,bind:function(n){return it(t)},exists:Q,forall:Y,toOptional:tt.none}},ut={value:at,error:it,fromOption:function(t,n){return t.fold(function(){return it(n)},at)}},ft="undefined"!=typeof window?window:Function("return this;")(),ct=[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1"},{start:"##",format:"h2"},{start:"###",format:"h3"},{start:"####",format:"h4"},{start:"#####",format:"h5"},{start:"######",format:"h6"},{start:"1. ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}],st=tinymce.util.Tools.resolve("tinymce.util.Delay"),lt=tinymce.util.Tools.resolve("tinymce.util.VK"),dt=tinymce.util.Tools.resolve("tinymce.util.Tools"),mt=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),gt=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),pt=function(t,n,r){var e;n&&t.isEmpty(n)&&!r(n)&&(e=n.parentNode,t.remove(n),pt(t,e,r))},ht=mt.DOM,vt=function(t,n,r){if(!w(t))return tt.none();var e=t.textContent;if(n>=0&&n<=e.length)return tt.some(O(t,n));var o=gt(ht);return tt.from(o.backwards(t,n,T(t),r)).bind(function(t){var e=t.container.data;return vt(t.container,n+e.length,r)})},yt=function(t,n,r){if(!w(t))return tt.none();var e=t.textContent;if(n<=e.length)return tt.some(O(t,n));var o=gt(ht);return tt.from(o.forwards(t,n,T(t),r)).bind(function(t){return yt(t.container,n-e.length,r)})},bt=0,kt=function(t,n,r,e){var o,a,i,f,c,s,l,d=n.start;return a=e.container,i=e.offset,o=d,f=function(t,n){var r=t.data.substring(0,n),e=r.lastIndexOf(o.charAt(o.length-1)),a=r.lastIndexOf(o);return-1!==a?a+o.length:-1!==e?e+1:-1},c=r,l=gt(t,(s=t,function(t){return s.isBlock(t)||u(["BR","IMG","HR","INPUT"],t.nodeName)||"false"===s.getContentEditable(t)})),tt.from(l.backwards(a,i,f,c)).bind(function(e){if(e.offset>=d.length){var o=t.createRng();return o.setStart(e.container,e.offset-d.length),o.setEnd(e.container,e.offset),tt.some(o)}var a=e.offset-d.length;return vt(e.container,a,r).map(function(n){var r=t.createRng();return r.setStart(n.container,n.offset),r.setEnd(e.container,e.offset),r}).filter(function(t){return t.toString()===d}).orThunk(function(){return kt(t,n,r,O(e.container,0))})})},Ot=function(t,n,r,e,o){var a=t.dom;return P(r,e,a.getRoot()).bind(function(i){var u=a.createRng();u.setStart(o,0),u.setEnd(r,e);for(var f,c=u.toString(),s=0;s<n.length;s++){var l,d,m=n[s],g=m.end;if(d=f=void 0,l=(f=c).length-g.length,""===(d=g)||f.length>=d.length&&f.substr(l,l+d.length)===d){var p=n.slice();p.splice(s,1);var h=function(t,n,r){var e=t.dom,o=e.getRoot(),a=r.pattern,i=r.position.container,u=r.position.offset;return vt(i,u-r.pattern.end.length,n).bind(function(f){var c=S(o,f.container,f.offset,i,u);if(x(a))return tt.some({matches:[{pattern:a,startRng:c,endRng:c}],position:f});var s=Ot(t,r.remainingPatterns,f.container,f.offset,n),l=s.getOr({matches:[],position:f}),d=l.position;return function(t,n,r,e,o,a){if(void 0===a&&(a=!1),0!==n.start.length||a)return P(r,e,o).bind(function(r){return kt(t,n,o,r).bind(function(t){if(a){if(t.endContainer===r.container&&t.endOffset===r.offset)return tt.none();if(0===r.offset&&t.endContainer.textContent.length===t.endOffset)return tt.none()}return tt.some(t)})});var i=t.createRng();return i.setStart(r,e),i.setEnd(r,e),tt.some(i)}(e,a,d.container,d.offset,n,s.isNone()).map(function(t){var n=S(o,t.startContainer,t.startOffset,t.endContainer,t.endOffset);return{matches:l.matches.concat([{pattern:a,startRng:n,endRng:c}]),position:O(t.startContainer,t.startOffset)}})})}(t,o,{pattern:m,remainingPatterns:p,position:i});if(h.isSome())return h}}return tt.none()})};H.add("textpattern",function(n){var r,e,o,a=(r=function(){var t=n.getParam("textpattern_patterns",ct,"array");if(!z(t))return b("The setting textpattern_patterns should be an array"),{inlinePatterns:[],blockPatterns:[]};var r=m(f(t,h));return c(r.errors,function(t){return b(t.message,t.pattern),0}),y(r.values)}(),e=r,{get:function(){return e},set:function(t){e=t}});return G(n,a),o=a,{setPatterns:function(t){var n=m(f(t,h));if(0<n.errors.length){var r=n.errors[0];throw new Error(r.message+":\n"+JSON.stringify(r.pattern,null,2))}o.set(y(n.values))},getPatterns:function(){return t(t([],f(o.get().inlinePatterns,v),!0),f(o.get().blockPatterns,v),!0)}}})}();