!function(){"use strict";function e(e){return e.getParam("pagebreak_split_block",!1)}function a(e){var a='<img src="'+t.transparentSrc+'" class="'+r+'" data-mce-resize="false" data-mce-placeholder />';return e?"<p>"+a+"</p>":a}var n=tinymce.util.Tools.resolve("tinymce.PluginManager"),t=tinymce.util.Tools.resolve("tinymce.Env"),r="mce-pagebreak";n.add("pagebreak",function(n){function t(){return c.execCommand("mcePageBreak")}function o(){return e(g)}var i,c,g,u,l,m;(i=n).addCommand("mcePageBreak",function(){i.insertContent(a(e(i)))}),(c=n).ui.registry.addButton("pagebreak",{icon:"page-break",tooltip:"Page break",onAction:t}),c.ui.registry.addMenuItem("pagebreak",{text:"Page break",icon:"page-break",onAction:t}),u=(g=n).getParam("pagebreak_separator","<!-- pagebreak -->"),l=new RegExp(u.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(e){return"\\"+e}),"gi"),g.on("BeforeSetContent",function(e){e.content=e.content.replace(l,a(o()))}),g.on("PreInit",function(){g.serializer.addNodeFilter("img",function(e){for(var a,n,t,i=e.length;i--;)(t=(n=e[i]).attr("class"))&&-1!==t.indexOf(r)&&(a=n.parent,g.schema.getBlockElements()[a.name]&&o()?(a.type=3,a.value=u,a.raw=!0,n.remove()):(n.type=3,n.value=u,n.raw=!0))})}),(m=n).on("ResolveName",function(e){"IMG"===e.target.nodeName&&m.dom.hasClass(e.target,r)&&(e.name="pagebreak")})})}();